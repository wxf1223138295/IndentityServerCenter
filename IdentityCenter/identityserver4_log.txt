2019-05-24 09:19:51.047 +08:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-05-24 09:19:51.078 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-05-24 09:19:51.078 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-05-24 09:19:51.079 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-05-24 09:19:51.079 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-05-24 09:19:51.079 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-05-24 09:19:51.290 +08:00 [DBG] Starting grant removal
2019-05-24 09:19:51.515 +08:00 [DBG] Login Url: /Account/Login
2019-05-24 09:19:51.517 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-24 09:19:51.517 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-24 09:19:51.518 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-24 09:19:51.518 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-24 09:19:51.518 +08:00 [DBG] Error Url: /home/error
2019-05-24 09:19:51.518 +08:00 [DBG] Error Id Parameter: errorId
2019-05-24 09:19:55.225 +08:00 [INF] AuthenticationScheme: idsrv was challenged.
2019-05-24 09:20:02.664 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-24 09:20:02.670 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-24 09:20:02.670 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-24 09:20:02.674 +08:00 [DBG] Start discovery request
2019-05-24 09:20:04.235 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-24 09:49:28.620 +08:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-05-24 09:49:28.671 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-05-24 09:49:28.671 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-05-24 09:49:28.671 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-05-24 09:49:28.671 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-05-24 09:49:28.672 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-05-24 09:49:28.799 +08:00 [DBG] Starting grant removal
2019-05-24 09:49:29.026 +08:00 [DBG] Login Url: /Account/Login
2019-05-24 09:49:29.030 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-24 09:49:29.030 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-24 09:49:29.030 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-24 09:49:29.030 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-24 09:49:29.030 +08:00 [DBG] Error Url: /home/error
2019-05-24 09:49:29.030 +08:00 [DBG] Error Id Parameter: errorId
2019-05-27 10:24:03.162 +08:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-05-27 10:24:03.195 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-05-27 10:24:03.195 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-05-27 10:24:03.195 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-05-27 10:24:03.196 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-05-27 10:24:03.196 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-05-27 10:24:03.373 +08:00 [DBG] Starting grant removal
2019-05-27 10:24:03.576 +08:00 [DBG] Login Url: /Account/Login
2019-05-27 10:24:03.579 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-27 10:24:03.579 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-27 10:24:03.579 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-27 10:24:03.579 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-27 10:24:03.579 +08:00 [DBG] Error Url: /home/error
2019-05-27 10:24:03.579 +08:00 [DBG] Error Id Parameter: errorId
2019-05-27 10:34:41.160 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 10:34:41.164 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 10:34:41.165 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 10:34:41.339 +08:00 [DBG] Start discovery request
2019-05-27 10:34:43.302 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 10:34:43.505 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 10:34:43.505 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 10:34:43.506 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 10:34:43.506 +08:00 [DBG] Start discovery request
2019-05-27 10:34:44.126 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 10:40:24.064 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 10:40:24.064 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 10:40:24.065 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 10:40:24.065 +08:00 [DBG] Start discovery request
2019-05-27 10:40:24.914 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 10:40:25.153 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-27 10:40:25.154 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-27 10:40:25.154 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-27 10:40:25.158 +08:00 [DBG] Start key discovery request
2019-05-27 10:40:35.474 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-27 10:40:35.484 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-27 10:40:35.484 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-27 10:40:35.492 +08:00 [DBG] Start token request.
2019-05-27 10:40:35.502 +08:00 [DBG] Start client validation
2019-05-27 10:40:35.510 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-27 10:40:35.514 +08:00 [DBG] Start parsing for secret in post body
2019-05-27 10:40:35.536 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-27 10:40:35.536 +08:00 [DBG] Secret id found: client
2019-05-27 10:40:36.926 +08:00 [DBG] client found in database: true
2019-05-27 10:40:36.936 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-27 10:40:36.947 +08:00 [DBG] No matching hashed secret found.
2019-05-27 10:40:36.947 +08:00 [DBG] Secret validators could not validate secret
2019-05-27 10:40:36.959 +08:00 [INF] {"ClientId":"client","Category":"Authentication","Name":"Client Authentication Failure","EventType":"Failure","Id":1011,"Message":"Invalid client secret","ActivityId":"0HLN299HE8JF9:00000003","TimeStamp":"2019-05-27T02:40:36.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"ClientAuthenticationFailureEvent"}
2019-05-27 10:40:36.965 +08:00 [ERR] Client secret validation failed for client: client.
2019-05-27 11:21:10.263 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 11:21:10.266 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 11:21:10.266 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 11:21:10.267 +08:00 [DBG] Start discovery request
2019-05-27 11:21:11.166 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 11:24:03.872 +08:00 [INF] Removing 0 grants
2019-05-27 11:25:09.270 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 11:25:09.272 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 11:25:09.272 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 11:25:09.272 +08:00 [DBG] Start discovery request
2019-05-27 11:25:09.984 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 11:26:06.824 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 11:26:06.825 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 11:26:06.825 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 11:26:06.825 +08:00 [DBG] Start discovery request
2019-05-27 11:26:07.589 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 11:27:37.903 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 11:27:37.904 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 11:27:37.904 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 11:27:37.904 +08:00 [DBG] Start discovery request
2019-05-27 11:27:38.672 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 11:35:21.073 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 11:35:21.073 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 11:35:21.073 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 11:35:21.074 +08:00 [DBG] Start discovery request
2019-05-27 11:35:22.038 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 11:35:22.153 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-27 11:35:22.154 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-27 11:35:22.154 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-27 11:35:22.156 +08:00 [DBG] Start key discovery request
2019-05-27 11:35:23.129 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-27 11:35:23.130 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-27 11:35:23.131 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-27 11:35:23.131 +08:00 [DBG] Start token request.
2019-05-27 11:35:23.131 +08:00 [DBG] Start client validation
2019-05-27 11:35:23.131 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-27 11:35:23.131 +08:00 [DBG] Start parsing for secret in post body
2019-05-27 11:35:23.137 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-27 11:35:23.137 +08:00 [DBG] Secret id found: client
2019-05-27 11:35:24.377 +08:00 [DBG] client found in database: true
2019-05-27 11:35:24.377 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-27 11:35:24.377 +08:00 [DBG] No matching hashed secret found.
2019-05-27 11:35:24.378 +08:00 [DBG] Secret validators could not validate secret
2019-05-27 11:35:24.378 +08:00 [INF] {"ClientId":"client","Category":"Authentication","Name":"Client Authentication Failure","EventType":"Failure","Id":1011,"Message":"Invalid client secret","ActivityId":"0HLN299HE8JFD:00000003","TimeStamp":"2019-05-27T03:35:24.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"ClientAuthenticationFailureEvent"}
2019-05-27 11:35:24.378 +08:00 [ERR] Client secret validation failed for client: client.
2019-05-27 11:37:02.626 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 11:37:02.627 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 11:37:02.627 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 11:37:02.627 +08:00 [DBG] Start discovery request
2019-05-27 11:37:03.458 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 11:37:03.646 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-27 11:37:03.646 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-27 11:37:03.646 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-27 11:37:03.646 +08:00 [DBG] Start key discovery request
2019-05-27 11:37:04.529 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-27 11:37:04.530 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-27 11:37:04.530 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-27 11:37:04.530 +08:00 [DBG] Start token request.
2019-05-27 11:37:04.531 +08:00 [DBG] Start client validation
2019-05-27 11:37:04.531 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-27 11:37:04.531 +08:00 [DBG] Start parsing for secret in post body
2019-05-27 11:37:04.531 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-27 11:37:04.531 +08:00 [DBG] Secret id found: client
2019-05-27 11:37:05.713 +08:00 [DBG] client found in database: true
2019-05-27 11:37:05.713 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-27 11:37:05.713 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-27 11:37:05.713 +08:00 [DBG] Client validation success
2019-05-27 11:37:05.714 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN299HE8JFE:00000003","TimeStamp":"2019-05-27T03:37:05.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-27 11:37:05.722 +08:00 [DBG] Start token request validation
2019-05-27 11:37:05.732 +08:00 [DBG] Start client credentials token request validation
2019-05-27 11:37:05.901 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 11:37:06.839 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 11:37:06.983 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 11:37:07.598 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 11:37:07.601 +08:00 [DBG] client credentials token request validation success
2019-05-27 11:37:07.609 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-27 11:37:07.636 +08:00 [DBG] Getting claims for access token for client: client
2019-05-27 11:37:07.784 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****YSeA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN299HE8JFE:00000003","TimeStamp":"2019-05-27T03:37:07.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-27 11:37:07.786 +08:00 [DBG] Token request success.
2019-05-27 11:37:13.251 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 11:37:13.252 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 11:37:13.252 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 11:37:13.252 +08:00 [DBG] Start discovery request
2019-05-27 11:37:14.030 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 11:37:14.284 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-27 11:37:14.285 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-27 11:37:14.285 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-27 11:37:14.285 +08:00 [DBG] Start key discovery request
2019-05-27 11:38:15.305 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 11:38:15.306 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 11:38:15.306 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 11:38:15.306 +08:00 [DBG] Start discovery request
2019-05-27 11:38:16.101 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 11:38:16.176 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-27 11:38:16.178 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-27 11:38:16.178 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-27 11:38:16.179 +08:00 [DBG] Start key discovery request
2019-05-27 11:38:16.912 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-27 11:38:16.914 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-27 11:38:16.914 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-27 11:38:16.914 +08:00 [DBG] Start token request.
2019-05-27 11:38:16.914 +08:00 [DBG] Start client validation
2019-05-27 11:38:16.914 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-27 11:38:16.915 +08:00 [DBG] Start parsing for secret in post body
2019-05-27 11:38:16.919 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-27 11:38:16.919 +08:00 [DBG] Secret id found: client
2019-05-27 11:38:18.185 +08:00 [DBG] client found in database: true
2019-05-27 11:38:18.185 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-27 11:38:18.185 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-27 11:38:18.185 +08:00 [DBG] Client validation success
2019-05-27 11:38:18.185 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN299HE8JFF:00000003","TimeStamp":"2019-05-27T03:38:18.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-27 11:38:18.185 +08:00 [DBG] Start token request validation
2019-05-27 11:38:18.186 +08:00 [DBG] Start client credentials token request validation
2019-05-27 11:38:18.317 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 11:38:18.937 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 11:38:19.072 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 11:38:19.688 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 11:38:19.688 +08:00 [DBG] client credentials token request validation success
2019-05-27 11:38:19.688 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-27 11:38:19.688 +08:00 [DBG] Getting claims for access token for client: client
2019-05-27 11:38:19.691 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****AIiw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN299HE8JFF:00000003","TimeStamp":"2019-05-27T03:38:19.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-27 11:38:19.691 +08:00 [DBG] Token request success.
2019-05-27 11:40:59.177 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 11:40:59.177 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 11:40:59.177 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 11:40:59.177 +08:00 [DBG] Start discovery request
2019-05-27 11:40:59.940 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 11:41:00.018 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-27 11:41:00.018 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-27 11:41:00.018 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-27 11:41:00.018 +08:00 [DBG] Start key discovery request
2019-05-27 11:41:00.083 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-27 11:41:00.083 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-27 11:41:00.084 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-27 11:41:00.084 +08:00 [DBG] Start token request.
2019-05-27 11:41:00.084 +08:00 [DBG] Start client validation
2019-05-27 11:41:00.084 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-27 11:41:00.084 +08:00 [DBG] Start parsing for secret in post body
2019-05-27 11:41:00.085 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-27 11:41:00.085 +08:00 [DBG] Secret id found: client
2019-05-27 11:41:01.307 +08:00 [DBG] client found in database: true
2019-05-27 11:41:01.307 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-27 11:41:01.307 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-27 11:41:01.307 +08:00 [DBG] Client validation success
2019-05-27 11:41:01.308 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN299HE8JFG:00000003","TimeStamp":"2019-05-27T03:41:01.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-27 11:41:01.308 +08:00 [DBG] Start token request validation
2019-05-27 11:41:01.308 +08:00 [DBG] Start client credentials token request validation
2019-05-27 11:41:01.436 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 11:41:02.058 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 11:41:02.190 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 11:41:02.807 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 11:41:02.808 +08:00 [DBG] client credentials token request validation success
2019-05-27 11:41:02.808 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-27 11:41:02.808 +08:00 [DBG] Getting claims for access token for client: client
2019-05-27 11:41:02.811 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****jpOw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN299HE8JFG:00000003","TimeStamp":"2019-05-27T03:41:02.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-27 11:41:02.811 +08:00 [DBG] Token request success.
2019-05-27 11:41:32.605 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 11:41:32.605 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 11:41:32.605 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 11:41:32.606 +08:00 [DBG] Start discovery request
2019-05-27 11:41:33.415 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 11:41:33.483 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-27 11:41:33.484 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-27 11:41:33.484 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-27 11:41:33.484 +08:00 [DBG] Start key discovery request
2019-05-27 11:41:33.540 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-27 11:41:33.542 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-27 11:41:33.543 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-27 11:41:33.543 +08:00 [DBG] Start token request.
2019-05-27 11:41:33.543 +08:00 [DBG] Start client validation
2019-05-27 11:41:33.543 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-27 11:41:33.543 +08:00 [DBG] Start parsing for secret in post body
2019-05-27 11:41:33.544 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-27 11:41:33.544 +08:00 [DBG] Secret id found: client
2019-05-27 11:41:34.770 +08:00 [DBG] client found in database: true
2019-05-27 11:41:34.771 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-27 11:41:34.771 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-27 11:41:34.771 +08:00 [DBG] Client validation success
2019-05-27 11:41:34.771 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN299HE8JFG:00000006","TimeStamp":"2019-05-27T03:41:34.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-27 11:41:34.771 +08:00 [DBG] Start token request validation
2019-05-27 11:41:34.771 +08:00 [DBG] Start client credentials token request validation
2019-05-27 11:41:34.907 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 11:41:35.544 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 11:41:35.678 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 11:41:36.304 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 11:41:36.305 +08:00 [DBG] client credentials token request validation success
2019-05-27 11:41:36.305 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-27 11:41:36.305 +08:00 [DBG] Getting claims for access token for client: client
2019-05-27 11:41:36.308 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****Atow","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN299HE8JFG:00000006","TimeStamp":"2019-05-27T03:41:36.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-27 11:41:36.308 +08:00 [DBG] Token request success.
2019-05-27 11:47:42.372 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-27 11:47:42.373 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-27 11:47:42.373 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-27 11:47:42.373 +08:00 [DBG] Start token request.
2019-05-27 11:47:42.374 +08:00 [DBG] Start client validation
2019-05-27 11:47:42.374 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-27 11:47:42.374 +08:00 [DBG] Start parsing for secret in post body
2019-05-27 11:47:42.374 +08:00 [DBG] client id without secret found
2019-05-27 11:47:42.374 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-27 11:47:42.375 +08:00 [DBG] Secret id found: client
2019-05-27 11:47:43.707 +08:00 [DBG] client found in database: true
2019-05-27 11:47:43.707 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-27 11:47:43.707 +08:00 [DBG] Hashed shared secret validator cannot process NoSecret
2019-05-27 11:47:43.707 +08:00 [DBG] Secret validators could not validate secret
2019-05-27 11:47:43.707 +08:00 [INF] {"ClientId":"client","Category":"Authentication","Name":"Client Authentication Failure","EventType":"Failure","Id":1011,"Message":"Invalid client secret","ActivityId":"0HLN299HE8JFH:00000001","TimeStamp":"2019-05-27T03:47:43.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"ClientAuthenticationFailureEvent"}
2019-05-27 11:47:43.708 +08:00 [ERR] Client secret validation failed for client: client.
2019-05-27 11:49:09.155 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-27 11:49:09.155 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-27 11:49:09.155 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-27 11:49:09.156 +08:00 [DBG] Start token request.
2019-05-27 11:49:09.156 +08:00 [DBG] Start client validation
2019-05-27 11:49:09.156 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-27 11:49:09.156 +08:00 [DBG] Start parsing for secret in post body
2019-05-27 11:49:09.157 +08:00 [DBG] No secret in post body found
2019-05-27 11:49:09.157 +08:00 [DBG] Parser found no secret
2019-05-27 11:49:09.157 +08:00 [INF] {"ClientId":"unknown","Category":"Authentication","Name":"Client Authentication Failure","EventType":"Failure","Id":1011,"Message":"No client id found","ActivityId":"0HLN299HE8JFI:00000001","TimeStamp":"2019-05-27T03:49:09.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"ClientAuthenticationFailureEvent"}
2019-05-27 11:49:09.157 +08:00 [ERR] No client identifier found
2019-05-27 11:49:27.308 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-27 11:49:27.308 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-27 11:49:27.309 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-27 11:49:27.309 +08:00 [DBG] Start token request.
2019-05-27 11:49:27.309 +08:00 [DBG] Start client validation
2019-05-27 11:49:27.309 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-27 11:49:27.309 +08:00 [DBG] Start parsing for secret in post body
2019-05-27 11:49:27.309 +08:00 [DBG] No secret in post body found
2019-05-27 11:49:27.309 +08:00 [DBG] Parser found no secret
2019-05-27 11:49:27.310 +08:00 [INF] {"ClientId":"unknown","Category":"Authentication","Name":"Client Authentication Failure","EventType":"Failure","Id":1011,"Message":"No client id found","ActivityId":"0HLN299HE8JFI:00000002","TimeStamp":"2019-05-27T03:49:27.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"ClientAuthenticationFailureEvent"}
2019-05-27 11:49:27.310 +08:00 [ERR] No client identifier found
2019-05-27 11:50:23.627 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-27 11:50:23.627 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-27 11:50:23.627 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-27 11:50:23.628 +08:00 [DBG] Start token request.
2019-05-27 11:50:23.628 +08:00 [DBG] Start client validation
2019-05-27 11:50:23.629 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-27 11:50:23.629 +08:00 [DBG] Start parsing for secret in post body
2019-05-27 11:50:23.646 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-27 11:50:23.646 +08:00 [DBG] Secret id found: client
2019-05-27 11:50:24.808 +08:00 [DBG] client found in database: true
2019-05-27 11:50:24.809 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-27 11:50:24.809 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-27 11:50:24.809 +08:00 [DBG] Client validation success
2019-05-27 11:50:24.809 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN299HE8JFI:00000003","TimeStamp":"2019-05-27T03:50:24.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-27 11:50:24.809 +08:00 [DBG] Start token request validation
2019-05-27 11:50:24.809 +08:00 [DBG] Start client credentials token request validation
2019-05-27 11:50:24.934 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 11:50:25.604 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 11:50:25.731 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 11:50:26.539 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 11:50:26.539 +08:00 [DBG] client credentials token request validation success
2019-05-27 11:50:26.539 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","client_secret":"***REDACTED***","client_id":"client"},"$type":"TokenRequestValidationLog"}
2019-05-27 11:50:26.539 +08:00 [DBG] Getting claims for access token for client: client
2019-05-27 11:50:26.542 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****zu3g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN299HE8JFI:00000003","TimeStamp":"2019-05-27T03:50:26.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-27 11:50:26.542 +08:00 [DBG] Token request success.
2019-05-27 11:51:27.852 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 11:51:27.860 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 11:51:27.866 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 11:51:27.867 +08:00 [DBG] Start discovery request
2019-05-27 11:51:28.669 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 11:51:28.891 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-27 11:51:28.892 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-27 11:51:28.892 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-27 11:51:28.892 +08:00 [DBG] Start key discovery request
2019-05-27 11:53:59.598 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-27 11:53:59.598 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-27 11:53:59.598 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-27 11:53:59.598 +08:00 [DBG] Start token request.
2019-05-27 11:53:59.598 +08:00 [DBG] Start client validation
2019-05-27 11:53:59.599 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-27 11:53:59.599 +08:00 [DBG] Start parsing for secret in post body
2019-05-27 11:53:59.606 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-27 11:53:59.606 +08:00 [DBG] Secret id found: client
2019-05-27 11:54:00.742 +08:00 [DBG] client found in database: true
2019-05-27 11:54:00.742 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-27 11:54:00.742 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-27 11:54:00.742 +08:00 [DBG] Client validation success
2019-05-27 11:54:00.742 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN299HE8JFK:00000001","TimeStamp":"2019-05-27T03:54:00.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-27 11:54:00.743 +08:00 [DBG] Start token request validation
2019-05-27 11:54:00.743 +08:00 [DBG] Start client credentials token request validation
2019-05-27 11:54:00.850 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 11:54:01.422 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 11:54:01.572 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 11:54:02.098 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 11:54:02.098 +08:00 [DBG] client credentials token request validation success
2019-05-27 11:54:02.098 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","client_secret":"***REDACTED***","client_id":"client"},"$type":"TokenRequestValidationLog"}
2019-05-27 11:54:02.098 +08:00 [DBG] Getting claims for access token for client: client
2019-05-27 11:54:02.101 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****niiA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN299HE8JFK:00000001","TimeStamp":"2019-05-27T03:54:02.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-27 11:54:02.101 +08:00 [DBG] Token request success.
2019-05-27 12:00:30.705 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-27 12:00:30.705 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-27 12:00:30.706 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-27 12:00:30.706 +08:00 [DBG] Start token request.
2019-05-27 12:00:30.706 +08:00 [DBG] Start client validation
2019-05-27 12:00:30.706 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-27 12:00:30.706 +08:00 [DBG] Start parsing for secret in post body
2019-05-27 12:00:30.707 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-27 12:00:30.707 +08:00 [DBG] Secret id found: client
2019-05-27 12:00:32.222 +08:00 [DBG] client found in database: true
2019-05-27 12:00:32.222 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-27 12:00:32.222 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-27 12:00:32.222 +08:00 [DBG] Client validation success
2019-05-27 12:00:32.222 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN299HE8JFL:00000001","TimeStamp":"2019-05-27T04:00:32.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-27 12:00:32.222 +08:00 [DBG] Start token request validation
2019-05-27 12:00:32.222 +08:00 [DBG] Start client credentials token request validation
2019-05-27 12:00:32.353 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 12:00:32.876 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 12:00:33.010 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 12:00:33.681 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 12:00:33.681 +08:00 [DBG] client credentials token request validation success
2019-05-27 12:00:33.681 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","client_secret":"***REDACTED***","client_id":"client"},"$type":"TokenRequestValidationLog"}
2019-05-27 12:00:33.682 +08:00 [DBG] Getting claims for access token for client: client
2019-05-27 12:00:33.685 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****gRhA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN299HE8JFL:00000001","TimeStamp":"2019-05-27T04:00:33.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-27 12:00:33.685 +08:00 [DBG] Token request success.
2019-05-27 12:00:46.176 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 12:00:46.177 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 12:00:46.177 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 12:00:46.178 +08:00 [DBG] Start discovery request
2019-05-27 12:00:46.843 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 12:00:47.197 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-27 12:00:47.198 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-27 12:00:47.198 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-27 12:00:47.199 +08:00 [DBG] Start key discovery request
2019-05-27 12:03:00.654 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-27 12:03:00.654 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-27 12:03:00.655 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-27 12:03:00.655 +08:00 [DBG] Start token request.
2019-05-27 12:03:00.655 +08:00 [DBG] Start client validation
2019-05-27 12:03:00.655 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-27 12:03:00.655 +08:00 [DBG] Start parsing for secret in post body
2019-05-27 12:03:00.655 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-27 12:03:00.655 +08:00 [DBG] Secret id found: client
2019-05-27 12:03:01.691 +08:00 [DBG] client found in database: true
2019-05-27 12:03:01.691 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-27 12:03:01.691 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-27 12:03:01.691 +08:00 [DBG] Client validation success
2019-05-27 12:03:01.691 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN299HE8JFM:00000001","TimeStamp":"2019-05-27T04:03:01.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-27 12:03:01.692 +08:00 [DBG] Start token request validation
2019-05-27 12:03:01.692 +08:00 [DBG] Start client credentials token request validation
2019-05-27 12:03:01.794 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 12:03:02.319 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 12:03:02.433 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 12:03:02.969 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 12:03:02.969 +08:00 [DBG] client credentials token request validation success
2019-05-27 12:03:02.969 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","client_secret":"***REDACTED***","client_id":"client"},"$type":"TokenRequestValidationLog"}
2019-05-27 12:03:02.969 +08:00 [DBG] Getting claims for access token for client: client
2019-05-27 12:03:02.972 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****VjfA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN299HE8JFM:00000001","TimeStamp":"2019-05-27T04:03:02.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-27 12:03:02.973 +08:00 [DBG] Token request success.
2019-05-27 12:04:46.342 +08:00 [INF] AuthenticationScheme: idsrv was challenged.
2019-05-27 12:06:30.274 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-27 12:06:30.274 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-27 12:06:30.274 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-27 12:06:30.275 +08:00 [DBG] Start token request.
2019-05-27 12:06:30.275 +08:00 [DBG] Start client validation
2019-05-27 12:06:30.276 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-27 12:06:30.282 +08:00 [DBG] Start parsing for secret in post body
2019-05-27 12:06:30.319 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-27 12:06:30.319 +08:00 [DBG] Secret id found: client
2019-05-27 12:06:31.373 +08:00 [DBG] client found in database: true
2019-05-27 12:06:31.373 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-27 12:06:31.373 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-27 12:06:31.373 +08:00 [DBG] Client validation success
2019-05-27 12:06:31.373 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN299HE8JFR:00000001","TimeStamp":"2019-05-27T04:06:31.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-27 12:06:31.373 +08:00 [DBG] Start token request validation
2019-05-27 12:06:31.373 +08:00 [DBG] Start client credentials token request validation
2019-05-27 12:06:31.478 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 12:06:32.059 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 12:06:32.186 +08:00 [DBG] Found [] identity scopes in database
2019-05-27 12:06:32.790 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-27 12:06:32.790 +08:00 [DBG] client credentials token request validation success
2019-05-27 12:06:32.790 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","client_secret":"***REDACTED***","client_id":"client"},"$type":"TokenRequestValidationLog"}
2019-05-27 12:06:32.790 +08:00 [DBG] Getting claims for access token for client: client
2019-05-27 12:06:32.793 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****L4CQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN299HE8JFR:00000001","TimeStamp":"2019-05-27T04:06:32.0000000Z","ProcessId":38348,"LocalIpAddress":"127.0.0.1:38278","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-27 12:06:32.793 +08:00 [DBG] Token request success.
2019-05-27 12:06:49.248 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 12:06:49.248 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 12:06:49.249 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 12:06:49.249 +08:00 [DBG] Start discovery request
2019-05-27 12:06:49.955 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 12:06:50.222 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-27 12:06:50.223 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-27 12:06:50.223 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-27 12:06:50.223 +08:00 [DBG] Start key discovery request
2019-05-27 12:11:47.326 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-27 12:11:47.327 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-27 12:11:47.327 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-27 12:11:47.327 +08:00 [DBG] Start discovery request
2019-05-27 12:11:48.277 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-27 12:11:48.516 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-27 12:11:48.517 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-27 12:11:48.517 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-27 12:11:48.517 +08:00 [DBG] Start key discovery request
2019-05-27 12:24:04.154 +08:00 [INF] Removing 0 grants
2019-05-27 13:24:04.526 +08:00 [INF] Removing 0 grants
2019-05-27 14:24:04.914 +08:00 [INF] Removing 0 grants
2019-05-27 15:24:05.322 +08:00 [INF] Removing 0 grants
2019-05-27 16:24:05.689 +08:00 [INF] Removing 0 grants
2019-05-27 17:24:06.044 +08:00 [INF] Removing 0 grants
2019-05-27 18:24:06.418 +08:00 [INF] Removing 0 grants
2019-05-27 19:24:06.755 +08:00 [INF] Removing 0 grants
2019-05-28 17:21:07.803 +08:00 [INF] Using the default authentication scheme idsrv for IdentityServer
2019-05-28 17:21:07.830 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for authentication
2019-05-28 17:21:07.831 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-in
2019-05-28 17:21:07.831 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for sign-out
2019-05-28 17:21:07.831 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for challenge
2019-05-28 17:21:07.831 +08:00 [DBG] Using idsrv as default ASP.NET Core scheme for forbid
2019-05-28 17:21:08.216 +08:00 [DBG] Starting grant removal
2019-05-28 17:21:08.442 +08:00 [DBG] Login Url: /Account/Login
2019-05-28 17:21:08.444 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-28 17:21:08.445 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-28 17:21:08.445 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-28 17:21:08.445 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-28 17:21:08.445 +08:00 [DBG] Error Url: /home/error
2019-05-28 17:21:08.445 +08:00 [DBG] Error Id Parameter: errorId
2019-05-28 17:32:40.039 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-28 17:32:40.069 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-28 17:32:40.069 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-28 17:32:40.069 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-28 17:32:40.070 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-28 17:32:40.070 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-28 17:32:40.461 +08:00 [DBG] Starting grant removal
2019-05-28 17:32:40.798 +08:00 [DBG] Login Url: /Account/Login
2019-05-28 17:32:40.802 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-28 17:32:40.802 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-28 17:32:40.802 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-28 17:32:40.802 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-28 17:32:40.802 +08:00 [DBG] Error Url: /home/error
2019-05-28 17:32:40.802 +08:00 [DBG] Error Id Parameter: errorId
2019-05-28 17:34:48.710 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-28 17:34:48.736 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-28 17:34:48.737 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-28 17:34:48.737 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-28 17:34:48.737 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-28 17:34:48.737 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-28 17:34:48.816 +08:00 [DBG] Starting grant removal
2019-05-28 17:34:49.118 +08:00 [DBG] Login Url: /Account/Login
2019-05-28 17:34:49.120 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-28 17:34:49.120 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-28 17:34:49.120 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-28 17:34:49.120 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-28 17:34:49.120 +08:00 [DBG] Error Url: /home/error
2019-05-28 17:34:49.120 +08:00 [DBG] Error Id Parameter: errorId
2019-05-28 17:36:40.764 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-28 17:36:40.791 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-28 17:36:40.791 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-28 17:36:40.792 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-28 17:36:40.792 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-28 17:36:40.792 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-28 17:36:41.195 +08:00 [DBG] Starting grant removal
2019-05-28 17:36:41.435 +08:00 [DBG] Login Url: /Account/Login
2019-05-28 17:36:41.437 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-28 17:36:41.437 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-28 17:36:41.438 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-28 17:36:41.438 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-28 17:36:41.438 +08:00 [DBG] Error Url: /home/error
2019-05-28 17:36:41.438 +08:00 [DBG] Error Id Parameter: errorId
2019-05-28 17:36:45.214 +08:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-05-28 17:45:47.954 +08:00 [ERR] Failed executing DbCommand (313ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `AspNetRoles` (
    `Id` nvarchar(450) NOT NULL,
    `ConcurrencyStamp` nvarchar(max) NULL,
    `Name` nvarchar(256) NULL,
    `NormalizedName` nvarchar(256) NULL,
    CONSTRAINT `PK_AspNetRoles` PRIMARY KEY (`Id`)
);
MySql.Data.MySqlClient.MySqlException (0x80004005): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'max) NULL,
    `Name` nvarchar(256) NULL,
    `NormalizedName` nvarchar(256) N' at line 3 ---> MySql.Data.MySqlClient.MySqlException (0x80004005): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'max) NULL,
    `Name` nvarchar(256) NULL,
    `NormalizedName` nvarchar(256) N' at line 3
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
2019-05-28 17:45:48.265 +08:00 [FTL] Application startup exception
MySql.Data.MySqlClient.MySqlException (0x80004005): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'max) NULL,
    `Name` nvarchar(256) NULL,
    `NormalizedName` nvarchar(256) N' at line 3 ---> MySql.Data.MySqlClient.MySqlException (0x80004005): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'max) NULL,
    `Name` nvarchar(256) NULL,
    `NormalizedName` nvarchar(256) N' at line 3
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at IdentityCenter.Startup.InitializeDatabase(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 128
   at IdentityCenter.Startup.Configure(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 105
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter.<>c__DisplayClass4_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2019-05-28 17:45:48.304 +08:00 [DBG] Starting grant removal
2019-05-28 17:45:48.806 +08:00 [ERR] Connection id "0HLN3A51P228I", Request id "0HLN3A51P228I:00000001": An unhandled exception was thrown by the application.
System.ArgumentNullException: Value cannot be null.
Parameter name: values
   at System.String.Join(String separator, IEnumerable`1 values)
   at Microsoft.Extensions.RazorViews.BaseView.EndWriteAttribute()
   at Microsoft.AspNetCore.Hosting.Views.ErrorPage.ExecuteAsync()
   at Microsoft.Extensions.RazorViews.BaseView.ExecuteAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2019-05-28 17:46:42.782 +08:00 [ERR] Failed executing DbCommand (294ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `AspNetRoles` (
    `Id` nvarchar(450) NOT NULL,
    `ConcurrencyStamp` nvarchar(max) NULL,
    `Name` nvarchar(256) NULL,
    `NormalizedName` nvarchar(256) NULL,
    CONSTRAINT `PK_AspNetRoles` PRIMARY KEY (`Id`)
);
MySql.Data.MySqlClient.MySqlException (0x80004005): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'max) NULL,
    `Name` nvarchar(256) NULL,
    `NormalizedName` nvarchar(256) N' at line 3 ---> MySql.Data.MySqlClient.MySqlException (0x80004005): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'max) NULL,
    `Name` nvarchar(256) NULL,
    `NormalizedName` nvarchar(256) N' at line 3
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
2019-05-28 17:46:43.127 +08:00 [FTL] Application startup exception
MySql.Data.MySqlClient.MySqlException (0x80004005): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'max) NULL,
    `Name` nvarchar(256) NULL,
    `NormalizedName` nvarchar(256) N' at line 3 ---> MySql.Data.MySqlClient.MySqlException (0x80004005): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'max) NULL,
    `Name` nvarchar(256) NULL,
    `NormalizedName` nvarchar(256) N' at line 3
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at IdentityCenter.Startup.InitializeDatabase(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 128
   at IdentityCenter.Startup.Configure(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 105
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter.<>c__DisplayClass4_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2019-05-28 17:46:43.177 +08:00 [DBG] Starting grant removal
2019-05-28 17:46:43.670 +08:00 [ERR] Connection id "0HLN3A5I3SB9Q", Request id "0HLN3A5I3SB9Q:00000001": An unhandled exception was thrown by the application.
System.ArgumentNullException: Value cannot be null.
Parameter name: values
   at System.String.Join(String separator, IEnumerable`1 values)
   at Microsoft.Extensions.RazorViews.BaseView.EndWriteAttribute()
   at Microsoft.AspNetCore.Hosting.Views.ErrorPage.ExecuteAsync()
   at Microsoft.Extensions.RazorViews.BaseView.ExecuteAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2019-05-28 17:56:48.821 +08:00 [ERR] Failed executing DbCommand (315ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `AspNetUsers` (
    `Id` nvarchar(450) NOT NULL,
    `AccessFailedCount` int NOT NULL,
    `CardHolderName` text NOT NULL,
    `CardNumber` text NOT NULL,
    `CardType` int NOT NULL,
    `City` text NOT NULL,
    `ConcurrencyStamp` text NULL,
    `Country` text NOT NULL,
    `Email` nvarchar(256) NULL,
    `EmailConfirmed` bit NOT NULL,
    `Expiration` text NOT NULL,
    `LastName` text NOT NULL,
    `LockoutEnabled` bit NOT NULL,
    `LockoutEnd` datetimeoffset NULL,
    `Name` text NOT NULL,
    `NormalizedEmail` nvarchar(256) NULL,
    `NormalizedUserName` nvarchar(256) NULL,
    `PasswordHash` text NULL,
    `PhoneNumber` text NULL,
    `PhoneNumberConfirmed` bit NOT NULL,
    `SecurityNumber` text NOT NULL,
    `SecurityStamp` text NULL,
    `State` text NOT NULL,
    `Street` text NOT NULL,
    `TwoFactorEnabled` bit NOT NULL,
    `UserName` nvarchar(256) NULL,
    `ZipCode` text NOT NULL,
    CONSTRAINT `PK_AspNetUsers` PRIMARY KEY (`Id`)
);
MySql.Data.MySqlClient.MySqlException (0x80004005): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'datetimeoffset NULL,
    `Name` text NOT NULL,
    `NormalizedEmail` nvarchar(' at line 15 ---> MySql.Data.MySqlClient.MySqlException (0x80004005): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'datetimeoffset NULL,
    `Name` text NOT NULL,
    `NormalizedEmail` nvarchar(' at line 15
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
2019-05-28 17:56:49.079 +08:00 [FTL] Application startup exception
MySql.Data.MySqlClient.MySqlException (0x80004005): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'datetimeoffset NULL,
    `Name` text NOT NULL,
    `NormalizedEmail` nvarchar(' at line 15 ---> MySql.Data.MySqlClient.MySqlException (0x80004005): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'datetimeoffset NULL,
    `Name` text NOT NULL,
    `NormalizedEmail` nvarchar(' at line 15
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at IdentityCenter.Startup.InitializeDatabase(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 128
   at IdentityCenter.Startup.Configure(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 105
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter.<>c__DisplayClass4_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2019-05-28 17:56:49.113 +08:00 [DBG] Starting grant removal
2019-05-28 17:56:49.623 +08:00 [ERR] Connection id "0HLN3AB6MDBQK", Request id "0HLN3AB6MDBQK:00000001": An unhandled exception was thrown by the application.
System.OverflowException: Arithmetic operation resulted in an overflow.
   at System.IO.StreamWriter.Write(String value)
   at Microsoft.AspNetCore.Hosting.Views.ErrorPage.ExecuteAsync()
   at Microsoft.Extensions.RazorViews.BaseView.ExecuteAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2019-05-28 17:56:49.623 +08:00 [ERR] Connection id "0HLN3AB6MDBQJ", Request id "0HLN3AB6MDBQJ:00000001": An unhandled exception was thrown by the application.
System.OverflowException: Arithmetic operation resulted in an overflow.
   at System.IO.StreamWriter.Write(String value)
   at Microsoft.Extensions.RazorViews.BaseView.Write(String value)
   at Microsoft.AspNetCore.Hosting.Views.ErrorPage.ExecuteAsync()
   at Microsoft.Extensions.RazorViews.BaseView.ExecuteAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2019-05-28 18:05:47.855 +08:00 [ERR] Failed executing DbCommand (289ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `AspNetRoles` (
    `Id` nvarchar(450) NOT NULL,
    `ConcurrencyStamp` text NULL,
    `Name` nvarchar(256) NULL,
    `NormalizedName` nvarchar(256) NULL,
    CONSTRAINT `PK_AspNetRoles` PRIMARY KEY (`Id`)
);
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AspNetRoles' already exists ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AspNetRoles' already exists
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
2019-05-28 18:05:48.210 +08:00 [FTL] Application startup exception
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AspNetRoles' already exists ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AspNetRoles' already exists
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at IdentityCenter.Startup.InitializeDatabase(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 128
   at IdentityCenter.Startup.Configure(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 105
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter.<>c__DisplayClass4_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2019-05-28 18:05:48.250 +08:00 [DBG] Starting grant removal
2019-05-28 18:05:48.764 +08:00 [ERR] Connection id "0HLN3AG7BPNFJ", Request id "0HLN3AG7BPNFJ:00000001": An unhandled exception was thrown by the application.
System.ObjectDisposedException: Cannot write to the response body, the response has completed.
Object name: 'HttpResponseStream'.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpResponseStream.ValidateState(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpResponseStream.FlushAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpResponseStream.Flush()
   at System.IO.StreamWriter.Flush(Boolean flushStream, Boolean flushEncoder)
   at System.IO.StreamWriter.Dispose(Boolean disposing)
   at System.IO.TextWriter.Dispose()
   at Microsoft.Extensions.RazorViews.BaseView.ExecuteAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2019-05-28 18:10:07.936 +08:00 [ERR] Failed executing DbCommand (308ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `AspNetUserTokens` (
    `UserId` nvarchar(450) NOT NULL,
    `LoginProvider` nvarchar(450) NOT NULL,
    `Name` nvarchar(450) NOT NULL,
    `Value` text NULL,
    CONSTRAINT `PK_AspNetUserTokens` PRIMARY KEY (`UserId`, `LoginProvider`, `Name`),
    CONSTRAINT `FK_AspNetUserTokens_AspNetUsers_UserId` FOREIGN KEY (`UserId`) REFERENCES `AspNetUsers` (`Id`) ON DELETE CASCADE
);
MySql.Data.MySqlClient.MySqlException (0x80004005): Specified key was too long; max key length is 3072 bytes ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Specified key was too long; max key length is 3072 bytes
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
2019-05-28 18:10:08.248 +08:00 [FTL] Application startup exception
MySql.Data.MySqlClient.MySqlException (0x80004005): Specified key was too long; max key length is 3072 bytes ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Specified key was too long; max key length is 3072 bytes
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at IdentityCenter.Startup.InitializeDatabase(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 128
   at IdentityCenter.Startup.Configure(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 105
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter.<>c__DisplayClass4_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2019-05-28 18:10:08.291 +08:00 [DBG] Starting grant removal
2019-05-28 18:10:08.724 +08:00 [ERR] Connection id "0HLN3AIKRM4FF", Request id "0HLN3AIKRM4FF:00000001": An unhandled exception was thrown by the application.
System.ArgumentNullException: Value cannot be null.
Parameter name: values
   at System.String.Join(String separator, IEnumerable`1 values)
   at Microsoft.Extensions.RazorViews.BaseView.EndWriteAttribute()
   at Microsoft.AspNetCore.Hosting.Views.ErrorPage.ExecuteAsync()
   at Microsoft.Extensions.RazorViews.BaseView.ExecuteAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2019-05-28 18:15:50.878 +08:00 [ERR] Failed executing DbCommand (282ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `AspNetUserTokens` (
    `UserId` nvarchar(400) NOT NULL,
    `LoginProvider` nvarchar(400) NOT NULL,
    `Name` nvarchar(400) NOT NULL,
    `Value` text NULL,
    CONSTRAINT `PK_AspNetUserTokens` PRIMARY KEY (`UserId`, `LoginProvider`, `Name`),
    CONSTRAINT `FK_AspNetUserTokens_AspNetUsers_UserId` FOREIGN KEY (`UserId`) REFERENCES `AspNetUsers` (`Id`) ON DELETE CASCADE
);
MySql.Data.MySqlClient.MySqlException (0x80004005): Specified key was too long; max key length is 3072 bytes ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Specified key was too long; max key length is 3072 bytes
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
2019-05-28 18:15:51.203 +08:00 [FTL] Application startup exception
MySql.Data.MySqlClient.MySqlException (0x80004005): Specified key was too long; max key length is 3072 bytes ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Specified key was too long; max key length is 3072 bytes
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at IdentityCenter.Startup.InitializeDatabase(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 128
   at IdentityCenter.Startup.Configure(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 105
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter.<>c__DisplayClass4_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2019-05-28 18:15:51.251 +08:00 [DBG] Starting grant removal
2019-05-28 18:15:51.758 +08:00 [ERR] Connection id "0HLN3ALR2GJD5", Request id "0HLN3ALR2GJD5:00000001": An unhandled exception was thrown by the application.
System.OverflowException: Arithmetic operation resulted in an overflow.
   at System.IO.StreamWriter.Write(String value)
   at Microsoft.AspNetCore.Hosting.Views.ErrorPage.ExecuteAsync()
   at Microsoft.Extensions.RazorViews.BaseView.ExecuteAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2019-05-28 18:15:51.758 +08:00 [ERR] Connection id "0HLN3ALR2GJD4", Request id "0HLN3ALR2GJD4:00000001": An unhandled exception was thrown by the application.
System.OverflowException: Arithmetic operation resulted in an overflow.
   at System.IO.StreamWriter.Write(String value)
   at Microsoft.Extensions.RazorViews.BaseView.Write(String value)
   at Microsoft.AspNetCore.Hosting.Views.ErrorPage.ExecuteAsync()
   at Microsoft.Extensions.RazorViews.BaseView.ExecuteAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2019-05-28 18:19:06.524 +08:00 [ERR] Failed executing DbCommand (305ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `AspNetRoles` (
    `Id` nvarchar(767) NOT NULL,
    `ConcurrencyStamp` text NULL,
    `Name` nvarchar(256) NULL,
    `NormalizedName` nvarchar(256) NULL,
    CONSTRAINT `PK_AspNetRoles` PRIMARY KEY (`Id`)
);
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AspNetRoles' already exists ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AspNetRoles' already exists
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
2019-05-28 18:19:06.854 +08:00 [FTL] Application startup exception
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AspNetRoles' already exists ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AspNetRoles' already exists
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at IdentityCenter.Startup.InitializeDatabase(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 128
   at IdentityCenter.Startup.Configure(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 105
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter.<>c__DisplayClass4_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2019-05-28 18:19:06.906 +08:00 [DBG] Starting grant removal
2019-05-28 18:19:07.487 +08:00 [ERR] Connection id "0HLN3ANLCJJO6", Request id "0HLN3ANLCJJO6:00000001": An unhandled exception was thrown by the application.
System.OverflowException: Arithmetic operation resulted in an overflow.
   at System.IO.StreamWriter.Write(String value)
   at Microsoft.AspNetCore.Hosting.Views.ErrorPage.ExecuteAsync()
   at Microsoft.Extensions.RazorViews.BaseView.ExecuteAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2019-05-28 18:19:07.487 +08:00 [ERR] Connection id "0HLN3ANLCJJO5", Request id "0HLN3ANLCJJO5:00000001": An unhandled exception was thrown by the application.
System.ArgumentOutOfRangeException: Index and count must refer to a location within the buffer.
Parameter name: chars
   at System.Text.EncoderNLS.GetBytes(Char[] chars, Int32 charIndex, Int32 charCount, Byte[] bytes, Int32 byteIndex, Boolean flush)
   at System.IO.StreamWriter.Flush(Boolean flushStream, Boolean flushEncoder)
   at System.IO.StreamWriter.Write(String value)
   at Microsoft.AspNetCore.Hosting.Views.ErrorPage.ExecuteAsync()
   at Microsoft.Extensions.RazorViews.BaseView.ExecuteAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2019-05-28 18:19:53.286 +08:00 [ERR] Failed executing DbCommand (291ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `AspNetUserLogins` (
    `LoginProvider` nvarchar(767) NOT NULL,
    `ProviderKey` nvarchar(767) NOT NULL,
    `ProviderDisplayName` text NULL,
    `UserId` nvarchar(767) NOT NULL,
    CONSTRAINT `PK_AspNetUserLogins` PRIMARY KEY (`LoginProvider`, `ProviderKey`),
    CONSTRAINT `FK_AspNetUserLogins_AspNetUsers_UserId` FOREIGN KEY (`UserId`) REFERENCES `AspNetUsers` (`Id`) ON DELETE CASCADE
);
MySql.Data.MySqlClient.MySqlException (0x80004005): Specified key was too long; max key length is 3072 bytes ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Specified key was too long; max key length is 3072 bytes
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
2019-05-28 18:19:53.615 +08:00 [FTL] Application startup exception
MySql.Data.MySqlClient.MySqlException (0x80004005): Specified key was too long; max key length is 3072 bytes ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Specified key was too long; max key length is 3072 bytes
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at IdentityCenter.Startup.InitializeDatabase(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 128
   at IdentityCenter.Startup.Configure(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 105
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter.<>c__DisplayClass4_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2019-05-28 18:19:53.661 +08:00 [DBG] Starting grant removal
2019-05-28 18:19:54.218 +08:00 [ERR] Connection id "0HLN3AO3ATF5O", Request id "0HLN3AO3ATF5O:00000001": An unhandled exception was thrown by the application.
System.ArgumentOutOfRangeException: Index and count must refer to a location within the buffer.
Parameter name: chars
   at System.Text.EncoderNLS.GetBytes(Char[] chars, Int32 charIndex, Int32 charCount, Byte[] bytes, Int32 byteIndex, Boolean flush)
   at System.IO.StreamWriter.Flush(Boolean flushStream, Boolean flushEncoder)
   at System.IO.StreamWriter.Write(String value)
   at Microsoft.AspNetCore.Hosting.Views.ErrorPage.ExecuteAsync()
   at Microsoft.Extensions.RazorViews.BaseView.ExecuteAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2019-05-28 18:19:54.218 +08:00 [ERR] Connection id "0HLN3AO3ATF5N", Request id "0HLN3AO3ATF5N:00000001": An unhandled exception was thrown by the application.
System.OverflowException: Arithmetic operation resulted in an overflow.
   at System.IO.StreamWriter.Write(String value)
   at Microsoft.AspNetCore.Hosting.Views.ErrorPage.ExecuteAsync()
   at Microsoft.Extensions.RazorViews.BaseView.ExecuteAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2019-05-28 18:22:18.835 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-28 18:22:18.866 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-28 18:22:18.866 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-28 18:22:18.866 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-28 18:22:18.866 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-28 18:22:18.866 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-28 18:22:19.297 +08:00 [DBG] Starting grant removal
2019-05-28 18:22:19.487 +08:00 [DBG] Login Url: /Account/Login
2019-05-28 18:22:19.490 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-28 18:22:19.491 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-28 18:22:19.491 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-28 18:22:19.491 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-28 18:22:19.491 +08:00 [DBG] Error Url: /home/error
2019-05-28 18:22:19.491 +08:00 [DBG] Error Id Parameter: errorId
2019-05-28 18:23:11.182 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-28 18:23:11.211 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-28 18:23:11.211 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-28 18:23:11.211 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-28 18:23:11.211 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-28 18:23:11.211 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-28 18:23:11.662 +08:00 [DBG] Starting grant removal
2019-05-28 18:23:11.931 +08:00 [DBG] Login Url: /Account/Login
2019-05-28 18:23:11.934 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-28 18:23:11.934 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-28 18:23:11.934 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-28 18:23:11.934 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-28 18:23:11.934 +08:00 [DBG] Error Url: /home/error
2019-05-28 18:23:11.934 +08:00 [DBG] Error Id Parameter: errorId
2019-05-28 23:30:50.803 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-28 23:30:50.837 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-28 23:30:50.838 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-28 23:30:50.838 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-28 23:30:50.838 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-28 23:30:50.838 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-28 23:30:51.096 +08:00 [DBG] Starting grant removal
2019-05-28 23:31:14.087 +08:00 [DBG] Login Url: /Account/Login
2019-05-28 23:31:14.095 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-28 23:31:14.095 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-28 23:31:14.096 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-28 23:31:14.096 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-28 23:31:14.096 +08:00 [DBG] Error Url: /home/error
2019-05-28 23:31:14.096 +08:00 [DBG] Error Id Parameter: errorId
2019-05-28 23:32:14.773 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-28 23:32:14.862 +08:00 [INF] {"Username":"admin","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLN3G62DV8H4:00000002","TimeStamp":"2019-05-28T15:32:14.0000000Z","ProcessId":40948,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-05-28 23:32:37.380 +08:00 [DBG] TaskCanceledException. Exiting.
2019-05-28 23:32:37.409 +08:00 [DBG] Stopping grant removal
2019-05-28 23:41:58.585 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-28 23:41:58.610 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-28 23:41:58.610 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-28 23:41:58.610 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-28 23:41:58.610 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-28 23:41:58.610 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-28 23:41:58.806 +08:00 [DBG] Starting grant removal
2019-05-28 23:42:05.833 +08:00 [DBG] Login Url: /Account/Login
2019-05-28 23:42:05.835 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-28 23:42:05.835 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-28 23:42:05.836 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-28 23:42:05.836 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-28 23:42:05.836 +08:00 [DBG] Error Url: /home/error
2019-05-28 23:42:05.836 +08:00 [DBG] Error Id Parameter: errorId
2019-05-28 23:43:42.785 +08:00 [DBG] TaskCanceledException. Exiting.
2019-05-28 23:43:42.819 +08:00 [DBG] Stopping grant removal
2019-05-28 23:43:57.971 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-28 23:43:57.998 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-28 23:43:57.999 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-28 23:43:57.999 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-28 23:43:57.999 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-28 23:43:57.999 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-28 23:43:58.185 +08:00 [DBG] Starting grant removal
2019-05-28 23:44:08.560 +08:00 [DBG] Login Url: /Account/Login
2019-05-28 23:44:08.562 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-28 23:44:08.562 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-28 23:44:08.562 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-28 23:44:08.563 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-28 23:44:08.563 +08:00 [DBG] Error Url: /home/error
2019-05-28 23:44:08.563 +08:00 [DBG] Error Id Parameter: errorId
2019-05-28 23:44:10.643 +08:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The partial view '_ValidationScriptsPartial' was not found. The following locations were searched:
/Views/Account/_ValidationScriptsPartial.cshtml
/Views/Shared/_ValidationScriptsPartial.cshtml
/Pages/Shared/_ValidationScriptsPartial.cshtml
   at Microsoft.AspNetCore.Mvc.ViewFeatures.HtmlHelper.RenderPartialCoreAsync(String partialViewName, Object model, ViewDataDictionary viewData, TextWriter writer)
   at AspNetCore.Views_Account_Register.<ExecuteAsync>b__24_2() in /XiaofengWang的文稿/IndentityserverCentity/IdentityCenter/Views/Account/Register.cshtml:line 104
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSectionAsyncCore(String sectionName, Boolean required)
   at Microsoft.AspNetCore.Mvc.Razor.RazorPage.RenderSection(String name, Boolean required)
   at AspNetCore.Views_Shared__Layout.<>c__DisplayClass24_0.<<ExecuteAsync>b__1>d.MoveNext() in /XiaofengWang的文稿/IndentityserverCentity/IdentityCenter/Views/Shared/_Layout.cshtml:line 59
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext.SetOutputContentAsync()
   at AspNetCore.Views_Shared__Layout.ExecuteAsync() in /XiaofengWang的文稿/IndentityserverCentity/IdentityCenter/Views/Shared/_Layout.cshtml:line 7
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderLayoutAsync(ViewContext context, ViewBufferTextWriter bodyWriter)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync[TFilter,TFilterAsync]()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-28 23:58:58.309 +08:00 [DBG] TaskCanceledException. Exiting.
2019-05-28 23:58:58.321 +08:00 [DBG] Stopping grant removal
2019-05-28 23:59:18.825 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-28 23:59:18.850 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-28 23:59:18.850 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-28 23:59:18.850 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-28 23:59:18.850 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-28 23:59:18.850 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-28 23:59:19.021 +08:00 [DBG] Starting grant removal
2019-05-28 23:59:24.090 +08:00 [DBG] Login Url: /Account/Login
2019-05-28 23:59:24.092 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-28 23:59:24.092 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-28 23:59:24.092 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-28 23:59:24.093 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-28 23:59:24.093 +08:00 [DBG] Error Url: /home/error
2019-05-28 23:59:24.093 +08:00 [DBG] Error Id Parameter: errorId
2019-05-29 00:01:10.943 +08:00 [DBG] CORS request made for path: /Account/Register from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-29 00:02:37.180 +08:00 [DBG] TaskCanceledException. Exiting.
2019-05-29 00:02:37.222 +08:00 [DBG] Stopping grant removal
2019-05-29 00:03:20.855 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-29 00:03:20.882 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-29 00:03:20.883 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-29 00:03:20.883 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-29 00:03:20.883 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-29 00:03:20.883 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-29 00:03:21.186 +08:00 [DBG] Starting grant removal
2019-05-29 00:03:21.960 +08:00 [DBG] Login Url: /Account/Login
2019-05-29 00:03:21.965 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-29 00:03:21.965 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-29 00:03:21.965 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-29 00:03:21.965 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-29 00:03:21.970 +08:00 [DBG] Error Url: /home/error
2019-05-29 00:03:21.970 +08:00 [DBG] Error Id Parameter: errorId
2019-05-29 00:04:32.886 +08:00 [DBG] CORS request made for path: /Account/Register from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-29 00:04:58.984 +08:00 [DBG] CORS request made for path: /Account/Register from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-29 00:06:19.351 +08:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-05-29 00:06:31.020 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-29 00:06:31.070 +08:00 [INF] {"Username":"shawn","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLN3GO0T3MI2:00000009","TimeStamp":"2019-05-28T16:06:31.0000000Z","ProcessId":41589,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-05-29 00:10:12.562 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-29 00:10:12.595 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-29 00:10:12.595 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-29 00:10:12.595 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-29 00:10:12.595 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-29 00:10:12.595 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-29 00:10:12.952 +08:00 [DBG] Starting grant removal
2019-05-29 00:10:13.577 +08:00 [DBG] Login Url: /Account/Login
2019-05-29 00:10:13.579 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-29 00:10:13.579 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-29 00:10:13.579 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-29 00:10:13.579 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-29 00:10:13.580 +08:00 [DBG] Error Url: /home/error
2019-05-29 00:10:13.580 +08:00 [DBG] Error Id Parameter: errorId
2019-05-29 00:10:16.001 +08:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-05-29 00:11:06.022 +08:00 [DBG] CORS request made for path: /Account/Register from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-29 00:11:20.299 +08:00 [WRN] User 04c23b6f-152e-4c2b-9705-92a328c5cfd4 password validation failed: PasswordRequiresUpper.
2019-05-29 00:12:05.713 +08:00 [DBG] CORS request made for path: /Account/Register from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-29 00:12:18.251 +08:00 [WRN] User 93200d4c-e01a-4f23-8cc8-2b1822e24b19 password validation failed: PasswordRequiresDigit.
2019-05-29 00:12:44.602 +08:00 [DBG] CORS request made for path: /Account/Register from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-29 00:13:15.519 +08:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-05-29 00:13:29.653 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-29 00:13:29.694 +08:00 [INF] {"Username":"shawn","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLN3GRRK0PIC:00000012","TimeStamp":"2019-05-28T16:13:29.0000000Z","ProcessId":41714,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-05-29 00:14:30.398 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-29 00:14:30.403 +08:00 [INF] {"Username":"1223138295@qq.com","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLN3GRRK0PIC:00000013","TimeStamp":"2019-05-28T16:14:30.0000000Z","ProcessId":41714,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-05-29 00:29:44.025 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-29 00:29:44.050 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-29 00:29:44.050 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-29 00:29:44.050 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-29 00:29:44.050 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-29 00:29:44.050 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-29 00:29:44.242 +08:00 [DBG] Starting grant removal
2019-05-29 00:29:48.608 +08:00 [DBG] Login Url: /Account/Login
2019-05-29 00:29:48.611 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-29 00:29:48.611 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-29 00:29:48.611 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-29 00:29:48.611 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-29 00:29:48.611 +08:00 [DBG] Error Url: /home/error
2019-05-29 00:29:48.612 +08:00 [DBG] Error Id Parameter: errorId
2019-05-29 00:29:59.661 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-29 00:30:00.485 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"1223138295@qq.com","DisplayName":"shawn","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLN3H6PRHVL3:00000002","TimeStamp":"2019-05-28T16:30:00.0000000Z","ProcessId":42314,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-29 00:30:01.024 +08:00 [DBG] Augmenting SignInContext
2019-05-29 00:30:01.027 +08:00 [DBG] Adding idp claim with value: local
2019-05-29 00:30:01.027 +08:00 [DBG] Adding amr claim with value: pwd
2019-05-29 00:30:01.028 +08:00 [DBG] Adding auth_time claim with value: 1559061001
2019-05-29 00:30:01.046 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-29 00:30:01.320 +08:00 [DBG] 0 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-05-29 00:30:22.204 +08:00 [DBG] TaskCanceledException. Exiting.
2019-05-29 00:30:22.246 +08:00 [DBG] Stopping grant removal
2019-05-29 16:52:13.838 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-29 16:52:13.866 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-29 16:52:13.866 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-29 16:52:13.867 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-29 16:52:13.867 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-29 16:52:13.867 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-29 16:52:14.285 +08:00 [DBG] Starting grant removal
2019-05-29 16:52:14.502 +08:00 [DBG] Login Url: /Account/Login
2019-05-29 16:52:14.504 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-29 16:52:14.504 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-29 16:52:14.504 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-29 16:52:14.505 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-29 16:52:14.505 +08:00 [DBG] Error Url: /home/error
2019-05-29 16:52:14.505 +08:00 [DBG] Error Id Parameter: errorId
2019-05-29 16:56:42.159 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-29 16:56:42.186 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-29 16:56:42.186 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-29 16:56:42.186 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-29 16:56:42.186 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-29 16:56:42.187 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-29 16:56:42.590 +08:00 [DBG] Starting grant removal
2019-05-29 16:56:42.837 +08:00 [DBG] Login Url: /Account/Login
2019-05-29 16:56:42.839 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-29 16:56:42.839 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-29 16:56:42.839 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-29 16:56:42.839 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-29 16:56:42.839 +08:00 [DBG] Error Url: /home/error
2019-05-29 16:56:42.839 +08:00 [DBG] Error Id Parameter: errorId
2019-05-29 17:03:10.670 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-29 17:03:10.674 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-29 17:03:10.674 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-29 17:03:10.677 +08:00 [DBG] Start discovery request
2019-05-29 17:03:11.824 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-29 17:03:12.075 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-29 17:03:12.076 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-29 17:03:12.076 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-29 17:03:12.079 +08:00 [DBG] Start key discovery request
2019-05-29 17:03:12.312 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-29 17:03:12.320 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-29 17:03:12.320 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-29 17:03:12.328 +08:00 [DBG] Start token request.
2019-05-29 17:03:12.337 +08:00 [DBG] Start client validation
2019-05-29 17:03:12.342 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-29 17:03:12.347 +08:00 [DBG] Start parsing for secret in post body
2019-05-29 17:03:12.367 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-29 17:03:12.368 +08:00 [DBG] Secret id found: client
2019-05-29 17:03:13.542 +08:00 [DBG] client found in database: true
2019-05-29 17:03:13.551 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-29 17:03:13.560 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-29 17:03:13.561 +08:00 [DBG] Client validation success
2019-05-29 17:03:13.574 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN42E928H6L:00000003","TimeStamp":"2019-05-29T09:03:13.0000000Z","ProcessId":23864,"LocalIpAddress":"127.0.0.1:46886","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-29 17:03:13.584 +08:00 [DBG] Start token request validation
2019-05-29 17:03:13.591 +08:00 [DBG] Start client credentials token request validation
2019-05-29 17:03:13.740 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:03:14.263 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:03:14.385 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:03:14.897 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:03:14.900 +08:00 [DBG] client credentials token request validation success
2019-05-29 17:03:14.908 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-29 17:03:14.933 +08:00 [DBG] Getting claims for access token for client: client
2019-05-29 17:03:15.042 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****ed3Q","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN42E928H6L:00000003","TimeStamp":"2019-05-29T09:03:15.0000000Z","ProcessId":23864,"LocalIpAddress":"127.0.0.1:46886","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-29 17:03:15.043 +08:00 [DBG] Token request success.
2019-05-29 17:03:15.289 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-29 17:03:15.291 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-29 17:03:15.292 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-29 17:03:15.292 +08:00 [DBG] Start discovery request
2019-05-29 17:03:15.902 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-29 17:03:16.124 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-29 17:03:16.124 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-29 17:03:16.125 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-29 17:03:16.125 +08:00 [DBG] Start key discovery request
2019-05-29 17:03:32.833 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-29 17:03:32.836 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-29 17:03:32.836 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-29 17:03:32.837 +08:00 [DBG] Start discovery request
2019-05-29 17:03:33.706 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-29 17:03:33.793 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-29 17:03:33.794 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-29 17:03:33.794 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-29 17:03:33.794 +08:00 [DBG] Start key discovery request
2019-05-29 17:03:35.867 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-29 17:03:35.868 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-29 17:03:35.868 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-29 17:03:35.868 +08:00 [DBG] Start token request.
2019-05-29 17:03:35.868 +08:00 [DBG] Start client validation
2019-05-29 17:03:35.868 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-29 17:03:35.868 +08:00 [DBG] Start parsing for secret in post body
2019-05-29 17:03:35.869 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-29 17:03:35.870 +08:00 [DBG] Secret id found: ro.client
2019-05-29 17:03:36.874 +08:00 [DBG] ro.client found in database: true
2019-05-29 17:03:36.874 +08:00 [DBG] client configuration validation for client ro.client succeeded.
2019-05-29 17:03:36.875 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-29 17:03:36.875 +08:00 [DBG] Client validation success
2019-05-29 17:03:36.875 +08:00 [INF] {"ClientId":"ro.client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN42E928H6L:00000008","TimeStamp":"2019-05-29T09:03:36.0000000Z","ProcessId":23864,"LocalIpAddress":"127.0.0.1:46886","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-29 17:03:36.875 +08:00 [DBG] Start token request validation
2019-05-29 17:03:36.884 +08:00 [DBG] Start resource owner password token request validation
2019-05-29 17:03:36.985 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:03:37.482 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:03:37.583 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:03:38.078 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:03:38.081 +08:00 [INF] User authentication failed: ["invalid_username_or_password"], request details: {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"1223138295@qq.com","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"1223138295@qq.com","password":"***REDACTED***","scope":"api1","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-29 17:03:38.081 +08:00 [INF] {"Username":"1223138295@qq.com","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid_username_or_password","ActivityId":"0HLN42E928H6L:00000008","TimeStamp":"2019-05-29T09:03:38.0000000Z","ProcessId":23864,"LocalIpAddress":"127.0.0.1:46886","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-05-29 17:03:38.083 +08:00 [INF] {"ClientId":"ro.client","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"password","Error":"invalid_grant","ErrorDescription":"invalid_username_or_password","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLN42E928H6L:00000008","TimeStamp":"2019-05-29T09:03:38.0000000Z","ProcessId":23864,"LocalIpAddress":"127.0.0.1:46886","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-05-29 17:04:48.163 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-29 17:04:48.164 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-29 17:04:48.172 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-29 17:04:48.172 +08:00 [DBG] Start discovery request
2019-05-29 17:04:48.842 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-29 17:04:48.901 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-29 17:04:48.901 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-29 17:04:48.901 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-29 17:04:48.901 +08:00 [DBG] Start key discovery request
2019-05-29 17:04:50.823 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-29 17:04:50.824 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-29 17:04:50.824 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-29 17:04:50.824 +08:00 [DBG] Start token request.
2019-05-29 17:04:50.824 +08:00 [DBG] Start client validation
2019-05-29 17:04:50.824 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-29 17:04:50.824 +08:00 [DBG] Start parsing for secret in post body
2019-05-29 17:04:50.825 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-29 17:04:50.825 +08:00 [DBG] Secret id found: ro.client
2019-05-29 17:04:51.794 +08:00 [DBG] ro.client found in database: true
2019-05-29 17:04:51.794 +08:00 [DBG] client configuration validation for client ro.client succeeded.
2019-05-29 17:04:51.794 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-29 17:04:51.794 +08:00 [DBG] Client validation success
2019-05-29 17:04:51.794 +08:00 [INF] {"ClientId":"ro.client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN42E928H6M:00000003","TimeStamp":"2019-05-29T09:04:51.0000000Z","ProcessId":23864,"LocalIpAddress":"127.0.0.1:46886","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-29 17:04:51.794 +08:00 [DBG] Start token request validation
2019-05-29 17:04:51.794 +08:00 [DBG] Start resource owner password token request validation
2019-05-29 17:04:51.904 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:04:52.402 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:04:52.503 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:04:52.972 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:04:52.972 +08:00 [INF] User authentication failed: ["invalid_username_or_password"], request details: {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"1223138295@qq.com","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"1223138295@qq.com","password":"***REDACTED***","scope":"api1","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-29 17:04:52.972 +08:00 [INF] {"Username":"1223138295@qq.com","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid_username_or_password","ActivityId":"0HLN42E928H6M:00000003","TimeStamp":"2019-05-29T09:04:52.0000000Z","ProcessId":23864,"LocalIpAddress":"127.0.0.1:46886","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-05-29 17:04:52.973 +08:00 [INF] {"ClientId":"ro.client","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"password","Error":"invalid_grant","ErrorDescription":"invalid_username_or_password","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLN42E928H6M:00000003","TimeStamp":"2019-05-29T09:04:52.0000000Z","ProcessId":23864,"LocalIpAddress":"127.0.0.1:46886","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-05-29 17:06:13.712 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-29 17:06:13.713 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-29 17:06:13.713 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-29 17:06:13.713 +08:00 [DBG] Start discovery request
2019-05-29 17:06:14.424 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-29 17:06:14.484 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-29 17:06:14.484 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-29 17:06:14.485 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-29 17:06:14.485 +08:00 [DBG] Start key discovery request
2019-05-29 17:06:16.107 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-29 17:06:16.107 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-29 17:06:16.107 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-29 17:06:16.107 +08:00 [DBG] Start token request.
2019-05-29 17:06:16.107 +08:00 [DBG] Start client validation
2019-05-29 17:06:16.108 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-29 17:06:16.108 +08:00 [DBG] Start parsing for secret in post body
2019-05-29 17:06:16.109 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-29 17:06:16.109 +08:00 [DBG] Secret id found: ro.client
2019-05-29 17:06:17.108 +08:00 [DBG] ro.client found in database: true
2019-05-29 17:06:17.108 +08:00 [DBG] client configuration validation for client ro.client succeeded.
2019-05-29 17:06:17.108 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-29 17:06:17.108 +08:00 [DBG] Client validation success
2019-05-29 17:06:17.109 +08:00 [INF] {"ClientId":"ro.client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN42E928H6N:00000003","TimeStamp":"2019-05-29T09:06:17.0000000Z","ProcessId":23864,"LocalIpAddress":"127.0.0.1:46886","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-29 17:06:17.109 +08:00 [DBG] Start token request validation
2019-05-29 17:06:17.109 +08:00 [DBG] Start resource owner password token request validation
2019-05-29 17:06:17.265 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:06:17.752 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:06:17.855 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:06:18.340 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:06:18.341 +08:00 [INF] User authentication failed: ["invalid_username_or_password"], request details: {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"1223138295@qq.com","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"1223138295@qq.com","password":"***REDACTED***","scope":"api1","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-29 17:06:18.341 +08:00 [INF] {"Username":"1223138295@qq.com","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid_username_or_password","ActivityId":"0HLN42E928H6N:00000003","TimeStamp":"2019-05-29T09:06:18.0000000Z","ProcessId":23864,"LocalIpAddress":"127.0.0.1:46886","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-05-29 17:06:18.341 +08:00 [INF] {"ClientId":"ro.client","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"password","Error":"invalid_grant","ErrorDescription":"invalid_username_or_password","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLN42E928H6N:00000003","TimeStamp":"2019-05-29T09:06:18.0000000Z","ProcessId":23864,"LocalIpAddress":"127.0.0.1:46886","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-05-29 17:08:23.663 +08:00 [DBG] 0 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-05-29 17:08:31.235 +08:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-29 17:08:31.306 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-29 17:08:31.306 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLN42E928H6O:00000004","TimeStamp":"2019-05-29T09:08:31.0000000Z","ProcessId":23864,"LocalIpAddress":"127.0.0.1:46886","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-05-29 17:08:38.750 +08:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-29 17:08:38.775 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-29 17:08:38.776 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLN42E928H6O:00000007","TimeStamp":"2019-05-29T09:08:38.0000000Z","ProcessId":23864,"LocalIpAddress":"127.0.0.1:46886","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-05-29 17:08:59.488 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-29 17:08:59.770 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"1223138295@qq.com","DisplayName":"shawn","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLN42E928H6O:00000009","TimeStamp":"2019-05-29T09:08:59.0000000Z","ProcessId":23864,"LocalIpAddress":"127.0.0.1:46886","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-29 17:09:00.089 +08:00 [DBG] Augmenting SignInContext
2019-05-29 17:09:00.091 +08:00 [DBG] Adding idp claim with value: local
2019-05-29 17:09:00.092 +08:00 [DBG] Adding amr claim with value: pwd
2019-05-29 17:09:00.092 +08:00 [DBG] Adding auth_time claim with value: 1559120940
2019-05-29 17:09:00.099 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-29 17:09:00.249 +08:00 [DBG] 0 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-05-29 17:22:01.916 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-29 17:22:02.016 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-29 17:22:02.017 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-29 17:22:02.017 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-29 17:22:02.017 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-29 17:22:02.017 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-29 17:22:02.945 +08:00 [DBG] Starting grant removal
2019-05-29 17:22:03.295 +08:00 [DBG] Login Url: /Account/Login
2019-05-29 17:22:03.301 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-29 17:22:03.301 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-29 17:22:03.301 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-29 17:22:03.301 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-29 17:22:03.301 +08:00 [DBG] Error Url: /home/error
2019-05-29 17:22:03.301 +08:00 [DBG] Error Id Parameter: errorId
2019-05-29 17:22:14.545 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-29 17:22:14.551 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-29 17:22:14.552 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-29 17:22:14.556 +08:00 [DBG] Start discovery request
2019-05-29 17:22:15.888 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-29 17:22:16.013 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-29 17:22:16.014 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-29 17:22:16.014 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-29 17:22:16.018 +08:00 [DBG] Start key discovery request
2019-05-29 17:22:16.246 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-29 17:22:16.253 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-29 17:22:16.253 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-29 17:22:16.270 +08:00 [DBG] Start token request.
2019-05-29 17:22:16.278 +08:00 [DBG] Start client validation
2019-05-29 17:22:16.286 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-29 17:22:16.290 +08:00 [DBG] Start parsing for secret in post body
2019-05-29 17:22:16.308 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-29 17:22:16.308 +08:00 [DBG] Secret id found: client
2019-05-29 17:22:17.664 +08:00 [DBG] client found in database: true
2019-05-29 17:22:17.672 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-29 17:22:17.687 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-29 17:22:17.687 +08:00 [DBG] Client validation success
2019-05-29 17:22:17.707 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN42SE5UJU9:00000003","TimeStamp":"2019-05-29T09:22:17.0000000Z","ProcessId":29628,"LocalIpAddress":"127.0.0.1:25657","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-29 17:22:17.719 +08:00 [DBG] Start token request validation
2019-05-29 17:22:17.732 +08:00 [DBG] Start client credentials token request validation
2019-05-29 17:22:17.878 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:22:18.423 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:22:18.539 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:22:19.055 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:22:19.057 +08:00 [DBG] client credentials token request validation success
2019-05-29 17:22:19.065 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-29 17:22:19.089 +08:00 [DBG] Getting claims for access token for client: client
2019-05-29 17:22:19.187 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****SEmA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN42SE5UJU9:00000003","TimeStamp":"2019-05-29T09:22:19.0000000Z","ProcessId":29628,"LocalIpAddress":"127.0.0.1:25657","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-29 17:22:19.189 +08:00 [DBG] Token request success.
2019-05-29 17:22:19.387 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-29 17:22:19.387 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-29 17:22:19.388 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-29 17:22:19.388 +08:00 [DBG] Start discovery request
2019-05-29 17:22:20.055 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-29 17:22:20.283 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-29 17:22:20.284 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-29 17:22:20.284 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-29 17:22:20.284 +08:00 [DBG] Start key discovery request
2019-05-29 17:23:14.623 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-29 17:23:14.624 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-29 17:23:14.624 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-29 17:23:14.624 +08:00 [DBG] Start discovery request
2019-05-29 17:23:15.261 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-29 17:23:15.285 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-29 17:23:15.286 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-29 17:23:15.287 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-29 17:23:15.287 +08:00 [DBG] Start key discovery request
2019-05-29 17:23:16.098 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-29 17:23:16.099 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-29 17:23:16.100 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-29 17:23:16.100 +08:00 [DBG] Start token request.
2019-05-29 17:23:16.101 +08:00 [DBG] Start client validation
2019-05-29 17:23:16.101 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-29 17:23:16.101 +08:00 [DBG] Start parsing for secret in post body
2019-05-29 17:23:16.102 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-29 17:23:16.102 +08:00 [DBG] Secret id found: ro.client
2019-05-29 17:23:17.085 +08:00 [DBG] ro.client found in database: true
2019-05-29 17:23:17.085 +08:00 [DBG] client configuration validation for client ro.client succeeded.
2019-05-29 17:23:17.085 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-29 17:23:17.085 +08:00 [DBG] Client validation success
2019-05-29 17:23:17.085 +08:00 [INF] {"ClientId":"ro.client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN42SE5UJU8:00000005","TimeStamp":"2019-05-29T09:23:17.0000000Z","ProcessId":29628,"LocalIpAddress":"127.0.0.1:25657","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-29 17:23:17.086 +08:00 [DBG] Start token request validation
2019-05-29 17:23:17.093 +08:00 [DBG] Start resource owner password token request validation
2019-05-29 17:23:17.222 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:23:17.766 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:23:18.112 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:23:18.600 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:23:18.603 +08:00 [INF] User authentication failed: ["invalid_username_or_password"], request details: {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"1223138295@qq.com","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"1223138295@qq.com","password":"***REDACTED***","scope":"api1","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-29 17:23:18.603 +08:00 [INF] {"Username":"1223138295@qq.com","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid_username_or_password","ActivityId":"0HLN42SE5UJU8:00000005","TimeStamp":"2019-05-29T09:23:18.0000000Z","ProcessId":29628,"LocalIpAddress":"127.0.0.1:25657","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-05-29 17:23:18.605 +08:00 [INF] {"ClientId":"ro.client","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"password","Error":"invalid_grant","ErrorDescription":"invalid_username_or_password","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLN42SE5UJU8:00000005","TimeStamp":"2019-05-29T09:23:18.0000000Z","ProcessId":29628,"LocalIpAddress":"127.0.0.1:25657","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-05-29 17:41:29.420 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-29 17:41:29.447 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-29 17:41:29.448 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-29 17:41:29.448 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-29 17:41:29.448 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-29 17:41:29.448 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-29 17:41:29.838 +08:00 [DBG] Starting grant removal
2019-05-29 17:41:30.119 +08:00 [DBG] Login Url: /Account/Login
2019-05-29 17:41:30.121 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-29 17:41:30.121 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-29 17:41:30.121 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-29 17:41:30.121 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-29 17:41:30.122 +08:00 [DBG] Error Url: /home/error
2019-05-29 17:41:30.122 +08:00 [DBG] Error Id Parameter: errorId
2019-05-29 17:42:27.492 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-29 17:42:27.495 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-29 17:42:27.496 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-29 17:42:27.499 +08:00 [DBG] Start discovery request
2019-05-29 17:42:28.811 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-29 17:42:29.012 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-29 17:42:29.012 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-29 17:42:29.012 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-29 17:42:29.015 +08:00 [DBG] Start key discovery request
2019-05-29 17:42:29.259 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-29 17:42:29.265 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-29 17:42:29.265 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-29 17:42:29.275 +08:00 [DBG] Start token request.
2019-05-29 17:42:29.281 +08:00 [DBG] Start client validation
2019-05-29 17:42:29.288 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-29 17:42:29.292 +08:00 [DBG] Start parsing for secret in post body
2019-05-29 17:42:29.311 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-29 17:42:29.311 +08:00 [DBG] Secret id found: client
2019-05-29 17:42:30.806 +08:00 [DBG] client found in database: true
2019-05-29 17:42:30.819 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-29 17:42:30.833 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-29 17:42:30.833 +08:00 [DBG] Client validation success
2019-05-29 17:42:30.847 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN4379U4U4M:00000003","TimeStamp":"2019-05-29T09:42:30.0000000Z","ProcessId":29040,"LocalIpAddress":"127.0.0.1:6100","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-29 17:42:30.856 +08:00 [DBG] Start token request validation
2019-05-29 17:42:30.864 +08:00 [DBG] Start client credentials token request validation
2019-05-29 17:42:31.046 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:42:31.682 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:42:31.813 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:42:32.409 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:42:32.412 +08:00 [DBG] client credentials token request validation success
2019-05-29 17:42:32.420 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-29 17:42:32.445 +08:00 [DBG] Getting claims for access token for client: client
2019-05-29 17:42:32.571 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****YGxw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4379U4U4M:00000003","TimeStamp":"2019-05-29T09:42:32.0000000Z","ProcessId":29040,"LocalIpAddress":"127.0.0.1:6100","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-29 17:42:32.575 +08:00 [DBG] Token request success.
2019-05-29 17:43:09.351 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-29 17:43:09.352 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-29 17:43:09.365 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-29 17:43:09.365 +08:00 [DBG] Start discovery request
2019-05-29 17:43:10.170 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-29 17:43:10.264 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-29 17:43:10.264 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-29 17:43:10.264 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-29 17:43:10.264 +08:00 [DBG] Start key discovery request
2019-05-29 17:43:10.437 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-29 17:43:10.438 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-29 17:43:10.438 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-29 17:43:10.438 +08:00 [DBG] Start token request.
2019-05-29 17:43:10.438 +08:00 [DBG] Start client validation
2019-05-29 17:43:10.438 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-29 17:43:10.438 +08:00 [DBG] Start parsing for secret in post body
2019-05-29 17:43:10.441 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-29 17:43:10.441 +08:00 [DBG] Secret id found: client
2019-05-29 17:43:11.650 +08:00 [DBG] client found in database: true
2019-05-29 17:43:11.651 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-29 17:43:11.651 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-29 17:43:11.651 +08:00 [DBG] Client validation success
2019-05-29 17:43:11.651 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN4379U4U4L:00000004","TimeStamp":"2019-05-29T09:43:11.0000000Z","ProcessId":29040,"LocalIpAddress":"127.0.0.1:6100","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-29 17:43:11.651 +08:00 [DBG] Start token request validation
2019-05-29 17:43:11.651 +08:00 [DBG] Start client credentials token request validation
2019-05-29 17:43:11.781 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:43:12.374 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:43:12.506 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:43:13.116 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:43:13.117 +08:00 [DBG] client credentials token request validation success
2019-05-29 17:43:13.117 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-29 17:43:13.117 +08:00 [DBG] Getting claims for access token for client: client
2019-05-29 17:43:13.120 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****vvFw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4379U4U4L:00000004","TimeStamp":"2019-05-29T09:43:13.0000000Z","ProcessId":29040,"LocalIpAddress":"127.0.0.1:6100","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-29 17:43:13.120 +08:00 [DBG] Token request success.
2019-05-29 17:43:13.341 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-29 17:43:13.341 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-29 17:43:13.341 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-29 17:43:13.342 +08:00 [DBG] Start discovery request
2019-05-29 17:43:14.117 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-29 17:43:14.337 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-29 17:43:14.337 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-29 17:43:14.337 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-29 17:43:14.337 +08:00 [DBG] Start key discovery request
2019-05-29 17:43:26.411 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-29 17:43:26.411 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-29 17:43:26.412 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-29 17:43:26.412 +08:00 [DBG] Start discovery request
2019-05-29 17:43:27.190 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-29 17:43:27.213 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-29 17:43:27.214 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-29 17:43:27.214 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-29 17:43:27.214 +08:00 [DBG] Start key discovery request
2019-05-29 17:43:27.946 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-29 17:43:27.946 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-29 17:43:27.947 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-29 17:43:27.947 +08:00 [DBG] Start token request.
2019-05-29 17:43:27.947 +08:00 [DBG] Start client validation
2019-05-29 17:43:27.947 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-29 17:43:27.947 +08:00 [DBG] Start parsing for secret in post body
2019-05-29 17:43:27.947 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-29 17:43:27.948 +08:00 [DBG] Secret id found: ro.client
2019-05-29 17:43:29.144 +08:00 [DBG] ro.client found in database: true
2019-05-29 17:43:29.144 +08:00 [DBG] client configuration validation for client ro.client succeeded.
2019-05-29 17:43:29.144 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-29 17:43:29.144 +08:00 [DBG] Client validation success
2019-05-29 17:43:29.144 +08:00 [INF] {"ClientId":"ro.client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN4379U4U4M:00000007","TimeStamp":"2019-05-29T09:43:29.0000000Z","ProcessId":29040,"LocalIpAddress":"127.0.0.1:6100","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-29 17:43:29.145 +08:00 [DBG] Start token request validation
2019-05-29 17:43:29.152 +08:00 [DBG] Start resource owner password token request validation
2019-05-29 17:43:29.267 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:43:29.827 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:43:29.950 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 17:43:30.530 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 17:43:30.533 +08:00 [INF] User authentication failed: ["invalid_username_or_password"], request details: {"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"1223138295@qq.com","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"1223138295@qq.com","password":"***REDACTED***","scope":"api1","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-29 17:43:30.533 +08:00 [INF] {"Username":"1223138295@qq.com","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid_username_or_password","ActivityId":"0HLN4379U4U4M:00000007","TimeStamp":"2019-05-29T09:43:30.0000000Z","ProcessId":29040,"LocalIpAddress":"127.0.0.1:6100","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-05-29 17:43:30.535 +08:00 [INF] {"ClientId":"ro.client","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"password","Error":"invalid_grant","ErrorDescription":"invalid_username_or_password","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLN4379U4U4M:00000007","TimeStamp":"2019-05-29T09:43:30.0000000Z","ProcessId":29040,"LocalIpAddress":"127.0.0.1:6100","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-05-29 22:57:59.781 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-29 22:57:59.808 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-29 22:57:59.808 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-29 22:57:59.808 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-29 22:57:59.808 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-29 22:57:59.809 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-29 22:58:00.047 +08:00 [DBG] Starting grant removal
2019-05-29 22:58:26.992 +08:00 [DBG] Login Url: /Account/Login
2019-05-29 22:58:26.995 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-29 22:58:26.996 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-29 22:58:26.996 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-29 22:58:26.996 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-29 22:58:26.996 +08:00 [DBG] Error Url: /home/error
2019-05-29 22:58:26.996 +08:00 [DBG] Error Id Parameter: errorId
2019-05-29 22:58:33.001 +08:00 [DBG] 0 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-05-29 22:58:39.945 +08:00 [DBG] TaskCanceledException. Exiting.
2019-05-29 22:58:39.978 +08:00 [DBG] Stopping grant removal
2019-05-29 23:02:23.792 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-29 23:02:23.819 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-29 23:02:23.820 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-29 23:02:23.820 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-29 23:02:23.820 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-29 23:02:23.820 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-29 23:02:24.012 +08:00 [DBG] Starting grant removal
2019-05-29 23:02:34.162 +08:00 [DBG] Login Url: /Account/Login
2019-05-29 23:02:34.165 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-29 23:02:34.165 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-29 23:02:34.165 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-29 23:02:34.166 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-29 23:02:34.166 +08:00 [DBG] Error Url: /home/error
2019-05-29 23:02:34.166 +08:00 [DBG] Error Id Parameter: errorId
2019-05-29 23:06:30.519 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-29 23:06:30.524 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-29 23:06:30.525 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-29 23:06:30.538 +08:00 [DBG] Start discovery request
2019-05-29 23:06:33.295 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-29 23:06:33.427 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-29 23:06:33.428 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-29 23:06:33.429 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-29 23:06:33.432 +08:00 [DBG] Start key discovery request
2019-05-29 23:06:33.602 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-29 23:06:33.611 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-29 23:06:33.611 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-29 23:06:33.619 +08:00 [DBG] Start token request.
2019-05-29 23:06:33.626 +08:00 [DBG] Start client validation
2019-05-29 23:06:33.632 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-29 23:06:33.636 +08:00 [DBG] Start parsing for secret in post body
2019-05-29 23:06:33.660 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-29 23:06:33.660 +08:00 [DBG] Secret id found: client
2019-05-29 23:06:36.039 +08:00 [DBG] client found in database: true
2019-05-29 23:06:36.048 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-29 23:06:36.058 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-29 23:06:36.059 +08:00 [DBG] Client validation success
2019-05-29 23:06:36.075 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN48QN1FRJ7:00000003","TimeStamp":"2019-05-29T15:06:36.0000000Z","ProcessId":44337,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-29 23:06:36.090 +08:00 [DBG] Start token request validation
2019-05-29 23:06:36.100 +08:00 [DBG] Start client credentials token request validation
2019-05-29 23:06:36.351 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 23:06:37.319 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 23:06:37.513 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 23:06:38.423 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 23:06:38.427 +08:00 [DBG] client credentials token request validation success
2019-05-29 23:06:38.433 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-29 23:06:38.469 +08:00 [DBG] Getting claims for access token for client: client
2019-05-29 23:06:38.609 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****YNPA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN48QN1FRJ7:00000003","TimeStamp":"2019-05-29T15:06:38.0000000Z","ProcessId":44337,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-29 23:06:38.611 +08:00 [DBG] Token request success.
2019-05-29 23:06:38.777 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-29 23:06:38.778 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-29 23:06:38.779 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-29 23:06:38.779 +08:00 [DBG] Start discovery request
2019-05-29 23:06:39.926 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-29 23:06:40.180 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-29 23:06:40.180 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-29 23:06:40.181 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-29 23:06:40.181 +08:00 [DBG] Start key discovery request
2019-05-29 23:06:41.968 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-29 23:06:41.969 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-29 23:06:41.970 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-29 23:06:41.970 +08:00 [DBG] Start discovery request
2019-05-29 23:06:43.133 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-29 23:06:43.143 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-29 23:06:43.144 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-29 23:06:43.145 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-29 23:06:43.145 +08:00 [DBG] Start key discovery request
2019-05-29 23:06:43.151 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-29 23:06:43.153 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-29 23:06:43.153 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-29 23:06:43.154 +08:00 [DBG] Start token request.
2019-05-29 23:06:43.154 +08:00 [DBG] Start client validation
2019-05-29 23:06:43.154 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-29 23:06:43.155 +08:00 [DBG] Start parsing for secret in post body
2019-05-29 23:06:43.157 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-29 23:06:43.157 +08:00 [DBG] Secret id found: ro.client
2019-05-29 23:06:45.071 +08:00 [DBG] ro.client found in database: true
2019-05-29 23:06:45.072 +08:00 [DBG] client configuration validation for client ro.client succeeded.
2019-05-29 23:06:45.075 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-29 23:06:45.075 +08:00 [DBG] Client validation success
2019-05-29 23:06:45.076 +08:00 [INF] {"ClientId":"ro.client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN48QN1FRJ7:00000006","TimeStamp":"2019-05-29T15:06:45.0000000Z","ProcessId":44337,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-29 23:06:45.077 +08:00 [DBG] Start token request validation
2019-05-29 23:06:45.095 +08:00 [DBG] Start resource owner password token request validation
2019-05-29 23:06:45.304 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 23:06:46.259 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 23:06:46.483 +08:00 [DBG] Found [] identity scopes in database
2019-05-29 23:06:47.415 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-29 23:06:47.917 +08:00 [INF] Credentials validated for username: 1223138295@qq.com
2019-05-29 23:06:47.918 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Endpoint":"Token","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLN48QN1FRJ7:00000006","TimeStamp":"2019-05-29T15:06:47.0000000Z","ProcessId":44337,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-29 23:06:47.929 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":null,"Endpoint":"Token","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLN48QN1FRJ7:00000006","TimeStamp":"2019-05-29T15:06:47.0000000Z","ProcessId":44337,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-29 23:06:47.929 +08:00 [DBG] Resource owner password token request validation success.
2019-05-29 23:06:47.931 +08:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"1223138295@qq.com","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"1223138295@qq.com","password":"***REDACTED***","scope":"api1","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-29 23:06:47.934 +08:00 [DBG] Getting claims for access token for client: ro.client
2019-05-29 23:06:47.934 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-05-29 23:06:47.948 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-29 23:06:47.977 +08:00 [INF] {"ClientId":"ro.client","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"api1","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****1kHw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN48QN1FRJ7:00000006","TimeStamp":"2019-05-29T15:06:47.0000000Z","ProcessId":44337,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-29 23:06:47.978 +08:00 [DBG] Token request success.
2019-05-30 09:58:27.401 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 09:58:27.431 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 09:58:27.431 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 09:58:27.431 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 09:58:27.431 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 09:58:27.431 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 09:58:27.921 +08:00 [DBG] Starting grant removal
2019-05-30 09:58:28.241 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 09:58:28.243 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 09:58:28.243 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 09:58:28.243 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 09:58:28.243 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 09:58:28.244 +08:00 [DBG] Error Url: /home/error
2019-05-30 09:58:28.244 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 09:58:52.030 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 09:58:52.036 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 09:58:52.037 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 09:58:52.040 +08:00 [DBG] Start discovery request
2019-05-30 09:58:53.313 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 09:58:53.477 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 09:58:53.478 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 09:58:53.478 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 09:58:53.482 +08:00 [DBG] Start key discovery request
2019-05-30 09:58:53.702 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-30 09:58:53.710 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-30 09:58:53.710 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-30 09:58:53.717 +08:00 [DBG] Start token request.
2019-05-30 09:58:53.724 +08:00 [DBG] Start client validation
2019-05-30 09:58:53.730 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-30 09:58:53.735 +08:00 [DBG] Start parsing for secret in post body
2019-05-30 09:58:53.754 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-30 09:58:53.754 +08:00 [DBG] Secret id found: client
2019-05-30 09:58:55.074 +08:00 [DBG] client found in database: true
2019-05-30 09:58:55.085 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-30 09:58:55.096 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-30 09:58:55.096 +08:00 [DBG] Client validation success
2019-05-30 09:58:55.108 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN4K97FTFPR:00000002","TimeStamp":"2019-05-30T01:58:55.0000000Z","ProcessId":10952,"LocalIpAddress":"127.0.0.1:17798","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-30 09:58:55.122 +08:00 [DBG] Start token request validation
2019-05-30 09:58:55.129 +08:00 [DBG] Start client credentials token request validation
2019-05-30 09:58:55.274 +08:00 [DBG] Found [] identity scopes in database
2019-05-30 09:58:55.829 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-30 09:58:55.952 +08:00 [DBG] Found [] identity scopes in database
2019-05-30 09:58:56.437 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-30 09:58:56.440 +08:00 [DBG] client credentials token request validation success
2019-05-30 09:58:56.448 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-30 09:58:56.474 +08:00 [DBG] Getting claims for access token for client: client
2019-05-30 09:58:56.603 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****qTBw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4K97FTFPR:00000002","TimeStamp":"2019-05-30T01:58:56.0000000Z","ProcessId":10952,"LocalIpAddress":"127.0.0.1:17798","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 09:58:56.604 +08:00 [DBG] Token request success.
2019-05-30 09:58:56.838 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 09:58:56.839 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 09:58:56.839 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 09:58:56.839 +08:00 [DBG] Start discovery request
2019-05-30 09:58:57.456 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 09:58:57.691 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 09:58:57.691 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 09:58:57.693 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 09:58:57.700 +08:00 [DBG] Start key discovery request
2019-05-30 09:59:15.052 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 09:59:15.053 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 09:59:15.053 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 09:59:15.053 +08:00 [DBG] Start discovery request
2019-05-30 09:59:15.689 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 09:59:15.713 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 09:59:15.713 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 09:59:15.714 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 09:59:15.714 +08:00 [DBG] Start key discovery request
2019-05-30 09:59:16.452 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-30 09:59:16.454 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-30 09:59:16.454 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-30 09:59:16.454 +08:00 [DBG] Start token request.
2019-05-30 09:59:16.454 +08:00 [DBG] Start client validation
2019-05-30 09:59:16.455 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-30 09:59:16.455 +08:00 [DBG] Start parsing for secret in post body
2019-05-30 09:59:16.457 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-30 09:59:16.457 +08:00 [DBG] Secret id found: ro.client
2019-05-30 09:59:17.468 +08:00 [DBG] ro.client found in database: true
2019-05-30 09:59:17.468 +08:00 [DBG] client configuration validation for client ro.client succeeded.
2019-05-30 09:59:17.469 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-30 09:59:17.469 +08:00 [DBG] Client validation success
2019-05-30 09:59:17.469 +08:00 [INF] {"ClientId":"ro.client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN4K97FTFPO:00000004","TimeStamp":"2019-05-30T01:59:17.0000000Z","ProcessId":10952,"LocalIpAddress":"127.0.0.1:17798","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-30 09:59:17.469 +08:00 [DBG] Start token request validation
2019-05-30 09:59:17.478 +08:00 [DBG] Start resource owner password token request validation
2019-05-30 09:59:17.821 +08:00 [DBG] Found [] identity scopes in database
2019-05-30 09:59:18.299 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-30 09:59:18.401 +08:00 [DBG] Found [] identity scopes in database
2019-05-30 09:59:18.893 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-30 09:59:19.060 +08:00 [INF] Credentials validated for username: 1223138295@qq.com
2019-05-30 09:59:19.061 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Endpoint":"Token","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLN4K97FTFPO:00000004","TimeStamp":"2019-05-30T01:59:19.0000000Z","ProcessId":10952,"LocalIpAddress":"127.0.0.1:17798","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-30 09:59:19.069 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":null,"Endpoint":"Token","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLN4K97FTFPO:00000004","TimeStamp":"2019-05-30T01:59:19.0000000Z","ProcessId":10952,"LocalIpAddress":"127.0.0.1:17798","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-30 09:59:19.069 +08:00 [DBG] Resource owner password token request validation success.
2019-05-30 09:59:19.070 +08:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"1223138295@qq.com","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"1223138295@qq.com","password":"***REDACTED***","scope":"api1","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-30 09:59:19.073 +08:00 [DBG] Getting claims for access token for client: ro.client
2019-05-30 09:59:19.073 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 09:59:19.082 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 09:59:19.087 +08:00 [INF] {"ClientId":"ro.client","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"api1","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****TuFg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4K97FTFPO:00000004","TimeStamp":"2019-05-30T01:59:19.0000000Z","ProcessId":10952,"LocalIpAddress":"127.0.0.1:17798","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 09:59:19.087 +08:00 [DBG] Token request success.
2019-05-30 10:00:24.179 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 10:00:24.206 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 10:00:24.206 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 10:00:24.206 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 10:00:24.206 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 10:00:24.206 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 10:00:24.283 +08:00 [DBG] Starting grant removal
2019-05-30 10:00:24.535 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 10:00:24.537 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 10:00:24.537 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 10:00:24.538 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 10:00:24.538 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 10:00:24.538 +08:00 [DBG] Error Url: /home/error
2019-05-30 10:00:24.538 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 10:00:24.562 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 10:00:24.570 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 10:00:24.570 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 10:00:24.573 +08:00 [DBG] Start discovery request
2019-05-30 10:00:26.009 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 10:00:32.825 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 10:00:32.826 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 10:00:32.826 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 10:00:32.826 +08:00 [DBG] Start discovery request
2019-05-30 10:00:32.916 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 10:00:32.917 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 10:00:32.917 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 10:00:32.920 +08:00 [DBG] Start key discovery request
2019-05-30 10:00:33.115 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-30 10:00:33.122 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-30 10:00:33.123 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-30 10:00:33.135 +08:00 [DBG] Start token request.
2019-05-30 10:00:33.143 +08:00 [DBG] Start client validation
2019-05-30 10:00:33.148 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-30 10:00:33.151 +08:00 [DBG] Start parsing for secret in post body
2019-05-30 10:00:33.168 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-30 10:00:33.168 +08:00 [DBG] Secret id found: client
2019-05-30 10:00:33.611 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 10:00:33.630 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 10:00:33.632 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 10:00:33.632 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 10:00:33.632 +08:00 [DBG] Start key discovery request
2019-05-30 10:00:33.660 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-30 10:00:33.661 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-30 10:00:33.661 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-30 10:00:33.661 +08:00 [DBG] Start token request.
2019-05-30 10:00:33.661 +08:00 [DBG] Start client validation
2019-05-30 10:00:33.661 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-30 10:00:33.662 +08:00 [DBG] Start parsing for secret in post body
2019-05-30 10:00:33.662 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-30 10:00:33.662 +08:00 [DBG] Secret id found: ro.client
2019-05-30 10:00:34.915 +08:00 [DBG] client found in database: true
2019-05-30 10:00:34.927 +08:00 [DBG] client configuration validation for client client succeeded.
2019-05-30 10:00:34.932 +08:00 [DBG] ro.client found in database: true
2019-05-30 10:00:34.932 +08:00 [DBG] client configuration validation for client ro.client succeeded.
2019-05-30 10:00:34.937 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-30 10:00:34.937 +08:00 [DBG] Client validation success
2019-05-30 10:00:34.937 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-30 10:00:34.938 +08:00 [DBG] Client validation success
2019-05-30 10:00:34.949 +08:00 [INF] {"ClientId":"ro.client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN4KAA5L4S4:00000004","TimeStamp":"2019-05-30T02:00:34.0000000Z","ProcessId":8148,"LocalIpAddress":"127.0.0.1:26700","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-30 10:00:34.949 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN4KAA5L4S5:00000002","TimeStamp":"2019-05-30T02:00:34.0000000Z","ProcessId":8148,"LocalIpAddress":"127.0.0.1:26700","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-30 10:00:34.959 +08:00 [DBG] Start token request validation
2019-05-30 10:00:34.960 +08:00 [DBG] Start token request validation
2019-05-30 10:00:34.968 +08:00 [DBG] Start client credentials token request validation
2019-05-30 10:00:34.973 +08:00 [DBG] Start resource owner password token request validation
2019-05-30 10:00:35.192 +08:00 [DBG] Found [] identity scopes in database
2019-05-30 10:00:35.196 +08:00 [DBG] Found [] identity scopes in database
2019-05-30 10:00:36.072 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-30 10:00:36.122 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-30 10:00:36.272 +08:00 [DBG] Found [] identity scopes in database
2019-05-30 10:00:36.312 +08:00 [DBG] Found [] identity scopes in database
2019-05-30 10:00:37.242 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-30 10:00:37.261 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-30 10:00:37.262 +08:00 [DBG] client credentials token request validation success
2019-05-30 10:00:37.270 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-30 10:00:37.295 +08:00 [DBG] Getting claims for access token for client: client
2019-05-30 10:00:37.369 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****8rMQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4KAA5L4S5:00000002","TimeStamp":"2019-05-30T02:00:37.0000000Z","ProcessId":8148,"LocalIpAddress":"127.0.0.1:26700","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 10:00:37.370 +08:00 [DBG] Token request success.
2019-05-30 10:00:37.561 +08:00 [INF] Credentials validated for username: 1223138295@qq.com
2019-05-30 10:00:37.563 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Endpoint":"Token","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLN4KAA5L4S4:00000004","TimeStamp":"2019-05-30T02:00:37.0000000Z","ProcessId":8148,"LocalIpAddress":"127.0.0.1:26700","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-30 10:00:37.573 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":null,"Endpoint":"Token","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLN4KAA5L4S4:00000004","TimeStamp":"2019-05-30T02:00:37.0000000Z","ProcessId":8148,"LocalIpAddress":"127.0.0.1:26700","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-30 10:00:37.573 +08:00 [DBG] Resource owner password token request validation success.
2019-05-30 10:00:37.575 +08:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"1223138295@qq.com","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"1223138295@qq.com","password":"***REDACTED***","scope":"api1","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-30 10:00:37.579 +08:00 [DBG] Getting claims for access token for client: ro.client
2019-05-30 10:00:37.580 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 10:00:37.588 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 10:00:37.593 +08:00 [INF] {"ClientId":"ro.client","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"api1","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****WvEw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4KAA5L4S4:00000004","TimeStamp":"2019-05-30T02:00:37.0000000Z","ProcessId":8148,"LocalIpAddress":"127.0.0.1:26700","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 10:00:37.593 +08:00 [DBG] Token request success.
2019-05-30 10:00:37.625 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 10:00:37.626 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 10:00:37.626 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 10:00:37.626 +08:00 [DBG] Start discovery request
2019-05-30 10:00:38.871 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 10:00:39.104 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 10:00:39.105 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 10:00:39.105 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 10:00:39.105 +08:00 [DBG] Start key discovery request
2019-05-30 10:00:58.246 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 10:00:58.246 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 10:00:58.246 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 10:00:58.246 +08:00 [DBG] Start discovery request
2019-05-30 10:00:59.437 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 10:00:59.452 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 10:00:59.454 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 10:00:59.454 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 10:00:59.454 +08:00 [DBG] Start key discovery request
2019-05-30 10:00:59.467 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-30 10:00:59.468 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-30 10:00:59.468 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-30 10:00:59.468 +08:00 [DBG] Start token request.
2019-05-30 10:00:59.468 +08:00 [DBG] Start client validation
2019-05-30 10:00:59.468 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-30 10:00:59.468 +08:00 [DBG] Start parsing for secret in post body
2019-05-30 10:00:59.469 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-30 10:00:59.469 +08:00 [DBG] Secret id found: ro.client
2019-05-30 10:01:00.599 +08:00 [DBG] ro.client found in database: true
2019-05-30 10:01:00.599 +08:00 [DBG] client configuration validation for client ro.client succeeded.
2019-05-30 10:01:00.599 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-30 10:01:00.599 +08:00 [DBG] Client validation success
2019-05-30 10:01:00.599 +08:00 [INF] {"ClientId":"ro.client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN4KAA5L4S5:00000005","TimeStamp":"2019-05-30T02:01:00.0000000Z","ProcessId":8148,"LocalIpAddress":"127.0.0.1:26700","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-30 10:01:00.600 +08:00 [DBG] Start token request validation
2019-05-30 10:01:00.600 +08:00 [DBG] Start resource owner password token request validation
2019-05-30 10:01:00.739 +08:00 [DBG] Found [] identity scopes in database
2019-05-30 10:01:01.518 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-30 10:01:01.632 +08:00 [DBG] Found [] identity scopes in database
2019-05-30 10:01:02.235 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-30 10:01:02.376 +08:00 [INF] Credentials validated for username: 1223138295@qq.com
2019-05-30 10:01:02.376 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Endpoint":"Token","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLN4KAA5L4S5:00000005","TimeStamp":"2019-05-30T02:01:02.0000000Z","ProcessId":8148,"LocalIpAddress":"127.0.0.1:26700","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-30 10:01:02.377 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":null,"Endpoint":"Token","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLN4KAA5L4S5:00000005","TimeStamp":"2019-05-30T02:01:02.0000000Z","ProcessId":8148,"LocalIpAddress":"127.0.0.1:26700","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-30 10:01:02.377 +08:00 [DBG] Resource owner password token request validation success.
2019-05-30 10:01:02.377 +08:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"1223138295@qq.com","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"1223138295@qq.com","password":"***REDACTED***","scope":"api1","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-30 10:01:02.377 +08:00 [DBG] Getting claims for access token for client: ro.client
2019-05-30 10:01:02.377 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 10:01:02.377 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 10:01:02.380 +08:00 [INF] {"ClientId":"ro.client","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"api1","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****5s1Q","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4KAA5L4S5:00000005","TimeStamp":"2019-05-30T02:01:02.0000000Z","ProcessId":8148,"LocalIpAddress":"127.0.0.1:26700","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 10:01:02.380 +08:00 [DBG] Token request success.
2019-05-30 10:01:17.296 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 10:01:17.297 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 10:01:17.297 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 10:01:17.297 +08:00 [DBG] Start discovery request
2019-05-30 10:01:18.087 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 10:01:18.100 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 10:01:18.101 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 10:01:18.101 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 10:01:18.101 +08:00 [DBG] Start key discovery request
2019-05-30 10:01:18.116 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-30 10:01:18.116 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-30 10:01:18.116 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-30 10:01:18.116 +08:00 [DBG] Start token request.
2019-05-30 10:01:18.116 +08:00 [DBG] Start client validation
2019-05-30 10:01:18.117 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-30 10:01:18.117 +08:00 [DBG] Start parsing for secret in post body
2019-05-30 10:01:18.117 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-30 10:01:18.117 +08:00 [DBG] Secret id found: ro.client
2019-05-30 10:01:19.312 +08:00 [DBG] ro.client found in database: true
2019-05-30 10:01:19.313 +08:00 [DBG] client configuration validation for client ro.client succeeded.
2019-05-30 10:01:19.313 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-30 10:01:19.313 +08:00 [DBG] Client validation success
2019-05-30 10:01:19.313 +08:00 [INF] {"ClientId":"ro.client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN4KAA5L4S4:00000008","TimeStamp":"2019-05-30T02:01:19.0000000Z","ProcessId":8148,"LocalIpAddress":"127.0.0.1:26700","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-30 10:01:19.314 +08:00 [DBG] Start token request validation
2019-05-30 10:01:19.314 +08:00 [DBG] Start resource owner password token request validation
2019-05-30 10:01:19.431 +08:00 [DBG] Found [] identity scopes in database
2019-05-30 10:01:20.026 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-30 10:01:20.156 +08:00 [DBG] Found [] identity scopes in database
2019-05-30 10:01:20.757 +08:00 [DBG] Found ["api1"] API scopes in database
2019-05-30 10:01:20.903 +08:00 [INF] Credentials validated for username: 1223138295@qq.com
2019-05-30 10:01:20.903 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Endpoint":"Token","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLN4KAA5L4S4:00000008","TimeStamp":"2019-05-30T02:01:20.0000000Z","ProcessId":8148,"LocalIpAddress":"127.0.0.1:26700","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-30 10:01:20.903 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":null,"Endpoint":"Token","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLN4KAA5L4S4:00000008","TimeStamp":"2019-05-30T02:01:20.0000000Z","ProcessId":8148,"LocalIpAddress":"127.0.0.1:26700","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-30 10:01:20.903 +08:00 [DBG] Resource owner password token request validation success.
2019-05-30 10:01:20.903 +08:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"1223138295@qq.com","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"1223138295@qq.com","password":"***REDACTED***","scope":"api1","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-05-30 10:01:20.903 +08:00 [DBG] Getting claims for access token for client: ro.client
2019-05-30 10:01:20.903 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 10:01:20.904 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 10:01:20.907 +08:00 [INF] {"ClientId":"ro.client","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"api1","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****-_Uw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4KAA5L4S4:00000008","TimeStamp":"2019-05-30T02:01:20.0000000Z","ProcessId":8148,"LocalIpAddress":"127.0.0.1:26700","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 10:01:20.907 +08:00 [DBG] Token request success.
2019-05-30 10:57:34.525 +08:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-30 10:57:34.566 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-30 10:57:34.567 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLN4KAA5L4S7:00000002","TimeStamp":"2019-05-30T02:57:34.0000000Z","ProcessId":8148,"LocalIpAddress":"127.0.0.1:26700","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-05-30 10:58:02.784 +08:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-30 10:58:02.786 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-30 10:58:02.786 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLN4KAA5L4S7:00000006","TimeStamp":"2019-05-30T02:58:02.0000000Z","ProcessId":8148,"LocalIpAddress":"127.0.0.1:26700","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-05-30 11:18:24.800 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 11:18:24.827 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 11:18:24.828 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 11:18:24.828 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 11:18:24.828 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 11:18:24.828 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 11:18:25.237 +08:00 [DBG] Starting grant removal
2019-05-30 11:18:25.410 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 11:18:25.413 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 11:18:25.414 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 11:18:25.415 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 11:18:25.415 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 11:18:25.415 +08:00 [DBG] Error Url: /home/error
2019-05-30 11:18:25.415 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 11:19:16.355 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 11:19:16.387 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 11:19:16.387 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 11:19:16.387 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 11:19:16.387 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 11:19:16.388 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 11:19:16.790 +08:00 [DBG] Starting grant removal
2019-05-30 11:19:17.070 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 11:19:17.074 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 11:19:17.074 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 11:19:17.074 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 11:19:17.074 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 11:19:17.074 +08:00 [DBG] Error Url: /home/error
2019-05-30 11:19:17.074 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 11:19:33.964 +08:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-30 11:20:01.720 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-05-30 11:20:30.120 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLN4LMCI17RR:00000002","TimeStamp":"2019-05-30T03:20:30.0000000Z","ProcessId":18444,"LocalIpAddress":"127.0.0.1:6488","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-05-30 13:35:57.105 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 13:35:57.133 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 13:35:57.134 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 13:35:57.134 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 13:35:57.134 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 13:35:57.134 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 13:35:57.591 +08:00 [DBG] Starting grant removal
2019-05-30 13:35:57.861 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 13:35:57.864 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 13:35:57.864 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 13:35:57.864 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 13:35:57.864 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 13:35:57.864 +08:00 [DBG] Error Url: /home/error
2019-05-30 13:35:57.865 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 13:39:27.556 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 13:39:27.608 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 13:39:27.608 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 13:39:27.612 +08:00 [DBG] Start discovery request
2019-05-30 13:39:28.599 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 13:39:29.005 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 13:39:29.005 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 13:39:29.006 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 13:39:29.009 +08:00 [DBG] Start key discovery request
2019-05-30 13:39:29.148 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 13:39:29.151 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 13:39:29.152 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 13:39:29.157 +08:00 [DBG] Start authorize request
2019-05-30 13:39:29.170 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 13:39:29.177 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 13:39:30.455 +08:00 [DBG] mvc found in database: true
2019-05-30 13:39:30.465 +08:00 [DBG] client configuration validation for client mvc succeeded.
2019-05-30 13:39:30.482 +08:00 [ERR] Invalid redirect_uri: http://localhost:5004/signin-oidc
{"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5001/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947915690612307.MDhkOTFmNGYtYmU2My00N2VhLWJmMjktZTI2YzVhZTk5Yzk2NWQ1Y2M1ODctOThlZS00YTZlLWI3ZTktMzZlZjIyOTMwZTU5","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTsbTnJwGr0hHke_ERAjJ-wpd8TIcXgEUXteAKeH_CtsP47OoplhUPNM27-0Eq3KpCO1YFhGEpYVKYn3VnWYgb0AkKe0kI6sWdX0ihzZ8rQ4TV2U8HFZhbrWPZUQ1jmJ0j788aMZR4ZYjvFXOfCMbAwI5Qi5hrcBtXGUX7VqpwMV-uxrW13l_qky3aQruU9cxbHauyBgKnl2O6LKNp0js4W-JrHsmLnSkc5wFtIK544ITlalE1DyD4czFYD6e8lg-J6vLK8kCjvEhkzr1h8tnKGeYYyrMxT0YAv2Ex0fZZhcMQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 13:39:30.492 +08:00 [ERR] Request validation failed
2019-05-30 13:39:30.492 +08:00 [INF] {"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"AllowedRedirectUris":["http://localhost:5001/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvc","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947915690612307.MDhkOTFmNGYtYmU2My00N2VhLWJmMjktZTI2YzVhZTk5Yzk2NWQ1Y2M1ODctOThlZS00YTZlLWI3ZTktMzZlZjIyOTMwZTU5","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTsbTnJwGr0hHke_ERAjJ-wpd8TIcXgEUXteAKeH_CtsP47OoplhUPNM27-0Eq3KpCO1YFhGEpYVKYn3VnWYgb0AkKe0kI6sWdX0ihzZ8rQ4TV2U8HFZhbrWPZUQ1jmJ0j788aMZR4ZYjvFXOfCMbAwI5Qi5hrcBtXGUX7VqpwMV-uxrW13l_qky3aQruU9cxbHauyBgKnl2O6LKNp0js4W-JrHsmLnSkc5wFtIK544ITlalE1DyD4czFYD6e8lg-J6vLK8kCjvEhkzr1h8tnKGeYYyrMxT0YAv2Ex0fZZhcMQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 13:39:30.503 +08:00 [INF] {"ClientId":"mvc","ClientName":"MVC Client","RedirectUri":null,"Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLN4O2OISBI1:00000003","TimeStamp":"2019-05-30T05:39:30.0000000Z","ProcessId":28472,"LocalIpAddress":"127.0.0.1:2801","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-05-30 13:40:18.961 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 13:40:18.973 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 13:40:18.981 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 13:40:18.981 +08:00 [DBG] Start discovery request
2019-05-30 13:40:19.622 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 13:40:19.977 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 13:40:19.978 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 13:40:19.978 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 13:40:19.978 +08:00 [DBG] Start key discovery request
2019-05-30 13:40:20.076 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 13:40:20.076 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 13:40:20.077 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 13:40:20.077 +08:00 [DBG] Start authorize request
2019-05-30 13:40:20.077 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 13:40:20.078 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 13:40:21.061 +08:00 [DBG] mvcImp found in database: true
2019-05-30 13:40:21.062 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 13:40:21.292 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:40:21.435 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:40:21.631 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:40:21.754 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:40:21.761 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 13:40:21.762 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTu6VTtY-O9towz31eWmejWc-Ub4iZybebos8M_pmywP40s0f34VHSoYeg4dYb4V0T1EXLIKf0vKWLGeHR6XMVQPa1xtI23zdM57DTvFTDtmigfMBcLi__e8u4N5OeL3OqFu75gG0AY8PKPYmoNSr6aAILkvhe_hZcq47cLUiq76egc379DlV-ZpKH99LtDDPlFxkjiI0imUYHzOo0C5uiq6PP3gSpnaPv_QHWTKA5x2FdZmi8Hzfaf0zybdB3UJydzvn8iIbzljJIR1cS9sthjV_6YXw5TFcfsOP3xXOuIF7Q","UiLocales":null,"Nonce":"636947916200199997.YzgxMjhjZTAtODRhZS00Mjc1LWJhYzItMmVjZTAxZjE4YjYzZmZiMjk1ODItZDAwZS00MTIyLWJjOTYtMzRhZmJkNmFiYmZi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a13d0597f96184209db71ce8a68b4601","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947916200199997.YzgxMjhjZTAtODRhZS00Mjc1LWJhYzItMmVjZTAxZjE4YjYzZmZiMjk1ODItZDAwZS00MTIyLWJjOTYtMzRhZmJkNmFiYmZi","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTu6VTtY-O9towz31eWmejWc-Ub4iZybebos8M_pmywP40s0f34VHSoYeg4dYb4V0T1EXLIKf0vKWLGeHR6XMVQPa1xtI23zdM57DTvFTDtmigfMBcLi__e8u4N5OeL3OqFu75gG0AY8PKPYmoNSr6aAILkvhe_hZcq47cLUiq76egc379DlV-ZpKH99LtDDPlFxkjiI0imUYHzOo0C5uiq6PP3gSpnaPv_QHWTKA5x2FdZmi8Hzfaf0zybdB3UJydzvn8iIbzljJIR1cS9sthjV_6YXw5TFcfsOP3xXOuIF7Q","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 13:40:22.041 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: false
2019-05-30 13:40:22.041 +08:00 [DBG] user_consent grant with value: mvcImp|af61726e-716b-4170-8c26-6568bf294215 not found in store.
2019-05-30 13:40:22.041 +08:00 [DBG] Found no prior consent from consent store, consent is required
2019-05-30 13:40:22.041 +08:00 [INF] Showing consent: User has not yet consented
2019-05-30 13:40:22.118 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 13:40:23.094 +08:00 [DBG] mvcImp found in database: true
2019-05-30 13:40:23.094 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 13:40:23.277 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:40:23.380 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:40:23.575 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:40:23.720 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:40:23.720 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 13:40:24.739 +08:00 [DBG] mvcImp found in database: true
2019-05-30 13:40:24.739 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 13:40:24.918 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:40:25.019 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:41:47.516 +08:00 [ERR] No consent request matching request: null
2019-05-30 13:43:01.177 +08:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-30 13:43:01.256 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 13:43:03.170 +08:00 [DBG] mvcImp found in database: true
2019-05-30 13:43:03.170 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 13:43:03.388 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:43:03.503 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:43:03.686 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:43:03.801 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:43:03.801 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 13:43:03.803 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RequestedScopes":["openid","profile"],"GrantedScopes":["openid","profile"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLN4O2OISBI3:00000001","TimeStamp":"2019-05-30T05:43:03.0000000Z","ProcessId":28472,"LocalIpAddress":"127.0.0.1:2801","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-05-30 13:43:04.822 +08:00 [DBG] mvcImp found in database: true
2019-05-30 13:43:04.822 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 13:43:04.841 +08:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-05-30 13:43:04.842 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-05-30 13:43:04.842 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-05-30 13:43:04.849 +08:00 [DBG] Start authorize callback request
2019-05-30 13:43:04.855 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 13:43:04.855 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 13:43:05.839 +08:00 [DBG] mvcImp found in database: true
2019-05-30 13:43:05.839 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 13:43:06.013 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:43:06.128 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:43:06.332 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:43:06.438 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:43:06.439 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 13:43:06.439 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTu6VTtY-O9towz31eWmejWc-Ub4iZybebos8M_pmywP40s0f34VHSoYeg4dYb4V0T1EXLIKf0vKWLGeHR6XMVQPa1xtI23zdM57DTvFTDtmigfMBcLi__e8u4N5OeL3OqFu75gG0AY8PKPYmoNSr6aAILkvhe_hZcq47cLUiq76egc379DlV-ZpKH99LtDDPlFxkjiI0imUYHzOo0C5uiq6PP3gSpnaPv_QHWTKA5x2FdZmi8Hzfaf0zybdB3UJydzvn8iIbzljJIR1cS9sthjV_6YXw5TFcfsOP3xXOuIF7Q","UiLocales":null,"Nonce":"636947916200199997.YzgxMjhjZTAtODRhZS00Mjc1LWJhYzItMmVjZTAxZjE4YjYzZmZiMjk1ODItZDAwZS00MTIyLWJjOTYtMzRhZmJkNmFiYmZi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a13d0597f96184209db71ce8a68b4601","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947916200199997.YzgxMjhjZTAtODRhZS00Mjc1LWJhYzItMmVjZTAxZjE4YjYzZmZiMjk1ODItZDAwZS00MTIyLWJjOTYtMzRhZmJkNmFiYmZi","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTu6VTtY-O9towz31eWmejWc-Ub4iZybebos8M_pmywP40s0f34VHSoYeg4dYb4V0T1EXLIKf0vKWLGeHR6XMVQPa1xtI23zdM57DTvFTDtmigfMBcLi__e8u4N5OeL3OqFu75gG0AY8PKPYmoNSr6aAILkvhe_hZcq47cLUiq76egc379DlV-ZpKH99LtDDPlFxkjiI0imUYHzOo0C5uiq6PP3gSpnaPv_QHWTKA5x2FdZmi8Hzfaf0zybdB3UJydzvn8iIbzljJIR1cS9sthjV_6YXw5TFcfsOP3xXOuIF7Q","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 13:43:06.658 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: false
2019-05-30 13:43:06.658 +08:00 [DBG] user_consent grant with value: mvcImp|af61726e-716b-4170-8c26-6568bf294215 not found in store.
2019-05-30 13:43:06.659 +08:00 [DBG] Found no prior consent from consent store, consent is required
2019-05-30 13:43:06.662 +08:00 [INF] User consented to scopes: ["openid","profile"]
2019-05-30 13:43:06.663 +08:00 [DBG] User indicated to remember consent for scopes: ["openid","profile"]
2019-05-30 13:43:06.667 +08:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 13:43:06.797 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= not found in database
2019-05-30 13:43:07.043 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 13:43:07.052 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 13:43:13.481 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 13:43:13.615 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****iWYw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4O2OISBI3:00000002","TimeStamp":"2019-05-30T05:43:13.0000000Z","ProcessId":28472,"LocalIpAddress":"127.0.0.1:2801","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 13:43:13.617 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTu6VTtY-O9towz31eWmejWc-Ub4iZybebos8M_pmywP40s0f34VHSoYeg4dYb4V0T1EXLIKf0vKWLGeHR6XMVQPa1xtI23zdM57DTvFTDtmigfMBcLi__e8u4N5OeL3OqFu75gG0AY8PKPYmoNSr6aAILkvhe_hZcq47cLUiq76egc379DlV-ZpKH99LtDDPlFxkjiI0imUYHzOo0C5uiq6PP3gSpnaPv_QHWTKA5x2FdZmi8Hzfaf0zybdB3UJydzvn8iIbzljJIR1cS9sthjV_6YXw5TFcfsOP3xXOuIF7Q","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 13:43:13.643 +08:00 [DBG] Augmenting SignInContext
2019-05-30 13:43:13.653 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-30 13:43:23.120 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 13:43:25.139 +08:00 [DBG] mvcImp found in database: true
2019-05-30 13:43:25.139 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 13:43:25.399 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:43:25.522 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:43:25.734 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:43:25.869 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:43:25.869 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 13:43:26.979 +08:00 [DBG] mvcImp found in database: true
2019-05-30 13:43:26.979 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 13:43:27.158 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:43:27.271 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:43:30.356 +08:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-30 13:43:30.381 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 13:43:31.382 +08:00 [DBG] mvcImp found in database: true
2019-05-30 13:43:31.382 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 13:43:31.559 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:43:31.666 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:43:31.860 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:43:31.982 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:43:31.982 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 13:43:31.982 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RequestedScopes":["openid","profile"],"GrantedScopes":["openid","profile"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLN4O2OISBI3:00000004","TimeStamp":"2019-05-30T05:43:31.0000000Z","ProcessId":28472,"LocalIpAddress":"127.0.0.1:2801","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-05-30 13:43:33.080 +08:00 [DBG] mvcImp found in database: true
2019-05-30 13:43:33.080 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 13:43:33.100 +08:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-05-30 13:43:33.101 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-05-30 13:43:33.101 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-05-30 13:43:33.101 +08:00 [DBG] Start authorize callback request
2019-05-30 13:43:33.101 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 13:43:33.101 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 13:43:34.112 +08:00 [DBG] mvcImp found in database: true
2019-05-30 13:43:34.113 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 13:43:34.295 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:43:34.399 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:43:34.587 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:43:34.698 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:43:34.698 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 13:43:34.699 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTu6VTtY-O9towz31eWmejWc-Ub4iZybebos8M_pmywP40s0f34VHSoYeg4dYb4V0T1EXLIKf0vKWLGeHR6XMVQPa1xtI23zdM57DTvFTDtmigfMBcLi__e8u4N5OeL3OqFu75gG0AY8PKPYmoNSr6aAILkvhe_hZcq47cLUiq76egc379DlV-ZpKH99LtDDPlFxkjiI0imUYHzOo0C5uiq6PP3gSpnaPv_QHWTKA5x2FdZmi8Hzfaf0zybdB3UJydzvn8iIbzljJIR1cS9sthjV_6YXw5TFcfsOP3xXOuIF7Q","UiLocales":null,"Nonce":"636947916200199997.YzgxMjhjZTAtODRhZS00Mjc1LWJhYzItMmVjZTAxZjE4YjYzZmZiMjk1ODItZDAwZS00MTIyLWJjOTYtMzRhZmJkNmFiYmZi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a13d0597f96184209db71ce8a68b4601","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947916200199997.YzgxMjhjZTAtODRhZS00Mjc1LWJhYzItMmVjZTAxZjE4YjYzZmZiMjk1ODItZDAwZS00MTIyLWJjOTYtMzRhZmJkNmFiYmZi","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTu6VTtY-O9towz31eWmejWc-Ub4iZybebos8M_pmywP40s0f34VHSoYeg4dYb4V0T1EXLIKf0vKWLGeHR6XMVQPa1xtI23zdM57DTvFTDtmigfMBcLi__e8u4N5OeL3OqFu75gG0AY8PKPYmoNSr6aAILkvhe_hZcq47cLUiq76egc379DlV-ZpKH99LtDDPlFxkjiI0imUYHzOo0C5uiq6PP3gSpnaPv_QHWTKA5x2FdZmi8Hzfaf0zybdB3UJydzvn8iIbzljJIR1cS9sthjV_6YXw5TFcfsOP3xXOuIF7Q","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 13:43:34.934 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 13:43:34.939 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 13:43:34.939 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 13:43:34.939 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 13:44:16.324 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 13:44:56.299 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****GM1w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4O2OISBI3:00000005","TimeStamp":"2019-05-30T05:44:56.0000000Z","ProcessId":28472,"LocalIpAddress":"127.0.0.1:2801","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 13:45:00.612 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTu6VTtY-O9towz31eWmejWc-Ub4iZybebos8M_pmywP40s0f34VHSoYeg4dYb4V0T1EXLIKf0vKWLGeHR6XMVQPa1xtI23zdM57DTvFTDtmigfMBcLi__e8u4N5OeL3OqFu75gG0AY8PKPYmoNSr6aAILkvhe_hZcq47cLUiq76egc379DlV-ZpKH99LtDDPlFxkjiI0imUYHzOo0C5uiq6PP3gSpnaPv_QHWTKA5x2FdZmi8Hzfaf0zybdB3UJydzvn8iIbzljJIR1cS9sthjV_6YXw5TFcfsOP3xXOuIF7Q","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 13:51:42.841 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 13:51:42.875 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 13:51:42.876 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 13:51:42.876 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 13:51:42.876 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 13:51:42.876 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 13:51:43.278 +08:00 [DBG] Starting grant removal
2019-05-30 13:51:43.486 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 13:51:43.489 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 13:51:43.489 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 13:51:43.489 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 13:51:43.489 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 13:51:43.489 +08:00 [DBG] Error Url: /home/error
2019-05-30 13:51:43.489 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 13:52:34.166 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 13:52:34.171 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 13:52:34.171 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 13:52:34.175 +08:00 [DBG] Start discovery request
2019-05-30 13:52:35.541 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 13:52:35.980 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 13:52:35.981 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 13:52:35.981 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 13:52:35.987 +08:00 [DBG] Start key discovery request
2019-05-30 13:52:36.131 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 13:52:36.135 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 13:52:36.135 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 13:52:36.139 +08:00 [DBG] Start authorize request
2019-05-30 13:52:36.151 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 13:52:36.158 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 13:52:37.555 +08:00 [DBG] mvcImp found in database: true
2019-05-30 13:52:37.567 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 13:52:37.802 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:52:37.945 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:52:38.146 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:52:38.254 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:52:38.262 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 13:52:38.277 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTvzA4NInA4_LbvAvrRDexEXqakeO2B51A6RO04waZWYUxzTffGdLTCEWBFFTb9j5pzN8AImEr-tzDhd7fg0p5F1sNdfa7cX_GhHihduzpbmH-JyWEj7tUXbGTKy_3ccuZhpBmSAoyOpjoq8_aBBoIBiQvLRSpzEC5cjMh9Mb62ECeV-6g1lawMEikPFJmhar9E2qLZUUU3u3wyTVYBAHENSPzuc4LYUoNvGd3iEfLLi1vQCMSOPo1nekdjl4aoLNphxDFi2xYJT22FFQsn8CVuzTIZZ6z-UsR70K8TaqHFKeg","UiLocales":null,"Nonce":"636947923560620129.NGExOWFiMTQtNTI4Ni00ZTA5LTkwNDMtZmM1ODQxYjZiNDk1NjY4YTEzNDgtYmZkZS00NjRkLWI0YWYtMGNmNTEyN2JkMjkw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a13d0597f96184209db71ce8a68b4601","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947923560620129.NGExOWFiMTQtNTI4Ni00ZTA5LTkwNDMtZmM1ODQxYjZiNDk1NjY4YTEzNDgtYmZkZS00NjRkLWI0YWYtMGNmNTEyN2JkMjkw","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTvzA4NInA4_LbvAvrRDexEXqakeO2B51A6RO04waZWYUxzTffGdLTCEWBFFTb9j5pzN8AImEr-tzDhd7fg0p5F1sNdfa7cX_GhHihduzpbmH-JyWEj7tUXbGTKy_3ccuZhpBmSAoyOpjoq8_aBBoIBiQvLRSpzEC5cjMh9Mb62ECeV-6g1lawMEikPFJmhar9E2qLZUUU3u3wyTVYBAHENSPzuc4LYUoNvGd3iEfLLi1vQCMSOPo1nekdjl4aoLNphxDFi2xYJT22FFQsn8CVuzTIZZ6z-UsR70K8TaqHFKeg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 13:52:38.640 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 13:52:38.647 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 13:52:38.655 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 13:52:38.664 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 13:52:46.227 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 13:52:46.370 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****DQVQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4OBID92O2:00000003","TimeStamp":"2019-05-30T05:52:46.0000000Z","ProcessId":27164,"LocalIpAddress":"127.0.0.1:23500","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 13:52:46.376 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTvzA4NInA4_LbvAvrRDexEXqakeO2B51A6RO04waZWYUxzTffGdLTCEWBFFTb9j5pzN8AImEr-tzDhd7fg0p5F1sNdfa7cX_GhHihduzpbmH-JyWEj7tUXbGTKy_3ccuZhpBmSAoyOpjoq8_aBBoIBiQvLRSpzEC5cjMh9Mb62ECeV-6g1lawMEikPFJmhar9E2qLZUUU3u3wyTVYBAHENSPzuc4LYUoNvGd3iEfLLi1vQCMSOPo1nekdjl4aoLNphxDFi2xYJT22FFQsn8CVuzTIZZ6z-UsR70K8TaqHFKeg","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 13:56:49.533 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 13:56:49.533 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 13:56:49.542 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 13:56:49.542 +08:00 [DBG] Start discovery request
2019-05-30 13:56:50.434 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 13:56:50.826 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 13:56:50.827 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 13:56:50.827 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 13:56:50.827 +08:00 [DBG] Start key discovery request
2019-05-30 13:56:50.932 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 13:56:50.933 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 13:56:50.933 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 13:56:50.935 +08:00 [DBG] Start authorize request
2019-05-30 13:56:50.943 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 13:56:50.943 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 13:56:52.079 +08:00 [DBG] mvcImp found in database: true
2019-05-30 13:56:52.079 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 13:56:52.294 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:56:52.400 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:56:52.610 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:56:52.721 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:56:52.721 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 13:56:52.721 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTuf1mzJy5VAquivgn95lWQoSPVbUjEEhs53SMJ7cJXRX_dJE7InqWJqkySflNhJilZc0SoG23qAuAd5p43TSm-DBIi7V6ipIOwVaVvrGcmlWLF7LAhTPZFA_CwTZNlldXFSFVXQqlOJHwATLHW3GoNZoK32qAP7mAfhsUV-5EIVQuBWGn6u5o-DUpvLQm5XvRQ9RVwNWZjhdO1mXgMx_HjUFFJktcqTnEc6HCJmTmYgjYYvqHeFAKtaR5yEZyUg7zTa36dOu7zABp01rFSYQ1rGLU69inHaDGk5e5KvfLtjJw","UiLocales":null,"Nonce":"636947926108745872.NDRmNDY5YmUtYjRkMi00OTM1LTk3NzItOTliZThjNDJjYWE4MDEwZWMzYmEtZWVmMC00MWJmLTgxYWItYjkwYzc4ODg5YzIz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a13d0597f96184209db71ce8a68b4601","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947926108745872.NDRmNDY5YmUtYjRkMi00OTM1LTk3NzItOTliZThjNDJjYWE4MDEwZWMzYmEtZWVmMC00MWJmLTgxYWItYjkwYzc4ODg5YzIz","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTuf1mzJy5VAquivgn95lWQoSPVbUjEEhs53SMJ7cJXRX_dJE7InqWJqkySflNhJilZc0SoG23qAuAd5p43TSm-DBIi7V6ipIOwVaVvrGcmlWLF7LAhTPZFA_CwTZNlldXFSFVXQqlOJHwATLHW3GoNZoK32qAP7mAfhsUV-5EIVQuBWGn6u5o-DUpvLQm5XvRQ9RVwNWZjhdO1mXgMx_HjUFFJktcqTnEc6HCJmTmYgjYYvqHeFAKtaR5yEZyUg7zTa36dOu7zABp01rFSYQ1rGLU69inHaDGk5e5KvfLtjJw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 13:56:53.021 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 13:56:53.024 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 13:56:53.025 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 13:56:53.025 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 13:56:53.025 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 13:56:53.029 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****QCeg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4OBID92O3:00000003","TimeStamp":"2019-05-30T05:56:53.0000000Z","ProcessId":27164,"LocalIpAddress":"127.0.0.1:23500","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 13:56:53.029 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTuf1mzJy5VAquivgn95lWQoSPVbUjEEhs53SMJ7cJXRX_dJE7InqWJqkySflNhJilZc0SoG23qAuAd5p43TSm-DBIi7V6ipIOwVaVvrGcmlWLF7LAhTPZFA_CwTZNlldXFSFVXQqlOJHwATLHW3GoNZoK32qAP7mAfhsUV-5EIVQuBWGn6u5o-DUpvLQm5XvRQ9RVwNWZjhdO1mXgMx_HjUFFJktcqTnEc6HCJmTmYgjYYvqHeFAKtaR5yEZyUg7zTa36dOu7zABp01rFSYQ1rGLU69inHaDGk5e5KvfLtjJw","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 13:57:10.665 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 13:57:10.665 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 13:57:10.665 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 13:57:10.666 +08:00 [DBG] Start authorize request
2019-05-30 13:57:10.666 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 13:57:10.666 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 13:57:12.003 +08:00 [DBG] mvcImp found in database: true
2019-05-30 13:57:12.003 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 13:57:12.184 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:57:12.298 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:57:12.490 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:57:12.614 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:57:12.614 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 13:57:12.614 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTugNTd7YkvxyRDT5USbCNGSyRtioFHp9exc_LCJdsEXi85LO1gNFNl3IrqNSZ5RcixY7-AiOP4iV7CYhISwRvj78tnlL4o0WxmzbrBO4bppAj6NLnsoV0TtSTTwUk-SNUG3ti-0W0MMaPFZ-r1qup_oR02zOwoh1iyCB2-hw6M_jRurzJ5tzS4zwXz4jGZzK-COOTYmh0MwsB50x2o6gkuRFHzYNJNsCF15tW1auSpMpBaEBQ6vdEG1P4pZG51bLuN5U8vkC0rlz1iEdBz3vBOPEwPreMuv1rUuvaCxer7kdQ","UiLocales":null,"Nonce":"636947926306516607.NjBjMzE2NGMtZmVjNi00YmZjLWFjOWMtNTdlZTc1ZDVhNjRmMTRiZmFlMzAtN2EzOS00YjYwLWEwNzgtYmM0MDU5ZWViNWI0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a13d0597f96184209db71ce8a68b4601","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947926306516607.NjBjMzE2NGMtZmVjNi00YmZjLWFjOWMtNTdlZTc1ZDVhNjRmMTRiZmFlMzAtN2EzOS00YjYwLWEwNzgtYmM0MDU5ZWViNWI0","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTugNTd7YkvxyRDT5USbCNGSyRtioFHp9exc_LCJdsEXi85LO1gNFNl3IrqNSZ5RcixY7-AiOP4iV7CYhISwRvj78tnlL4o0WxmzbrBO4bppAj6NLnsoV0TtSTTwUk-SNUG3ti-0W0MMaPFZ-r1qup_oR02zOwoh1iyCB2-hw6M_jRurzJ5tzS4zwXz4jGZzK-COOTYmh0MwsB50x2o6gkuRFHzYNJNsCF15tW1auSpMpBaEBQ6vdEG1P4pZG51bLuN5U8vkC0rlz1iEdBz3vBOPEwPreMuv1rUuvaCxer7kdQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 13:57:12.875 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 13:57:12.878 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 13:57:12.878 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 13:57:12.878 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 13:57:12.879 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 13:57:12.882 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****lkyw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4OBID92O3:00000004","TimeStamp":"2019-05-30T05:57:12.0000000Z","ProcessId":27164,"LocalIpAddress":"127.0.0.1:23500","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 13:57:12.882 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTugNTd7YkvxyRDT5USbCNGSyRtioFHp9exc_LCJdsEXi85LO1gNFNl3IrqNSZ5RcixY7-AiOP4iV7CYhISwRvj78tnlL4o0WxmzbrBO4bppAj6NLnsoV0TtSTTwUk-SNUG3ti-0W0MMaPFZ-r1qup_oR02zOwoh1iyCB2-hw6M_jRurzJ5tzS4zwXz4jGZzK-COOTYmh0MwsB50x2o6gkuRFHzYNJNsCF15tW1auSpMpBaEBQ6vdEG1P4pZG51bLuN5U8vkC0rlz1iEdBz3vBOPEwPreMuv1rUuvaCxer7kdQ","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 13:57:20.354 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 13:57:20.355 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 13:57:20.355 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 13:57:20.355 +08:00 [DBG] Start authorize request
2019-05-30 13:57:20.355 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 13:57:20.355 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 13:57:21.373 +08:00 [DBG] mvcImp found in database: true
2019-05-30 13:57:21.373 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 13:57:21.575 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:57:21.699 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:57:21.912 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 13:57:22.014 +08:00 [DBG] Found [] API scopes in database
2019-05-30 13:57:22.015 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 13:57:22.015 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTupwzYnAYdgZ1SDBBt2Sx2FeROVGrq7lnRrxSbTbGqRU1ut1BOSInYWuuN_uXwm0RSS4q9-xSfMonx-GHsAWXDx7c_KjoPUEHDd2JJJiqW3eXdP0z1SOy253gQFjUNBfnVgvb_Selbhttrw0cqpvolyGeL-yABhuDbyr-wrWCuGIm9FiO1esvCQBLQKQ8ClQH1gZVWuWcSdH_HclNH67pHKaNSKg9CBCI9oIk_hTUjobUPNonr9NzQFiQeVGpzBKBKvwAktyDbIw0wGCJ2Gs765dmG481eKWws_Qh-hSsZhDw","UiLocales":null,"Nonce":"636947926403462172.NmZiY2Q1NWQtOGExMi00ODc3LThiYTYtNzI0OWQwOTU5ZDMwZWM1MjU2MDMtZWFhNS00MmFiLWJjNDctYjA1MzRlYmJiNTcz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a13d0597f96184209db71ce8a68b4601","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947926403462172.NmZiY2Q1NWQtOGExMi00ODc3LThiYTYtNzI0OWQwOTU5ZDMwZWM1MjU2MDMtZWFhNS00MmFiLWJjNDctYjA1MzRlYmJiNTcz","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTupwzYnAYdgZ1SDBBt2Sx2FeROVGrq7lnRrxSbTbGqRU1ut1BOSInYWuuN_uXwm0RSS4q9-xSfMonx-GHsAWXDx7c_KjoPUEHDd2JJJiqW3eXdP0z1SOy253gQFjUNBfnVgvb_Selbhttrw0cqpvolyGeL-yABhuDbyr-wrWCuGIm9FiO1esvCQBLQKQ8ClQH1gZVWuWcSdH_HclNH67pHKaNSKg9CBCI9oIk_hTUjobUPNonr9NzQFiQeVGpzBKBKvwAktyDbIw0wGCJ2Gs765dmG481eKWws_Qh-hSsZhDw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 13:57:22.228 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 13:57:22.232 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 13:57:22.232 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 13:57:22.232 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 13:57:22.233 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 13:57:22.236 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****pQHQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4OBID92O3:00000005","TimeStamp":"2019-05-30T05:57:22.0000000Z","ProcessId":27164,"LocalIpAddress":"127.0.0.1:23500","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 13:57:22.236 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTupwzYnAYdgZ1SDBBt2Sx2FeROVGrq7lnRrxSbTbGqRU1ut1BOSInYWuuN_uXwm0RSS4q9-xSfMonx-GHsAWXDx7c_KjoPUEHDd2JJJiqW3eXdP0z1SOy253gQFjUNBfnVgvb_Selbhttrw0cqpvolyGeL-yABhuDbyr-wrWCuGIm9FiO1esvCQBLQKQ8ClQH1gZVWuWcSdH_HclNH67pHKaNSKg9CBCI9oIk_hTUjobUPNonr9NzQFiQeVGpzBKBKvwAktyDbIw0wGCJ2Gs765dmG481eKWws_Qh-hSsZhDw","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 14:05:30.782 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 14:05:30.783 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 14:05:30.783 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 14:05:30.783 +08:00 [DBG] Start discovery request
2019-05-30 14:05:31.678 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 14:05:32.014 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 14:05:32.014 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 14:05:32.014 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 14:05:32.015 +08:00 [DBG] Start key discovery request
2019-05-30 14:05:32.131 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 14:05:32.131 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 14:05:32.132 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 14:05:32.132 +08:00 [DBG] Start authorize request
2019-05-30 14:05:32.132 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 14:05:32.132 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:05:33.271 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:05:33.271 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:05:33.487 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:05:33.609 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:05:33.813 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:05:33.943 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:05:33.943 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:05:33.943 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtSCz3xvo8Bf-PyW2AksFB4DewwBumOm0pJD7S4f7IV1rTr-8CjwtO62Qfa_sOW_0w61h91ybkG-tNXTwOjdLuBm05lFTKqcbdNZCkTmlga_zO49THtsOwQLcgOvjLBbxziZ5MwELZcQ7ndvQdhMiv7iewluhynkhsf9Q8KPfE5God2OR1_EQy_ZtiY_CF0W5Jt62Srubj7gHcI_sw1M0p-9MdHEBvWv8kTWWWFT44IBS4Z6dC9jZQAkT5VCpB86Tmm1erq2ZQJZQQ3yMzcfBUY67Heac0x14fTXscj9baRmg","UiLocales":null,"Nonce":"636947931320543096.YzBmNTJmOTEtMWFiNS00MDcwLTk5OTQtY2I3Y2Y0ODBjNzEwMjFkZjZiNjYtNTExZS00YWE3LTkzZTctN2U3OWMyZDU1OTEx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a13d0597f96184209db71ce8a68b4601","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947931320543096.YzBmNTJmOTEtMWFiNS00MDcwLTk5OTQtY2I3Y2Y0ODBjNzEwMjFkZjZiNjYtNTExZS00YWE3LTkzZTctN2U3OWMyZDU1OTEx","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTtSCz3xvo8Bf-PyW2AksFB4DewwBumOm0pJD7S4f7IV1rTr-8CjwtO62Qfa_sOW_0w61h91ybkG-tNXTwOjdLuBm05lFTKqcbdNZCkTmlga_zO49THtsOwQLcgOvjLBbxziZ5MwELZcQ7ndvQdhMiv7iewluhynkhsf9Q8KPfE5God2OR1_EQy_ZtiY_CF0W5Jt62Srubj7gHcI_sw1M0p-9MdHEBvWv8kTWWWFT44IBS4Z6dC9jZQAkT5VCpB86Tmm1erq2ZQJZQQ3yMzcfBUY67Heac0x14fTXscj9baRmg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 14:05:34.186 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 14:05:34.189 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 14:05:34.189 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 14:05:34.190 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 14:05:34.190 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 14:05:34.193 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****uhVg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4OBID92O4:00000003","TimeStamp":"2019-05-30T06:05:34.0000000Z","ProcessId":27164,"LocalIpAddress":"127.0.0.1:23500","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 14:05:34.193 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtSCz3xvo8Bf-PyW2AksFB4DewwBumOm0pJD7S4f7IV1rTr-8CjwtO62Qfa_sOW_0w61h91ybkG-tNXTwOjdLuBm05lFTKqcbdNZCkTmlga_zO49THtsOwQLcgOvjLBbxziZ5MwELZcQ7ndvQdhMiv7iewluhynkhsf9Q8KPfE5God2OR1_EQy_ZtiY_CF0W5Jt62Srubj7gHcI_sw1M0p-9MdHEBvWv8kTWWWFT44IBS4Z6dC9jZQAkT5VCpB86Tmm1erq2ZQJZQQ3yMzcfBUY67Heac0x14fTXscj9baRmg","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 14:19:50.933 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 14:19:50.965 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 14:19:50.965 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 14:19:50.965 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 14:19:50.965 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 14:19:50.965 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 14:19:51.384 +08:00 [DBG] Starting grant removal
2019-05-30 14:19:51.725 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 14:19:51.728 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 14:19:51.728 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 14:19:51.728 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 14:19:51.728 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 14:19:51.728 +08:00 [DBG] Error Url: /home/error
2019-05-30 14:19:51.728 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 14:19:51.758 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 14:19:51.762 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 14:19:51.762 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 14:19:51.766 +08:00 [DBG] Start discovery request
2019-05-30 14:19:53.375 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 14:19:53.745 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 14:19:53.746 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 14:19:53.746 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 14:19:53.752 +08:00 [DBG] Start key discovery request
2019-05-30 14:19:53.895 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 14:19:53.898 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 14:19:53.898 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 14:19:53.903 +08:00 [DBG] Start authorize request
2019-05-30 14:19:53.917 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 14:19:53.921 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:19:55.248 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:19:55.257 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:19:55.516 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:19:55.655 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:19:55.850 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:19:55.952 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:19:55.960 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:19:55.974 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTun5qMcDh3rc0A21e0bvVv3b90t02pWu-JRDBikY8vBi5wdRxJvucJnRgHJ4Tf_UfFCJfR5lp1oHB6-bl_pGWXe8v4bbzQ4ar-u0fS7iFEZz07dioW--kGVEY2tHsHL1YeTf3Q9HrGbX36NiMdMaB5lKgtPxOQ2CfT5coMWSYjwN9BJP_cKhoMjy9ZxZe74uDdj31x2NlwRp-aAw4oHiMiGGooSa8HRdDw9JcAGUShWeW-jAqpFWm-qLgOPnAsy8ccH-qIhMieLrqoKekHMxaK4F-PF-BKrlhVrUoiWNpXLcw","UiLocales":null,"Nonce":"636947939938168277.NmZmMmY4MjktODA0MS00YWZhLWEwNTUtZDE5Y2M4MjQ1NzllMjBlNjExOWMtMDkzOC00ZDQzLWFkODUtNGUzY2M3MmJkMTIw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a13d0597f96184209db71ce8a68b4601","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947939938168277.NmZmMmY4MjktODA0MS00YWZhLWEwNTUtZDE5Y2M4MjQ1NzllMjBlNjExOWMtMDkzOC00ZDQzLWFkODUtNGUzY2M3MmJkMTIw","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTun5qMcDh3rc0A21e0bvVv3b90t02pWu-JRDBikY8vBi5wdRxJvucJnRgHJ4Tf_UfFCJfR5lp1oHB6-bl_pGWXe8v4bbzQ4ar-u0fS7iFEZz07dioW--kGVEY2tHsHL1YeTf3Q9HrGbX36NiMdMaB5lKgtPxOQ2CfT5coMWSYjwN9BJP_cKhoMjy9ZxZe74uDdj31x2NlwRp-aAw4oHiMiGGooSa8HRdDw9JcAGUShWeW-jAqpFWm-qLgOPnAsy8ccH-qIhMieLrqoKekHMxaK4F-PF-BKrlhVrUoiWNpXLcw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 14:19:56.247 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 14:19:56.253 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 14:19:56.261 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 14:19:56.270 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 14:19:56.279 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 14:19:56.382 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****e0rw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4OR9HC3H8:00000002","TimeStamp":"2019-05-30T06:19:56.0000000Z","ProcessId":12892,"LocalIpAddress":"127.0.0.1:16657","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 14:19:56.384 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTun5qMcDh3rc0A21e0bvVv3b90t02pWu-JRDBikY8vBi5wdRxJvucJnRgHJ4Tf_UfFCJfR5lp1oHB6-bl_pGWXe8v4bbzQ4ar-u0fS7iFEZz07dioW--kGVEY2tHsHL1YeTf3Q9HrGbX36NiMdMaB5lKgtPxOQ2CfT5coMWSYjwN9BJP_cKhoMjy9ZxZe74uDdj31x2NlwRp-aAw4oHiMiGGooSa8HRdDw9JcAGUShWeW-jAqpFWm-qLgOPnAsy8ccH-qIhMieLrqoKekHMxaK4F-PF-BKrlhVrUoiWNpXLcw","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 14:20:19.462 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 14:20:19.473 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 14:20:19.473 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 14:20:19.473 +08:00 [DBG] Start authorize request
2019-05-30 14:20:19.474 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 14:20:19.474 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:20:20.519 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:20:20.523 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:20:20.698 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:20:20.832 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:20:21.025 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:20:21.152 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:20:21.152 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:20:21.153 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTt5eMwxjC0ehDBDIwyFFypbXZRK_od47YrylTh7n33GIFa1RBYuGAcbLCxLSuiMQgMMFuWt67F6PuMPAcdPmPgGWQHbmmwIwXVo_t1AcgpOfPDqa-LBqmUzEGbYUZfTsYpP_NdAGy0T7vbWuKTbS1hBJSMfhv0mPd5gHBCcmLS4EtCRoJVrULBvAvz4_IEyR0VSsBT-yUIDP0PQS81Nw9gxgU2z-6SMXT_ajx_hcjwD8szMHHshxtcIrIB71SiM0RmnnzHf6lLE7jCLphkcJWVLcb92qRmyZHFehT-HeWBzJA","UiLocales":null,"Nonce":"636947940194413420.YzMwMzc5ZmItODNlMC00NjU3LWE5NTUtYThiOWViYmE0ZTM2NzNhN2QxNDAtZjQ2My00Yjc5LTkyMzQtMWZjNTM2ZDhkNzQy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a13d0597f96184209db71ce8a68b4601","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947940194413420.YzMwMzc5ZmItODNlMC00NjU3LWE5NTUtYThiOWViYmE0ZTM2NzNhN2QxNDAtZjQ2My00Yjc5LTkyMzQtMWZjNTM2ZDhkNzQy","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTt5eMwxjC0ehDBDIwyFFypbXZRK_od47YrylTh7n33GIFa1RBYuGAcbLCxLSuiMQgMMFuWt67F6PuMPAcdPmPgGWQHbmmwIwXVo_t1AcgpOfPDqa-LBqmUzEGbYUZfTsYpP_NdAGy0T7vbWuKTbS1hBJSMfhv0mPd5gHBCcmLS4EtCRoJVrULBvAvz4_IEyR0VSsBT-yUIDP0PQS81Nw9gxgU2z-6SMXT_ajx_hcjwD8szMHHshxtcIrIB71SiM0RmnnzHf6lLE7jCLphkcJWVLcb92qRmyZHFehT-HeWBzJA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 14:20:21.385 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 14:20:21.389 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 14:20:21.389 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 14:20:21.389 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 14:20:21.389 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 14:20:21.393 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****iRsQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4OR9HC3H6:00000002","TimeStamp":"2019-05-30T06:20:21.0000000Z","ProcessId":12892,"LocalIpAddress":"127.0.0.1:16657","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 14:20:21.393 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTt5eMwxjC0ehDBDIwyFFypbXZRK_od47YrylTh7n33GIFa1RBYuGAcbLCxLSuiMQgMMFuWt67F6PuMPAcdPmPgGWQHbmmwIwXVo_t1AcgpOfPDqa-LBqmUzEGbYUZfTsYpP_NdAGy0T7vbWuKTbS1hBJSMfhv0mPd5gHBCcmLS4EtCRoJVrULBvAvz4_IEyR0VSsBT-yUIDP0PQS81Nw9gxgU2z-6SMXT_ajx_hcjwD8szMHHshxtcIrIB71SiM0RmnnzHf6lLE7jCLphkcJWVLcb92qRmyZHFehT-HeWBzJA","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 14:20:42.664 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 14:20:42.664 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 14:20:42.664 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 14:20:42.665 +08:00 [DBG] Start authorize request
2019-05-30 14:20:42.665 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 14:20:42.665 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:20:43.668 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:20:43.668 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:20:43.860 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:20:43.973 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:20:44.158 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:20:44.274 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:20:44.275 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:20:44.275 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTvB_05guwk7xMpVewCbavkG4vCxIcPgFXiG8NOT6nYi0UjLeDk6RWNCXU6Tgtyl0EIGOyCeeAi-kBeS3eD1-eAPm6HWTqTliarlomYhCztDBMnqhWst5MfmlBlHQP9fU627R9SiDqnSLlPsA3EyMiFWyl6jAc7qxDIbTD27P_4RXuOmD_G8YvINmNMyYmNjOCcXudx0ss06XkzgHSdyuV9CGipmukhOReX7lQt07SB-Wso-m7BnfHs5xW6ya37B84aO6gCtZza4Vzkh1wk9E3rPzcutMrSMJglFwzdp8vnNdA","UiLocales":null,"Nonce":"636947940426527630.MTMzNDcwMjAtMzVlOC00ZDdkLTkwMTUtZjEyOGRjZmMyMzBiMWUxZDRmMDItNzYwZC00ZDU3LTkwN2ItN2U0MzFlZTA2OWM4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a13d0597f96184209db71ce8a68b4601","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947940426527630.MTMzNDcwMjAtMzVlOC00ZDdkLTkwMTUtZjEyOGRjZmMyMzBiMWUxZDRmMDItNzYwZC00ZDU3LTkwN2ItN2U0MzFlZTA2OWM4","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTvB_05guwk7xMpVewCbavkG4vCxIcPgFXiG8NOT6nYi0UjLeDk6RWNCXU6Tgtyl0EIGOyCeeAi-kBeS3eD1-eAPm6HWTqTliarlomYhCztDBMnqhWst5MfmlBlHQP9fU627R9SiDqnSLlPsA3EyMiFWyl6jAc7qxDIbTD27P_4RXuOmD_G8YvINmNMyYmNjOCcXudx0ss06XkzgHSdyuV9CGipmukhOReX7lQt07SB-Wso-m7BnfHs5xW6ya37B84aO6gCtZza4Vzkh1wk9E3rPzcutMrSMJglFwzdp8vnNdA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 14:20:44.497 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 14:20:44.501 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 14:20:44.501 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 14:20:44.501 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 14:20:44.501 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 14:20:44.504 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****1nLw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4OR9HC3H7:00000003","TimeStamp":"2019-05-30T06:20:44.0000000Z","ProcessId":12892,"LocalIpAddress":"127.0.0.1:16657","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 14:20:44.504 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTvB_05guwk7xMpVewCbavkG4vCxIcPgFXiG8NOT6nYi0UjLeDk6RWNCXU6Tgtyl0EIGOyCeeAi-kBeS3eD1-eAPm6HWTqTliarlomYhCztDBMnqhWst5MfmlBlHQP9fU627R9SiDqnSLlPsA3EyMiFWyl6jAc7qxDIbTD27P_4RXuOmD_G8YvINmNMyYmNjOCcXudx0ss06XkzgHSdyuV9CGipmukhOReX7lQt07SB-Wso-m7BnfHs5xW6ya37B84aO6gCtZza4Vzkh1wk9E3rPzcutMrSMJglFwzdp8vnNdA","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 14:20:58.807 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 14:20:58.809 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 14:20:58.809 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 14:20:58.809 +08:00 [DBG] Start authorize request
2019-05-30 14:20:58.809 +08:00 [DBG] No user present in authorize request
2019-05-30 14:20:58.810 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:20:59.891 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:20:59.892 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:21:00.072 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:21:00.176 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:21:00.358 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:21:00.460 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:21:00.461 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:21:00.461 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTseCNkKiM7zkNePa5Y7i59BMiYZKd2Ne0EFEUdP5I_1mHb54O8BbgzNHRbX3uodGfPVZySN3N3-CKBwjlfs8gJreL91JCgTMtL32Imku2_FLRiWIB5wPXZqT9ZU8lzyh0DnptzxZW4AJpurE08zX4W88p8kf0iy8zUqeQlSsOrwsmDW9BX-MqoNGSTHqbC0MWnHazBupl53tsiff4wllR5swGXjb5S6wFcmY5jeEjZd2SQ01YXwkgmBskuApwO6GAno2hAXymNM0YuKrpI-ZO5Ba2RBkz4AekiskUIKOYZaRQ","UiLocales":null,"Nonce":"636947940587966820.ZDQ5ZWJmNzMtMjJkZi00ZWJiLWEwNGMtMGYxZGYxMGMwZDk4ZDE4NjIzOGQtNGZiZS00NzA2LTllN2QtMWM3NDM0MDYwMjc5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947940587966820.ZDQ5ZWJmNzMtMjJkZi00ZWJiLWEwNGMtMGYxZGYxMGMwZDk4ZDE4NjIzOGQtNGZiZS00NzA2LTllN2QtMWM3NDM0MDYwMjc5","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTseCNkKiM7zkNePa5Y7i59BMiYZKd2Ne0EFEUdP5I_1mHb54O8BbgzNHRbX3uodGfPVZySN3N3-CKBwjlfs8gJreL91JCgTMtL32Imku2_FLRiWIB5wPXZqT9ZU8lzyh0DnptzxZW4AJpurE08zX4W88p8kf0iy8zUqeQlSsOrwsmDW9BX-MqoNGSTHqbC0MWnHazBupl53tsiff4wllR5swGXjb5S6wFcmY5jeEjZd2SQ01YXwkgmBskuApwO6GAno2hAXymNM0YuKrpI-ZO5Ba2RBkz4AekiskUIKOYZaRQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 14:21:00.461 +08:00 [INF] Showing login: User is not authenticated
2019-05-30 14:21:00.567 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:21:01.561 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:21:01.561 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:21:01.743 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:21:01.845 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:21:02.032 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:21:02.136 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:21:02.137 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:21:03.178 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:21:03.178 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:21:12.037 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-30 14:21:14.936 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:21:15.964 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:21:15.964 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:21:16.145 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:21:16.248 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:21:16.430 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:21:16.531 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:21:16.531 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:21:16.698 +08:00 [WRN] Invalid password for user af61726e-716b-4170-8c26-6568bf294215.
2019-05-30 14:21:16.699 +08:00 [INF] {"Username":"1223138295@qq.com","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLN4OR9HC3H6:00000004","TimeStamp":"2019-05-30T06:21:16.0000000Z","ProcessId":12892,"LocalIpAddress":"127.0.0.1:16657","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-05-30 14:21:16.700 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:21:17.667 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:21:17.668 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:21:17.872 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:21:17.984 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:21:18.160 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:21:18.262 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:21:18.263 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:21:19.261 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:21:19.261 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:21:29.297 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-30 14:21:35.550 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:21:36.646 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:21:36.646 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:21:36.829 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:21:36.965 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:21:37.162 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:21:37.278 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:21:37.278 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:21:37.402 +08:00 [WRN] Invalid password for user af61726e-716b-4170-8c26-6568bf294215.
2019-05-30 14:21:37.402 +08:00 [INF] {"Username":"1223138295@qq.com","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLN4OR9HC3H7:00000005","TimeStamp":"2019-05-30T06:21:37.0000000Z","ProcessId":12892,"LocalIpAddress":"127.0.0.1:16657","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-05-30 14:21:37.402 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:21:38.444 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:21:38.445 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:21:38.650 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:21:38.752 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:21:38.939 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:21:39.053 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:21:39.054 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:21:40.072 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:21:40.072 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:21:45.957 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-30 14:21:45.984 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:21:47.088 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:21:47.088 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:21:47.274 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:21:47.377 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:21:47.587 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:21:47.690 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:21:47.690 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:21:47.838 +08:00 [WRN] Invalid password for user af61726e-716b-4170-8c26-6568bf294215.
2019-05-30 14:21:47.838 +08:00 [INF] {"Username":"1223138295@qq.com","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLN4OR9HC3H6:00000005","TimeStamp":"2019-05-30T06:21:47.0000000Z","ProcessId":12892,"LocalIpAddress":"127.0.0.1:16657","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-05-30 14:21:47.838 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:21:48.881 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:21:48.882 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:21:49.082 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:21:49.206 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:21:49.402 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:21:49.515 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:21:49.515 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:21:50.552 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:21:50.552 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:22:58.837 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-30 14:22:58.872 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:22:59.940 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:22:59.940 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:23:00.160 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:23:00.292 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:23:00.489 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:23:00.611 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:23:00.611 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:23:00.740 +08:00 [WRN] Invalid password for user af61726e-716b-4170-8c26-6568bf294215.
2019-05-30 14:23:00.740 +08:00 [INF] {"Username":"1223138295@qq.com","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLN4OR9HC3H9:00000001","TimeStamp":"2019-05-30T06:23:00.0000000Z","ProcessId":12892,"LocalIpAddress":"127.0.0.1:16657","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-05-30 14:23:00.740 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:23:01.818 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:23:01.818 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:23:02.029 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:23:02.160 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:23:02.379 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:23:02.511 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:23:02.511 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:23:03.627 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:23:03.627 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:23:23.499 +08:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-05-30 14:23:30.680 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-30 14:23:30.831 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"1223138295@qq.com","DisplayName":"shawn","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLN4OR9HC3H9:00000005","TimeStamp":"2019-05-30T06:23:30.0000000Z","ProcessId":12892,"LocalIpAddress":"127.0.0.1:16657","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-30 14:23:31.065 +08:00 [DBG] Augmenting SignInContext
2019-05-30 14:23:31.067 +08:00 [DBG] Adding idp claim with value: local
2019-05-30 14:23:31.067 +08:00 [DBG] Adding amr claim with value: pwd
2019-05-30 14:23:31.068 +08:00 [DBG] Adding auth_time claim with value: 1559197411
2019-05-30 14:23:31.073 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-30 14:23:31.236 +08:00 [DBG] 1 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-05-30 14:23:32.328 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:23:32.328 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:23:32.529 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:23:32.642 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:28:40.058 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 14:28:40.058 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 14:28:40.058 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 14:28:40.059 +08:00 [DBG] Start discovery request
2019-05-30 14:28:40.835 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 14:28:41.184 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 14:28:41.185 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 14:28:41.185 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 14:28:41.186 +08:00 [DBG] Start key discovery request
2019-05-30 14:28:41.291 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 14:28:41.292 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 14:28:41.292 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 14:28:41.292 +08:00 [DBG] Start authorize request
2019-05-30 14:28:41.292 +08:00 [DBG] No user present in authorize request
2019-05-30 14:28:41.292 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:28:42.272 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:28:42.272 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:28:42.443 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:28:42.565 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:28:42.736 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:28:42.847 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:28:42.847 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:28:42.848 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTsq5DPPBimqB3rSSD_w3K2MqK0todkGFSyrUFZwJoUcdkmawJ4H-9bUu9WIoavhZdqq1XMz865PmkQMvpeFr3KbFidQe1sY_HqJkAwRAYSvV0Nac92tL6wW8iBGciQ0nKF71dcoAR87x4UnygnTCI-F8o_Kyt2syDlTgHIDkARahOsNOD7HSCIj_oxLL571UuHWeuRpzpp8CgxfLFSx6d_UeAwsAP2Lrg1xum5G2K7JVyrSC2FQmjbbpvRPqZUE7DrE9VdX104HpjCztpJZyfaLpgOCcLcN0ZKpDTzF_Xs6rg","UiLocales":null,"Nonce":"636947945212325079.MzE3ZDVlZjktZDhjMS00NzViLThlYmQtNWZlNGE3MDU0ZjJjOWNmMGZjM2MtZjRkOC00MGFmLWI1MWEtZDk0MmExZjUyNzUz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947945212325079.MzE3ZDVlZjktZDhjMS00NzViLThlYmQtNWZlNGE3MDU0ZjJjOWNmMGZjM2MtZjRkOC00MGFmLWI1MWEtZDk0MmExZjUyNzUz","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTsq5DPPBimqB3rSSD_w3K2MqK0todkGFSyrUFZwJoUcdkmawJ4H-9bUu9WIoavhZdqq1XMz865PmkQMvpeFr3KbFidQe1sY_HqJkAwRAYSvV0Nac92tL6wW8iBGciQ0nKF71dcoAR87x4UnygnTCI-F8o_Kyt2syDlTgHIDkARahOsNOD7HSCIj_oxLL571UuHWeuRpzpp8CgxfLFSx6d_UeAwsAP2Lrg1xum5G2K7JVyrSC2FQmjbbpvRPqZUE7DrE9VdX104HpjCztpJZyfaLpgOCcLcN0ZKpDTzF_Xs6rg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 14:28:42.848 +08:00 [INF] Showing login: User is not authenticated
2019-05-30 14:28:42.880 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:28:43.924 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:28:43.925 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:28:44.107 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:28:44.232 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:28:44.403 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:28:44.505 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:28:44.505 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:28:45.483 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:28:45.483 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:28:59.981 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-30 14:29:00.009 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:29:01.061 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:29:01.061 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:29:01.242 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:29:01.344 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:29:01.513 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:29:01.615 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:29:01.616 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:29:01.737 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"1223138295@qq.com","DisplayName":"shawn","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLN4OR9HC3HA:00000007","TimeStamp":"2019-05-30T06:29:01.0000000Z","ProcessId":12892,"LocalIpAddress":"127.0.0.1:16657","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-05-30 14:29:01.943 +08:00 [DBG] Augmenting SignInContext
2019-05-30 14:29:01.944 +08:00 [DBG] Adding idp claim with value: local
2019-05-30 14:29:01.944 +08:00 [DBG] Adding amr claim with value: pwd
2019-05-30 14:29:01.944 +08:00 [DBG] Adding auth_time claim with value: 1559197741
2019-05-30 14:29:01.944 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-30 14:29:01.951 +08:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-05-30 14:29:01.955 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-05-30 14:29:01.955 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-05-30 14:29:01.961 +08:00 [DBG] Start authorize callback request
2019-05-30 14:29:01.965 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 14:29:01.965 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:29:02.982 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:29:02.983 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:29:03.186 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:29:03.296 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:29:03.463 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:29:03.565 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:29:03.565 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:29:03.565 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTsq5DPPBimqB3rSSD_w3K2MqK0todkGFSyrUFZwJoUcdkmawJ4H-9bUu9WIoavhZdqq1XMz865PmkQMvpeFr3KbFidQe1sY_HqJkAwRAYSvV0Nac92tL6wW8iBGciQ0nKF71dcoAR87x4UnygnTCI-F8o_Kyt2syDlTgHIDkARahOsNOD7HSCIj_oxLL571UuHWeuRpzpp8CgxfLFSx6d_UeAwsAP2Lrg1xum5G2K7JVyrSC2FQmjbbpvRPqZUE7DrE9VdX104HpjCztpJZyfaLpgOCcLcN0ZKpDTzF_Xs6rg","UiLocales":null,"Nonce":"636947945212325079.MzE3ZDVlZjktZDhjMS00NzViLThlYmQtNWZlNGE3MDU0ZjJjOWNmMGZjM2MtZjRkOC00MGFmLWI1MWEtZDk0MmExZjUyNzUz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947945212325079.MzE3ZDVlZjktZDhjMS00NzViLThlYmQtNWZlNGE3MDU0ZjJjOWNmMGZjM2MtZjRkOC00MGFmLWI1MWEtZDk0MmExZjUyNzUz","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTsq5DPPBimqB3rSSD_w3K2MqK0todkGFSyrUFZwJoUcdkmawJ4H-9bUu9WIoavhZdqq1XMz865PmkQMvpeFr3KbFidQe1sY_HqJkAwRAYSvV0Nac92tL6wW8iBGciQ0nKF71dcoAR87x4UnygnTCI-F8o_Kyt2syDlTgHIDkARahOsNOD7HSCIj_oxLL571UuHWeuRpzpp8CgxfLFSx6d_UeAwsAP2Lrg1xum5G2K7JVyrSC2FQmjbbpvRPqZUE7DrE9VdX104HpjCztpJZyfaLpgOCcLcN0ZKpDTzF_Xs6rg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 14:29:03.774 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 14:29:03.778 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 14:29:03.778 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 14:29:03.778 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 14:29:03.778 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 14:29:03.782 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****yYbA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4OR9HC3HA:00000008","TimeStamp":"2019-05-30T06:29:03.0000000Z","ProcessId":12892,"LocalIpAddress":"127.0.0.1:16657","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 14:29:03.783 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTsq5DPPBimqB3rSSD_w3K2MqK0todkGFSyrUFZwJoUcdkmawJ4H-9bUu9WIoavhZdqq1XMz865PmkQMvpeFr3KbFidQe1sY_HqJkAwRAYSvV0Nac92tL6wW8iBGciQ0nKF71dcoAR87x4UnygnTCI-F8o_Kyt2syDlTgHIDkARahOsNOD7HSCIj_oxLL571UuHWeuRpzpp8CgxfLFSx6d_UeAwsAP2Lrg1xum5G2K7JVyrSC2FQmjbbpvRPqZUE7DrE9VdX104HpjCztpJZyfaLpgOCcLcN0ZKpDTzF_Xs6rg","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 14:29:03.792 +08:00 [DBG] Augmenting SignInContext
2019-05-30 14:29:03.792 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-30 14:29:27.565 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 14:29:27.566 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 14:29:27.566 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 14:29:27.566 +08:00 [DBG] Start authorize request
2019-05-30 14:29:27.567 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 14:29:27.567 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:29:28.598 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:29:28.598 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:29:28.795 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:29:28.904 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:29:29.081 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:29:29.191 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:29:29.192 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:29:29.192 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTuwLRvhQ4gZhQiDI9aCGyVV0OsnI1oE0qiu7lu0dh9fT-85a0DdbYgJFvMDtizpRoKdwdDfu6ICk-lKea0u39McjFzlgtSQ4YQiXC_SVBoOEx6ZBba3rvKj42JSmZEdqqef2Lo4-Vj92v1BMUDH0eNXsIvVMrqmSUvxc8WIIBj6lJncHEyU546SohThYNii4bEj2fqQCXfurkNA3bSdFnfx-_GWoZua1y3YxLpiPpAZC8U7aSEy-KuTJKcKFeshBV7xJ7Jk7Bhs8XIyAXJiMM-qe14CiTcO01fQRtEXlkBRYA","UiLocales":null,"Nonce":"636947945675511145.YWQ2YmZmZDAtYWViYi00YjNjLWE2MTItMjc1MDkwNTFlNTcyMGE0YTNkMTktYjBjZC00YTIwLTk2NTYtNTJlMDVmOGQ0ZTZl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947945675511145.YWQ2YmZmZDAtYWViYi00YjNjLWE2MTItMjc1MDkwNTFlNTcyMGE0YTNkMTktYjBjZC00YTIwLTk2NTYtNTJlMDVmOGQ0ZTZl","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTuwLRvhQ4gZhQiDI9aCGyVV0OsnI1oE0qiu7lu0dh9fT-85a0DdbYgJFvMDtizpRoKdwdDfu6ICk-lKea0u39McjFzlgtSQ4YQiXC_SVBoOEx6ZBba3rvKj42JSmZEdqqef2Lo4-Vj92v1BMUDH0eNXsIvVMrqmSUvxc8WIIBj6lJncHEyU546SohThYNii4bEj2fqQCXfurkNA3bSdFnfx-_GWoZua1y3YxLpiPpAZC8U7aSEy-KuTJKcKFeshBV7xJ7Jk7Bhs8XIyAXJiMM-qe14CiTcO01fQRtEXlkBRYA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 14:29:29.412 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 14:29:29.415 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 14:29:29.416 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 14:29:29.416 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 14:29:29.416 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 14:29:29.419 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****5b4w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4OR9HC3HA:00000009","TimeStamp":"2019-05-30T06:29:29.0000000Z","ProcessId":12892,"LocalIpAddress":"127.0.0.1:16657","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 14:29:29.419 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTuwLRvhQ4gZhQiDI9aCGyVV0OsnI1oE0qiu7lu0dh9fT-85a0DdbYgJFvMDtizpRoKdwdDfu6ICk-lKea0u39McjFzlgtSQ4YQiXC_SVBoOEx6ZBba3rvKj42JSmZEdqqef2Lo4-Vj92v1BMUDH0eNXsIvVMrqmSUvxc8WIIBj6lJncHEyU546SohThYNii4bEj2fqQCXfurkNA3bSdFnfx-_GWoZua1y3YxLpiPpAZC8U7aSEy-KuTJKcKFeshBV7xJ7Jk7Bhs8XIyAXJiMM-qe14CiTcO01fQRtEXlkBRYA","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 14:29:29.426 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 14:29:29.426 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 14:29:29.427 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 14:29:29.427 +08:00 [DBG] Start authorize request
2019-05-30 14:29:29.427 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 14:29:29.427 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:29:30.456 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:29:30.456 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:29:30.645 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:29:30.755 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:29:30.932 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:29:31.031 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:29:31.031 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:29:31.032 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTuwLRvhQ4gZhQiDI9aCGyVV0OsnI1oE0qiu7lu0dh9fT-85a0DdbYgJFvMDtizpRoKdwdDfu6ICk-lKea0u39McjFzlgtSQ4YQiXC_SVBoOEx6ZBba3rvKj42JSmZEdqqef2Lo4-Vj92v1BMUDH0eNXsIvVMrqmSUvxc8WIIBj6lJncHEyU546SohThYNii4bEj2fqQCXfurkNA3bSdFnfx-_GWoZua1y3YxLpiPpAZC8U7aSEy-KuTJKcKFeshBV7xJ7Jk7Bhs8XIyAXJiMM-qe14CiTcO01fQRtEXlkBRYA","UiLocales":null,"Nonce":"636947945675511145.YWQ2YmZmZDAtYWViYi00YjNjLWE2MTItMjc1MDkwNTFlNTcyMGE0YTNkMTktYjBjZC00YTIwLTk2NTYtNTJlMDVmOGQ0ZTZl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947945675511145.YWQ2YmZmZDAtYWViYi00YjNjLWE2MTItMjc1MDkwNTFlNTcyMGE0YTNkMTktYjBjZC00YTIwLTk2NTYtNTJlMDVmOGQ0ZTZl","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTuwLRvhQ4gZhQiDI9aCGyVV0OsnI1oE0qiu7lu0dh9fT-85a0DdbYgJFvMDtizpRoKdwdDfu6ICk-lKea0u39McjFzlgtSQ4YQiXC_SVBoOEx6ZBba3rvKj42JSmZEdqqef2Lo4-Vj92v1BMUDH0eNXsIvVMrqmSUvxc8WIIBj6lJncHEyU546SohThYNii4bEj2fqQCXfurkNA3bSdFnfx-_GWoZua1y3YxLpiPpAZC8U7aSEy-KuTJKcKFeshBV7xJ7Jk7Bhs8XIyAXJiMM-qe14CiTcO01fQRtEXlkBRYA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 14:29:31.240 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 14:29:31.243 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 14:29:31.243 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 14:29:31.244 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 14:29:31.244 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 14:29:31.247 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****uASg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4OR9HC3HA:0000000A","TimeStamp":"2019-05-30T06:29:31.0000000Z","ProcessId":12892,"LocalIpAddress":"127.0.0.1:16657","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 14:29:31.247 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTuwLRvhQ4gZhQiDI9aCGyVV0OsnI1oE0qiu7lu0dh9fT-85a0DdbYgJFvMDtizpRoKdwdDfu6ICk-lKea0u39McjFzlgtSQ4YQiXC_SVBoOEx6ZBba3rvKj42JSmZEdqqef2Lo4-Vj92v1BMUDH0eNXsIvVMrqmSUvxc8WIIBj6lJncHEyU546SohThYNii4bEj2fqQCXfurkNA3bSdFnfx-_GWoZua1y3YxLpiPpAZC8U7aSEy-KuTJKcKFeshBV7xJ7Jk7Bhs8XIyAXJiMM-qe14CiTcO01fQRtEXlkBRYA","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 14:37:05.720 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 14:37:05.748 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 14:37:05.748 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 14:37:05.748 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 14:37:05.748 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 14:37:05.748 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 14:37:06.159 +08:00 [DBG] Starting grant removal
2019-05-30 14:37:06.488 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 14:37:06.490 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 14:37:06.490 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 14:37:06.490 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 14:37:06.490 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 14:37:06.490 +08:00 [DBG] Error Url: /home/error
2019-05-30 14:37:06.490 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 14:37:33.873 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 14:37:33.884 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 14:37:33.884 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 14:37:33.889 +08:00 [DBG] Start authorize request
2019-05-30 14:37:33.903 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 14:37:33.921 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:37:35.693 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:37:35.706 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:37:35.949 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:37:36.197 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:37:36.411 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:37:36.531 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:37:36.539 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:37:36.553 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTva3QHSGN3FdhNI0rpWq4Z25IA6aB0kp-G6iwh1CXcjCXSFUHuEqM_cAytgHjk8ho5Pcjehvlxkclqs4NxcGRbPRA_n6EvfEc7mI9yeFV4JBStiKG2M4BKjPrR2wsGvWRaCACZCJUPK9Z8LcY0giRYimUkuq5aIOenBkr6hzdJdJW_ZbW-fx8gyLUaMmU9V3OAJeIIK7yUzGysZrErNcFM5Ii9iyZDwG0a972VN0Tjzmd119p2WvHy3xztJz6NA0_1tXTb4_7gPlUi14W_v1Mum-dZ9-JpYGSoaEKrUhGeFTw","UiLocales":null,"Nonce":"636947950538360158.OTU5Y2Y5ODktNmEwZS00MjMyLWFhZjItMWIxYTE5NmM3NTcyMWExNDQzMWEtYzgyNS00MmRmLThmMGMtNzhjMDIyYTE1ODQy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947950538360158.OTU5Y2Y5ODktNmEwZS00MjMyLWFhZjItMWIxYTE5NmM3NTcyMWExNDQzMWEtYzgyNS00MmRmLThmMGMtNzhjMDIyYTE1ODQy","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTva3QHSGN3FdhNI0rpWq4Z25IA6aB0kp-G6iwh1CXcjCXSFUHuEqM_cAytgHjk8ho5Pcjehvlxkclqs4NxcGRbPRA_n6EvfEc7mI9yeFV4JBStiKG2M4BKjPrR2wsGvWRaCACZCJUPK9Z8LcY0giRYimUkuq5aIOenBkr6hzdJdJW_ZbW-fx8gyLUaMmU9V3OAJeIIK7yUzGysZrErNcFM5Ii9iyZDwG0a972VN0Tjzmd119p2WvHy3xztJz6NA0_1tXTb4_7gPlUi14W_v1Mum-dZ9-JpYGSoaEKrUhGeFTw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 14:37:36.959 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 14:37:36.965 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 14:37:36.973 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 14:37:36.982 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 14:37:36.989 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 14:37:37.108 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****vlvg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVMC:00000002","TimeStamp":"2019-05-30T06:37:37.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 14:37:37.111 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTva3QHSGN3FdhNI0rpWq4Z25IA6aB0kp-G6iwh1CXcjCXSFUHuEqM_cAytgHjk8ho5Pcjehvlxkclqs4NxcGRbPRA_n6EvfEc7mI9yeFV4JBStiKG2M4BKjPrR2wsGvWRaCACZCJUPK9Z8LcY0giRYimUkuq5aIOenBkr6hzdJdJW_ZbW-fx8gyLUaMmU9V3OAJeIIK7yUzGysZrErNcFM5Ii9iyZDwG0a972VN0Tjzmd119p2WvHy3xztJz6NA0_1tXTb4_7gPlUi14W_v1Mum-dZ9-JpYGSoaEKrUhGeFTw","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 14:37:38.128 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 14:37:38.128 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 14:37:38.129 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 14:37:38.129 +08:00 [DBG] Start authorize request
2019-05-30 14:37:38.129 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 14:37:38.129 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:37:39.159 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:37:39.159 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:37:39.384 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:37:39.486 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:37:39.669 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:37:39.781 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:37:39.781 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:37:39.781 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTu5ibZRWMVdwCJZL3lpSnJZ9JEtHVjgXXAnqsJGsOmuaxEIbMrr4sECEUNAC3x3irbkf-y3XghiGRxgNmXIHSJUxtlkHZ3zO9IkgyhARjczaWDXzlTbcCSQfD1KgvRmzMeLx6mc4px2I7lj7uvlfCo_QaNB1mtK42guBv97mpXXqRWYwsAp-jG7h8mljMlv6ASR3YqAKHZWvbRbmt_pteJZcbh8NDiJp6n0CTA8kP_WMCZy9OiIAz26OczZFRQ5rZK2qcCcm5N26-ouTejWHWvs-qllkgbb9_ffa5HxiyVtS8Dg_3w1TWSD5buzby60dNA","UiLocales":null,"Nonce":"636947950580917966.ZTYwOTUyYzItNWY4MS00YjljLWFjYmUtOTUyZDUyMjc5ODgwNDU3MTkzZmEtMTJmOS00MGFhLWEzZjUtNDBmNTkwOTVkNDNk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947950580917966.ZTYwOTUyYzItNWY4MS00YjljLWFjYmUtOTUyZDUyMjc5ODgwNDU3MTkzZmEtMTJmOS00MGFhLWEzZjUtNDBmNTkwOTVkNDNk","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTu5ibZRWMVdwCJZL3lpSnJZ9JEtHVjgXXAnqsJGsOmuaxEIbMrr4sECEUNAC3x3irbkf-y3XghiGRxgNmXIHSJUxtlkHZ3zO9IkgyhARjczaWDXzlTbcCSQfD1KgvRmzMeLx6mc4px2I7lj7uvlfCo_QaNB1mtK42guBv97mpXXqRWYwsAp-jG7h8mljMlv6ASR3YqAKHZWvbRbmt_pteJZcbh8NDiJp6n0CTA8kP_WMCZy9OiIAz26OczZFRQ5rZK2qcCcm5N26-ouTejWHWvs-qllkgbb9_ffa5HxiyVtS8Dg_3w1TWSD5buzby60dNA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 14:37:40.019 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 14:37:40.022 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 14:37:40.022 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 14:37:40.022 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 14:37:40.023 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 14:37:40.026 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****6Uzw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVMB:00000002","TimeStamp":"2019-05-30T06:37:40.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 14:37:40.026 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTu5ibZRWMVdwCJZL3lpSnJZ9JEtHVjgXXAnqsJGsOmuaxEIbMrr4sECEUNAC3x3irbkf-y3XghiGRxgNmXIHSJUxtlkHZ3zO9IkgyhARjczaWDXzlTbcCSQfD1KgvRmzMeLx6mc4px2I7lj7uvlfCo_QaNB1mtK42guBv97mpXXqRWYwsAp-jG7h8mljMlv6ASR3YqAKHZWvbRbmt_pteJZcbh8NDiJp6n0CTA8kP_WMCZy9OiIAz26OczZFRQ5rZK2qcCcm5N26-ouTejWHWvs-qllkgbb9_ffa5HxiyVtS8Dg_3w1TWSD5buzby60dNA","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 14:39:34.098 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 14:39:34.098 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 14:39:34.098 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 14:39:34.098 +08:00 [DBG] Start authorize request
2019-05-30 14:39:34.098 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 14:39:34.099 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:39:35.132 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:39:35.132 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:39:35.324 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:39:35.425 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:39:35.609 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:39:35.722 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:39:35.722 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:39:35.723 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTva3QHSGN3FdhNI0rpWq4Z25IA6aB0kp-G6iwh1CXcjCXSFUHuEqM_cAytgHjk8ho5Pcjehvlxkclqs4NxcGRbPRA_n6EvfEc7mI9yeFV4JBStiKG2M4BKjPrR2wsGvWRaCACZCJUPK9Z8LcY0giRYimUkuq5aIOenBkr6hzdJdJW_ZbW-fx8gyLUaMmU9V3OAJeIIK7yUzGysZrErNcFM5Ii9iyZDwG0a972VN0Tjzmd119p2WvHy3xztJz6NA0_1tXTb4_7gPlUi14W_v1Mum-dZ9-JpYGSoaEKrUhGeFTw","UiLocales":null,"Nonce":"636947950538360158.OTU5Y2Y5ODktNmEwZS00MjMyLWFhZjItMWIxYTE5NmM3NTcyMWExNDQzMWEtYzgyNS00MmRmLThmMGMtNzhjMDIyYTE1ODQy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947950538360158.OTU5Y2Y5ODktNmEwZS00MjMyLWFhZjItMWIxYTE5NmM3NTcyMWExNDQzMWEtYzgyNS00MmRmLThmMGMtNzhjMDIyYTE1ODQy","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTva3QHSGN3FdhNI0rpWq4Z25IA6aB0kp-G6iwh1CXcjCXSFUHuEqM_cAytgHjk8ho5Pcjehvlxkclqs4NxcGRbPRA_n6EvfEc7mI9yeFV4JBStiKG2M4BKjPrR2wsGvWRaCACZCJUPK9Z8LcY0giRYimUkuq5aIOenBkr6hzdJdJW_ZbW-fx8gyLUaMmU9V3OAJeIIK7yUzGysZrErNcFM5Ii9iyZDwG0a972VN0Tjzmd119p2WvHy3xztJz6NA0_1tXTb4_7gPlUi14W_v1Mum-dZ9-JpYGSoaEKrUhGeFTw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 14:39:38.925 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 14:39:38.929 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 14:39:38.929 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 14:39:38.929 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 14:40:13.210 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 14:40:28.936 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****NUlA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVMD:00000001","TimeStamp":"2019-05-30T06:40:28.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 14:40:31.008 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTva3QHSGN3FdhNI0rpWq4Z25IA6aB0kp-G6iwh1CXcjCXSFUHuEqM_cAytgHjk8ho5Pcjehvlxkclqs4NxcGRbPRA_n6EvfEc7mI9yeFV4JBStiKG2M4BKjPrR2wsGvWRaCACZCJUPK9Z8LcY0giRYimUkuq5aIOenBkr6hzdJdJW_ZbW-fx8gyLUaMmU9V3OAJeIIK7yUzGysZrErNcFM5Ii9iyZDwG0a972VN0Tjzmd119p2WvHy3xztJz6NA0_1tXTb4_7gPlUi14W_v1Mum-dZ9-JpYGSoaEKrUhGeFTw","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 14:42:19.108 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 14:42:19.109 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 14:42:19.109 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 14:42:19.109 +08:00 [DBG] Start authorize request
2019-05-30 14:42:19.109 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 14:42:19.109 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:42:20.229 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:42:20.229 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:42:20.431 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:42:20.533 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:42:20.726 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:42:20.851 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:42:20.851 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:42:20.851 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTu6ZWsXX4ot69AxARuuRxwN-VTARknYjkz4V1nwje5z1rilZ-UUYiduKt4ukgZE8wB2fB1bGabWrnp05Eo1Hn0CDbCmFJk4Iry0-DonPoSICpY-OLOBvb7OfGSYsFNKJvARbz6_FIqh5lM_D3-0qEZqmmspgZgGTvDV18AfP7xZeHSlz5OC3sRj9pM3FMo-yoFlaeHROnPZ48LKa4AWPeALqC30PCzvh-mGPeMZcbuUB7M1TT4ThDlzOgO3crumClXo5304fm2Ne_pMG3gVyBseh6GDcteoCraM2wYTX5lQOQ","UiLocales":null,"Nonce":"636947953390894630.NjliODM5YjItZjU5YS00MmQxLWEzNmQtZWFlMDEwYzE3OGJmNmY2YjgzMGUtOWRmNS00ZGZlLWFlM2UtODJjMDE4NTQ5YWJi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947953390894630.NjliODM5YjItZjU5YS00MmQxLWEzNmQtZWFlMDEwYzE3OGJmNmY2YjgzMGUtOWRmNS00ZGZlLWFlM2UtODJjMDE4NTQ5YWJi","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTu6ZWsXX4ot69AxARuuRxwN-VTARknYjkz4V1nwje5z1rilZ-UUYiduKt4ukgZE8wB2fB1bGabWrnp05Eo1Hn0CDbCmFJk4Iry0-DonPoSICpY-OLOBvb7OfGSYsFNKJvARbz6_FIqh5lM_D3-0qEZqmmspgZgGTvDV18AfP7xZeHSlz5OC3sRj9pM3FMo-yoFlaeHROnPZ48LKa4AWPeALqC30PCzvh-mGPeMZcbuUB7M1TT4ThDlzOgO3crumClXo5304fm2Ne_pMG3gVyBseh6GDcteoCraM2wYTX5lQOQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 14:42:22.746 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 14:42:22.750 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 14:42:22.751 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 14:42:22.751 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 14:42:24.546 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 14:42:24.550 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****DlJQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVMD:00000002","TimeStamp":"2019-05-30T06:42:24.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 14:42:24.550 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTu6ZWsXX4ot69AxARuuRxwN-VTARknYjkz4V1nwje5z1rilZ-UUYiduKt4ukgZE8wB2fB1bGabWrnp05Eo1Hn0CDbCmFJk4Iry0-DonPoSICpY-OLOBvb7OfGSYsFNKJvARbz6_FIqh5lM_D3-0qEZqmmspgZgGTvDV18AfP7xZeHSlz5OC3sRj9pM3FMo-yoFlaeHROnPZ48LKa4AWPeALqC30PCzvh-mGPeMZcbuUB7M1TT4ThDlzOgO3crumClXo5304fm2Ne_pMG3gVyBseh6GDcteoCraM2wYTX5lQOQ","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 14:42:30.483 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 14:42:30.484 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 14:42:30.488 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 14:42:30.488 +08:00 [DBG] Start authorize request
2019-05-30 14:42:30.489 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 14:42:30.489 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:42:31.649 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:42:31.650 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:42:31.869 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:42:31.981 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:42:32.177 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:42:32.307 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:42:32.308 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:42:32.308 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtg_72n9_5MR0uxM60Y9cMl4tXb8kvLa1ffHIe4Yd3ETSuvk2Jt-DOwFiiNRQFVIFYDPeIwo4NdDbR3WFGZiGmywXMWAL5P6s9fmxZRvIGqgXiMqrvUgI3-60ZPHn1_sWuUg2vKa7_WKDN-aiTMBtXcJX-7IGzEAoNp9gm4h8PvY0kKprp6juZ2r1ZDuEyaE7Y7Erv-x6K3aHFjaSt2RhZRz5_zXP0WYdeLRHVgqC2o34H3yHtgwQRrH2hnnDuLQzpVQmkscvFqGwABsDx1SjxGv8c8PYGghHw3hpx6iwV31g","UiLocales":null,"Nonce":"636947953504742129.ZmM0ODZmZDctMmQxMy00ZTFmLWJkMGMtM2RhNDhkMWZhMTMzNWFjOTc3MmUtMTM4ZS00ZjU2LWFlZmMtMzQ5ZjFmMmU0ZWM5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947953504742129.ZmM0ODZmZDctMmQxMy00ZTFmLWJkMGMtM2RhNDhkMWZhMTMzNWFjOTc3MmUtMTM4ZS00ZjU2LWFlZmMtMzQ5ZjFmMmU0ZWM5","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTtg_72n9_5MR0uxM60Y9cMl4tXb8kvLa1ffHIe4Yd3ETSuvk2Jt-DOwFiiNRQFVIFYDPeIwo4NdDbR3WFGZiGmywXMWAL5P6s9fmxZRvIGqgXiMqrvUgI3-60ZPHn1_sWuUg2vKa7_WKDN-aiTMBtXcJX-7IGzEAoNp9gm4h8PvY0kKprp6juZ2r1ZDuEyaE7Y7Erv-x6K3aHFjaSt2RhZRz5_zXP0WYdeLRHVgqC2o34H3yHtgwQRrH2hnnDuLQzpVQmkscvFqGwABsDx1SjxGv8c8PYGghHw3hpx6iwV31g","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 14:42:33.717 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 14:42:33.721 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 14:42:33.721 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 14:42:33.721 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 14:42:36.963 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 14:42:36.967 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****5fSg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVMD:00000003","TimeStamp":"2019-05-30T06:42:36.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 14:42:36.967 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtg_72n9_5MR0uxM60Y9cMl4tXb8kvLa1ffHIe4Yd3ETSuvk2Jt-DOwFiiNRQFVIFYDPeIwo4NdDbR3WFGZiGmywXMWAL5P6s9fmxZRvIGqgXiMqrvUgI3-60ZPHn1_sWuUg2vKa7_WKDN-aiTMBtXcJX-7IGzEAoNp9gm4h8PvY0kKprp6juZ2r1ZDuEyaE7Y7Erv-x6K3aHFjaSt2RhZRz5_zXP0WYdeLRHVgqC2o34H3yHtgwQRrH2hnnDuLQzpVQmkscvFqGwABsDx1SjxGv8c8PYGghHw3hpx6iwV31g","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 14:43:43.470 +08:00 [INF] {"Details":"System.NullReferenceException: Object reference not set to an instance of an object.\r\n   at IdentityServer4.Endpoints.Results.AuthorizeResult.Init(HttpContext context) in C:\\local\\identity\\server4\\IdentityServer4\\src\\Endpoints\\Results\\AuthorizeResult.cs:line 52\r\n   at IdentityServer4.Endpoints.Results.AuthorizeResult.ExecuteAsync(HttpContext context) in C:\\local\\identity\\server4\\IdentityServer4\\src\\Endpoints\\Results\\AuthorizeResult.cs:line 60\r\n   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\\local\\identity\\server4\\IdentityServer4\\src\\Hosting\\IdentityServerMiddleware.cs:line 59","Category":"Error","Name":"Unhandled Exception","EventType":"Error","Id":3000,"Message":"Object reference not set to an instance of an object.","ActivityId":"0HLN4P4TTNVMD:00000003","TimeStamp":"2019-05-30T06:43:43.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"UnhandledExceptionEvent"}
2019-05-30 14:43:43.471 +08:00 [FTL] Unhandled exception: Object reference not set to an instance of an object.
System.NullReferenceException: Object reference not set to an instance of an object.
   at IdentityServer4.Endpoints.Results.AuthorizeResult.Init(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Endpoints\Results\AuthorizeResult.cs:line 52
   at IdentityServer4.Endpoints.Results.AuthorizeResult.ExecuteAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Endpoints\Results\AuthorizeResult.cs:line 60
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 59
2019-05-30 14:43:44.307 +08:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at IdentityServer4.Endpoints.Results.AuthorizeResult.Init(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Endpoints\Results\AuthorizeResult.cs:line 52
   at IdentityServer4.Endpoints.Results.AuthorizeResult.ExecuteAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Endpoints\Results\AuthorizeResult.cs:line 60
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 59
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 69
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-30 14:43:44.310 +08:00 [WRN] The response has already started, the error page middleware will not be executed.
2019-05-30 14:43:44.707 +08:00 [ERR] Connection id "0HLN4P4TTNVMD", Request id "0HLN4P4TTNVMD:00000003": An unhandled exception was thrown by the application.
System.NullReferenceException: Object reference not set to an instance of an object.
   at IdentityServer4.Endpoints.Results.AuthorizeResult.Init(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Endpoints\Results\AuthorizeResult.cs:line 52
   at IdentityServer4.Endpoints.Results.AuthorizeResult.ExecuteAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Endpoints\Results\AuthorizeResult.cs:line 60
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 59
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 69
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Server.IISIntegration.IISMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2019-05-30 14:43:46.967 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 14:43:46.967 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 14:43:46.968 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 14:43:46.968 +08:00 [DBG] Start authorize request
2019-05-30 14:43:46.970 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 14:43:46.970 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:43:47.985 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:43:47.985 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:43:48.166 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:43:48.288 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:43:48.479 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:43:48.823 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:43:48.823 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:43:48.823 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtMo5jJA0GU9M58XLehFxWaV4Bdm16rKwBOjUXfqoEVE6KxVWUwJfCyy7v9BBM_pIg7Kpa3fHPR2_Ip_fWBXUu7GEIr2i95PiyyrFYqvTMDrIjWwtIv5VMbEL69P0kM0JzprZSH-ZjEF1NYT6YrMwQyLvrV3kOm5g4TKlbZLYbJMEFfld9TY27jsf5IzGeLAHUTMmxqidVAXjo_IsyZjS08p_NOoZb_PoUqL0XlyEr6rA4ZxQcLuvKpCIyJ6p-sk8Zs7qas2x1w4v4110Ob1Nr6siJTs1DHrtizzKOg-dPcvw","UiLocales":null,"Nonce":"636947954269573475.YzFlZjQyYjctZTQzZS00ZTFhLTliNTctZWRkOTE1OTdkMzU0ZGVjMzA4ZTgtYjM2MC00NjJmLWJjZDItMzYyNDgzODk5Y2Rh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947954269573475.YzFlZjQyYjctZTQzZS00ZTFhLTliNTctZWRkOTE1OTdkMzU0ZGVjMzA4ZTgtYjM2MC00NjJmLWJjZDItMzYyNDgzODk5Y2Rh","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTtMo5jJA0GU9M58XLehFxWaV4Bdm16rKwBOjUXfqoEVE6KxVWUwJfCyy7v9BBM_pIg7Kpa3fHPR2_Ip_fWBXUu7GEIr2i95PiyyrFYqvTMDrIjWwtIv5VMbEL69P0kM0JzprZSH-ZjEF1NYT6YrMwQyLvrV3kOm5g4TKlbZLYbJMEFfld9TY27jsf5IzGeLAHUTMmxqidVAXjo_IsyZjS08p_NOoZb_PoUqL0XlyEr6rA4ZxQcLuvKpCIyJ6p-sk8Zs7qas2x1w4v4110Ob1Nr6siJTs1DHrtizzKOg-dPcvw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 14:43:50.883 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 14:43:50.887 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 14:43:50.887 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 14:43:50.887 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 14:43:52.732 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 14:43:52.733 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 14:43:52.733 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 14:43:52.733 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 14:43:52.733 +08:00 [DBG] Start authorize request
2019-05-30 14:43:52.735 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 14:43:52.735 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 14:43:52.736 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****azxQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVME:00000001","TimeStamp":"2019-05-30T06:43:52.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 14:43:52.736 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtMo5jJA0GU9M58XLehFxWaV4Bdm16rKwBOjUXfqoEVE6KxVWUwJfCyy7v9BBM_pIg7Kpa3fHPR2_Ip_fWBXUu7GEIr2i95PiyyrFYqvTMDrIjWwtIv5VMbEL69P0kM0JzprZSH-ZjEF1NYT6YrMwQyLvrV3kOm5g4TKlbZLYbJMEFfld9TY27jsf5IzGeLAHUTMmxqidVAXjo_IsyZjS08p_NOoZb_PoUqL0XlyEr6rA4ZxQcLuvKpCIyJ6p-sk8Zs7qas2x1w4v4110Ob1Nr6siJTs1DHrtizzKOg-dPcvw","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 14:44:20.366 +08:00 [DBG] mvcImp found in database: true
2019-05-30 14:44:20.366 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 14:44:24.822 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:44:25.074 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:44:25.583 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 14:44:25.959 +08:00 [DBG] Found [] API scopes in database
2019-05-30 14:44:25.987 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 14:44:25.988 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtMo5jJA0GU9M58XLehFxWaV4Bdm16rKwBOjUXfqoEVE6KxVWUwJfCyy7v9BBM_pIg7Kpa3fHPR2_Ip_fWBXUu7GEIr2i95PiyyrFYqvTMDrIjWwtIv5VMbEL69P0kM0JzprZSH-ZjEF1NYT6YrMwQyLvrV3kOm5g4TKlbZLYbJMEFfld9TY27jsf5IzGeLAHUTMmxqidVAXjo_IsyZjS08p_NOoZb_PoUqL0XlyEr6rA4ZxQcLuvKpCIyJ6p-sk8Zs7qas2x1w4v4110Ob1Nr6siJTs1DHrtizzKOg-dPcvw","UiLocales":null,"Nonce":"636947954269573475.YzFlZjQyYjctZTQzZS00ZTFhLTliNTctZWRkOTE1OTdkMzU0ZGVjMzA4ZTgtYjM2MC00NjJmLWJjZDItMzYyNDgzODk5Y2Rh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947954269573475.YzFlZjQyYjctZTQzZS00ZTFhLTliNTctZWRkOTE1OTdkMzU0ZGVjMzA4ZTgtYjM2MC00NjJmLWJjZDItMzYyNDgzODk5Y2Rh","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTtMo5jJA0GU9M58XLehFxWaV4Bdm16rKwBOjUXfqoEVE6KxVWUwJfCyy7v9BBM_pIg7Kpa3fHPR2_Ip_fWBXUu7GEIr2i95PiyyrFYqvTMDrIjWwtIv5VMbEL69P0kM0JzprZSH-ZjEF1NYT6YrMwQyLvrV3kOm5g4TKlbZLYbJMEFfld9TY27jsf5IzGeLAHUTMmxqidVAXjo_IsyZjS08p_NOoZb_PoUqL0XlyEr6rA4ZxQcLuvKpCIyJ6p-sk8Zs7qas2x1w4v4110Ob1Nr6siJTs1DHrtizzKOg-dPcvw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 14:45:15.717 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 14:45:15.747 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 14:45:31.709 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 14:45:31.711 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 14:45:39.603 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 14:45:39.674 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****DSoQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVMF:00000001","TimeStamp":"2019-05-30T06:45:39.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 14:45:39.692 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtMo5jJA0GU9M58XLehFxWaV4Bdm16rKwBOjUXfqoEVE6KxVWUwJfCyy7v9BBM_pIg7Kpa3fHPR2_Ip_fWBXUu7GEIr2i95PiyyrFYqvTMDrIjWwtIv5VMbEL69P0kM0JzprZSH-ZjEF1NYT6YrMwQyLvrV3kOm5g4TKlbZLYbJMEFfld9TY27jsf5IzGeLAHUTMmxqidVAXjo_IsyZjS08p_NOoZb_PoUqL0XlyEr6rA4ZxQcLuvKpCIyJ6p-sk8Zs7qas2x1w4v4110Ob1Nr6siJTs1DHrtizzKOg-dPcvw","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 15:14:52.402 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 15:14:52.402 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 15:14:52.403 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 15:14:52.403 +08:00 [DBG] Start authorize request
2019-05-30 15:14:52.403 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 15:14:52.403 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 15:14:53.402 +08:00 [DBG] mvcImp found in database: true
2019-05-30 15:14:53.402 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 15:14:53.592 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:14:53.716 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:14:53.916 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:14:54.038 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:14:54.038 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 15:14:54.038 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtRwid5KBmoqRnUe_gFTSQqvwJvXdg7XYLtxR6W4C0n_-oRLF23gkIJyfJf78UDIZjxh5sIAjTVnG4SrtjTrsZCOy_M8Y8i7a65tgwtzXEpUaVffmD61fFh5MIi6LhjmPj2bowOJSpmtq7KS03Js5Nrw7jEBouFVo8thzHuFxZsI7pdTZdn5LkCDv_Dr1MBKAbTQoxw24ohhmE6VXQGaRXFPFuoSunMH3Ze_dOm-R2wqwADCW3Kuu8zflL2OCr5cfuj5kh_R8S6MIdV-TxUFQSrVMy3T9MN12ezbS83xheo0Q","UiLocales":null,"Nonce":"636947972914318653.ZTQxOGFkMzYtODU3YS00ZDk1LTg1YTktYmRmYjQ1MmFmY2UzNGQ2M2UwMzYtZWUwZi00YTlkLTk3NDEtZjRmNzQ0YmRhN2M3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947972914318653.ZTQxOGFkMzYtODU3YS00ZDk1LTg1YTktYmRmYjQ1MmFmY2UzNGQ2M2UwMzYtZWUwZi00YTlkLTk3NDEtZjRmNzQ0YmRhN2M3","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTtRwid5KBmoqRnUe_gFTSQqvwJvXdg7XYLtxR6W4C0n_-oRLF23gkIJyfJf78UDIZjxh5sIAjTVnG4SrtjTrsZCOy_M8Y8i7a65tgwtzXEpUaVffmD61fFh5MIi6LhjmPj2bowOJSpmtq7KS03Js5Nrw7jEBouFVo8thzHuFxZsI7pdTZdn5LkCDv_Dr1MBKAbTQoxw24ohhmE6VXQGaRXFPFuoSunMH3Ze_dOm-R2wqwADCW3Kuu8zflL2OCr5cfuj5kh_R8S6MIdV-TxUFQSrVMy3T9MN12ezbS83xheo0Q","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 15:14:56.584 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 15:14:56.588 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 15:14:56.588 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 15:14:56.588 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 15:15:04.871 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 15:15:04.887 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****Y-hA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVMF:00000002","TimeStamp":"2019-05-30T07:15:04.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 15:15:04.887 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtRwid5KBmoqRnUe_gFTSQqvwJvXdg7XYLtxR6W4C0n_-oRLF23gkIJyfJf78UDIZjxh5sIAjTVnG4SrtjTrsZCOy_M8Y8i7a65tgwtzXEpUaVffmD61fFh5MIi6LhjmPj2bowOJSpmtq7KS03Js5Nrw7jEBouFVo8thzHuFxZsI7pdTZdn5LkCDv_Dr1MBKAbTQoxw24ohhmE6VXQGaRXFPFuoSunMH3Ze_dOm-R2wqwADCW3Kuu8zflL2OCr5cfuj5kh_R8S6MIdV-TxUFQSrVMy3T9MN12ezbS83xheo0Q","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 15:15:48.185 +08:00 [ERR] An error occurred using the connection to database 'IndentityCenter' on server '129.204.217.190'.
MySql.Data.MySqlClient.MySqlException (0x80004005): Connect Timeout expired. ---> System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at MySqlConnector.Core.ServerSession.TryResetConnectionAsync(ConnectionSettings cs, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 398
   at MySqlConnector.Core.ConnectionPool.GetSessionAsync(MySqlConnection connection, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ConnectionPool.cs:line 72
   at MySqlConnector.Core.ConnectionPool.GetSessionAsync(MySqlConnection connection, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ConnectionPool.cs:line 141
   at MySql.Data.MySqlClient.MySqlConnection.CreateSessionAsync(Nullable`1 ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlConnection.cs:line 431
   at MySql.Data.MySqlClient.MySqlConnection.CreateSessionAsync(Nullable`1 ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlConnection.cs:line 447
   at MySql.Data.MySqlClient.MySqlConnection.OpenAsync(Nullable`1 ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlConnection.cs:line 175
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
2019-05-30 15:16:14.051 +08:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'IdentityCenter.Data.ApplicationDbContext'.
MySql.Data.MySqlClient.MySqlException (0x80004005): Connect Timeout expired. ---> System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at MySqlConnector.Core.ServerSession.TryResetConnectionAsync(ConnectionSettings cs, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 398
   at MySqlConnector.Core.ConnectionPool.GetSessionAsync(MySqlConnection connection, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ConnectionPool.cs:line 72
   at MySqlConnector.Core.ConnectionPool.GetSessionAsync(MySqlConnection connection, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ConnectionPool.cs:line 141
   at MySql.Data.MySqlClient.MySqlConnection.CreateSessionAsync(Nullable`1 ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlConnection.cs:line 431
   at MySql.Data.MySqlClient.MySqlConnection.CreateSessionAsync(Nullable`1 ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlConnection.cs:line 447
   at MySql.Data.MySqlClient.MySqlConnection.OpenAsync(Nullable`1 ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlConnection.cs:line 175
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
MySql.Data.MySqlClient.MySqlException (0x80004005): Connect Timeout expired. ---> System.Threading.Tasks.TaskCanceledException: A task was canceled.
   at MySqlConnector.Core.ServerSession.TryResetConnectionAsync(ConnectionSettings cs, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 398
   at MySqlConnector.Core.ConnectionPool.GetSessionAsync(MySqlConnection connection, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ConnectionPool.cs:line 72
   at MySqlConnector.Core.ConnectionPool.GetSessionAsync(MySqlConnection connection, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ConnectionPool.cs:line 141
   at MySql.Data.MySqlClient.MySqlConnection.CreateSessionAsync(Nullable`1 ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlConnection.cs:line 431
   at MySql.Data.MySqlClient.MySqlConnection.CreateSessionAsync(Nullable`1 ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlConnection.cs:line 447
   at MySql.Data.MySqlClient.MySqlConnection.OpenAsync(Nullable`1 ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlConnection.cs:line 175
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenDbConnectionAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
2019-05-30 15:16:38.526 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 15:16:38.526 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 15:16:38.526 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 15:16:38.526 +08:00 [DBG] Start authorize request
2019-05-30 15:16:38.527 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 15:16:38.527 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 15:16:40.032 +08:00 [DBG] mvcImp found in database: true
2019-05-30 15:16:40.032 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 15:16:40.216 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:16:40.330 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:16:40.568 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:16:40.681 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:16:40.682 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 15:16:40.682 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtuoFSYn3q9K00nZOWm3Zi0-zdhJHHSgQ_jK9PSYpIdbdQSOsXlBMKHhLz4TRs8xe3NGHey8X-TRFx-RZRiVQJ-cPWTogKMj2AcPNpCn6gKN5yBI5IBTjZ4vr-igkn6HSJejSJIhshxjl5rLJaZTe3DJSZflAeSL-wBX31UvD4JeS0oHj6dBXWqcWbmBGdFJQFTnlCHX7rD39WBkt_x91yJvrVgrPI7rR5PpI9-rwbCCOz9TmmRhyTN_eYQ4S4Gv1Y8TZS9KXx670xlF_949Tjw5A22KzjY1-YbT7shymmKPA","UiLocales":null,"Nonce":"636947973981503330.NjJmNGM2NzgtYTg1Ny00YzkxLWEyMjgtOWNlODY5NWNiZGY2MDlmMDhjN2EtMzFlOS00NmVlLWJmZDQtMzljOWRmMzhlMzRj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947973981503330.NjJmNGM2NzgtYTg1Ny00YzkxLWEyMjgtOWNlODY5NWNiZGY2MDlmMDhjN2EtMzFlOS00NmVlLWJmZDQtMzljOWRmMzhlMzRj","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTtuoFSYn3q9K00nZOWm3Zi0-zdhJHHSgQ_jK9PSYpIdbdQSOsXlBMKHhLz4TRs8xe3NGHey8X-TRFx-RZRiVQJ-cPWTogKMj2AcPNpCn6gKN5yBI5IBTjZ4vr-igkn6HSJejSJIhshxjl5rLJaZTe3DJSZflAeSL-wBX31UvD4JeS0oHj6dBXWqcWbmBGdFJQFTnlCHX7rD39WBkt_x91yJvrVgrPI7rR5PpI9-rwbCCOz9TmmRhyTN_eYQ4S4Gv1Y8TZS9KXx670xlF_949Tjw5A22KzjY1-YbT7shymmKPA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 15:16:43.142 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 15:16:43.145 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 15:16:43.145 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 15:16:43.146 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 15:16:45.011 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 15:16:45.014 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****3h_w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVMG:00000002","TimeStamp":"2019-05-30T07:16:45.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 15:16:45.017 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtuoFSYn3q9K00nZOWm3Zi0-zdhJHHSgQ_jK9PSYpIdbdQSOsXlBMKHhLz4TRs8xe3NGHey8X-TRFx-RZRiVQJ-cPWTogKMj2AcPNpCn6gKN5yBI5IBTjZ4vr-igkn6HSJejSJIhshxjl5rLJaZTe3DJSZflAeSL-wBX31UvD4JeS0oHj6dBXWqcWbmBGdFJQFTnlCHX7rD39WBkt_x91yJvrVgrPI7rR5PpI9-rwbCCOz9TmmRhyTN_eYQ4S4Gv1Y8TZS9KXx670xlF_949Tjw5A22KzjY1-YbT7shymmKPA","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 15:17:22.089 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 15:17:22.090 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 15:17:22.090 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 15:17:22.090 +08:00 [DBG] Start authorize request
2019-05-30 15:17:22.090 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 15:17:22.090 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 15:17:23.276 +08:00 [DBG] mvcImp found in database: true
2019-05-30 15:17:23.276 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 15:17:23.496 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:17:23.619 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:17:23.843 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:17:23.967 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:17:23.968 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 15:17:23.968 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTuXGMQgrrOq3P1In7YTV7_-jl5NB2YxmEMc3AZ7JRZLKwWGmjDOWL13Bkw0ShpdibMrKOeYR4n2dpdg19yR_y4XrZVxIODwvREwpmE_99yEfoQ0ksebmmx16m7pD5zH7SYHk2foEx_qI5V64sx8IT2jOunvXAQudSWgAgEeffVtP93P04lV_meoJ4f-4VNAxwmwTrtTizJ_8jk6R_1FP4KsXpRHIW3KlLNLQdKFTIWZcXuBvQElxqQiA6PEX-hTRumQ8GQEQr3C4Itdd7bSYRA22UTo60dzunqp7LT7as_LDw","UiLocales":null,"Nonce":"636947974420705386.NWY4MWNkOGQtNDljOS00OTRhLWExNzAtODcyZmM1NTI4Yzc5Y2VkM2JkNWEtNzQ3Zi00OGY3LTg5NDEtMGU5ZGRjMDcxNjU5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947974420705386.NWY4MWNkOGQtNDljOS00OTRhLWExNzAtODcyZmM1NTI4Yzc5Y2VkM2JkNWEtNzQ3Zi00OGY3LTg5NDEtMGU5ZGRjMDcxNjU5","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTuXGMQgrrOq3P1In7YTV7_-jl5NB2YxmEMc3AZ7JRZLKwWGmjDOWL13Bkw0ShpdibMrKOeYR4n2dpdg19yR_y4XrZVxIODwvREwpmE_99yEfoQ0ksebmmx16m7pD5zH7SYHk2foEx_qI5V64sx8IT2jOunvXAQudSWgAgEeffVtP93P04lV_meoJ4f-4VNAxwmwTrtTizJ_8jk6R_1FP4KsXpRHIW3KlLNLQdKFTIWZcXuBvQElxqQiA6PEX-hTRumQ8GQEQr3C4Itdd7bSYRA22UTo60dzunqp7LT7as_LDw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 15:17:25.535 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 15:17:25.539 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 15:17:25.539 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 15:17:25.539 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 15:17:26.931 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 15:17:26.934 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****h-GA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVMG:00000003","TimeStamp":"2019-05-30T07:17:26.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 15:17:26.935 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTuXGMQgrrOq3P1In7YTV7_-jl5NB2YxmEMc3AZ7JRZLKwWGmjDOWL13Bkw0ShpdibMrKOeYR4n2dpdg19yR_y4XrZVxIODwvREwpmE_99yEfoQ0ksebmmx16m7pD5zH7SYHk2foEx_qI5V64sx8IT2jOunvXAQudSWgAgEeffVtP93P04lV_meoJ4f-4VNAxwmwTrtTizJ_8jk6R_1FP4KsXpRHIW3KlLNLQdKFTIWZcXuBvQElxqQiA6PEX-hTRumQ8GQEQr3C4Itdd7bSYRA22UTo60dzunqp7LT7as_LDw","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 15:17:47.883 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 15:17:47.883 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 15:17:47.884 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 15:17:47.884 +08:00 [DBG] Start authorize request
2019-05-30 15:17:47.884 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 15:17:47.884 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 15:17:48.875 +08:00 [DBG] mvcImp found in database: true
2019-05-30 15:17:48.875 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 15:17:49.046 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:17:49.148 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:17:49.330 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:17:49.445 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:17:49.445 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 15:17:49.445 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTsg80gYRBreD8VRsM7rI7La_doTTmLNclHggRUrGnYCCd_F4EYULz6KhS17HBU7t1SnIUPv1HuX72aHzgqpIp8bkwkzXVCcYynLnly3EG0LASz6kn-Jy5gz6M3uuzmLBZl4JDaAgfOezHfxPu1kF1SMsm4iFWZk2Ps4BuPEMAMGGqCfEGyc8qEBCuxoksqjUCwFlGk89tQfobPVQwHojWe-eAE1ZpFdeqtornQldg4rDeg5Gf3wCWWF38ir5qoWYaiX700oc0a4xE97rX7FI3qb3bGzmGxqL_Jhr9QA8KtgcQ","UiLocales":null,"Nonce":"636947974648633641.YmQwODE2ODctZjQ2MS00MmMwLWIwMzgtMmFiYTQzNWJjMGQzMDk1ZWQzYWMtYjE0Ni00ODU3LWEyNmUtMDg5MzNhMmVlODc2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947974648633641.YmQwODE2ODctZjQ2MS00MmMwLWIwMzgtMmFiYTQzNWJjMGQzMDk1ZWQzYWMtYjE0Ni00ODU3LWEyNmUtMDg5MzNhMmVlODc2","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTsg80gYRBreD8VRsM7rI7La_doTTmLNclHggRUrGnYCCd_F4EYULz6KhS17HBU7t1SnIUPv1HuX72aHzgqpIp8bkwkzXVCcYynLnly3EG0LASz6kn-Jy5gz6M3uuzmLBZl4JDaAgfOezHfxPu1kF1SMsm4iFWZk2Ps4BuPEMAMGGqCfEGyc8qEBCuxoksqjUCwFlGk89tQfobPVQwHojWe-eAE1ZpFdeqtornQldg4rDeg5Gf3wCWWF38ir5qoWYaiX700oc0a4xE97rX7FI3qb3bGzmGxqL_Jhr9QA8KtgcQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 15:17:51.341 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 15:17:51.345 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 15:17:51.346 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 15:17:51.346 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 15:17:53.332 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 15:17:53.336 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****NLkA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVMH:00000001","TimeStamp":"2019-05-30T07:17:53.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 15:17:53.336 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTsg80gYRBreD8VRsM7rI7La_doTTmLNclHggRUrGnYCCd_F4EYULz6KhS17HBU7t1SnIUPv1HuX72aHzgqpIp8bkwkzXVCcYynLnly3EG0LASz6kn-Jy5gz6M3uuzmLBZl4JDaAgfOezHfxPu1kF1SMsm4iFWZk2Ps4BuPEMAMGGqCfEGyc8qEBCuxoksqjUCwFlGk89tQfobPVQwHojWe-eAE1ZpFdeqtornQldg4rDeg5Gf3wCWWF38ir5qoWYaiX700oc0a4xE97rX7FI3qb3bGzmGxqL_Jhr9QA8KtgcQ","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 15:19:48.553 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 15:19:48.565 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 15:19:48.574 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 15:19:48.575 +08:00 [DBG] Start authorize request
2019-05-30 15:19:48.584 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 15:19:48.591 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 15:19:49.646 +08:00 [DBG] mvcImp found in database: true
2019-05-30 15:19:49.646 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 15:19:49.851 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:19:49.965 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:19:50.148 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:19:50.262 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:19:50.262 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 15:19:50.262 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTstHT9HFTVhH-3-PxQxEgMq6bqgXU3YLTTAOoZXcrYOhc8M_Jh_BPDfYGsWxY49OdovBO_z_yIDuetLuMPB_8VxTNZF9AcT4RUkHF5ixP1-YXxGPKpRkDal05ahliyLWjPi3kyK1vgWl5_BNEgHKm8XRo6ZVJJ4sdQYwadN5-7xF48X2JNvd8MZ71TYDtXF7Z3QJPhPxzfHFW31uuWASN_AGWlUZga7NhZ77-Jo5bwD936QjpppsdeH2Bv6oCOL4gz7UALsgTrS_Npebk5mJsaleetG4eiE0QZVSpAcCDKJrw","UiLocales":null,"Nonce":"636947975884530552.YWRiNmUzZDQtMzcwYS00YmVmLWIxNWItMjVjY2QwODI5NTg3NzMzYTdlODktMGY4MC00YjgwLWE3YzgtMmZkMzM0NjE2NWZk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947975884530552.YWRiNmUzZDQtMzcwYS00YmVmLWIxNWItMjVjY2QwODI5NTg3NzMzYTdlODktMGY4MC00YjgwLWE3YzgtMmZkMzM0NjE2NWZk","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTstHT9HFTVhH-3-PxQxEgMq6bqgXU3YLTTAOoZXcrYOhc8M_Jh_BPDfYGsWxY49OdovBO_z_yIDuetLuMPB_8VxTNZF9AcT4RUkHF5ixP1-YXxGPKpRkDal05ahliyLWjPi3kyK1vgWl5_BNEgHKm8XRo6ZVJJ4sdQYwadN5-7xF48X2JNvd8MZ71TYDtXF7Z3QJPhPxzfHFW31uuWASN_AGWlUZga7NhZ77-Jo5bwD936QjpppsdeH2Bv6oCOL4gz7UALsgTrS_Npebk5mJsaleetG4eiE0QZVSpAcCDKJrw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 15:19:53.751 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 15:19:53.755 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 15:19:53.755 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 15:19:53.755 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 15:19:55.446 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 15:19:55.450 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****fWwg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVMH:00000002","TimeStamp":"2019-05-30T07:19:55.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 15:19:55.450 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTstHT9HFTVhH-3-PxQxEgMq6bqgXU3YLTTAOoZXcrYOhc8M_Jh_BPDfYGsWxY49OdovBO_z_yIDuetLuMPB_8VxTNZF9AcT4RUkHF5ixP1-YXxGPKpRkDal05ahliyLWjPi3kyK1vgWl5_BNEgHKm8XRo6ZVJJ4sdQYwadN5-7xF48X2JNvd8MZ71TYDtXF7Z3QJPhPxzfHFW31uuWASN_AGWlUZga7NhZ77-Jo5bwD936QjpppsdeH2Bv6oCOL4gz7UALsgTrS_Npebk5mJsaleetG4eiE0QZVSpAcCDKJrw","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 15:20:38.670 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 15:20:38.672 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 15:20:38.672 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 15:20:38.673 +08:00 [DBG] Start authorize request
2019-05-30 15:20:38.673 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 15:20:38.675 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 15:20:39.802 +08:00 [DBG] mvcImp found in database: true
2019-05-30 15:20:39.802 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 15:20:40.012 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:20:40.123 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:20:40.317 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:20:40.420 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:20:40.420 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 15:20:40.421 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTvzsSsLCY8tE3x5A0-gYp05l1NmbDEyqM78NGePYD3j7gZm-t_4ZOVgRHT2Gs785tja20HBoJtZ2HjfpHcWLrE9fM_DbfFOdztIcRlZTbbigSP3QKV0VJR4hSuo10KJ5Q-sYqDRgz4-e1U7Z7C4sRKsuzxaYi22abw1nOCcmSsV9kozwZ60LoulCkgtTFoT4Wc8fbPylqcnVK8hVF98uh7AYQk1RFm7d94G8v-Ao3UknsSO-lc0yOrijvXztTvfUCh0lj8GR1AnaiqjPobT7VY8QOG0pYwTEpiW2mLIRWbm5Q","UiLocales":null,"Nonce":"636947976386541184.MjZjYzRhMDUtNjNkMC00M2RlLTkyNmUtNTJiNjk5OTdkZDFmNTY1YjdmNDMtMzZkNi00NzVkLTk3OWQtYjZkMzg3MzA2OGU1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947976386541184.MjZjYzRhMDUtNjNkMC00M2RlLTkyNmUtNTJiNjk5OTdkZDFmNTY1YjdmNDMtMzZkNi00NzVkLTk3OWQtYjZkMzg3MzA2OGU1","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTvzsSsLCY8tE3x5A0-gYp05l1NmbDEyqM78NGePYD3j7gZm-t_4ZOVgRHT2Gs785tja20HBoJtZ2HjfpHcWLrE9fM_DbfFOdztIcRlZTbbigSP3QKV0VJR4hSuo10KJ5Q-sYqDRgz4-e1U7Z7C4sRKsuzxaYi22abw1nOCcmSsV9kozwZ60LoulCkgtTFoT4Wc8fbPylqcnVK8hVF98uh7AYQk1RFm7d94G8v-Ao3UknsSO-lc0yOrijvXztTvfUCh0lj8GR1AnaiqjPobT7VY8QOG0pYwTEpiW2mLIRWbm5Q","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 15:20:46.500 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 15:20:47.877 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 15:20:47.877 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 15:20:47.877 +08:00 [DBG] Start authorize request
2019-05-30 15:20:47.878 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 15:20:47.878 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 15:20:48.112 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 15:20:48.116 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 15:20:48.116 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 15:20:48.116 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 15:20:55.470 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 15:20:55.475 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****uZcg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVMH:00000003","TimeStamp":"2019-05-30T07:20:55.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 15:20:55.475 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTvzsSsLCY8tE3x5A0-gYp05l1NmbDEyqM78NGePYD3j7gZm-t_4ZOVgRHT2Gs785tja20HBoJtZ2HjfpHcWLrE9fM_DbfFOdztIcRlZTbbigSP3QKV0VJR4hSuo10KJ5Q-sYqDRgz4-e1U7Z7C4sRKsuzxaYi22abw1nOCcmSsV9kozwZ60LoulCkgtTFoT4Wc8fbPylqcnVK8hVF98uh7AYQk1RFm7d94G8v-Ao3UknsSO-lc0yOrijvXztTvfUCh0lj8GR1AnaiqjPobT7VY8QOG0pYwTEpiW2mLIRWbm5Q","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 15:21:02.888 +08:00 [DBG] mvcImp found in database: true
2019-05-30 15:21:02.888 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 15:21:03.073 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:21:03.176 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:21:03.348 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:21:03.451 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:21:03.451 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 15:21:03.452 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTvzsSsLCY8tE3x5A0-gYp05l1NmbDEyqM78NGePYD3j7gZm-t_4ZOVgRHT2Gs785tja20HBoJtZ2HjfpHcWLrE9fM_DbfFOdztIcRlZTbbigSP3QKV0VJR4hSuo10KJ5Q-sYqDRgz4-e1U7Z7C4sRKsuzxaYi22abw1nOCcmSsV9kozwZ60LoulCkgtTFoT4Wc8fbPylqcnVK8hVF98uh7AYQk1RFm7d94G8v-Ao3UknsSO-lc0yOrijvXztTvfUCh0lj8GR1AnaiqjPobT7VY8QOG0pYwTEpiW2mLIRWbm5Q","UiLocales":null,"Nonce":"636947976386541184.MjZjYzRhMDUtNjNkMC00M2RlLTkyNmUtNTJiNjk5OTdkZDFmNTY1YjdmNDMtMzZkNi00NzVkLTk3OWQtYjZkMzg3MzA2OGU1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947976386541184.MjZjYzRhMDUtNjNkMC00M2RlLTkyNmUtNTJiNjk5OTdkZDFmNTY1YjdmNDMtMzZkNi00NzVkLTk3OWQtYjZkMzg3MzA2OGU1","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTvzsSsLCY8tE3x5A0-gYp05l1NmbDEyqM78NGePYD3j7gZm-t_4ZOVgRHT2Gs785tja20HBoJtZ2HjfpHcWLrE9fM_DbfFOdztIcRlZTbbigSP3QKV0VJR4hSuo10KJ5Q-sYqDRgz4-e1U7Z7C4sRKsuzxaYi22abw1nOCcmSsV9kozwZ60LoulCkgtTFoT4Wc8fbPylqcnVK8hVF98uh7AYQk1RFm7d94G8v-Ao3UknsSO-lc0yOrijvXztTvfUCh0lj8GR1AnaiqjPobT7VY8QOG0pYwTEpiW2mLIRWbm5Q","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 15:21:09.416 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 15:21:09.420 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 15:21:09.420 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 15:21:09.420 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 15:21:11.308 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 15:21:11.314 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****6F0A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVMI:00000001","TimeStamp":"2019-05-30T07:21:11.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 15:21:11.315 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTvzsSsLCY8tE3x5A0-gYp05l1NmbDEyqM78NGePYD3j7gZm-t_4ZOVgRHT2Gs785tja20HBoJtZ2HjfpHcWLrE9fM_DbfFOdztIcRlZTbbigSP3QKV0VJR4hSuo10KJ5Q-sYqDRgz4-e1U7Z7C4sRKsuzxaYi22abw1nOCcmSsV9kozwZ60LoulCkgtTFoT4Wc8fbPylqcnVK8hVF98uh7AYQk1RFm7d94G8v-Ao3UknsSO-lc0yOrijvXztTvfUCh0lj8GR1AnaiqjPobT7VY8QOG0pYwTEpiW2mLIRWbm5Q","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 15:21:36.878 +08:00 [INF] {"Details":"System.NullReferenceException: Object reference not set to an instance of an object.\r\n   at IdentityServer4.Services.DefaultUserSession.AddClientIdAsync(String clientId) in C:\\local\\identity\\server4\\IdentityServer4\\src\\Services\\Default\\DefaultUserSession.cs:line 259\r\n   at IdentityServer4.Endpoints.Results.AuthorizeResult.ProcessResponseAsync(HttpContext context) in C:\\local\\identity\\server4\\IdentityServer4\\src\\Endpoints\\Results\\AuthorizeResult.cs:line 101\r\n   at IdentityServer4.Endpoints.Results.AuthorizeResult.ExecuteAsync(HttpContext context) in C:\\local\\identity\\server4\\IdentityServer4\\src\\Endpoints\\Results\\AuthorizeResult.cs:line 68\r\n   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\\local\\identity\\server4\\IdentityServer4\\src\\Hosting\\IdentityServerMiddleware.cs:line 59","Category":"Error","Name":"Unhandled Exception","EventType":"Error","Id":3000,"Message":"Object reference not set to an instance of an object.","ActivityId":"0HLN4P4TTNVMI:00000001","TimeStamp":"2019-05-30T07:21:36.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"UnhandledExceptionEvent"}
2019-05-30 15:21:36.879 +08:00 [FTL] Unhandled exception: Object reference not set to an instance of an object.
System.NullReferenceException: Object reference not set to an instance of an object.
   at IdentityServer4.Services.DefaultUserSession.AddClientIdAsync(String clientId) in C:\local\identity\server4\IdentityServer4\src\Services\Default\DefaultUserSession.cs:line 259
   at IdentityServer4.Endpoints.Results.AuthorizeResult.ProcessResponseAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Endpoints\Results\AuthorizeResult.cs:line 101
   at IdentityServer4.Endpoints.Results.AuthorizeResult.ExecuteAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Endpoints\Results\AuthorizeResult.cs:line 68
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 59
2019-05-30 15:21:37.745 +08:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at IdentityServer4.Services.DefaultUserSession.AddClientIdAsync(String clientId) in C:\local\identity\server4\IdentityServer4\src\Services\Default\DefaultUserSession.cs:line 259
   at IdentityServer4.Endpoints.Results.AuthorizeResult.ProcessResponseAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Endpoints\Results\AuthorizeResult.cs:line 101
   at IdentityServer4.Endpoints.Results.AuthorizeResult.ExecuteAsync(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Endpoints\Results\AuthorizeResult.cs:line 68
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 59
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 69
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-05-30 15:21:46.826 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 15:21:46.829 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 15:21:46.829 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 15:21:46.829 +08:00 [DBG] Start authorize request
2019-05-30 15:21:46.829 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 15:21:46.829 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 15:21:47.861 +08:00 [DBG] mvcImp found in database: true
2019-05-30 15:21:47.861 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 15:21:48.041 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:21:48.153 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:21:48.328 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:21:48.443 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:21:48.443 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 15:21:48.443 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtCXdZ_dnGayV426XJK2sLtGlfrG4TtB72qgRG42oph3Y6t8oLMTZJh01xPP-MYK8tm8pTc-scywXowFJhQiZ1HfFUQP_3K-u5Sc2_bclVTZGxjpTYlw-QMiSKNzetppwOuzlDJnqvl1boug93ugl4EEx7Z2qu427YR2GqhxX7XifxOLjRDgRaSrvGOV7e2aiLR2Z_289PDxC2qPX-_qhGEsivE6H8XRVc22hjQFIJOSjHi03p_GxFiB_swVbEJO6LqkaSsrMacpGNOl-EtXgshyYmrtEHfDDOrivhrUiK38Q","UiLocales":null,"Nonce":"636947977068171881.YWJlN2E5ZDgtMDk1Yi00NTM4LTk5MzItZGI3ZjhiN2NkMWZkNWFkNDY2NmQtNzAwZC00OTEzLThhMzYtZmIwNjM0NWIwZWIw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947977068171881.YWJlN2E5ZDgtMDk1Yi00NTM4LTk5MzItZGI3ZjhiN2NkMWZkNWFkNDY2NmQtNzAwZC00OTEzLThhMzYtZmIwNjM0NWIwZWIw","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTtCXdZ_dnGayV426XJK2sLtGlfrG4TtB72qgRG42oph3Y6t8oLMTZJh01xPP-MYK8tm8pTc-scywXowFJhQiZ1HfFUQP_3K-u5Sc2_bclVTZGxjpTYlw-QMiSKNzetppwOuzlDJnqvl1boug93ugl4EEx7Z2qu427YR2GqhxX7XifxOLjRDgRaSrvGOV7e2aiLR2Z_289PDxC2qPX-_qhGEsivE6H8XRVc22hjQFIJOSjHi03p_GxFiB_swVbEJO6LqkaSsrMacpGNOl-EtXgshyYmrtEHfDDOrivhrUiK38Q","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 15:21:51.191 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 15:21:51.195 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 15:21:51.195 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 15:21:51.196 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 15:21:53.128 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 15:21:53.132 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****UTng","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVMI:00000002","TimeStamp":"2019-05-30T07:21:53.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 15:21:53.132 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtCXdZ_dnGayV426XJK2sLtGlfrG4TtB72qgRG42oph3Y6t8oLMTZJh01xPP-MYK8tm8pTc-scywXowFJhQiZ1HfFUQP_3K-u5Sc2_bclVTZGxjpTYlw-QMiSKNzetppwOuzlDJnqvl1boug93ugl4EEx7Z2qu427YR2GqhxX7XifxOLjRDgRaSrvGOV7e2aiLR2Z_289PDxC2qPX-_qhGEsivE6H8XRVc22hjQFIJOSjHi03p_GxFiB_swVbEJO6LqkaSsrMacpGNOl-EtXgshyYmrtEHfDDOrivhrUiK38Q","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 15:22:49.439 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 15:22:49.440 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 15:22:49.440 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 15:22:49.440 +08:00 [DBG] Start authorize request
2019-05-30 15:22:49.440 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 15:22:49.440 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 15:22:50.504 +08:00 [DBG] mvcImp found in database: true
2019-05-30 15:22:50.505 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 15:22:50.732 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:22:50.844 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:22:51.048 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:22:51.152 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:22:51.152 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 15:22:51.152 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtrE0g0ApmqSNH1GCtkma8ncsH7jO48wN9CHd-ThSnn8q7H6Lp4wKrP04aOyBYDKdBlvUkTgHWw3Iyx71F1fMDgl6jnPHFQKvwdBkqYDgaYeFXX6RT9TPA-erxoGtbhe2DhohmhucDLfyB9u95ID5b2h-WfF0oXaDj8nzgQxudblVo5F7job9RH0dom32SHpLoYqwRH6i3hCta6y67z9dSWpCjayYiKS4m1moX92N0mX7dChVcja44er9yVUSCCBE6KZ4mUx-uiTy8FH53WjdzE6PgqSIm38yG8rBFfdTn1Gg","UiLocales":null,"Nonce":"636947977694293205.Nzc0OTJjNmItOWIxYy00NmUyLTkwNGUtOGYxM2Y4MjgyNTI2YWYyZDI0OTUtMmNmZC00MjBjLWFlMTQtOTU0ZWFkNzcyMGI1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947977694293205.Nzc0OTJjNmItOWIxYy00NmUyLTkwNGUtOGYxM2Y4MjgyNTI2YWYyZDI0OTUtMmNmZC00MjBjLWFlMTQtOTU0ZWFkNzcyMGI1","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTtrE0g0ApmqSNH1GCtkma8ncsH7jO48wN9CHd-ThSnn8q7H6Lp4wKrP04aOyBYDKdBlvUkTgHWw3Iyx71F1fMDgl6jnPHFQKvwdBkqYDgaYeFXX6RT9TPA-erxoGtbhe2DhohmhucDLfyB9u95ID5b2h-WfF0oXaDj8nzgQxudblVo5F7job9RH0dom32SHpLoYqwRH6i3hCta6y67z9dSWpCjayYiKS4m1moX92N0mX7dChVcja44er9yVUSCCBE6KZ4mUx-uiTy8FH53WjdzE6PgqSIm38yG8rBFfdTn1Gg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 15:22:54.448 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 15:22:54.451 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 15:22:54.452 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 15:22:54.452 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 15:22:55.340 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 15:22:55.344 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****U9UA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVMI:00000003","TimeStamp":"2019-05-30T07:22:55.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 15:22:55.345 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtrE0g0ApmqSNH1GCtkma8ncsH7jO48wN9CHd-ThSnn8q7H6Lp4wKrP04aOyBYDKdBlvUkTgHWw3Iyx71F1fMDgl6jnPHFQKvwdBkqYDgaYeFXX6RT9TPA-erxoGtbhe2DhohmhucDLfyB9u95ID5b2h-WfF0oXaDj8nzgQxudblVo5F7job9RH0dom32SHpLoYqwRH6i3hCta6y67z9dSWpCjayYiKS4m1moX92N0mX7dChVcja44er9yVUSCCBE6KZ4mUx-uiTy8FH53WjdzE6PgqSIm38yG8rBFfdTn1Gg","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 15:23:40.022 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 15:23:40.022 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 15:23:40.023 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 15:23:40.023 +08:00 [DBG] Start authorize request
2019-05-30 15:23:40.024 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 15:23:40.024 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 15:23:41.090 +08:00 [DBG] mvcImp found in database: true
2019-05-30 15:23:41.090 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 15:23:41.285 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:23:41.399 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:23:41.607 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 15:23:41.719 +08:00 [DBG] Found [] API scopes in database
2019-05-30 15:23:41.719 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 15:23:41.719 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTspLMZ-48IHhue_n39sNIwUaEMUWKtn52c2ZYlvaYwdhNXRntzlxY-C3qM62FjedNRIWWxoTojc5IJKm1c7UTyQ9F7tsde8V7JPWrYiH90CBLr3IRy5MrA6ZEPZgkeJnV6ZVgpAT586keuw1ptZpKOeI8ynD9IE1WzcaTlcQm2xWtfONieLnDwvC7VagrTtKQZteXnii8AL-6tbYdZoA9Z158mmjliQXW3R6Vzc9l4wmjLm4gGsIhI51IN6XQ9_YiLgCS-fsFiznAdSjH62A5l8ERel46U50Bos6gCv8W1TGw","UiLocales":null,"Nonce":"636947978200045053.MDdlZmIwYzktN2JmOS00YzQyLTkzYzItN2Q2MmVmMTUwNGQzN2FiZTExNzEtNWE0Yy00ZmUxLWFmYmMtNzU2YjQ1Y2FjNGM1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636947978200045053.MDdlZmIwYzktN2JmOS00YzQyLTkzYzItN2Q2MmVmMTUwNGQzN2FiZTExNzEtNWE0Yy00ZmUxLWFmYmMtNzU2YjQ1Y2FjNGM1","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTspLMZ-48IHhue_n39sNIwUaEMUWKtn52c2ZYlvaYwdhNXRntzlxY-C3qM62FjedNRIWWxoTojc5IJKm1c7UTyQ9F7tsde8V7JPWrYiH90CBLr3IRy5MrA6ZEPZgkeJnV6ZVgpAT586keuw1ptZpKOeI8ynD9IE1WzcaTlcQm2xWtfONieLnDwvC7VagrTtKQZteXnii8AL-6tbYdZoA9Z158mmjliQXW3R6Vzc9l4wmjLm4gGsIhI51IN6XQ9_YiLgCS-fsFiznAdSjH62A5l8ERel46U50Bos6gCv8W1TGw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 15:23:43.640 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 15:23:43.644 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 15:23:43.644 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 15:23:43.644 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 15:23:44.608 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 15:23:44.613 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****b_iA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4P4TTNVMI:00000004","TimeStamp":"2019-05-30T07:23:44.0000000Z","ProcessId":13224,"LocalIpAddress":"127.0.0.1:45618","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 15:23:44.613 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTspLMZ-48IHhue_n39sNIwUaEMUWKtn52c2ZYlvaYwdhNXRntzlxY-C3qM62FjedNRIWWxoTojc5IJKm1c7UTyQ9F7tsde8V7JPWrYiH90CBLr3IRy5MrA6ZEPZgkeJnV6ZVgpAT586keuw1ptZpKOeI8ynD9IE1WzcaTlcQm2xWtfONieLnDwvC7VagrTtKQZteXnii8AL-6tbYdZoA9Z158mmjliQXW3R6Vzc9l4wmjLm4gGsIhI51IN6XQ9_YiLgCS-fsFiznAdSjH62A5l8ERel46U50Bos6gCv8W1TGw","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 15:24:47.453 +08:00 [WRN] Connection processing ended abnormally.
Microsoft.AspNetCore.Connections.ConnectionAbortedException: The connection was aborted
   at System.IO.Pipelines.PipeCompletion.ThrowLatchedException()
   at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)
   at System.IO.Pipelines.Pipe.GetReadAsyncResult()
   at System.IO.Pipelines.Pipe.DefaultPipeReader.GetResult(Int16 token)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequestsAsync[TContext](IHttpApplication`1 application)
2019-05-30 16:21:40.329 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 16:21:40.360 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 16:21:40.360 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 16:21:40.363 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 16:21:40.363 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 16:21:40.364 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 16:21:40.779 +08:00 [DBG] Starting grant removal
2019-05-30 16:21:41.057 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 16:21:41.060 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 16:21:41.060 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 16:21:41.060 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 16:21:41.060 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 16:21:41.060 +08:00 [DBG] Error Url: /home/error
2019-05-30 16:21:41.060 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 16:22:09.861 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 16:22:09.866 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 16:22:09.866 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 16:22:09.870 +08:00 [DBG] Start discovery request
2019-05-30 16:22:10.947 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 16:22:46.358 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 16:22:46.362 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 16:22:46.363 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 16:22:46.366 +08:00 [DBG] Start key discovery request
2019-05-30 16:22:47.289 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 16:22:47.293 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 16:22:47.293 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 16:22:47.299 +08:00 [DBG] Start authorize request
2019-05-30 16:22:47.312 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 16:22:47.318 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 16:22:48.712 +08:00 [DBG] mvcImp found in database: true
2019-05-30 16:22:48.721 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 16:22:48.986 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 16:22:49.148 +08:00 [DBG] Found [] API scopes in database
2019-05-30 16:22:49.369 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 16:22:49.501 +08:00 [DBG] Found [] API scopes in database
2019-05-30 16:22:49.508 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 16:22:49.523 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtSwzCllJedc7T9HKVABPgUKitrv5zuw18acJce9QM0j6UL55FEUjxg9gwtKuWFbkoETaO4NCxVS6I4GdnIEsq1oQOfYoPqxvHvTW3QwXwoN-30X8SPrdiQckEyi11jwvXgXOgxeQI-CwGT5eRVKMQop7wQnUGhNmNTxu42b2kM3YegdZNLQtXeMsd_0lY7DDkg74UeHH3-FrozM9ONXUfjfYf5kG9vGcG-gqJdvCG8ibtFtKOGbRqVQKq0V6X5iuZecxZy7brOgthcJ43u_KewqzuU_bVF8wem-P0tnA-Zyg","UiLocales":null,"Nonce":"636948013672125853.MDUwODM4YWItM2U3NS00Mzc5LThkMTYtYzA0MmZmOWFiZGE1MWQ5ZDgzMWEtN2Y3MS00OWZiLWE3MjUtNmUzMWQyZTdiZDBm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636948013672125853.MDUwODM4YWItM2U3NS00Mzc5LThkMTYtYzA0MmZmOWFiZGE1MWQ5ZDgzMWEtN2Y3MS00OWZiLWE3MjUtNmUzMWQyZTdiZDBm","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTtSwzCllJedc7T9HKVABPgUKitrv5zuw18acJce9QM0j6UL55FEUjxg9gwtKuWFbkoETaO4NCxVS6I4GdnIEsq1oQOfYoPqxvHvTW3QwXwoN-30X8SPrdiQckEyi11jwvXgXOgxeQI-CwGT5eRVKMQop7wQnUGhNmNTxu42b2kM3YegdZNLQtXeMsd_0lY7DDkg74UeHH3-FrozM9ONXUfjfYf5kG9vGcG-gqJdvCG8ibtFtKOGbRqVQKq0V6X5iuZecxZy7brOgthcJ43u_KewqzuU_bVF8wem-P0tnA-Zyg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 16:22:51.811 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 16:22:51.817 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 16:22:51.824 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 16:22:51.834 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 16:22:53.942 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 16:22:54.058 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****m2kg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4QVBS931E:00000004","TimeStamp":"2019-05-30T08:22:54.0000000Z","ProcessId":27560,"LocalIpAddress":"127.0.0.1:44904","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 16:22:54.060 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTtSwzCllJedc7T9HKVABPgUKitrv5zuw18acJce9QM0j6UL55FEUjxg9gwtKuWFbkoETaO4NCxVS6I4GdnIEsq1oQOfYoPqxvHvTW3QwXwoN-30X8SPrdiQckEyi11jwvXgXOgxeQI-CwGT5eRVKMQop7wQnUGhNmNTxu42b2kM3YegdZNLQtXeMsd_0lY7DDkg74UeHH3-FrozM9ONXUfjfYf5kG9vGcG-gqJdvCG8ibtFtKOGbRqVQKq0V6X5iuZecxZy7brOgthcJ43u_KewqzuU_bVF8wem-P0tnA-Zyg","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 16:44:10.145 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 16:44:10.146 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 16:44:10.146 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 16:44:10.146 +08:00 [DBG] Start discovery request
2019-05-30 16:44:11.086 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 16:44:15.566 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 16:44:15.566 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 16:44:15.566 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 16:44:15.567 +08:00 [DBG] Start key discovery request
2019-05-30 16:44:15.664 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 16:44:15.664 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 16:44:15.664 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 16:44:15.664 +08:00 [DBG] Start authorize request
2019-05-30 16:44:15.665 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 16:44:15.665 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 16:44:16.910 +08:00 [DBG] mvcImp found in database: true
2019-05-30 16:44:16.910 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-30 16:44:17.132 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 16:44:17.265 +08:00 [DBG] Found [] API scopes in database
2019-05-30 16:44:17.488 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 16:44:17.622 +08:00 [DBG] Found [] API scopes in database
2019-05-30 16:44:17.622 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 16:44:17.622 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTvy1VH_9HdFN7VHzUMwNvgiDjsq-M3Q5aDNMkt9HqayixIrTAc81vTWqrwjPAJXaMdr8sQk9uMvrUMrvZtw9EvAzFwN0-UPciSX3BMXzjm7YtIHa4N4pj-8uPwVCjiUbmXe_d1CEBSXsX2Nqg67tfIrFyvUnXu-dclvciHkbh6Q9c70ufdI8rq0lFa357iRuVeIHv67IXMyjM4OThsp4kNJoZ7cZcNqq59hxBoo3FQLWvDlnXcPO7S-4dx5p8fV3rGpDP6v9DwgDHRxLHVrIDcYi7xAt8-ZVizh8BOJc7e2UWjabHP9q-0O6rr139acEUQ","UiLocales":null,"Nonce":"636948026556313549.MWIwNDVmNjItMzJiMC00MGU0LWJhOTItYjJjOWUxNmRiNDY0ZDA0NDZmMjEtYjUxZi00NzYwLTgyNzMtMDE5ZDJmMzRjYjRi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d2cc5d1c1ed7eea8580a1fc3647d93b5","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636948026556313549.MWIwNDVmNjItMzJiMC00MGU0LWJhOTItYjJjOWUxNmRiNDY0ZDA0NDZmMjEtYjUxZi00NzYwLTgyNzMtMDE5ZDJmMzRjYjRi","state":"CfDJ8J6dQdEYr6RAjUqFr50zuTvy1VH_9HdFN7VHzUMwNvgiDjsq-M3Q5aDNMkt9HqayixIrTAc81vTWqrwjPAJXaMdr8sQk9uMvrUMrvZtw9EvAzFwN0-UPciSX3BMXzjm7YtIHa4N4pj-8uPwVCjiUbmXe_d1CEBSXsX2Nqg67tfIrFyvUnXu-dclvciHkbh6Q9c70ufdI8rq0lFa357iRuVeIHv67IXMyjM4OThsp4kNJoZ7cZcNqq59hxBoo3FQLWvDlnXcPO7S-4dx5p8fV3rGpDP6v9DwgDHRxLHVrIDcYi7xAt8-ZVizh8BOJc7e2UWjabHP9q-0O6rr139acEUQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 16:44:21.332 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-05-30 16:44:21.335 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-05-30 16:44:21.335 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 16:44:21.335 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-05-30 16:44:22.942 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 16:44:22.946 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****T1tg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4QVBS931G:00000003","TimeStamp":"2019-05-30T08:44:22.0000000Z","ProcessId":27560,"LocalIpAddress":"127.0.0.1:44904","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 16:44:22.947 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8J6dQdEYr6RAjUqFr50zuTvy1VH_9HdFN7VHzUMwNvgiDjsq-M3Q5aDNMkt9HqayixIrTAc81vTWqrwjPAJXaMdr8sQk9uMvrUMrvZtw9EvAzFwN0-UPciSX3BMXzjm7YtIHa4N4pj-8uPwVCjiUbmXe_d1CEBSXsX2Nqg67tfIrFyvUnXu-dclvciHkbh6Q9c70ufdI8rq0lFa357iRuVeIHv67IXMyjM4OThsp4kNJoZ7cZcNqq59hxBoo3FQLWvDlnXcPO7S-4dx5p8fV3rGpDP6v9DwgDHRxLHVrIDcYi7xAt8-ZVizh8BOJc7e2UWjabHP9q-0O6rr139acEUQ","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 18:01:32.582 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 18:01:32.611 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 18:01:32.612 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 18:01:32.612 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 18:01:32.612 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 18:01:32.612 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 18:01:33.049 +08:00 [DBG] Starting grant removal
2019-05-30 18:01:33.459 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 18:01:33.461 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 18:01:33.461 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 18:01:33.462 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 18:01:33.462 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 18:01:33.462 +08:00 [DBG] Error Url: /home/error
2019-05-30 18:01:33.462 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 19:01:33.431 +08:00 [INF] Removing 0 grants
2019-05-30 19:49:21.027 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 19:49:21.057 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 19:49:21.057 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 19:49:21.057 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 19:49:21.058 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 19:49:21.058 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 19:49:21.506 +08:00 [DBG] Starting grant removal
2019-05-30 19:49:21.856 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 19:49:21.859 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 19:49:21.860 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 19:49:21.860 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 19:49:21.860 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 19:49:21.860 +08:00 [DBG] Error Url: /home/error
2019-05-30 19:49:21.861 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 19:57:15.201 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 19:57:15.229 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 19:57:15.229 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 19:57:15.229 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 19:57:15.229 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 19:57:15.229 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 19:57:15.418 +08:00 [DBG] Starting grant removal
2019-05-30 20:24:19.399 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 20:24:19.404 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 20:24:19.405 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 20:24:19.405 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 20:24:19.406 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 20:24:19.406 +08:00 [DBG] Error Url: /home/error
2019-05-30 20:24:19.406 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 20:24:19.440 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 20:24:19.449 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 20:24:19.450 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 20:24:19.454 +08:00 [DBG] Start discovery request
2019-05-30 20:24:21.723 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 20:24:21.877 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 20:24:21.878 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 20:24:21.878 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 20:24:21.885 +08:00 [DBG] Start key discovery request
2019-05-30 20:24:22.998 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 20:24:23.003 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 20:24:23.003 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 20:24:23.010 +08:00 [DBG] Start authorize request
2019-05-30 20:24:23.026 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 20:24:23.033 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 20:24:25.211 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:24:25.226 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:24:25.231 +08:00 [DBG] Checking for PKCE parameters
2019-05-30 20:24:25.233 +08:00 [DBG] No PKCE used.
2019-05-30 20:24:25.672 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:24:25.954 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:24:25.959 +08:00 [ERR] Invalid scope: Email
2019-05-30 20:24:25.965 +08:00 [ERR] Request validation failed
2019-05-30 20:24:25.981 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile Email","State":"CfDJ8F85EO-pYlJKvNXwUT18ba5sULIk8n67Z7GOBzD9JnlgLq7MPPVOegf6TQYgHJ_KzvDNftNyhKIb4u16MtTqSdZ37K39ojnA4GqqntR8xHg__wJDMRZCZiuvY7pi3e25XTbWE4QEsjFJhRjfyIAof67UR3m0-l5gP25eTKFXYTeyu5b4_irl9bAHQt0qw0p6CQRwHQ0QFz9wKeSzh7rMVCN4kLRV9bVZ-758GGddd-4R_0amawAfrVKhEp8Ersr5Kx_CZXyF1gkZAOxCLKqmAhjd9EybXPiYa3d8V738TRNOAFxE6vzA-EZ4nFFICW5zXoxaOXFgEtYZpNgjSW0y4l0","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile Email","response_mode":"form_post","nonce":"636948158619183640.MTNmNTBkNjYtNjE4Yi00YzhmLWEzNzMtZTA0OTUzYjc4MTZkMjhiNGZhZWQtYzg0Yy00ZGU4LWI4ZGEtMTlhMzhlZWU3MjBh","state":"CfDJ8F85EO-pYlJKvNXwUT18ba5sULIk8n67Z7GOBzD9JnlgLq7MPPVOegf6TQYgHJ_KzvDNftNyhKIb4u16MtTqSdZ37K39ojnA4GqqntR8xHg__wJDMRZCZiuvY7pi3e25XTbWE4QEsjFJhRjfyIAof67UR3m0-l5gP25eTKFXYTeyu5b4_irl9bAHQt0qw0p6CQRwHQ0QFz9wKeSzh7rMVCN4kLRV9bVZ-758GGddd-4R_0amawAfrVKhEp8Ersr5Kx_CZXyF1gkZAOxCLKqmAhjd9EybXPiYa3d8V738TRNOAFxE6vzA-EZ4nFFICW5zXoxaOXFgEtYZpNgjSW0y4l0","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 20:24:26.000 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile Email","GrantType":"hybrid","Error":"invalid_scope","ErrorDescription":"Invalid scope","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLN4V6UK03LQ:00000001","TimeStamp":"2019-05-30T12:24:25.0000000Z","ProcessId":45234,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-05-30 20:25:15.425 +08:00 [DBG] TaskCanceledException. Exiting.
2019-05-30 20:25:15.472 +08:00 [DBG] Stopping grant removal
2019-05-30 20:25:33.853 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 20:25:33.878 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 20:25:33.878 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 20:25:33.878 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 20:25:33.879 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 20:25:33.879 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 20:25:34.064 +08:00 [DBG] Starting grant removal
2019-05-30 20:25:44.634 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 20:25:44.636 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 20:25:44.636 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 20:25:44.648 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 20:25:44.649 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 20:25:44.649 +08:00 [DBG] Error Url: /home/error
2019-05-30 20:25:44.649 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 20:25:44.699 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 20:25:44.709 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 20:25:44.709 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 20:25:44.714 +08:00 [DBG] Start authorize request
2019-05-30 20:25:44.729 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 20:25:44.737 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 20:25:48.203 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:25:48.213 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:25:48.219 +08:00 [DBG] Checking for PKCE parameters
2019-05-30 20:25:48.221 +08:00 [DBG] No PKCE used.
2019-05-30 20:25:49.251 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:25:49.902 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:25:49.910 +08:00 [ERR] Invalid scope: Email
2019-05-30 20:25:49.913 +08:00 [ERR] Request validation failed
2019-05-30 20:25:49.928 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile Email","State":"CfDJ8F85EO-pYlJKvNXwUT18ba6LX8ef0VB_y0kE8xTLd3lnFoc-qhe8ffG6A6NDkMwHM0QQfVqwwE88K2QMBPQri-vZKO3FN3WfGpF79xvvhtWYymMpE5DqLD8MvF53L2nTTu38ElNb0NL2RIlR-RSQ07cFKQuZX9AUlEp3A1i5jCgSVtZlZpCtkxM2zd7QNsGLpU8i50y2uP4MG6RKt56vC3cMbVfeqWmnVm5yAwHDRpYouTP1tj3_KerBpwe-zEP9MqbGI6GkvBSyoHxXAnUMzK-PLHpSnElkHbDo2Oqr7TPRgKNTplwYgrmexLCyhj1rTZNj3RxYz0C6yg-Ek-JrzIQ","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile Email","response_mode":"form_post","nonce":"636948159445394960.ZjVjMWRjOTgtMTYyMy00NTUwLWE4YTUtYjc5ODFlZDJmZmZhYjAxMTQ1MjgtMmIzNy00MzMxLTkxZTYtZTk0M2U0ZDliZmFk","state":"CfDJ8F85EO-pYlJKvNXwUT18ba6LX8ef0VB_y0kE8xTLd3lnFoc-qhe8ffG6A6NDkMwHM0QQfVqwwE88K2QMBPQri-vZKO3FN3WfGpF79xvvhtWYymMpE5DqLD8MvF53L2nTTu38ElNb0NL2RIlR-RSQ07cFKQuZX9AUlEp3A1i5jCgSVtZlZpCtkxM2zd7QNsGLpU8i50y2uP4MG6RKt56vC3cMbVfeqWmnVm5yAwHDRpYouTP1tj3_KerBpwe-zEP9MqbGI6GkvBSyoHxXAnUMzK-PLHpSnElkHbDo2Oqr7TPRgKNTplwYgrmexLCyhj1rTZNj3RxYz0C6yg-Ek-JrzIQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 20:25:49.943 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile Email","GrantType":"hybrid","Error":"invalid_scope","ErrorDescription":"Invalid scope","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLN4V7MF994F:00000001","TimeStamp":"2019-05-30T12:25:49.0000000Z","ProcessId":45995,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-05-30 20:27:51.111 +08:00 [DBG] TaskCanceledException. Exiting.
2019-05-30 20:27:51.145 +08:00 [DBG] Stopping grant removal
2019-05-30 20:28:06.707 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 20:28:06.737 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 20:28:06.737 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 20:28:06.737 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 20:28:06.737 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 20:28:06.737 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 20:28:06.920 +08:00 [DBG] Starting grant removal
2019-05-30 20:28:27.970 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 20:28:27.972 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 20:28:27.973 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 20:28:27.974 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 20:28:27.974 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 20:28:27.974 +08:00 [DBG] Error Url: /home/error
2019-05-30 20:28:27.974 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 20:28:28.020 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 20:28:28.028 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 20:28:28.028 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 20:28:28.034 +08:00 [DBG] Start authorize request
2019-05-30 20:28:28.051 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 20:28:28.069 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 20:28:33.125 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:28:33.141 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:28:33.146 +08:00 [DBG] Checking for PKCE parameters
2019-05-30 20:28:33.148 +08:00 [DBG] No PKCE used.
2019-05-30 20:28:33.587 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:28:33.950 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:28:33.961 +08:00 [ERR] Invalid scope: Email
2019-05-30 20:28:33.966 +08:00 [ERR] Request validation failed
2019-05-30 20:28:33.978 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile Email","State":"CfDJ8F85EO-pYlJKvNXwUT18ba5jM4BNxBebuEX8OsyrJKj5YhMwCYaAoOhu6xyhnWuvae4SAIiNLT8F5yQust13vvuaBDTHml4YAavoukDUXAoCkD1L7_O-CCDzZ9Erys7Hmw_d7ZMXUhFGXRkU_jIUGTGHLvoW9AGTYkFAP8tEipxMdGL-z3Iy_2cDdhkx8pkV77AG2Ve_vgEFY6LphTQn4N563yLDocFTfqMvt-M6xycvkCXluQ-rwXApJoHLZGrrV-pGZJXE1ND_xmYmLhlY-UbXDNpuMWTO1PGbIGFNjU7lCNEMO1enSNPxgH7YGEcfNf03w-6_rGsrb6KvTwe-mNo","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile Email","response_mode":"form_post","nonce":"636948161078150860.OWRjYWFjOGItYmMwZS00YmMwLWFhMDYtYzkyMmRmMmQ4NzU2ZGI0YjAwZjgtZDMyMy00ODQ0LTkyZGItNThjMWQwODMyYWQ3","state":"CfDJ8F85EO-pYlJKvNXwUT18ba5jM4BNxBebuEX8OsyrJKj5YhMwCYaAoOhu6xyhnWuvae4SAIiNLT8F5yQust13vvuaBDTHml4YAavoukDUXAoCkD1L7_O-CCDzZ9Erys7Hmw_d7ZMXUhFGXRkU_jIUGTGHLvoW9AGTYkFAP8tEipxMdGL-z3Iy_2cDdhkx8pkV77AG2Ve_vgEFY6LphTQn4N563yLDocFTfqMvt-M6xycvkCXluQ-rwXApJoHLZGrrV-pGZJXE1ND_xmYmLhlY-UbXDNpuMWTO1PGbIGFNjU7lCNEMO1enSNPxgH7YGEcfNf03w-6_rGsrb6KvTwe-mNo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 20:28:33.996 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile Email","GrantType":"hybrid","Error":"invalid_scope","ErrorDescription":"Invalid scope","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLN4V98MK033:00000001","TimeStamp":"2019-05-30T12:28:33.0000000Z","ProcessId":46114,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-05-30 20:29:44.171 +08:00 [DBG] TaskCanceledException. Exiting.
2019-05-30 20:29:44.212 +08:00 [DBG] Stopping grant removal
2019-05-30 20:29:59.916 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 20:29:59.952 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 20:29:59.952 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 20:29:59.952 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 20:29:59.952 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 20:29:59.953 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 20:30:00.135 +08:00 [DBG] Starting grant removal
2019-05-30 20:30:23.265 +08:00 [DBG] TaskCanceledException. Exiting.
2019-05-30 20:30:23.320 +08:00 [DBG] Stopping grant removal
2019-05-30 20:30:43.507 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 20:30:43.545 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 20:30:43.545 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 20:30:43.545 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 20:30:43.545 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 20:30:43.546 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 20:30:43.773 +08:00 [DBG] Starting grant removal
2019-05-30 20:30:57.421 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 20:30:57.425 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 20:30:57.426 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 20:30:57.426 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 20:30:57.426 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 20:30:57.427 +08:00 [DBG] Error Url: /home/error
2019-05-30 20:30:57.427 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 20:30:57.456 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 20:30:57.465 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 20:30:57.466 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 20:30:57.469 +08:00 [DBG] Start discovery request
2019-05-30 20:30:59.443 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 20:30:59.573 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 20:30:59.575 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 20:30:59.575 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 20:30:59.580 +08:00 [DBG] Start key discovery request
2019-05-30 20:30:59.671 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 20:30:59.676 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 20:30:59.676 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 20:30:59.680 +08:00 [DBG] Start authorize request
2019-05-30 20:30:59.694 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 20:30:59.699 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 20:31:01.949 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:31:01.957 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:31:01.963 +08:00 [DBG] Checking for PKCE parameters
2019-05-30 20:31:01.965 +08:00 [DBG] No PKCE used.
2019-05-30 20:31:02.364 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:31:02.598 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:31:02.917 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:31:03.103 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:31:03.117 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 20:31:03.131 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile","State":"CfDJ8F85EO-pYlJKvNXwUT18ba4S9WCn7zx8mv-Wi41GKKay4prOI4zOchBIRIyyjRshsg9gu0aeT3kwEWay-_8swPZQ_Tv9iyW6NKCGB9MCfMsCcV7sHv2xsnGEfPPpiPbsVFLGRb2WfbtCOuK4evAkcZYHDWN1K0O_T5AOLPl6UI2PPDKbfdNZL11SSyxQB1he8JX50K9YyLMwRHbbLyiSCoNzIrlrY7t_tkqgLjdL3fAt8a6hdtsThqfYSGvkt9ECB3MLMRI1jx6ZHANMS9g_UAk_0Q_eBxZ9pd0SZZxs3j5TeTbZ07Hxqz7gQ04hRGrvvQBKpj5ALUCa2YdPzuKdMAo","UiLocales":null,"Nonce":"636948162596223740.MWFlZTcxM2YtZjg0YS00YTBmLWJiY2UtN2ExYzM0ZWQ3M2E3MGFlOWI0NmQtNzk4Zi00ZWFiLTlkMGQtMmM4NzhhOWE4ZjYy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8115527021d4937e613b0f1d59ccf9e0","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile","response_mode":"form_post","nonce":"636948162596223740.MWFlZTcxM2YtZjg0YS00YTBmLWJiY2UtN2ExYzM0ZWQ3M2E3MGFlOWI0NmQtNzk4Zi00ZWFiLTlkMGQtMmM4NzhhOWE4ZjYy","state":"CfDJ8F85EO-pYlJKvNXwUT18ba4S9WCn7zx8mv-Wi41GKKay4prOI4zOchBIRIyyjRshsg9gu0aeT3kwEWay-_8swPZQ_Tv9iyW6NKCGB9MCfMsCcV7sHv2xsnGEfPPpiPbsVFLGRb2WfbtCOuK4evAkcZYHDWN1K0O_T5AOLPl6UI2PPDKbfdNZL11SSyxQB1he8JX50K9YyLMwRHbbLyiSCoNzIrlrY7t_tkqgLjdL3fAt8a6hdtsThqfYSGvkt9ECB3MLMRI1jx6ZHANMS9g_UAk_0Q_eBxZ9pd0SZZxs3j5TeTbZ07Hxqz7gQ04hRGrvvQBKpj5ALUCa2YdPzuKdMAo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 20:31:03.752 +08:00 [DBG] FiTLcYGBYEV8OnKEgTs+U+128Zy+PdC+Fm2zjauszrc= found in database: false
2019-05-30 20:31:03.753 +08:00 [DBG] user_consent grant with value: mvcHybrid|af61726e-716b-4170-8c26-6568bf294215 not found in store.
2019-05-30 20:31:03.755 +08:00 [DBG] Found no prior consent from consent store, consent is required
2019-05-30 20:31:03.755 +08:00 [INF] Showing consent: User has not yet consented
2019-05-30 20:31:03.987 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 20:31:05.803 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:31:05.804 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:31:05.805 +08:00 [DBG] Checking for PKCE parameters
2019-05-30 20:31:05.807 +08:00 [DBG] No PKCE used.
2019-05-30 20:31:06.122 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:31:06.308 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:31:06.631 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:31:06.823 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:31:06.824 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 20:31:08.569 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:31:08.570 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:31:08.876 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:31:09.073 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:31:24.785 +08:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-30 20:31:24.839 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 20:31:26.582 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:31:26.583 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:31:26.584 +08:00 [DBG] Checking for PKCE parameters
2019-05-30 20:31:26.585 +08:00 [DBG] No PKCE used.
2019-05-30 20:31:26.922 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:31:27.120 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:31:27.473 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:31:27.672 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:31:27.674 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 20:31:27.694 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcHybrid","RequestedScopes":["openid","profile"],"GrantedScopes":["openid","profile"],"ConsentRemembered":false,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLN4VAJNJGF1:00000004","TimeStamp":"2019-05-30T12:31:27.0000000Z","ProcessId":46241,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-05-30 20:31:29.503 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:31:29.503 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:31:29.517 +08:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-05-30 20:31:29.519 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-05-30 20:31:29.520 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-05-30 20:31:29.526 +08:00 [DBG] Start authorize callback request
2019-05-30 20:31:29.535 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 20:31:29.535 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 20:31:31.342 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:31:31.342 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:31:31.343 +08:00 [DBG] Checking for PKCE parameters
2019-05-30 20:31:31.343 +08:00 [DBG] No PKCE used.
2019-05-30 20:31:31.674 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:31:31.860 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:31:32.195 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:31:32.369 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:31:32.371 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 20:31:32.372 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile","State":"CfDJ8F85EO-pYlJKvNXwUT18ba4S9WCn7zx8mv-Wi41GKKay4prOI4zOchBIRIyyjRshsg9gu0aeT3kwEWay-_8swPZQ_Tv9iyW6NKCGB9MCfMsCcV7sHv2xsnGEfPPpiPbsVFLGRb2WfbtCOuK4evAkcZYHDWN1K0O_T5AOLPl6UI2PPDKbfdNZL11SSyxQB1he8JX50K9YyLMwRHbbLyiSCoNzIrlrY7t_tkqgLjdL3fAt8a6hdtsThqfYSGvkt9ECB3MLMRI1jx6ZHANMS9g_UAk_0Q_eBxZ9pd0SZZxs3j5TeTbZ07Hxqz7gQ04hRGrvvQBKpj5ALUCa2YdPzuKdMAo","UiLocales":null,"Nonce":"636948162596223740.MWFlZTcxM2YtZjg0YS00YTBmLWJiY2UtN2ExYzM0ZWQ3M2E3MGFlOWI0NmQtNzk4Zi00ZWFiLTlkMGQtMmM4NzhhOWE4ZjYy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8115527021d4937e613b0f1d59ccf9e0","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile","response_mode":"form_post","nonce":"636948162596223740.MWFlZTcxM2YtZjg0YS00YTBmLWJiY2UtN2ExYzM0ZWQ3M2E3MGFlOWI0NmQtNzk4Zi00ZWFiLTlkMGQtMmM4NzhhOWE4ZjYy","state":"CfDJ8F85EO-pYlJKvNXwUT18ba4S9WCn7zx8mv-Wi41GKKay4prOI4zOchBIRIyyjRshsg9gu0aeT3kwEWay-_8swPZQ_Tv9iyW6NKCGB9MCfMsCcV7sHv2xsnGEfPPpiPbsVFLGRb2WfbtCOuK4evAkcZYHDWN1K0O_T5AOLPl6UI2PPDKbfdNZL11SSyxQB1he8JX50K9YyLMwRHbbLyiSCoNzIrlrY7t_tkqgLjdL3fAt8a6hdtsThqfYSGvkt9ECB3MLMRI1jx6ZHANMS9g_UAk_0Q_eBxZ9pd0SZZxs3j5TeTbZ07Hxqz7gQ04hRGrvvQBKpj5ALUCa2YdPzuKdMAo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 20:31:32.756 +08:00 [DBG] FiTLcYGBYEV8OnKEgTs+U+128Zy+PdC+Fm2zjauszrc= found in database: false
2019-05-30 20:31:32.756 +08:00 [DBG] user_consent grant with value: mvcHybrid|af61726e-716b-4170-8c26-6568bf294215 not found in store.
2019-05-30 20:31:32.757 +08:00 [DBG] Found no prior consent from consent store, consent is required
2019-05-30 20:31:32.762 +08:00 [INF] User consented to scopes: ["openid","profile"]
2019-05-30 20:31:32.766 +08:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 20:31:32.988 +08:00 [DBG] no FiTLcYGBYEV8OnKEgTs+U+128Zy+PdC+Fm2zjauszrc= persisted grant found in database
2019-05-30 20:31:32.999 +08:00 [DBG] Creating Hybrid Flow response.
2019-05-30 20:31:33.260 +08:00 [DBG] yF2Z1jIHH/HhQV9bJfIey6zdcXvuKHVEjZjxDzqcD1c= not found in database
2019-05-30 20:31:34.305 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 20:31:34.320 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcHybrid
2019-05-30 20:31:34.322 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-05-30 20:31:34.413 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****fjkw","$type":"Token"},{"TokenType":"code","TokenValue":"****328c","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4VAJNJGF1:00000005","TimeStamp":"2019-05-30T12:31:34.0000000Z","ProcessId":46241,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 20:31:34.416 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcHybrid","RedirectUri":"http://localhost:5005/signin-oidc","State":"CfDJ8F85EO-pYlJKvNXwUT18ba4S9WCn7zx8mv-Wi41GKKay4prOI4zOchBIRIyyjRshsg9gu0aeT3kwEWay-_8swPZQ_Tv9iyW6NKCGB9MCfMsCcV7sHv2xsnGEfPPpiPbsVFLGRb2WfbtCOuK4evAkcZYHDWN1K0O_T5AOLPl6UI2PPDKbfdNZL11SSyxQB1he8JX50K9YyLMwRHbbLyiSCoNzIrlrY7t_tkqgLjdL3fAt8a6hdtsThqfYSGvkt9ECB3MLMRI1jx6ZHANMS9g_UAk_0Q_eBxZ9pd0SZZxs3j5TeTbZ07Hxqz7gQ04hRGrvvQBKpj5ALUCa2YdPzuKdMAo","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 20:31:34.443 +08:00 [DBG] Augmenting SignInContext
2019-05-30 20:31:34.456 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-05-30 20:31:34.671 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-30 20:31:34.680 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-30 20:31:34.680 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-30 20:31:34.694 +08:00 [DBG] Start token request.
2019-05-30 20:31:34.702 +08:00 [DBG] Start client validation
2019-05-30 20:31:34.709 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-30 20:31:34.714 +08:00 [DBG] Start parsing for secret in post body
2019-05-30 20:31:34.716 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-30 20:31:34.716 +08:00 [DBG] Secret id found: mvcHybrid
2019-05-30 20:31:38.736 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:31:38.737 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:31:38.751 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-30 20:31:38.752 +08:00 [DBG] Client validation success
2019-05-30 20:31:38.752 +08:00 [INF] {"ClientId":"mvcHybrid","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN4VAJNJGF3:00000003","TimeStamp":"2019-05-30T12:31:38.0000000Z","ProcessId":46241,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-30 20:31:38.762 +08:00 [DBG] Start token request validation
2019-05-30 20:31:38.775 +08:00 [DBG] Start validation of authorization code token request
2019-05-30 20:31:38.978 +08:00 [DBG] yF2Z1jIHH/HhQV9bJfIey6zdcXvuKHVEjZjxDzqcD1c= found in database: true
2019-05-30 20:31:39.164 +08:00 [DBG] removing yF2Z1jIHH/HhQV9bJfIey6zdcXvuKHVEjZjxDzqcD1c= persisted grant from database
2019-05-30 20:31:39.685 +08:00 [DBG] Validation of authorization code token request success
2019-05-30 20:31:39.689 +08:00 [INF] Token request validation success
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"28a465c2ddf4dc623506d452c11de4d765edaf072cec46f3d22d7e6f7e9a328c","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvcHybrid","client_secret":"***REDACTED***","code":"28a465c2ddf4dc623506d452c11de4d765edaf072cec46f3d22d7e6f7e9a328c","grant_type":"authorization_code","redirect_uri":"http://localhost:5005/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-30 20:31:41.423 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:31:41.423 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:31:41.734 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:31:41.912 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:31:41.930 +08:00 [DBG] Getting claims for access token for client: mvcHybrid
2019-05-30 20:31:41.931 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 20:31:41.939 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 20:31:43.628 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:31:43.628 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:31:43.956 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:31:44.139 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:31:44.140 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcHybrid
2019-05-30 20:31:44.140 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-05-30 20:31:44.167 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****MWRg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****z-2A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4VAJNJGF3:00000003","TimeStamp":"2019-05-30T12:31:44.0000000Z","ProcessId":46241,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 20:31:44.170 +08:00 [DBG] Token request success.
2019-05-30 20:31:44.197 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-30 20:31:44.199 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-30 20:31:44.200 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-30 20:31:44.215 +08:00 [DBG] Start userinfo request
2019-05-30 20:31:44.223 +08:00 [DBG] Bearer token found in header
2019-05-30 20:31:46.019 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:31:46.019 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:31:47.707 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:31:47.708 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:31:47.904 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-30 20:31:47.908 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1559219501,"exp":1559219561,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"mvcHybrid","sub":"af61726e-716b-4170-8c26-6568bf294215","auth_time":1559134138,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"shawn","last_name":"wong","card_number":"12123","card_holder":"王曉鋒","card_security_number":"2323","card_expiration":"20/12","address_city":"shanghai","address_country":"中国","address_state":"canials","address_street":"shanghai","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-30 20:31:47.928 +08:00 [DBG] Creating userinfo response
2019-05-30 20:31:47.936 +08:00 [DBG] Scopes in access token: openid profile
2019-05-30 20:31:47.942 +08:00 [DBG] Scopes in access token: openid profile
2019-05-30 20:31:48.249 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:31:48.251 +08:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-05-30 20:31:48.252 +08:00 [DBG] Scopes in access token: openid profile
2019-05-30 20:31:48.567 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:31:48.569 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-05-30 20:31:48.570 +08:00 [DBG] End userinfo request
2019-05-30 20:31:49.007 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 20:31:49.008 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 20:31:49.008 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 20:31:49.009 +08:00 [DBG] Start discovery request
2019-05-30 20:31:50.212 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 20:31:50.473 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 20:31:50.473 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 20:31:50.474 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 20:31:50.474 +08:00 [DBG] Start key discovery request
2019-05-30 20:33:20.453 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 20:33:20.454 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 20:33:20.454 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 20:33:20.454 +08:00 [DBG] Start discovery request
2019-05-30 20:33:21.579 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 20:33:21.663 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 20:33:21.664 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 20:33:21.664 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 20:33:21.665 +08:00 [DBG] Start key discovery request
2019-05-30 20:33:21.727 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 20:33:21.728 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 20:33:21.728 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 20:33:21.728 +08:00 [DBG] Start authorize request
2019-05-30 20:33:21.729 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 20:33:21.729 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 20:33:23.434 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:33:23.435 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:33:23.436 +08:00 [DBG] Checking for PKCE parameters
2019-05-30 20:33:23.436 +08:00 [DBG] No PKCE used.
2019-05-30 20:33:23.761 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:33:23.950 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:33:24.232 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:33:24.419 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:33:24.420 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 20:33:24.420 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile","State":"CfDJ8F85EO-pYlJKvNXwUT18ba5KvVUDrTV8kSVgbzAtOLRTQmB1xH5sAHt5F2Hvcty11gswnLD5lbdyCc4PEQ42O9jv-PvdzL7_YJz4TioDi8y3vW8rcTp30b9yqHFxNp_nA4wHX0qx14tvnlo9nupf_XrvOfOF7Hx1zCTbnmqHIrGxlbMwEYv0K7GcuWa_sjd6xIFRhIg4a_I7PyFCtbXEu6Jv8FfnPZg2wT70dzETjAyjfm_zVUhkM-9QZDBASc8CXgPXoAZtEh3Hk6ZTpxXHFws6dcF9IaEFSsNbLwLjcGUqRDkeB_173IkNbAgOf-Nqxfo9cJjg92AofdRbSuTMws4","UiLocales":null,"Nonce":"636948164016844110.NGZlNTgzNjMtMGI5Ny00NTE5LWJkMTItM2FlMjVlZjUwYzYyMGY3M2UwZTgtYzkzZi00MWI1LWIyOTQtODFiM2JhNmVjYWY0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8115527021d4937e613b0f1d59ccf9e0","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile","response_mode":"form_post","nonce":"636948164016844110.NGZlNTgzNjMtMGI5Ny00NTE5LWJkMTItM2FlMjVlZjUwYzYyMGY3M2UwZTgtYzkzZi00MWI1LWIyOTQtODFiM2JhNmVjYWY0","state":"CfDJ8F85EO-pYlJKvNXwUT18ba5KvVUDrTV8kSVgbzAtOLRTQmB1xH5sAHt5F2Hvcty11gswnLD5lbdyCc4PEQ42O9jv-PvdzL7_YJz4TioDi8y3vW8rcTp30b9yqHFxNp_nA4wHX0qx14tvnlo9nupf_XrvOfOF7Hx1zCTbnmqHIrGxlbMwEYv0K7GcuWa_sjd6xIFRhIg4a_I7PyFCtbXEu6Jv8FfnPZg2wT70dzETjAyjfm_zVUhkM-9QZDBASc8CXgPXoAZtEh3Hk6ZTpxXHFws6dcF9IaEFSsNbLwLjcGUqRDkeB_173IkNbAgOf-Nqxfo9cJjg92AofdRbSuTMws4","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 20:33:24.807 +08:00 [DBG] FiTLcYGBYEV8OnKEgTs+U+128Zy+PdC+Fm2zjauszrc= found in database: false
2019-05-30 20:33:24.807 +08:00 [DBG] user_consent grant with value: mvcHybrid|af61726e-716b-4170-8c26-6568bf294215 not found in store.
2019-05-30 20:33:24.808 +08:00 [DBG] Found no prior consent from consent store, consent is required
2019-05-30 20:33:24.808 +08:00 [INF] Showing consent: User has not yet consented
2019-05-30 20:33:24.816 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 20:33:26.540 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:33:26.541 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:33:26.541 +08:00 [DBG] Checking for PKCE parameters
2019-05-30 20:33:26.542 +08:00 [DBG] No PKCE used.
2019-05-30 20:33:26.850 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:33:27.045 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:33:27.348 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:33:27.517 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:33:27.518 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 20:33:29.307 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:33:29.308 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:33:29.664 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:33:29.845 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:33:33.891 +08:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-30 20:33:33.896 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 20:33:35.706 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:33:35.707 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:33:35.708 +08:00 [DBG] Checking for PKCE parameters
2019-05-30 20:33:35.709 +08:00 [DBG] No PKCE used.
2019-05-30 20:33:36.023 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:33:36.196 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:33:36.549 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:33:36.733 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:33:36.735 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 20:33:36.736 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcHybrid","RequestedScopes":["openid","profile"],"GrantedScopes":["openid","profile"],"ConsentRemembered":false,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLN4VAJNJGF1:00000008","TimeStamp":"2019-05-30T12:33:36.0000000Z","ProcessId":46241,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-05-30 20:33:41.386 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:33:41.389 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:33:41.402 +08:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-05-30 20:33:41.403 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-05-30 20:33:41.403 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-05-30 20:33:41.404 +08:00 [DBG] Start authorize callback request
2019-05-30 20:33:41.405 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 20:33:41.406 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 20:33:43.231 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:33:43.232 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:33:43.233 +08:00 [DBG] Checking for PKCE parameters
2019-05-30 20:33:43.233 +08:00 [DBG] No PKCE used.
2019-05-30 20:33:43.540 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:33:43.727 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:33:44.033 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:33:44.240 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:33:44.241 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 20:33:44.242 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile","State":"CfDJ8F85EO-pYlJKvNXwUT18ba5KvVUDrTV8kSVgbzAtOLRTQmB1xH5sAHt5F2Hvcty11gswnLD5lbdyCc4PEQ42O9jv-PvdzL7_YJz4TioDi8y3vW8rcTp30b9yqHFxNp_nA4wHX0qx14tvnlo9nupf_XrvOfOF7Hx1zCTbnmqHIrGxlbMwEYv0K7GcuWa_sjd6xIFRhIg4a_I7PyFCtbXEu6Jv8FfnPZg2wT70dzETjAyjfm_zVUhkM-9QZDBASc8CXgPXoAZtEh3Hk6ZTpxXHFws6dcF9IaEFSsNbLwLjcGUqRDkeB_173IkNbAgOf-Nqxfo9cJjg92AofdRbSuTMws4","UiLocales":null,"Nonce":"636948164016844110.NGZlNTgzNjMtMGI5Ny00NTE5LWJkMTItM2FlMjVlZjUwYzYyMGY3M2UwZTgtYzkzZi00MWI1LWIyOTQtODFiM2JhNmVjYWY0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8115527021d4937e613b0f1d59ccf9e0","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile","response_mode":"form_post","nonce":"636948164016844110.NGZlNTgzNjMtMGI5Ny00NTE5LWJkMTItM2FlMjVlZjUwYzYyMGY3M2UwZTgtYzkzZi00MWI1LWIyOTQtODFiM2JhNmVjYWY0","state":"CfDJ8F85EO-pYlJKvNXwUT18ba5KvVUDrTV8kSVgbzAtOLRTQmB1xH5sAHt5F2Hvcty11gswnLD5lbdyCc4PEQ42O9jv-PvdzL7_YJz4TioDi8y3vW8rcTp30b9yqHFxNp_nA4wHX0qx14tvnlo9nupf_XrvOfOF7Hx1zCTbnmqHIrGxlbMwEYv0K7GcuWa_sjd6xIFRhIg4a_I7PyFCtbXEu6Jv8FfnPZg2wT70dzETjAyjfm_zVUhkM-9QZDBASc8CXgPXoAZtEh3Hk6ZTpxXHFws6dcF9IaEFSsNbLwLjcGUqRDkeB_173IkNbAgOf-Nqxfo9cJjg92AofdRbSuTMws4","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 20:33:44.614 +08:00 [DBG] FiTLcYGBYEV8OnKEgTs+U+128Zy+PdC+Fm2zjauszrc= found in database: false
2019-05-30 20:33:44.614 +08:00 [DBG] user_consent grant with value: mvcHybrid|af61726e-716b-4170-8c26-6568bf294215 not found in store.
2019-05-30 20:33:44.615 +08:00 [DBG] Found no prior consent from consent store, consent is required
2019-05-30 20:33:44.617 +08:00 [INF] User consented to scopes: ["openid","profile"]
2019-05-30 20:33:44.618 +08:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 20:33:44.815 +08:00 [DBG] no FiTLcYGBYEV8OnKEgTs+U+128Zy+PdC+Fm2zjauszrc= persisted grant found in database
2019-05-30 20:33:44.815 +08:00 [DBG] Creating Hybrid Flow response.
2019-05-30 20:33:45.006 +08:00 [DBG] obBN7ZRWMcWwNPfFp42ZXJbB5ydR+bL+az2Q3HIT+FE= not found in database
2019-05-30 20:33:45.343 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 20:33:45.343 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcHybrid
2019-05-30 20:33:45.344 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-05-30 20:33:45.359 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****Oxhg","$type":"Token"},{"TokenType":"code","TokenValue":"****571e","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4VAJNJGF1:00000009","TimeStamp":"2019-05-30T12:33:45.0000000Z","ProcessId":46241,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 20:33:45.360 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcHybrid","RedirectUri":"http://localhost:5005/signin-oidc","State":"CfDJ8F85EO-pYlJKvNXwUT18ba5KvVUDrTV8kSVgbzAtOLRTQmB1xH5sAHt5F2Hvcty11gswnLD5lbdyCc4PEQ42O9jv-PvdzL7_YJz4TioDi8y3vW8rcTp30b9yqHFxNp_nA4wHX0qx14tvnlo9nupf_XrvOfOF7Hx1zCTbnmqHIrGxlbMwEYv0K7GcuWa_sjd6xIFRhIg4a_I7PyFCtbXEu6Jv8FfnPZg2wT70dzETjAyjfm_zVUhkM-9QZDBASc8CXgPXoAZtEh3Hk6ZTpxXHFws6dcF9IaEFSsNbLwLjcGUqRDkeB_173IkNbAgOf-Nqxfo9cJjg92AofdRbSuTMws4","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 20:33:45.556 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-30 20:33:45.557 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-30 20:33:45.557 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-30 20:33:45.557 +08:00 [DBG] Start token request.
2019-05-30 20:33:45.558 +08:00 [DBG] Start client validation
2019-05-30 20:33:45.558 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-30 20:33:45.558 +08:00 [DBG] Start parsing for secret in post body
2019-05-30 20:33:45.559 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-30 20:33:45.560 +08:00 [DBG] Secret id found: mvcHybrid
2019-05-30 20:33:47.356 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:33:47.356 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:33:47.358 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-30 20:33:47.358 +08:00 [DBG] Client validation success
2019-05-30 20:33:47.360 +08:00 [INF] {"ClientId":"mvcHybrid","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN4VAJNJGF6:00000003","TimeStamp":"2019-05-30T12:33:47.0000000Z","ProcessId":46241,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-30 20:33:47.361 +08:00 [DBG] Start token request validation
2019-05-30 20:33:47.362 +08:00 [DBG] Start validation of authorization code token request
2019-05-30 20:33:47.536 +08:00 [DBG] obBN7ZRWMcWwNPfFp42ZXJbB5ydR+bL+az2Q3HIT+FE= found in database: true
2019-05-30 20:33:47.726 +08:00 [DBG] removing obBN7ZRWMcWwNPfFp42ZXJbB5ydR+bL+az2Q3HIT+FE= persisted grant from database
2019-05-30 20:33:48.258 +08:00 [DBG] Validation of authorization code token request success
2019-05-30 20:33:48.259 +08:00 [INF] Token request validation success
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"4a62418294d95df18e7ff891c0dbfb4d71027227ab5e3f23571fa33677b0571e","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvcHybrid","client_secret":"***REDACTED***","code":"4a62418294d95df18e7ff891c0dbfb4d71027227ab5e3f23571fa33677b0571e","grant_type":"authorization_code","redirect_uri":"http://localhost:5005/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-30 20:33:49.979 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:33:49.980 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:33:50.304 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:33:50.526 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:33:50.526 +08:00 [DBG] Getting claims for access token for client: mvcHybrid
2019-05-30 20:33:50.527 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 20:33:50.527 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 20:33:52.396 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:33:52.397 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:33:52.743 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:33:52.921 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:33:52.922 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcHybrid
2019-05-30 20:33:52.923 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-05-30 20:33:52.939 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****ZByw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****ahWA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4VAJNJGF6:00000003","TimeStamp":"2019-05-30T12:33:52.0000000Z","ProcessId":46241,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 20:33:52.940 +08:00 [DBG] Token request success.
2019-05-30 20:33:52.953 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-30 20:33:52.954 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-30 20:33:52.954 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-30 20:33:52.955 +08:00 [DBG] Start userinfo request
2019-05-30 20:33:52.955 +08:00 [DBG] Bearer token found in header
2019-05-30 20:33:54.711 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:33:54.711 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:33:56.587 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:33:56.588 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:33:56.786 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-30 20:33:56.786 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1559219630,"exp":1559219690,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"mvcHybrid","sub":"af61726e-716b-4170-8c26-6568bf294215","auth_time":1559134138,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"shawn","last_name":"wong","card_number":"12123","card_holder":"王曉鋒","card_security_number":"2323","card_expiration":"20/12","address_city":"shanghai","address_country":"中国","address_state":"canials","address_street":"shanghai","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-30 20:33:56.787 +08:00 [DBG] Creating userinfo response
2019-05-30 20:33:56.788 +08:00 [DBG] Scopes in access token: openid profile
2019-05-30 20:33:56.788 +08:00 [DBG] Scopes in access token: openid profile
2019-05-30 20:33:57.128 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:33:57.128 +08:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2019-05-30 20:33:57.129 +08:00 [DBG] Scopes in access token: openid profile
2019-05-30 20:33:57.446 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:33:57.447 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-05-30 20:33:57.447 +08:00 [DBG] End userinfo request
2019-05-30 20:36:31.799 +08:00 [DBG] TaskCanceledException. Exiting.
2019-05-30 20:36:31.815 +08:00 [DBG] Stopping grant removal
2019-05-30 20:36:50.877 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 20:36:50.908 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 20:36:50.908 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 20:36:50.908 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 20:36:50.908 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 20:36:50.908 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 20:36:51.110 +08:00 [DBG] Starting grant removal
2019-05-30 20:36:58.235 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 20:36:58.238 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 20:36:58.238 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 20:36:58.238 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 20:36:58.238 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 20:36:58.239 +08:00 [DBG] Error Url: /home/error
2019-05-30 20:36:58.239 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 20:36:58.265 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 20:36:58.276 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 20:36:58.276 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 20:36:58.280 +08:00 [DBG] Start discovery request
2019-05-30 20:37:00.375 +08:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2019-05-30 20:37:00.545 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 20:37:00.548 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 20:37:00.549 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 20:37:00.554 +08:00 [DBG] Start key discovery request
2019-05-30 20:37:00.646 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 20:37:00.650 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 20:37:00.651 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 20:37:00.655 +08:00 [DBG] Start authorize request
2019-05-30 20:37:00.668 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 20:37:00.673 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 20:37:03.135 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:37:03.143 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:37:03.149 +08:00 [DBG] Checking for PKCE parameters
2019-05-30 20:37:03.152 +08:00 [DBG] No PKCE used.
2019-05-30 20:37:03.598 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-30 20:37:03.875 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:37:03.882 +08:00 [ERR] Invalid scope: email
2019-05-30 20:37:03.888 +08:00 [ERR] Request validation failed
2019-05-30 20:37:03.900 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile email","State":"CfDJ8F85EO-pYlJKvNXwUT18ba5dXQwO4zH7tMEK7awd-vfksGkEh7pTy-_5StOf4NV1r5n0cnGe32RE5LQ35shPWCbKjtCyBaJjh0vA3G6mVK-pR_LqJe2-u8ilMQzIqFidf1op31BLXTEG5ymthyWjXVJza_NcLQG-cqkMfQGju7pbjdAWLRKXWrTMuRBWwetVmmHUOeFsMbq-EvBwUdtkCl8bUJKsdSlPc8sDVFXZlSCSqhiJigr9GToxsHoNt6q6ohAA6sA4knLQJLXoh0ZY2nEbrAcUThxAKR_VmmvmrWuuTqK722YnUcgBmKB4bovG1DrBl0umx30hM7OaI09phvM","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile email","response_mode":"form_post","nonce":"636948166205860010.MDYxYzRlNzUtY2I3Ni00NzkzLTkyYzItMjYxYWM4MWFkNzgzNzc2YjVmZjQtM2U5OS00N2NmLTg0ODUtMjc0Zjg5MzU0Yzc4","state":"CfDJ8F85EO-pYlJKvNXwUT18ba5dXQwO4zH7tMEK7awd-vfksGkEh7pTy-_5StOf4NV1r5n0cnGe32RE5LQ35shPWCbKjtCyBaJjh0vA3G6mVK-pR_LqJe2-u8ilMQzIqFidf1op31BLXTEG5ymthyWjXVJza_NcLQG-cqkMfQGju7pbjdAWLRKXWrTMuRBWwetVmmHUOeFsMbq-EvBwUdtkCl8bUJKsdSlPc8sDVFXZlSCSqhiJigr9GToxsHoNt6q6ohAA6sA4knLQJLXoh0ZY2nEbrAcUThxAKR_VmmvmrWuuTqK722YnUcgBmKB4bovG1DrBl0umx30hM7OaI09phvM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 20:37:03.918 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile email","GrantType":"hybrid","Error":"invalid_scope","ErrorDescription":"Invalid scope","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLN4VE0OV6F2:00000001","TimeStamp":"2019-05-30T12:37:03.0000000Z","ProcessId":46497,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-05-30 20:37:47.978 +08:00 [DBG] TaskCanceledException. Exiting.
2019-05-30 20:37:48.012 +08:00 [DBG] Stopping grant removal
2019-05-30 20:38:24.523 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 20:38:24.569 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 20:38:24.570 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 20:38:24.571 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 20:38:24.571 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 20:38:24.573 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 20:38:24.951 +08:00 [DBG] Starting grant removal
2019-05-30 20:42:13.070 +08:00 [DBG] TaskCanceledException. Exiting.
2019-05-30 20:42:13.109 +08:00 [DBG] Stopping grant removal
2019-05-30 20:42:32.826 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-30 20:42:32.855 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-30 20:42:32.855 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-30 20:42:32.855 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-30 20:42:32.855 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-30 20:42:32.855 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-30 20:42:33.034 +08:00 [DBG] Starting grant removal
2019-05-30 20:43:29.155 +08:00 [DBG] Login Url: /Account/Login
2019-05-30 20:43:29.158 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-30 20:43:29.159 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-30 20:43:29.159 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-30 20:43:29.159 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-30 20:43:29.159 +08:00 [DBG] Error Url: /home/error
2019-05-30 20:43:29.160 +08:00 [DBG] Error Id Parameter: errorId
2019-05-30 20:43:29.190 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-05-30 20:43:29.215 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-05-30 20:43:29.216 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-05-30 20:43:29.221 +08:00 [DBG] Start discovery request
2019-05-30 20:43:30.824 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-05-30 20:43:31.053 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-05-30 20:43:31.056 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-05-30 20:43:31.056 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-05-30 20:43:31.062 +08:00 [DBG] Start key discovery request
2019-05-30 20:43:31.163 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-05-30 20:43:31.171 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-05-30 20:43:31.171 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-05-30 20:43:31.175 +08:00 [DBG] Start authorize request
2019-05-30 20:43:31.192 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 20:43:31.199 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 20:43:33.303 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:43:33.315 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:43:33.320 +08:00 [DBG] Checking for PKCE parameters
2019-05-30 20:43:33.322 +08:00 [DBG] No PKCE used.
2019-05-30 20:43:33.735 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-05-30 20:43:33.976 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:43:34.312 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-05-30 20:43:34.515 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:43:34.532 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 20:43:34.549 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile email","State":"CfDJ8F85EO-pYlJKvNXwUT18ba7UFK9MrX3VlHnYRC72ousSTC5h2YwzCj9JpgkS7zcxx9xoPtRYi0Hu9IP1WyS5y_K_to3T0W-0Nd6E8CPY6_rRN3MPF2Qq7BW0Bd6_C2r8suPSVq2TcYwFEjIigonO5tY55GdSJ23J7y7F7kK51RAmQiReLJn70uvhudJyvKygJUFIkeVxbseje9jC2LeasgZBNdz3JVCIirxlR5knn7nqY4du2FskY7GG8rMHMOMnbzECGnEdMsZrxmZaKZI7HV-l2Gr2pU_6LtFDn2sTmBuIShnZmyG4_zLEcbfLeigWfzHeICAU5_TjWt36wIyK-8Q","UiLocales":null,"Nonce":"636948170111067560.ODE5MDQyYzQtNjM4ZS00MGUxLTkxMGMtMWI0ZDQzMThmZTlkMzAyZjI5NTQtMjE5Ni00NjdmLThhMmQtM2UxZDNkNjYxNDcz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8115527021d4937e613b0f1d59ccf9e0","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile email","response_mode":"form_post","nonce":"636948170111067560.ODE5MDQyYzQtNjM4ZS00MGUxLTkxMGMtMWI0ZDQzMThmZTlkMzAyZjI5NTQtMjE5Ni00NjdmLThhMmQtM2UxZDNkNjYxNDcz","state":"CfDJ8F85EO-pYlJKvNXwUT18ba7UFK9MrX3VlHnYRC72ousSTC5h2YwzCj9JpgkS7zcxx9xoPtRYi0Hu9IP1WyS5y_K_to3T0W-0Nd6E8CPY6_rRN3MPF2Qq7BW0Bd6_C2r8suPSVq2TcYwFEjIigonO5tY55GdSJ23J7y7F7kK51RAmQiReLJn70uvhudJyvKygJUFIkeVxbseje9jC2LeasgZBNdz3JVCIirxlR5knn7nqY4du2FskY7GG8rMHMOMnbzECGnEdMsZrxmZaKZI7HV-l2Gr2pU_6LtFDn2sTmBuIShnZmyG4_zLEcbfLeigWfzHeICAU5_TjWt36wIyK-8Q","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 20:43:35.136 +08:00 [DBG] FiTLcYGBYEV8OnKEgTs+U+128Zy+PdC+Fm2zjauszrc= found in database: false
2019-05-30 20:43:35.136 +08:00 [DBG] user_consent grant with value: mvcHybrid|af61726e-716b-4170-8c26-6568bf294215 not found in store.
2019-05-30 20:43:35.137 +08:00 [DBG] Found no prior consent from consent store, consent is required
2019-05-30 20:43:35.138 +08:00 [INF] Showing consent: User has not yet consented
2019-05-30 20:43:35.409 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 20:43:37.209 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:43:37.210 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:43:37.211 +08:00 [DBG] Checking for PKCE parameters
2019-05-30 20:43:37.213 +08:00 [DBG] No PKCE used.
2019-05-30 20:43:37.540 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-05-30 20:43:37.721 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:43:38.038 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-05-30 20:43:38.220 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:43:38.221 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 20:43:40.026 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:43:40.027 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:43:40.378 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-05-30 20:43:40.602 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:43:46.413 +08:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-05-30 20:43:46.466 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 20:43:50.171 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:43:50.171 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:43:50.172 +08:00 [DBG] Checking for PKCE parameters
2019-05-30 20:43:50.173 +08:00 [DBG] No PKCE used.
2019-05-30 20:43:50.490 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-05-30 20:43:50.685 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:43:51.032 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-05-30 20:43:51.223 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:43:51.224 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 20:43:51.245 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcHybrid","RequestedScopes":["openid","profile","email"],"GrantedScopes":["openid","profile","email"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLN4VHL84K70:00000003","TimeStamp":"2019-05-30T12:43:51.0000000Z","ProcessId":46758,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-05-30 20:43:53.161 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:43:53.161 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:43:53.173 +08:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-05-30 20:43:53.174 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-05-30 20:43:53.175 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-05-30 20:43:53.181 +08:00 [DBG] Start authorize callback request
2019-05-30 20:43:53.188 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 20:43:53.188 +08:00 [DBG] Start authorize request protocol validation
2019-05-30 20:43:55.008 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:43:55.012 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:43:55.013 +08:00 [DBG] Checking for PKCE parameters
2019-05-30 20:43:55.013 +08:00 [DBG] No PKCE used.
2019-05-30 20:43:55.337 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-05-30 20:43:55.518 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:43:55.846 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-05-30 20:43:56.038 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:43:56.038 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-05-30 20:43:56.040 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile email","State":"CfDJ8F85EO-pYlJKvNXwUT18ba7UFK9MrX3VlHnYRC72ousSTC5h2YwzCj9JpgkS7zcxx9xoPtRYi0Hu9IP1WyS5y_K_to3T0W-0Nd6E8CPY6_rRN3MPF2Qq7BW0Bd6_C2r8suPSVq2TcYwFEjIigonO5tY55GdSJ23J7y7F7kK51RAmQiReLJn70uvhudJyvKygJUFIkeVxbseje9jC2LeasgZBNdz3JVCIirxlR5knn7nqY4du2FskY7GG8rMHMOMnbzECGnEdMsZrxmZaKZI7HV-l2Gr2pU_6LtFDn2sTmBuIShnZmyG4_zLEcbfLeigWfzHeICAU5_TjWt36wIyK-8Q","UiLocales":null,"Nonce":"636948170111067560.ODE5MDQyYzQtNjM4ZS00MGUxLTkxMGMtMWI0ZDQzMThmZTlkMzAyZjI5NTQtMjE5Ni00NjdmLThhMmQtM2UxZDNkNjYxNDcz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"8115527021d4937e613b0f1d59ccf9e0","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile email","response_mode":"form_post","nonce":"636948170111067560.ODE5MDQyYzQtNjM4ZS00MGUxLTkxMGMtMWI0ZDQzMThmZTlkMzAyZjI5NTQtMjE5Ni00NjdmLThhMmQtM2UxZDNkNjYxNDcz","state":"CfDJ8F85EO-pYlJKvNXwUT18ba7UFK9MrX3VlHnYRC72ousSTC5h2YwzCj9JpgkS7zcxx9xoPtRYi0Hu9IP1WyS5y_K_to3T0W-0Nd6E8CPY6_rRN3MPF2Qq7BW0Bd6_C2r8suPSVq2TcYwFEjIigonO5tY55GdSJ23J7y7F7kK51RAmQiReLJn70uvhudJyvKygJUFIkeVxbseje9jC2LeasgZBNdz3JVCIirxlR5knn7nqY4du2FskY7GG8rMHMOMnbzECGnEdMsZrxmZaKZI7HV-l2Gr2pU_6LtFDn2sTmBuIShnZmyG4_zLEcbfLeigWfzHeICAU5_TjWt36wIyK-8Q","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-05-30 20:43:56.451 +08:00 [DBG] FiTLcYGBYEV8OnKEgTs+U+128Zy+PdC+Fm2zjauszrc= found in database: false
2019-05-30 20:43:56.452 +08:00 [DBG] user_consent grant with value: mvcHybrid|af61726e-716b-4170-8c26-6568bf294215 not found in store.
2019-05-30 20:43:56.452 +08:00 [DBG] Found no prior consent from consent store, consent is required
2019-05-30 20:43:56.461 +08:00 [INF] User consented to scopes: ["openid","profile","email"]
2019-05-30 20:43:56.463 +08:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email"]
2019-05-30 20:43:56.469 +08:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 20:43:56.676 +08:00 [DBG] FiTLcYGBYEV8OnKEgTs+U+128Zy+PdC+Fm2zjauszrc= not found in database
2019-05-30 20:43:57.063 +08:00 [DBG] Creating Hybrid Flow response.
2019-05-30 20:43:57.273 +08:00 [DBG] sl62ISBBzZ6OG8mQGI5Ng1Yr16/UvZBc3BMaEgMZCDI= not found in database
2019-05-30 20:43:57.622 +08:00 [DBG] Creating Implicit Flow response.
2019-05-30 20:43:57.635 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcHybrid
2019-05-30 20:43:57.639 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-05-30 20:43:57.733 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile email","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****D8dQ","$type":"Token"},{"TokenType":"code","TokenValue":"****8936","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4VHL84K70:00000004","TimeStamp":"2019-05-30T12:43:57.0000000Z","ProcessId":46758,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 20:43:57.735 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcHybrid","RedirectUri":"http://localhost:5005/signin-oidc","State":"CfDJ8F85EO-pYlJKvNXwUT18ba7UFK9MrX3VlHnYRC72ousSTC5h2YwzCj9JpgkS7zcxx9xoPtRYi0Hu9IP1WyS5y_K_to3T0W-0Nd6E8CPY6_rRN3MPF2Qq7BW0Bd6_C2r8suPSVq2TcYwFEjIigonO5tY55GdSJ23J7y7F7kK51RAmQiReLJn70uvhudJyvKygJUFIkeVxbseje9jC2LeasgZBNdz3JVCIirxlR5knn7nqY4du2FskY7GG8rMHMOMnbzECGnEdMsZrxmZaKZI7HV-l2Gr2pU_6LtFDn2sTmBuIShnZmyG4_zLEcbfLeigWfzHeICAU5_TjWt36wIyK-8Q","Scope":"openid profile email","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-05-30 20:43:57.934 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-05-30 20:43:57.939 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-05-30 20:43:57.940 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-05-30 20:43:57.947 +08:00 [DBG] Start token request.
2019-05-30 20:43:57.955 +08:00 [DBG] Start client validation
2019-05-30 20:43:57.961 +08:00 [DBG] Start parsing Basic Authentication secret
2019-05-30 20:43:57.966 +08:00 [DBG] Start parsing for secret in post body
2019-05-30 20:43:57.967 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-05-30 20:43:57.967 +08:00 [DBG] Secret id found: mvcHybrid
2019-05-30 20:43:59.756 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:43:59.756 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:43:59.778 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-05-30 20:43:59.778 +08:00 [DBG] Client validation success
2019-05-30 20:43:59.779 +08:00 [INF] {"ClientId":"mvcHybrid","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLN4VHL84K6V:00000003","TimeStamp":"2019-05-30T12:43:59.0000000Z","ProcessId":46758,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-05-30 20:43:59.788 +08:00 [DBG] Start token request validation
2019-05-30 20:43:59.801 +08:00 [DBG] Start validation of authorization code token request
2019-05-30 20:43:59.993 +08:00 [DBG] sl62ISBBzZ6OG8mQGI5Ng1Yr16/UvZBc3BMaEgMZCDI= found in database: true
2019-05-30 20:44:00.197 +08:00 [DBG] removing sl62ISBBzZ6OG8mQGI5Ng1Yr16/UvZBc3BMaEgMZCDI= persisted grant from database
2019-05-30 20:44:00.752 +08:00 [DBG] Validation of authorization code token request success
2019-05-30 20:44:00.759 +08:00 [INF] Token request validation success
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"fb8b51610483d2afaad04f93922e149633d23f6ad37eef49cb5a3a140a678936","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvcHybrid","client_secret":"***REDACTED***","code":"fb8b51610483d2afaad04f93922e149633d23f6ad37eef49cb5a3a140a678936","grant_type":"authorization_code","redirect_uri":"http://localhost:5005/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-05-30 20:44:02.528 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:44:02.529 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:44:02.839 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-05-30 20:44:03.015 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:44:03.034 +08:00 [DBG] Getting claims for access token for client: mvcHybrid
2019-05-30 20:44:03.035 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-05-30 20:44:03.040 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-05-30 20:44:04.821 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:44:04.821 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:44:05.136 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-05-30 20:44:05.340 +08:00 [DBG] Found [] API scopes in database
2019-05-30 20:44:05.341 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcHybrid
2019-05-30 20:44:05.341 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-05-30 20:44:05.364 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile email","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****dtWQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****_hdg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLN4VHL84K6V:00000003","TimeStamp":"2019-05-30T12:44:05.0000000Z","ProcessId":46758,"LocalIpAddress":"::1:5000","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-05-30 20:44:05.366 +08:00 [DBG] Token request success.
2019-05-30 20:44:05.388 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-05-30 20:44:05.391 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-05-30 20:44:05.392 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-05-30 20:44:05.400 +08:00 [DBG] Start userinfo request
2019-05-30 20:44:05.407 +08:00 [DBG] Bearer token found in header
2019-05-30 20:44:07.263 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:44:07.264 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:44:09.105 +08:00 [DBG] mvcHybrid found in database: true
2019-05-30 20:44:09.106 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-30 20:44:09.295 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-05-30 20:44:09.298 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1559220243,"exp":1559220303,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"mvcHybrid","sub":"af61726e-716b-4170-8c26-6568bf294215","auth_time":1559134138,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"shawn","last_name":"wong","card_number":"12123","card_holder":"王曉鋒","card_security_number":"2323","card_expiration":"20/12","address_city":"shanghai","address_country":"中国","address_state":"canials","address_street":"shanghai","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-05-30 20:44:09.309 +08:00 [DBG] Creating userinfo response
2019-05-30 20:44:09.315 +08:00 [DBG] Scopes in access token: openid profile email
2019-05-30 20:44:09.319 +08:00 [DBG] Scopes in access token: openid profile email
2019-05-30 20:44:09.658 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-05-30 20:44:09.660 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-05-30 20:44:09.661 +08:00 [DBG] Scopes in access token: openid profile email
2019-05-30 20:44:09.993 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-05-30 20:44:09.994 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-05-30 20:44:09.995 +08:00 [DBG] End userinfo request
2019-05-30 20:44:24.046 +08:00 [DBG] TaskCanceledException. Exiting.
2019-05-30 20:44:24.085 +08:00 [DBG] Stopping grant removal
2019-05-31 09:50:22.962 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-31 09:50:22.995 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-31 09:50:22.996 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-31 09:50:22.996 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-31 09:50:22.996 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-31 09:50:22.996 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-31 09:50:23.507 +08:00 [DBG] Starting grant removal
2019-05-31 09:50:24.129 +08:00 [DBG] Login Url: /Account/Login
2019-05-31 09:50:24.132 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-31 09:50:24.132 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-31 09:50:24.132 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-31 09:50:24.132 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-31 09:50:24.132 +08:00 [DBG] Error Url: /home/error
2019-05-31 09:50:24.132 +08:00 [DBG] Error Id Parameter: errorId
2019-05-31 10:00:53.012 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-31 10:00:53.040 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-31 10:00:53.040 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-31 10:00:53.040 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-31 10:00:53.040 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-31 10:00:53.041 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-31 10:00:53.450 +08:00 [DBG] Starting grant removal
2019-05-31 10:00:53.706 +08:00 [DBG] Login Url: /Account/Login
2019-05-31 10:00:53.708 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-31 10:00:53.708 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-31 10:00:53.708 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-31 10:00:53.709 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-31 10:00:53.709 +08:00 [DBG] Error Url: /home/error
2019-05-31 10:00:53.709 +08:00 [DBG] Error Id Parameter: errorId
2019-05-31 10:01:25.397 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-31 10:01:25.425 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-31 10:01:25.425 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-31 10:01:25.426 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-31 10:01:25.427 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-31 10:01:25.427 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-31 10:01:25.842 +08:00 [DBG] Starting grant removal
2019-05-31 10:01:26.248 +08:00 [DBG] Login Url: /Account/Login
2019-05-31 10:01:26.251 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-31 10:01:26.251 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-31 10:01:26.251 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-31 10:01:26.251 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-31 10:01:26.251 +08:00 [DBG] Error Url: /home/error
2019-05-31 10:01:26.251 +08:00 [DBG] Error Id Parameter: errorId
2019-05-31 10:02:24.731 +08:00 [DBG] 2 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-05-31 10:02:26.904 +08:00 [DBG] mvcHybrid found in database: true
2019-05-31 10:02:26.915 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-05-31 10:02:28.320 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-05-31 10:02:28.549 +08:00 [DBG] Found [] API scopes in database
2019-05-31 10:02:29.799 +08:00 [DBG] mvcImp found in database: true
2019-05-31 10:02:29.799 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-05-31 10:02:30.023 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-05-31 10:02:30.158 +08:00 [DBG] Found [] API scopes in database
2019-05-31 11:49:07.506 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-31 11:49:07.559 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-31 11:49:07.559 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-31 11:49:07.559 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-31 11:49:07.559 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-31 11:49:07.559 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-31 11:49:08.064 +08:00 [DBG] Starting grant removal
2019-05-31 11:49:08.346 +08:00 [DBG] Login Url: /Account/Login
2019-05-31 11:49:08.349 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-31 11:49:08.349 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-31 11:49:08.349 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-31 11:49:08.349 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-31 11:49:08.349 +08:00 [DBG] Error Url: /home/error
2019-05-31 11:49:08.350 +08:00 [DBG] Error Id Parameter: errorId
2019-05-31 14:39:29.756 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-31 14:39:29.811 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-31 14:39:29.814 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-31 14:39:29.814 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-31 14:39:29.814 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-31 14:39:29.814 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-31 14:39:30.278 +08:00 [DBG] Starting grant removal
2019-05-31 14:39:30.565 +08:00 [DBG] Login Url: /Account/Login
2019-05-31 14:39:30.567 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-31 14:39:30.567 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-31 14:39:30.567 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-31 14:39:30.567 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-31 14:39:30.567 +08:00 [DBG] Error Url: /home/error
2019-05-31 14:39:30.567 +08:00 [DBG] Error Id Parameter: errorId
2019-05-31 14:40:49.965 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-05-31 14:40:50.012 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-05-31 14:40:50.013 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-05-31 14:40:50.013 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-05-31 14:40:50.013 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-05-31 14:40:50.013 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-05-31 14:40:50.597 +08:00 [DBG] Starting grant removal
2019-05-31 14:40:50.794 +08:00 [DBG] Login Url: /Account/Login
2019-05-31 14:40:50.798 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-05-31 14:40:50.799 +08:00 [DBG] Logout Url: /Account/Logout
2019-05-31 14:40:50.799 +08:00 [DBG] ConsentUrl Url: /consent
2019-05-31 14:40:50.799 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-05-31 14:40:50.799 +08:00 [DBG] Error Url: /home/error
2019-05-31 14:40:50.799 +08:00 [DBG] Error Id Parameter: errorId
2019-06-08 15:47:57.950 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-08 15:47:58.014 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-08 15:47:58.015 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-08 15:47:58.015 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-08 15:47:58.015 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-08 15:47:58.015 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-08 15:47:58.337 +08:00 [DBG] Starting grant removal
2019-06-08 15:47:58.876 +08:00 [DBG] Login Url: /Account/Login
2019-06-08 15:47:58.880 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-08 15:47:58.880 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-08 15:47:58.881 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-08 15:47:58.881 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-08 15:47:58.882 +08:00 [DBG] Error Url: /home/error
2019-06-08 15:47:58.882 +08:00 [DBG] Error Id Parameter: errorId
2019-06-08 15:49:23.932 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-08 15:49:23.953 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-08 15:49:23.954 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-08 15:49:23.969 +08:00 [DBG] Start discovery request
2019-06-08 15:49:27.249 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-08 15:49:27.476 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-08 15:49:27.478 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-08 15:49:27.479 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-08 15:49:27.487 +08:00 [DBG] Start key discovery request
2019-06-08 15:49:27.798 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-08 15:49:27.819 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-08 15:49:27.819 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-08 15:49:27.839 +08:00 [DBG] Start token request.
2019-06-08 15:49:27.856 +08:00 [DBG] Start client validation
2019-06-08 15:49:27.873 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-08 15:49:27.886 +08:00 [DBG] Start parsing for secret in post body
2019-06-08 15:49:27.943 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-08 15:49:27.943 +08:00 [DBG] Secret id found: client
2019-06-08 15:49:29.968 +08:00 [DBG] client found in database: true
2019-06-08 15:49:29.994 +08:00 [DBG] client configuration validation for client client succeeded.
2019-06-08 15:49:30.025 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-08 15:49:30.025 +08:00 [DBG] Client validation success
2019-06-08 15:49:30.053 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNBSMG1MOHV:00000003","TimeStamp":"2019-06-08T07:49:30.0000000Z","ProcessId":17888,"LocalIpAddress":"127.0.0.1:21787","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-08 15:49:30.079 +08:00 [DBG] Start token request validation
2019-06-08 15:49:30.105 +08:00 [DBG] Start client credentials token request validation
2019-06-08 15:49:30.365 +08:00 [DBG] Found [] identity scopes in database
2019-06-08 15:49:31.120 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-08 15:49:31.274 +08:00 [DBG] Found [] identity scopes in database
2019-06-08 15:49:31.884 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-08 15:49:31.891 +08:00 [DBG] client credentials token request validation success
2019-06-08 15:49:31.904 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-06-08 15:49:31.953 +08:00 [DBG] Getting claims for access token for client: client
2019-06-08 15:49:32.154 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****s8oQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNBSMG1MOHV:00000003","TimeStamp":"2019-06-08T07:49:32.0000000Z","ProcessId":17888,"LocalIpAddress":"127.0.0.1:21787","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-08 15:49:32.156 +08:00 [DBG] Token request success.
2019-06-08 15:49:32.738 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-08 15:49:32.746 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-08 15:49:32.747 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-08 15:49:32.747 +08:00 [DBG] Start discovery request
2019-06-08 15:49:33.573 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-08 15:49:33.880 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-08 15:49:33.881 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-08 15:49:33.882 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-08 15:49:33.882 +08:00 [DBG] Start key discovery request
2019-06-08 15:49:45.432 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-08 15:49:45.434 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-08 15:49:45.434 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-08 15:49:45.434 +08:00 [DBG] Start discovery request
2019-06-08 15:49:46.229 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-08 15:49:46.310 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-08 15:49:46.311 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-08 15:49:46.311 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-08 15:49:46.311 +08:00 [DBG] Start key discovery request
2019-06-08 15:50:00.613 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-08 15:50:00.615 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-08 15:50:00.616 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-08 15:50:00.616 +08:00 [DBG] Start token request.
2019-06-08 15:50:00.616 +08:00 [DBG] Start client validation
2019-06-08 15:50:00.616 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-08 15:50:00.616 +08:00 [DBG] Start parsing for secret in post body
2019-06-08 15:50:00.620 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-08 15:50:00.620 +08:00 [DBG] Secret id found: ro.client
2019-06-08 15:50:01.888 +08:00 [DBG] ro.client found in database: true
2019-06-08 15:50:01.888 +08:00 [DBG] client configuration validation for client ro.client succeeded.
2019-06-08 15:50:01.889 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-08 15:50:01.889 +08:00 [DBG] Client validation success
2019-06-08 15:50:01.889 +08:00 [INF] {"ClientId":"ro.client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNBSMG1MOHV:00000008","TimeStamp":"2019-06-08T07:50:01.0000000Z","ProcessId":17888,"LocalIpAddress":"127.0.0.1:21787","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-08 15:50:01.889 +08:00 [DBG] Start token request validation
2019-06-08 15:50:01.905 +08:00 [DBG] Start resource owner password token request validation
2019-06-08 15:50:02.043 +08:00 [DBG] Found [] identity scopes in database
2019-06-08 15:50:02.665 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-08 15:50:02.800 +08:00 [DBG] Found [] identity scopes in database
2019-06-08 15:50:03.409 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-08 15:50:04.031 +08:00 [INF] Credentials validated for username: 1223138295@qq.com
2019-06-08 15:50:04.035 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Endpoint":"Token","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNBSMG1MOHV:00000008","TimeStamp":"2019-06-08T07:50:04.0000000Z","ProcessId":17888,"LocalIpAddress":"127.0.0.1:21787","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-08 15:50:04.058 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":null,"Endpoint":"Token","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNBSMG1MOHV:00000008","TimeStamp":"2019-06-08T07:50:04.0000000Z","ProcessId":17888,"LocalIpAddress":"127.0.0.1:21787","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-08 15:50:04.058 +08:00 [DBG] Resource owner password token request validation success.
2019-06-08 15:50:04.061 +08:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"1223138295@qq.com","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"1223138295@qq.com","password":"***REDACTED***","scope":"api1","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-06-08 15:50:04.067 +08:00 [DBG] Getting claims for access token for client: ro.client
2019-06-08 15:50:04.067 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-06-08 15:50:04.094 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-08 15:50:04.112 +08:00 [INF] {"ClientId":"ro.client","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"api1","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****0gMA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNBSMG1MOHV:00000008","TimeStamp":"2019-06-08T07:50:04.0000000Z","ProcessId":17888,"LocalIpAddress":"127.0.0.1:21787","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-08 15:50:04.112 +08:00 [DBG] Token request success.
2019-06-08 15:50:36.829 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-08 15:50:36.838 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-08 15:50:36.839 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-08 15:50:36.839 +08:00 [DBG] Start discovery request
2019-06-08 15:50:37.653 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-08 15:50:37.712 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-08 15:50:37.713 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-08 15:50:37.713 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-08 15:50:37.714 +08:00 [DBG] Start key discovery request
2019-06-08 15:50:40.229 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-08 15:50:40.243 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-08 15:50:40.244 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-08 15:50:40.244 +08:00 [DBG] Start token request.
2019-06-08 15:50:40.244 +08:00 [DBG] Start client validation
2019-06-08 15:50:40.244 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-08 15:50:40.244 +08:00 [DBG] Start parsing for secret in post body
2019-06-08 15:50:40.245 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-08 15:50:40.246 +08:00 [DBG] Secret id found: ro.client
2019-06-08 15:50:41.513 +08:00 [DBG] ro.client found in database: true
2019-06-08 15:50:41.513 +08:00 [DBG] client configuration validation for client ro.client succeeded.
2019-06-08 15:50:41.513 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-08 15:50:41.513 +08:00 [DBG] Client validation success
2019-06-08 15:50:41.513 +08:00 [INF] {"ClientId":"ro.client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNBSMG1MOHV:0000000B","TimeStamp":"2019-06-08T07:50:41.0000000Z","ProcessId":17888,"LocalIpAddress":"127.0.0.1:21787","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-08 15:50:41.514 +08:00 [DBG] Start token request validation
2019-06-08 15:50:41.514 +08:00 [DBG] Start resource owner password token request validation
2019-06-08 15:50:41.650 +08:00 [DBG] Found [] identity scopes in database
2019-06-08 15:50:42.299 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-08 15:50:42.432 +08:00 [DBG] Found [] identity scopes in database
2019-06-08 15:50:43.067 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-08 15:50:43.210 +08:00 [INF] Credentials validated for username: 1223138295@qq.com
2019-06-08 15:50:43.211 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Endpoint":"Token","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNBSMG1MOHV:0000000B","TimeStamp":"2019-06-08T07:50:43.0000000Z","ProcessId":17888,"LocalIpAddress":"127.0.0.1:21787","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-08 15:50:43.211 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":null,"Endpoint":"Token","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNBSMG1MOHV:0000000B","TimeStamp":"2019-06-08T07:50:43.0000000Z","ProcessId":17888,"LocalIpAddress":"127.0.0.1:21787","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-08 15:50:43.211 +08:00 [DBG] Resource owner password token request validation success.
2019-06-08 15:50:43.211 +08:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"1223138295@qq.com","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"1223138295@qq.com","password":"***REDACTED***","scope":"api1","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-06-08 15:50:43.212 +08:00 [DBG] Getting claims for access token for client: ro.client
2019-06-08 15:50:43.212 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-06-08 15:50:43.212 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-08 15:50:43.218 +08:00 [INF] {"ClientId":"ro.client","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"api1","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****xVYA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNBSMG1MOHV:0000000B","TimeStamp":"2019-06-08T07:50:43.0000000Z","ProcessId":17888,"LocalIpAddress":"127.0.0.1:21787","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-08 15:50:43.218 +08:00 [DBG] Token request success.
2019-06-10 16:03:59.238 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-10 16:03:59.289 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-10 16:03:59.289 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-10 16:03:59.289 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-10 16:03:59.289 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-10 16:03:59.289 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-10 16:04:00.029 +08:00 [DBG] Starting grant removal
2019-06-10 16:04:00.554 +08:00 [DBG] Login Url: /Account/Login
2019-06-10 16:04:00.558 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-10 16:04:00.558 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-10 16:04:00.558 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-10 16:04:00.558 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-10 16:04:00.558 +08:00 [DBG] Error Url: /home/error
2019-06-10 16:04:00.558 +08:00 [DBG] Error Id Parameter: errorId
2019-06-10 16:04:38.502 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-10 16:04:38.514 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-10 16:04:38.514 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-10 16:04:38.518 +08:00 [DBG] Start discovery request
2019-06-10 16:04:40.035 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-10 16:04:40.358 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-10 16:04:40.359 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-10 16:04:40.369 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-10 16:04:40.373 +08:00 [DBG] Start key discovery request
2019-06-10 16:04:40.515 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 16:04:40.519 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 16:04:40.519 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 16:04:40.523 +08:00 [DBG] Start authorize request
2019-06-10 16:04:40.536 +08:00 [DBG] No user present in authorize request
2019-06-10 16:04:40.542 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 16:04:42.086 +08:00 [DBG] mvcImp found in database: true
2019-06-10 16:04:42.101 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 16:04:42.123 +08:00 [ERR] Invalid redirect_uri: http://localhost:5004/signin-oidc
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":null,"AllowedRedirectUris":["http://129.204.217.190:5004/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957506804308375.NDMzOTk0OWMtNjgyZS00YTliLWIzZGQtNjEyZWMwMzcwNGE5ZjJkNjVkZGYtYTJmMy00NGJlLTk4NWMtN2QwNGZlMDgyY2Yx","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrP40cc207n8DHJITJ9FZxhmEUFRA0owtkWohEdUQzyTlXc9aipP_a4xCi7qbo-i1-pxK6-N22lSurQx5ubmwPBHyl-U8TBwbVfyZdh2wxRhwiKxYArD_Iu6AU8mgYz69_S1ugCmB3xYHZthwcqVBrIqgUiF-MB75w4FTI7BiHOlOqKX-tJCreqo-v3jLDtlaxYwKLdMpE8cR1YUCCEncLBiZaubB0PjLYqmbXULjP5t3W59MFzJeX9nHLUc6M4axOBRi-dhGj4UayHkmRoiAaOW-hsckG-BUjfQLvBliH_u6D-rQ6pWahJxBIOWPqHuSQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 16:04:42.130 +08:00 [ERR] Request validation failed
2019-06-10 16:04:42.131 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":null,"AllowedRedirectUris":["http://129.204.217.190:5004/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957506804308375.NDMzOTk0OWMtNjgyZS00YTliLWIzZGQtNjEyZWMwMzcwNGE5ZjJkNjVkZGYtYTJmMy00NGJlLTk4NWMtN2QwNGZlMDgyY2Yx","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrP40cc207n8DHJITJ9FZxhmEUFRA0owtkWohEdUQzyTlXc9aipP_a4xCi7qbo-i1-pxK6-N22lSurQx5ubmwPBHyl-U8TBwbVfyZdh2wxRhwiKxYArD_Iu6AU8mgYz69_S1ugCmB3xYHZthwcqVBrIqgUiF-MB75w4FTI7BiHOlOqKX-tJCreqo-v3jLDtlaxYwKLdMpE8cR1YUCCEncLBiZaubB0PjLYqmbXULjP5t3W59MFzJeX9nHLUc6M4axOBRi-dhGj4UayHkmRoiAaOW-hsckG-BUjfQLvBliH_u6D-rQ6pWahJxBIOWPqHuSQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 16:04:42.143 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLNDF8P1G31D:00000006","TimeStamp":"2019-06-10T08:04:42.0000000Z","ProcessId":33720,"LocalIpAddress":"127.0.0.1:36343","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-06-10 16:06:48.220 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-10 16:06:48.220 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-10 16:06:48.220 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-10 16:06:48.220 +08:00 [DBG] Start discovery request
2019-06-10 16:06:48.949 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-10 16:06:49.146 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-10 16:06:49.146 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-10 16:06:49.146 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-10 16:06:49.147 +08:00 [DBG] Start key discovery request
2019-06-10 16:06:49.211 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 16:06:49.211 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 16:06:49.211 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 16:06:49.212 +08:00 [DBG] Start authorize request
2019-06-10 16:06:49.212 +08:00 [DBG] No user present in authorize request
2019-06-10 16:06:49.212 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 16:06:50.416 +08:00 [DBG] mvcImp found in database: true
2019-06-10 16:06:50.416 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 16:06:50.416 +08:00 [ERR] Invalid redirect_uri: http://localhost:5004/signin-oidc
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":null,"AllowedRedirectUris":["http://129.204.217.190:5004/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957508091762423.ZDBkMzI5ODQtYjZiYS00ZTJjLTg3MWYtM2JkODM3OGNmZjFhMjBlYTJlZWItZGUwYS00YTI2LThkNjgtZDQ3MjdjOWZlODI1","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqbJjFu-CixPCxP69bqkYTwaa1MTUs2YMqFDWec9huS25a-_8XcNVxGdncjlVDAjMwgXhTnvDlsSByGHA_WkwGaFuvAiEs96dIUtnQvW_B5BPtgxJibzuXWYQMAVU9CE-A4bs5YfdDp7Xaxyxf9pso5gnqu7XAAfCnvLSWMOTViYQgkr-so09RqVRAdqsq4CvhZebnZ6-x__JnZzyAiXfFmpPFlEEwhgxUFutEGuuLyK09NrIdQEOXXigjCd8Gsmhs2_dIeYXpAp_YUhdyllJ3lTuOoYQb4il26cvPju5OFD8Hxm_yT2aK_KFt83s07h3k","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 16:06:50.416 +08:00 [ERR] Request validation failed
2019-06-10 16:06:50.416 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":null,"AllowedRedirectUris":["http://129.204.217.190:5004/signin-oidc"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957508091762423.ZDBkMzI5ODQtYjZiYS00ZTJjLTg3MWYtM2JkODM3OGNmZjFhMjBlYTJlZWItZGUwYS00YTI2LThkNjgtZDQ3MjdjOWZlODI1","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqbJjFu-CixPCxP69bqkYTwaa1MTUs2YMqFDWec9huS25a-_8XcNVxGdncjlVDAjMwgXhTnvDlsSByGHA_WkwGaFuvAiEs96dIUtnQvW_B5BPtgxJibzuXWYQMAVU9CE-A4bs5YfdDp7Xaxyxf9pso5gnqu7XAAfCnvLSWMOTViYQgkr-so09RqVRAdqsq4CvhZebnZ6-x__JnZzyAiXfFmpPFlEEwhgxUFutEGuuLyK09NrIdQEOXXigjCd8Gsmhs2_dIeYXpAp_YUhdyllJ3lTuOoYQb4il26cvPju5OFD8Hxm_yT2aK_KFt83s07h3k","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 16:06:50.417 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":null,"Endpoint":"Authorize","SubjectId":null,"Scopes":"","GrantType":null,"Error":"unauthorized_client","ErrorDescription":"Invalid redirect_uri","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLNDF8P1G31F:00000003","TimeStamp":"2019-06-10T08:06:50.0000000Z","ProcessId":33720,"LocalIpAddress":"127.0.0.1:36343","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-06-10 16:08:05.137 +08:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-06-10 17:16:13.451 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-10 17:16:13.497 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-10 17:16:13.497 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-10 17:16:13.497 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-10 17:16:13.497 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-10 17:16:13.497 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-10 17:16:13.945 +08:00 [DBG] Starting grant removal
2019-06-10 17:16:14.227 +08:00 [DBG] Login Url: /Account/Login
2019-06-10 17:16:14.230 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-10 17:16:14.230 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-10 17:16:14.230 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-10 17:16:14.230 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-10 17:16:14.230 +08:00 [DBG] Error Url: /home/error
2019-06-10 17:16:14.230 +08:00 [DBG] Error Id Parameter: errorId
2019-06-10 17:18:21.831 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-10 17:18:21.863 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-10 17:18:21.863 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-10 17:18:21.863 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-10 17:18:21.864 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-10 17:18:21.864 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-10 17:18:22.329 +08:00 [DBG] Starting grant removal
2019-06-10 17:18:22.698 +08:00 [DBG] Login Url: /Account/Login
2019-06-10 17:18:22.700 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-10 17:18:22.701 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-10 17:18:22.701 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-10 17:18:22.701 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-10 17:18:22.701 +08:00 [DBG] Error Url: /home/error
2019-06-10 17:18:22.701 +08:00 [DBG] Error Id Parameter: errorId
2019-06-10 17:22:52.728 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-10 17:22:52.743 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-10 17:22:52.744 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-10 17:22:52.751 +08:00 [DBG] Start discovery request
2019-06-10 17:22:53.895 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-10 17:22:54.197 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-10 17:22:54.201 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-10 17:22:54.201 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-10 17:22:54.205 +08:00 [DBG] Start key discovery request
2019-06-10 17:22:54.305 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 17:22:54.310 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 17:22:54.311 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 17:22:54.314 +08:00 [DBG] Start authorize request
2019-06-10 17:22:54.323 +08:00 [DBG] No user present in authorize request
2019-06-10 17:22:54.334 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 17:22:55.644 +08:00 [DBG] mvcImp found in database: true
2019-06-10 17:22:55.652 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 17:22:55.896 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:22:56.038 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:22:56.227 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:22:56.362 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:22:56.370 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 17:22:56.384 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"anonymous","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IplrgIQPKRUtD2T3DFLr8DftrrKHuM_Ekxe01aN7hxFq87hkOF45kpZJjExdMrY9Ct1xRPJjA_UPFvcgOEoz6yRDrsfHMBsdg8tW4237UfTwYJxxHxGuidKchj0EdGHXTNr087sGE93uf9xBDzsTM0kOI5rCfeqVLYJrxxn5fDedH4Yq6NHsf-O6MOwp4jguVNvArRHys32rcKYfUSe4uiCGWRnPqZsCvTxhp20mIseiAo2LSABkkoZUBXdsm2BErooFIjSyk0ZXRKTAK9DUqIiyEXtBu3PSl1TuKBks3aY1ZcCqVPCJXCRIUxdYYjWgI8","UiLocales":null,"Nonce":"636957553742527996.ZTk1M2E3Y2QtNjhkYi00Mzc5LWJkMGUtMjRiNDg1ODkyMWFhNmNiZmFiMzYtOTdkZS00NTlhLTgyOTktNjk2ODQwMzJhNDQz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957553742527996.ZTk1M2E3Y2QtNjhkYi00Mzc5LWJkMGUtMjRiNDg1ODkyMWFhNmNiZmFiMzYtOTdkZS00NTlhLTgyOTktNjk2ODQwMzJhNDQz","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IplrgIQPKRUtD2T3DFLr8DftrrKHuM_Ekxe01aN7hxFq87hkOF45kpZJjExdMrY9Ct1xRPJjA_UPFvcgOEoz6yRDrsfHMBsdg8tW4237UfTwYJxxHxGuidKchj0EdGHXTNr087sGE93uf9xBDzsTM0kOI5rCfeqVLYJrxxn5fDedH4Yq6NHsf-O6MOwp4jguVNvArRHys32rcKYfUSe4uiCGWRnPqZsCvTxhp20mIseiAo2LSABkkoZUBXdsm2BErooFIjSyk0ZXRKTAK9DUqIiyEXtBu3PSl1TuKBks3aY1ZcCqVPCJXCRIUxdYYjWgI8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 17:22:56.396 +08:00 [INF] Showing login: User is not authenticated
2019-06-10 17:22:56.562 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 17:22:57.834 +08:00 [DBG] mvcImp found in database: true
2019-06-10 17:22:57.834 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 17:22:58.036 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:22:58.164 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:22:58.366 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:22:58.488 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:22:58.488 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 17:22:59.561 +08:00 [DBG] mvcImp found in database: true
2019-06-10 17:22:59.561 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 17:23:37.952 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-10 17:23:38.063 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 17:23:39.138 +08:00 [DBG] mvcImp found in database: true
2019-06-10 17:23:39.138 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 17:23:39.335 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:23:39.445 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:23:39.629 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:23:39.742 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:23:39.742 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 17:23:40.018 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"1223138295@qq.com","DisplayName":"shawn","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNDGIATU5C7:00000005","TimeStamp":"2019-06-10T09:23:40.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-10 17:23:40.351 +08:00 [DBG] Augmenting SignInContext
2019-06-10 17:23:40.353 +08:00 [DBG] Adding idp claim with value: local
2019-06-10 17:23:40.353 +08:00 [DBG] Adding amr claim with value: pwd
2019-06-10 17:23:40.354 +08:00 [DBG] Adding auth_time claim with value: 1560158620
2019-06-10 17:23:40.367 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-10 17:23:40.409 +08:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-10 17:23:40.409 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-10 17:23:40.409 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-10 17:23:40.415 +08:00 [DBG] Start authorize callback request
2019-06-10 17:23:40.421 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-10 17:23:40.421 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 17:23:41.527 +08:00 [DBG] mvcImp found in database: true
2019-06-10 17:23:41.527 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 17:23:41.712 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:23:41.829 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:23:42.007 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:23:42.118 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:23:42.118 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 17:23:42.118 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IplrgIQPKRUtD2T3DFLr8DftrrKHuM_Ekxe01aN7hxFq87hkOF45kpZJjExdMrY9Ct1xRPJjA_UPFvcgOEoz6yRDrsfHMBsdg8tW4237UfTwYJxxHxGuidKchj0EdGHXTNr087sGE93uf9xBDzsTM0kOI5rCfeqVLYJrxxn5fDedH4Yq6NHsf-O6MOwp4jguVNvArRHys32rcKYfUSe4uiCGWRnPqZsCvTxhp20mIseiAo2LSABkkoZUBXdsm2BErooFIjSyk0ZXRKTAK9DUqIiyEXtBu3PSl1TuKBks3aY1ZcCqVPCJXCRIUxdYYjWgI8","UiLocales":null,"Nonce":"636957553742527996.ZTk1M2E3Y2QtNjhkYi00Mzc5LWJkMGUtMjRiNDg1ODkyMWFhNmNiZmFiMzYtOTdkZS00NTlhLTgyOTktNjk2ODQwMzJhNDQz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957553742527996.ZTk1M2E3Y2QtNjhkYi00Mzc5LWJkMGUtMjRiNDg1ODkyMWFhNmNiZmFiMzYtOTdkZS00NTlhLTgyOTktNjk2ODQwMzJhNDQz","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IplrgIQPKRUtD2T3DFLr8DftrrKHuM_Ekxe01aN7hxFq87hkOF45kpZJjExdMrY9Ct1xRPJjA_UPFvcgOEoz6yRDrsfHMBsdg8tW4237UfTwYJxxHxGuidKchj0EdGHXTNr087sGE93uf9xBDzsTM0kOI5rCfeqVLYJrxxn5fDedH4Yq6NHsf-O6MOwp4jguVNvArRHys32rcKYfUSe4uiCGWRnPqZsCvTxhp20mIseiAo2LSABkkoZUBXdsm2BErooFIjSyk0ZXRKTAK9DUqIiyEXtBu3PSl1TuKBks3aY1ZcCqVPCJXCRIUxdYYjWgI8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 17:23:42.384 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-10 17:23:42.391 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-10 17:23:42.399 +08:00 [DBG] Creating Implicit Flow response.
2019-06-10 17:23:42.407 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-10 17:23:42.418 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-10 17:23:42.536 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****9TLA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNDGIATU5C7:00000006","TimeStamp":"2019-06-10T09:23:42.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-10 17:23:42.539 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IplrgIQPKRUtD2T3DFLr8DftrrKHuM_Ekxe01aN7hxFq87hkOF45kpZJjExdMrY9Ct1xRPJjA_UPFvcgOEoz6yRDrsfHMBsdg8tW4237UfTwYJxxHxGuidKchj0EdGHXTNr087sGE93uf9xBDzsTM0kOI5rCfeqVLYJrxxn5fDedH4Yq6NHsf-O6MOwp4jguVNvArRHys32rcKYfUSe4uiCGWRnPqZsCvTxhp20mIseiAo2LSABkkoZUBXdsm2BErooFIjSyk0ZXRKTAK9DUqIiyEXtBu3PSl1TuKBks3aY1ZcCqVPCJXCRIUxdYYjWgI8","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-10 17:23:42.565 +08:00 [DBG] Augmenting SignInContext
2019-06-10 17:23:42.566 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-10 17:27:57.399 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-10 17:27:57.407 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-10 17:27:57.407 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-10 17:27:57.408 +08:00 [DBG] Start discovery request
2019-06-10 17:27:58.301 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-10 17:27:58.523 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-10 17:27:58.524 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-10 17:27:58.524 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-10 17:27:58.524 +08:00 [DBG] Start key discovery request
2019-06-10 17:27:58.630 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 17:27:58.630 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 17:27:58.631 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 17:27:58.631 +08:00 [DBG] Start authorize request
2019-06-10 17:27:58.631 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-10 17:27:58.631 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 17:27:59.798 +08:00 [DBG] mvcImp found in database: true
2019-06-10 17:27:59.799 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 17:28:00.005 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:28:00.130 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:28:00.334 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:28:00.457 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:28:00.457 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 17:28:00.457 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqdPI7Pwp-Q3I-p5ok51jH3Kpm3eSpko6-y5aerI6_7VV6PCo2OdTijioU4B6uQh5CIaTW5-3Uy2Ad9e6Ce9g1DevaO6CKuFlcZ58zWwEkIAwPN10R2f1B3RH5tSp2dUuU5UECDKwS_rp00MsLAtm9oxsaIE3dTgM3RezC-VsBkMVtnec_EVjFkswGN2EZlSBSlSa2Zj0fJsXI7TZv44qV1CHMHLDIDs9jgE6KF56s6NiePTmLnVQaCm1ZWUTbQmQSncU4-SlV-UYmARXnmv-2HpCxYaAJ-HYB7xq59T0C1yIzbangkFUDInyPVoYEPSDA","UiLocales":null,"Nonce":"636957556785570006.ZDdhMTM0YWMtYTQ0OS00OTUxLTgwYTUtMzk2NTc4MzNiNjNmNTQzN2QyYjYtZDMxZS00NmYwLTg5NjctYWM2MzBmN2JjYWE3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957556785570006.ZDdhMTM0YWMtYTQ0OS00OTUxLTgwYTUtMzk2NTc4MzNiNjNmNTQzN2QyYjYtZDMxZS00NmYwLTg5NjctYWM2MzBmN2JjYWE3","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqdPI7Pwp-Q3I-p5ok51jH3Kpm3eSpko6-y5aerI6_7VV6PCo2OdTijioU4B6uQh5CIaTW5-3Uy2Ad9e6Ce9g1DevaO6CKuFlcZ58zWwEkIAwPN10R2f1B3RH5tSp2dUuU5UECDKwS_rp00MsLAtm9oxsaIE3dTgM3RezC-VsBkMVtnec_EVjFkswGN2EZlSBSlSa2Zj0fJsXI7TZv44qV1CHMHLDIDs9jgE6KF56s6NiePTmLnVQaCm1ZWUTbQmQSncU4-SlV-UYmARXnmv-2HpCxYaAJ-HYB7xq59T0C1yIzbangkFUDInyPVoYEPSDA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 17:28:00.695 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-10 17:28:00.698 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-10 17:28:00.698 +08:00 [DBG] Creating Implicit Flow response.
2019-06-10 17:28:00.699 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-10 17:28:00.699 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-10 17:28:00.705 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****sgtg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNDGIATU5C8:00000003","TimeStamp":"2019-06-10T09:28:00.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-10 17:28:00.706 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqdPI7Pwp-Q3I-p5ok51jH3Kpm3eSpko6-y5aerI6_7VV6PCo2OdTijioU4B6uQh5CIaTW5-3Uy2Ad9e6Ce9g1DevaO6CKuFlcZ58zWwEkIAwPN10R2f1B3RH5tSp2dUuU5UECDKwS_rp00MsLAtm9oxsaIE3dTgM3RezC-VsBkMVtnec_EVjFkswGN2EZlSBSlSa2Zj0fJsXI7TZv44qV1CHMHLDIDs9jgE6KF56s6NiePTmLnVQaCm1ZWUTbQmQSncU4-SlV-UYmARXnmv-2HpCxYaAJ-HYB7xq59T0C1yIzbangkFUDInyPVoYEPSDA","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-10 17:28:00.716 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 17:28:00.716 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 17:28:00.716 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 17:28:00.716 +08:00 [DBG] Start authorize request
2019-06-10 17:28:00.717 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-10 17:28:00.717 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 17:28:01.885 +08:00 [DBG] mvcImp found in database: true
2019-06-10 17:28:01.885 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 17:28:02.093 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:28:02.221 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:28:02.446 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:28:02.569 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:28:02.569 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 17:28:02.569 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqdPI7Pwp-Q3I-p5ok51jH3Kpm3eSpko6-y5aerI6_7VV6PCo2OdTijioU4B6uQh5CIaTW5-3Uy2Ad9e6Ce9g1DevaO6CKuFlcZ58zWwEkIAwPN10R2f1B3RH5tSp2dUuU5UECDKwS_rp00MsLAtm9oxsaIE3dTgM3RezC-VsBkMVtnec_EVjFkswGN2EZlSBSlSa2Zj0fJsXI7TZv44qV1CHMHLDIDs9jgE6KF56s6NiePTmLnVQaCm1ZWUTbQmQSncU4-SlV-UYmARXnmv-2HpCxYaAJ-HYB7xq59T0C1yIzbangkFUDInyPVoYEPSDA","UiLocales":null,"Nonce":"636957556785570006.ZDdhMTM0YWMtYTQ0OS00OTUxLTgwYTUtMzk2NTc4MzNiNjNmNTQzN2QyYjYtZDMxZS00NmYwLTg5NjctYWM2MzBmN2JjYWE3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957556785570006.ZDdhMTM0YWMtYTQ0OS00OTUxLTgwYTUtMzk2NTc4MzNiNjNmNTQzN2QyYjYtZDMxZS00NmYwLTg5NjctYWM2MzBmN2JjYWE3","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqdPI7Pwp-Q3I-p5ok51jH3Kpm3eSpko6-y5aerI6_7VV6PCo2OdTijioU4B6uQh5CIaTW5-3Uy2Ad9e6Ce9g1DevaO6CKuFlcZ58zWwEkIAwPN10R2f1B3RH5tSp2dUuU5UECDKwS_rp00MsLAtm9oxsaIE3dTgM3RezC-VsBkMVtnec_EVjFkswGN2EZlSBSlSa2Zj0fJsXI7TZv44qV1CHMHLDIDs9jgE6KF56s6NiePTmLnVQaCm1ZWUTbQmQSncU4-SlV-UYmARXnmv-2HpCxYaAJ-HYB7xq59T0C1yIzbangkFUDInyPVoYEPSDA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 17:28:02.834 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-10 17:28:02.837 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-10 17:28:02.837 +08:00 [DBG] Creating Implicit Flow response.
2019-06-10 17:28:02.837 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-10 17:28:02.837 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-10 17:28:02.841 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****6bcA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNDGIATU5C8:00000004","TimeStamp":"2019-06-10T09:28:02.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-10 17:28:02.842 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqdPI7Pwp-Q3I-p5ok51jH3Kpm3eSpko6-y5aerI6_7VV6PCo2OdTijioU4B6uQh5CIaTW5-3Uy2Ad9e6Ce9g1DevaO6CKuFlcZ58zWwEkIAwPN10R2f1B3RH5tSp2dUuU5UECDKwS_rp00MsLAtm9oxsaIE3dTgM3RezC-VsBkMVtnec_EVjFkswGN2EZlSBSlSa2Zj0fJsXI7TZv44qV1CHMHLDIDs9jgE6KF56s6NiePTmLnVQaCm1ZWUTbQmQSncU4-SlV-UYmARXnmv-2HpCxYaAJ-HYB7xq59T0C1yIzbangkFUDInyPVoYEPSDA","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-10 17:38:28.522 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-10 17:38:28.523 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-10 17:38:28.524 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-10 17:38:28.524 +08:00 [DBG] Start discovery request
2019-06-10 17:38:29.326 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-10 17:38:29.507 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-10 17:38:29.507 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-10 17:38:29.507 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-10 17:38:29.507 +08:00 [DBG] Start key discovery request
2019-06-10 17:38:29.583 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 17:38:29.584 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 17:38:29.584 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 17:38:29.584 +08:00 [DBG] Start authorize request
2019-06-10 17:38:29.584 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-10 17:38:29.584 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 17:38:30.577 +08:00 [DBG] mvcImp found in database: true
2019-06-10 17:38:30.578 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 17:38:30.752 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:38:30.862 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:38:31.039 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:38:31.149 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:38:31.150 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 17:38:31.150 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqN453pS7cQan6W-HrUHSC-gcV8I8-pwfl9QMhG7UxlSsxlYfCX8QvTXQip4nWH1BRHKrppyLtJ663p5hme90vSmHyfK1yU0dVzSH95qAtrn4dw6IgowzJv3fyftXtbEGGWIxQdebgfC2NJoLJoUto3guaeYXzMwzX19cjvupy159K52YG_iomZ-Znr9yeo9jOc0AcbAM-fr5tIK2afDoeasrvsiUcPvBQamn0Qk8rGZWw6j0RXMZOKd22Hs6kZin_wTv2u2eSJsUQynNdqm9F0fcG5oMdsCSAcbfzAckv0QXCyJrKL3ighPSN8oVKPKZY","UiLocales":null,"Nonce":"636957563095545569.NDNmOWFlYWEtNzM1NC00MTc2LWEyZDUtMDE4MjY0ZGI2MzYzYWI2MDEwNDQtYWFmOC00YWQ3LWExZWMtMTc5NGZhN2FjNDAx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957563095545569.NDNmOWFlYWEtNzM1NC00MTc2LWEyZDUtMDE4MjY0ZGI2MzYzYWI2MDEwNDQtYWFmOC00YWQ3LWExZWMtMTc5NGZhN2FjNDAx","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqN453pS7cQan6W-HrUHSC-gcV8I8-pwfl9QMhG7UxlSsxlYfCX8QvTXQip4nWH1BRHKrppyLtJ663p5hme90vSmHyfK1yU0dVzSH95qAtrn4dw6IgowzJv3fyftXtbEGGWIxQdebgfC2NJoLJoUto3guaeYXzMwzX19cjvupy159K52YG_iomZ-Znr9yeo9jOc0AcbAM-fr5tIK2afDoeasrvsiUcPvBQamn0Qk8rGZWw6j0RXMZOKd22Hs6kZin_wTv2u2eSJsUQynNdqm9F0fcG5oMdsCSAcbfzAckv0QXCyJrKL3ighPSN8oVKPKZY","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 17:38:31.385 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-10 17:38:31.389 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-10 17:38:31.389 +08:00 [DBG] Creating Implicit Flow response.
2019-06-10 17:38:31.389 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-10 17:38:31.389 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-10 17:38:31.393 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****H2pw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNDGIATU5C9:00000003","TimeStamp":"2019-06-10T09:38:31.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-10 17:38:31.393 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqN453pS7cQan6W-HrUHSC-gcV8I8-pwfl9QMhG7UxlSsxlYfCX8QvTXQip4nWH1BRHKrppyLtJ663p5hme90vSmHyfK1yU0dVzSH95qAtrn4dw6IgowzJv3fyftXtbEGGWIxQdebgfC2NJoLJoUto3guaeYXzMwzX19cjvupy159K52YG_iomZ-Znr9yeo9jOc0AcbAM-fr5tIK2afDoeasrvsiUcPvBQamn0Qk8rGZWw6j0RXMZOKd22Hs6kZin_wTv2u2eSJsUQynNdqm9F0fcG5oMdsCSAcbfzAckv0QXCyJrKL3ighPSN8oVKPKZY","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-10 17:38:31.404 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 17:38:31.405 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 17:38:31.405 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 17:38:31.405 +08:00 [DBG] Start authorize request
2019-06-10 17:38:31.405 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-10 17:38:31.405 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 17:38:32.385 +08:00 [DBG] mvcImp found in database: true
2019-06-10 17:38:32.385 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 17:38:32.552 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:38:32.662 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:38:32.860 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:38:32.971 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:38:32.971 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 17:38:32.971 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqN453pS7cQan6W-HrUHSC-gcV8I8-pwfl9QMhG7UxlSsxlYfCX8QvTXQip4nWH1BRHKrppyLtJ663p5hme90vSmHyfK1yU0dVzSH95qAtrn4dw6IgowzJv3fyftXtbEGGWIxQdebgfC2NJoLJoUto3guaeYXzMwzX19cjvupy159K52YG_iomZ-Znr9yeo9jOc0AcbAM-fr5tIK2afDoeasrvsiUcPvBQamn0Qk8rGZWw6j0RXMZOKd22Hs6kZin_wTv2u2eSJsUQynNdqm9F0fcG5oMdsCSAcbfzAckv0QXCyJrKL3ighPSN8oVKPKZY","UiLocales":null,"Nonce":"636957563095545569.NDNmOWFlYWEtNzM1NC00MTc2LWEyZDUtMDE4MjY0ZGI2MzYzYWI2MDEwNDQtYWFmOC00YWQ3LWExZWMtMTc5NGZhN2FjNDAx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957563095545569.NDNmOWFlYWEtNzM1NC00MTc2LWEyZDUtMDE4MjY0ZGI2MzYzYWI2MDEwNDQtYWFmOC00YWQ3LWExZWMtMTc5NGZhN2FjNDAx","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqN453pS7cQan6W-HrUHSC-gcV8I8-pwfl9QMhG7UxlSsxlYfCX8QvTXQip4nWH1BRHKrppyLtJ663p5hme90vSmHyfK1yU0dVzSH95qAtrn4dw6IgowzJv3fyftXtbEGGWIxQdebgfC2NJoLJoUto3guaeYXzMwzX19cjvupy159K52YG_iomZ-Znr9yeo9jOc0AcbAM-fr5tIK2afDoeasrvsiUcPvBQamn0Qk8rGZWw6j0RXMZOKd22Hs6kZin_wTv2u2eSJsUQynNdqm9F0fcG5oMdsCSAcbfzAckv0QXCyJrKL3ighPSN8oVKPKZY","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 17:38:33.191 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-10 17:38:33.195 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-10 17:38:33.196 +08:00 [DBG] Creating Implicit Flow response.
2019-06-10 17:38:33.196 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-10 17:38:33.196 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-10 17:38:33.201 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****ExiA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNDGIATU5C9:00000004","TimeStamp":"2019-06-10T09:38:33.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-10 17:38:33.201 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqN453pS7cQan6W-HrUHSC-gcV8I8-pwfl9QMhG7UxlSsxlYfCX8QvTXQip4nWH1BRHKrppyLtJ663p5hme90vSmHyfK1yU0dVzSH95qAtrn4dw6IgowzJv3fyftXtbEGGWIxQdebgfC2NJoLJoUto3guaeYXzMwzX19cjvupy159K52YG_iomZ-Znr9yeo9jOc0AcbAM-fr5tIK2afDoeasrvsiUcPvBQamn0Qk8rGZWw6j0RXMZOKd22Hs6kZin_wTv2u2eSJsUQynNdqm9F0fcG5oMdsCSAcbfzAckv0QXCyJrKL3ighPSN8oVKPKZY","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-10 17:56:24.282 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-10 17:56:24.283 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-10 17:56:24.283 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-10 17:56:24.283 +08:00 [DBG] Start discovery request
2019-06-10 17:56:25.091 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-10 17:56:25.290 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-10 17:56:25.294 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-10 17:56:25.294 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-10 17:56:25.294 +08:00 [DBG] Start key discovery request
2019-06-10 17:56:25.719 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 17:56:25.719 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 17:56:25.720 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 17:56:25.720 +08:00 [DBG] Start authorize request
2019-06-10 17:56:25.720 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-10 17:56:25.720 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 17:56:26.741 +08:00 [DBG] mvcImp found in database: true
2019-06-10 17:56:26.741 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 17:56:26.832 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 17:56:26.832 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 17:56:26.833 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 17:56:26.833 +08:00 [DBG] Start authorize request
2019-06-10 17:56:26.833 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-10 17:56:26.833 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 17:56:26.913 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:56:27.019 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:56:27.204 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:56:27.307 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:56:27.307 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 17:56:27.307 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqmCrgu2yeTpKOOTUxZpclYnA_W-2MtIdRD3Wmcy_45RMf6PpcUjkE18aj8SN_B2ahjJPrsJtf1f4_olH1ruIAlrSExWgaUagDIDRWd2TikVF23HrduGBeQPVh24RRfSl0oc4b5pK9LzFQTAzRxTjKlF3gkGMk-Ah3nFeAx50_6pkT0dlCmcFLOtc11U-02BElTWV3e_5eWxeG7wojZ20FKjeT8qRFANB-2IwmbX-kuXQDNsNVfCqx9Vj8Q6DADrIUXORWf9URT6pFdoSH0X_Az36ws3Spm0NFHqvxrCmLx5vBNzwkZlDacziOV0lK7oBs","UiLocales":null,"Nonce":"636957573853299168.NWRkNWU2NzUtZDkwMC00YmNkLWE1NmItNzNmY2NjMDdkZjA3MWUzYjUyNDYtMWYzYy00YWI1LWE0ZjMtZGExNzZhOTVhYzBk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957573853299168.NWRkNWU2NzUtZDkwMC00YmNkLWE1NmItNzNmY2NjMDdkZjA3MWUzYjUyNDYtMWYzYy00YWI1LWE0ZjMtZGExNzZhOTVhYzBk","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqmCrgu2yeTpKOOTUxZpclYnA_W-2MtIdRD3Wmcy_45RMf6PpcUjkE18aj8SN_B2ahjJPrsJtf1f4_olH1ruIAlrSExWgaUagDIDRWd2TikVF23HrduGBeQPVh24RRfSl0oc4b5pK9LzFQTAzRxTjKlF3gkGMk-Ah3nFeAx50_6pkT0dlCmcFLOtc11U-02BElTWV3e_5eWxeG7wojZ20FKjeT8qRFANB-2IwmbX-kuXQDNsNVfCqx9Vj8Q6DADrIUXORWf9URT6pFdoSH0X_Az36ws3Spm0NFHqvxrCmLx5vBNzwkZlDacziOV0lK7oBs","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 17:56:27.411 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-10 17:56:27.417 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-10 17:56:27.417 +08:00 [DBG] Creating Implicit Flow response.
2019-06-10 17:56:27.417 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-10 17:56:27.417 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-10 17:56:27.420 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****fNNQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNDGIATU5CA:00000003","TimeStamp":"2019-06-10T09:56:27.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-10 17:56:27.420 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqmCrgu2yeTpKOOTUxZpclYnA_W-2MtIdRD3Wmcy_45RMf6PpcUjkE18aj8SN_B2ahjJPrsJtf1f4_olH1ruIAlrSExWgaUagDIDRWd2TikVF23HrduGBeQPVh24RRfSl0oc4b5pK9LzFQTAzRxTjKlF3gkGMk-Ah3nFeAx50_6pkT0dlCmcFLOtc11U-02BElTWV3e_5eWxeG7wojZ20FKjeT8qRFANB-2IwmbX-kuXQDNsNVfCqx9Vj8Q6DADrIUXORWf9URT6pFdoSH0X_Az36ws3Spm0NFHqvxrCmLx5vBNzwkZlDacziOV0lK7oBs","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-10 17:56:27.818 +08:00 [DBG] mvcImp found in database: true
2019-06-10 17:56:27.819 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 17:56:28.016 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:56:28.119 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:56:28.293 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:56:28.405 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:56:28.406 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 17:56:28.406 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqmCrgu2yeTpKOOTUxZpclYnA_W-2MtIdRD3Wmcy_45RMf6PpcUjkE18aj8SN_B2ahjJPrsJtf1f4_olH1ruIAlrSExWgaUagDIDRWd2TikVF23HrduGBeQPVh24RRfSl0oc4b5pK9LzFQTAzRxTjKlF3gkGMk-Ah3nFeAx50_6pkT0dlCmcFLOtc11U-02BElTWV3e_5eWxeG7wojZ20FKjeT8qRFANB-2IwmbX-kuXQDNsNVfCqx9Vj8Q6DADrIUXORWf9URT6pFdoSH0X_Az36ws3Spm0NFHqvxrCmLx5vBNzwkZlDacziOV0lK7oBs","UiLocales":null,"Nonce":"636957573853299168.NWRkNWU2NzUtZDkwMC00YmNkLWE1NmItNzNmY2NjMDdkZjA3MWUzYjUyNDYtMWYzYy00YWI1LWE0ZjMtZGExNzZhOTVhYzBk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957573853299168.NWRkNWU2NzUtZDkwMC00YmNkLWE1NmItNzNmY2NjMDdkZjA3MWUzYjUyNDYtMWYzYy00YWI1LWE0ZjMtZGExNzZhOTVhYzBk","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqmCrgu2yeTpKOOTUxZpclYnA_W-2MtIdRD3Wmcy_45RMf6PpcUjkE18aj8SN_B2ahjJPrsJtf1f4_olH1ruIAlrSExWgaUagDIDRWd2TikVF23HrduGBeQPVh24RRfSl0oc4b5pK9LzFQTAzRxTjKlF3gkGMk-Ah3nFeAx50_6pkT0dlCmcFLOtc11U-02BElTWV3e_5eWxeG7wojZ20FKjeT8qRFANB-2IwmbX-kuXQDNsNVfCqx9Vj8Q6DADrIUXORWf9URT6pFdoSH0X_Az36ws3Spm0NFHqvxrCmLx5vBNzwkZlDacziOV0lK7oBs","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 17:56:28.508 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-10 17:56:28.512 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-10 17:56:28.512 +08:00 [DBG] Creating Implicit Flow response.
2019-06-10 17:56:28.512 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-10 17:56:28.512 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-10 17:56:28.516 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****KfwA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNDGIATU5CB:00000001","TimeStamp":"2019-06-10T09:56:28.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-10 17:56:28.516 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqmCrgu2yeTpKOOTUxZpclYnA_W-2MtIdRD3Wmcy_45RMf6PpcUjkE18aj8SN_B2ahjJPrsJtf1f4_olH1ruIAlrSExWgaUagDIDRWd2TikVF23HrduGBeQPVh24RRfSl0oc4b5pK9LzFQTAzRxTjKlF3gkGMk-Ah3nFeAx50_6pkT0dlCmcFLOtc11U-02BElTWV3e_5eWxeG7wojZ20FKjeT8qRFANB-2IwmbX-kuXQDNsNVfCqx9Vj8Q6DADrIUXORWf9URT6pFdoSH0X_Az36ws3Spm0NFHqvxrCmLx5vBNzwkZlDacziOV0lK7oBs","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-10 17:59:20.974 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-10 17:59:20.975 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-10 17:59:20.975 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-10 17:59:20.975 +08:00 [DBG] Start discovery request
2019-06-10 17:59:21.604 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-10 17:59:21.803 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-10 17:59:21.803 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-10 17:59:21.803 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-10 17:59:21.803 +08:00 [DBG] Start key discovery request
2019-06-10 17:59:21.872 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 17:59:21.872 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 17:59:21.872 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 17:59:21.873 +08:00 [DBG] Start authorize request
2019-06-10 17:59:21.873 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-10 17:59:21.873 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 17:59:22.842 +08:00 [DBG] mvcImp found in database: true
2019-06-10 17:59:22.842 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 17:59:23.027 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:59:23.129 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:59:23.298 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 17:59:23.402 +08:00 [DBG] Found [] API scopes in database
2019-06-10 17:59:23.402 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 17:59:23.402 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iqp08JCzlIfqpRoKhB7oH6dp5YHGnNl7_I2Cn0GVTGHRdTpL5lf0VE_BnYzra2rA7ZZY0Xy5wkis6wRmuiTkq17SrUu9kEMiDqFxaLK84kTOBHaedI4tg8S-O0qZO_SoVAdyDtmITcYsSZHQEvLH2P7nDQ1YN8YoFQfJWqKfddKCDS5iazIKFM8uxT6NNVat0B_j1mF7cEAn5Was3waLvi3YGeBQAg4EL-z4BVVsvamP0O7IGznuWflBOzgutQ8QH-E3pGlOPDFJUKJ1txlFV3Q_-in_VYs-qBhC5ZUswnh6yQyq8b9k-CiZ-mOz7Hs_GY","UiLocales":null,"Nonce":"636957575618332540.NWRhZTIzZDktNGFjMi00Yjg2LWI0ZjctODkwYTk5YjkyZTc3NzYxNmY4Y2ItNzEzYi00NWY0LThiOTYtM2E1NjdhOGNiMjJm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957575618332540.NWRhZTIzZDktNGFjMi00Yjg2LWI0ZjctODkwYTk5YjkyZTc3NzYxNmY4Y2ItNzEzYi00NWY0LThiOTYtM2E1NjdhOGNiMjJm","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iqp08JCzlIfqpRoKhB7oH6dp5YHGnNl7_I2Cn0GVTGHRdTpL5lf0VE_BnYzra2rA7ZZY0Xy5wkis6wRmuiTkq17SrUu9kEMiDqFxaLK84kTOBHaedI4tg8S-O0qZO_SoVAdyDtmITcYsSZHQEvLH2P7nDQ1YN8YoFQfJWqKfddKCDS5iazIKFM8uxT6NNVat0B_j1mF7cEAn5Was3waLvi3YGeBQAg4EL-z4BVVsvamP0O7IGznuWflBOzgutQ8QH-E3pGlOPDFJUKJ1txlFV3Q_-in_VYs-qBhC5ZUswnh6yQyq8b9k-CiZ-mOz7Hs_GY","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 17:59:23.627 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-10 17:59:23.631 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-10 17:59:23.631 +08:00 [DBG] Creating Implicit Flow response.
2019-06-10 17:59:23.632 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-10 17:59:23.632 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-10 17:59:23.635 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****idoA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNDGIATU5CC:00000003","TimeStamp":"2019-06-10T09:59:23.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-10 17:59:23.636 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iqp08JCzlIfqpRoKhB7oH6dp5YHGnNl7_I2Cn0GVTGHRdTpL5lf0VE_BnYzra2rA7ZZY0Xy5wkis6wRmuiTkq17SrUu9kEMiDqFxaLK84kTOBHaedI4tg8S-O0qZO_SoVAdyDtmITcYsSZHQEvLH2P7nDQ1YN8YoFQfJWqKfddKCDS5iazIKFM8uxT6NNVat0B_j1mF7cEAn5Was3waLvi3YGeBQAg4EL-z4BVVsvamP0O7IGznuWflBOzgutQ8QH-E3pGlOPDFJUKJ1txlFV3Q_-in_VYs-qBhC5ZUswnh6yQyq8b9k-CiZ-mOz7Hs_GY","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-10 18:09:50.631 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-10 18:09:50.632 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-10 18:09:50.633 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-10 18:09:50.633 +08:00 [DBG] Start discovery request
2019-06-10 18:09:51.452 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-10 18:09:51.632 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-10 18:09:51.633 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-10 18:09:51.633 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-10 18:09:51.633 +08:00 [DBG] Start key discovery request
2019-06-10 18:09:51.700 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 18:09:51.700 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 18:09:51.700 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 18:09:51.701 +08:00 [DBG] Start authorize request
2019-06-10 18:09:51.701 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-10 18:09:51.701 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 18:09:52.689 +08:00 [DBG] mvcImp found in database: true
2019-06-10 18:09:52.689 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 18:09:52.868 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 18:09:52.990 +08:00 [DBG] Found [] API scopes in database
2019-06-10 18:09:53.178 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 18:09:53.278 +08:00 [DBG] Found [] API scopes in database
2019-06-10 18:09:53.278 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 18:09:53.278 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrcLHuyAsolAFV9vD7Bc9tOxSrrydI3YIZYlmXu1OW5_N-qOeXy4x30OdUAZ1-C8P-2A7VKoDTI3VzyGywemrJR3ZodSV6y-4XHEQ4nKycWGghqPd1gEwxTz9uMDz78Yh_D7QIDptz0RIlbllLek0KaaA8s6PZkD9xePzzwxcT821FD6Yh-1QT7cN7U7e48hvcAALFOpTg24-fHhm9aUD8bfl4jLW_agvcwLRayUxqdgI5HQSFuEWmgYTgAYGTwHXPPohiOQ1Pkb54YXj4pvMnzq_yT3oyvM-fNReY1DfkNN-yBtuy41T-yzumGIEIYugg","UiLocales":null,"Nonce":"636957581916611208.N2I0OTg2YmUtZjRlMS00MGJkLTllNTEtNDU3YTIwZWE4YmM5NTY2ZTBmNWUtNTBmMS00MWJkLWIyMDctMTUxNDk0OTBhMmIx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957581916611208.N2I0OTg2YmUtZjRlMS00MGJkLTllNTEtNDU3YTIwZWE4YmM5NTY2ZTBmNWUtNTBmMS00MWJkLWIyMDctMTUxNDk0OTBhMmIx","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrcLHuyAsolAFV9vD7Bc9tOxSrrydI3YIZYlmXu1OW5_N-qOeXy4x30OdUAZ1-C8P-2A7VKoDTI3VzyGywemrJR3ZodSV6y-4XHEQ4nKycWGghqPd1gEwxTz9uMDz78Yh_D7QIDptz0RIlbllLek0KaaA8s6PZkD9xePzzwxcT821FD6Yh-1QT7cN7U7e48hvcAALFOpTg24-fHhm9aUD8bfl4jLW_agvcwLRayUxqdgI5HQSFuEWmgYTgAYGTwHXPPohiOQ1Pkb54YXj4pvMnzq_yT3oyvM-fNReY1DfkNN-yBtuy41T-yzumGIEIYugg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 18:09:53.504 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-10 18:09:53.508 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-10 18:09:53.508 +08:00 [DBG] Creating Implicit Flow response.
2019-06-10 18:09:53.508 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-10 18:09:53.508 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-10 18:09:53.512 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****Bbiw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNDGIATU5CD:00000003","TimeStamp":"2019-06-10T10:09:53.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-10 18:09:53.512 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrcLHuyAsolAFV9vD7Bc9tOxSrrydI3YIZYlmXu1OW5_N-qOeXy4x30OdUAZ1-C8P-2A7VKoDTI3VzyGywemrJR3ZodSV6y-4XHEQ4nKycWGghqPd1gEwxTz9uMDz78Yh_D7QIDptz0RIlbllLek0KaaA8s6PZkD9xePzzwxcT821FD6Yh-1QT7cN7U7e48hvcAALFOpTg24-fHhm9aUD8bfl4jLW_agvcwLRayUxqdgI5HQSFuEWmgYTgAYGTwHXPPohiOQ1Pkb54YXj4pvMnzq_yT3oyvM-fNReY1DfkNN-yBtuy41T-yzumGIEIYugg","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-10 18:09:53.517 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 18:09:53.518 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 18:09:53.518 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 18:09:53.518 +08:00 [DBG] Start authorize request
2019-06-10 18:09:53.519 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-10 18:09:53.519 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 18:09:54.524 +08:00 [DBG] mvcImp found in database: true
2019-06-10 18:09:54.524 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 18:09:54.712 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 18:09:54.823 +08:00 [DBG] Found [] API scopes in database
2019-06-10 18:09:55.004 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 18:09:55.108 +08:00 [DBG] Found [] API scopes in database
2019-06-10 18:09:55.109 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 18:09:55.109 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrcLHuyAsolAFV9vD7Bc9tOxSrrydI3YIZYlmXu1OW5_N-qOeXy4x30OdUAZ1-C8P-2A7VKoDTI3VzyGywemrJR3ZodSV6y-4XHEQ4nKycWGghqPd1gEwxTz9uMDz78Yh_D7QIDptz0RIlbllLek0KaaA8s6PZkD9xePzzwxcT821FD6Yh-1QT7cN7U7e48hvcAALFOpTg24-fHhm9aUD8bfl4jLW_agvcwLRayUxqdgI5HQSFuEWmgYTgAYGTwHXPPohiOQ1Pkb54YXj4pvMnzq_yT3oyvM-fNReY1DfkNN-yBtuy41T-yzumGIEIYugg","UiLocales":null,"Nonce":"636957581916611208.N2I0OTg2YmUtZjRlMS00MGJkLTllNTEtNDU3YTIwZWE4YmM5NTY2ZTBmNWUtNTBmMS00MWJkLWIyMDctMTUxNDk0OTBhMmIx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957581916611208.N2I0OTg2YmUtZjRlMS00MGJkLTllNTEtNDU3YTIwZWE4YmM5NTY2ZTBmNWUtNTBmMS00MWJkLWIyMDctMTUxNDk0OTBhMmIx","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrcLHuyAsolAFV9vD7Bc9tOxSrrydI3YIZYlmXu1OW5_N-qOeXy4x30OdUAZ1-C8P-2A7VKoDTI3VzyGywemrJR3ZodSV6y-4XHEQ4nKycWGghqPd1gEwxTz9uMDz78Yh_D7QIDptz0RIlbllLek0KaaA8s6PZkD9xePzzwxcT821FD6Yh-1QT7cN7U7e48hvcAALFOpTg24-fHhm9aUD8bfl4jLW_agvcwLRayUxqdgI5HQSFuEWmgYTgAYGTwHXPPohiOQ1Pkb54YXj4pvMnzq_yT3oyvM-fNReY1DfkNN-yBtuy41T-yzumGIEIYugg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 18:09:55.337 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-10 18:09:55.341 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-10 18:09:55.341 +08:00 [DBG] Creating Implicit Flow response.
2019-06-10 18:09:55.341 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-10 18:09:55.342 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-10 18:09:55.345 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****2mtg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNDGIATU5CD:00000004","TimeStamp":"2019-06-10T10:09:55.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-10 18:09:55.345 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrcLHuyAsolAFV9vD7Bc9tOxSrrydI3YIZYlmXu1OW5_N-qOeXy4x30OdUAZ1-C8P-2A7VKoDTI3VzyGywemrJR3ZodSV6y-4XHEQ4nKycWGghqPd1gEwxTz9uMDz78Yh_D7QIDptz0RIlbllLek0KaaA8s6PZkD9xePzzwxcT821FD6Yh-1QT7cN7U7e48hvcAALFOpTg24-fHhm9aUD8bfl4jLW_agvcwLRayUxqdgI5HQSFuEWmgYTgAYGTwHXPPohiOQ1Pkb54YXj4pvMnzq_yT3oyvM-fNReY1DfkNN-yBtuy41T-yzumGIEIYugg","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-10 18:11:40.687 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-10 18:11:40.688 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-10 18:11:40.688 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-10 18:11:40.688 +08:00 [DBG] Start discovery request
2019-06-10 18:11:41.340 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-10 18:11:41.521 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-10 18:11:41.522 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-10 18:11:41.522 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-10 18:11:41.522 +08:00 [DBG] Start key discovery request
2019-06-10 18:11:41.584 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 18:11:41.585 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 18:11:41.585 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 18:11:41.585 +08:00 [DBG] Start authorize request
2019-06-10 18:11:41.585 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-10 18:11:41.585 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 18:11:42.632 +08:00 [DBG] mvcImp found in database: true
2019-06-10 18:11:42.632 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 18:11:42.803 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 18:11:42.905 +08:00 [DBG] Found [] API scopes in database
2019-06-10 18:11:43.111 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 18:11:43.226 +08:00 [DBG] Found [] API scopes in database
2019-06-10 18:11:43.226 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 18:11:43.227 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iq7iwnPVUGdw5RAUcnzatpHW0p98MDNvkSzl6gXrOoNnehfTZs8p3sRjYlqKX5fYK1wH2hJAFH5dRocRxt1W7eDEDftJuHbIp0h1h7TXa_a726p9WDJmv3m0P_9B5aqL7kMuOUcYoRLv5VZNRkzTK2ldlTp3ykssAQ6XVVeMBbL7GK6XDvVQB5FVD_wNdFWdEd_tZTFW6YH7j-OLOmm9xa0Cb6wIlSDkqtDOs_RwdxABnst3Y2jAHHPeNg9BvNzQQ0GNUwRQumreOBFjvvYDzAjnnx-nHvCZQjboI-UP4Q0lUwdInTrxCSa_eqQDijgME0","UiLocales":null,"Nonce":"636957583015526864.ZGIzNzQwOWEtNmU0Yy00NmE4LWE4ODctNjJkNjcwNDQ4YWZiMTI1MTA3ZDYtZGFhZC00NWM4LTg3ODQtNDQ2NGE2YzcwOGI2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957583015526864.ZGIzNzQwOWEtNmU0Yy00NmE4LWE4ODctNjJkNjcwNDQ4YWZiMTI1MTA3ZDYtZGFhZC00NWM4LTg3ODQtNDQ2NGE2YzcwOGI2","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iq7iwnPVUGdw5RAUcnzatpHW0p98MDNvkSzl6gXrOoNnehfTZs8p3sRjYlqKX5fYK1wH2hJAFH5dRocRxt1W7eDEDftJuHbIp0h1h7TXa_a726p9WDJmv3m0P_9B5aqL7kMuOUcYoRLv5VZNRkzTK2ldlTp3ykssAQ6XVVeMBbL7GK6XDvVQB5FVD_wNdFWdEd_tZTFW6YH7j-OLOmm9xa0Cb6wIlSDkqtDOs_RwdxABnst3Y2jAHHPeNg9BvNzQQ0GNUwRQumreOBFjvvYDzAjnnx-nHvCZQjboI-UP4Q0lUwdInTrxCSa_eqQDijgME0","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 18:11:43.466 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-10 18:11:43.470 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-10 18:11:43.470 +08:00 [DBG] Creating Implicit Flow response.
2019-06-10 18:11:43.470 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-10 18:11:43.471 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-10 18:11:43.474 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****3LJQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNDGIATU5CE:00000003","TimeStamp":"2019-06-10T10:11:43.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-10 18:11:43.474 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iq7iwnPVUGdw5RAUcnzatpHW0p98MDNvkSzl6gXrOoNnehfTZs8p3sRjYlqKX5fYK1wH2hJAFH5dRocRxt1W7eDEDftJuHbIp0h1h7TXa_a726p9WDJmv3m0P_9B5aqL7kMuOUcYoRLv5VZNRkzTK2ldlTp3ykssAQ6XVVeMBbL7GK6XDvVQB5FVD_wNdFWdEd_tZTFW6YH7j-OLOmm9xa0Cb6wIlSDkqtDOs_RwdxABnst3Y2jAHHPeNg9BvNzQQ0GNUwRQumreOBFjvvYDzAjnnx-nHvCZQjboI-UP4Q0lUwdInTrxCSa_eqQDijgME0","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-10 18:17:46.083 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-10 18:17:46.083 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-10 18:17:46.083 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-10 18:17:46.084 +08:00 [DBG] Start discovery request
2019-06-10 18:17:46.908 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-10 18:17:47.134 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-10 18:17:47.137 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-10 18:17:47.138 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-10 18:17:47.138 +08:00 [DBG] Start key discovery request
2019-06-10 18:17:47.291 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 18:17:47.292 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 18:17:47.292 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 18:17:47.293 +08:00 [DBG] Start authorize request
2019-06-10 18:17:47.293 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-10 18:17:47.293 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 18:17:48.275 +08:00 [DBG] mvcImp found in database: true
2019-06-10 18:17:48.275 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 18:17:48.447 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 18:17:48.549 +08:00 [DBG] Found [] API scopes in database
2019-06-10 18:17:48.722 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 18:17:48.826 +08:00 [DBG] Found [] API scopes in database
2019-06-10 18:17:48.826 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 18:17:48.827 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoV0IiwEQqf3eUOeypcomwoo_DoWtMkyzWi7bR5tbe4JRHt9Z2nr8OojxjmaBUxljnYfNXfJw4uummb7hlL8D9a7F_bGHPy-4cden0n3-3r_zq1DpnbULlqD5NK3-gPgi46olnx0BGGeCA3aS6QtdM-MaVYILbJqCvKTxP2fonrpAWfV5EC2NCCKT7fQxB1dJqOFbVXL8oZTfvp78y4xHg1OsHlfIZyG33E3zdYBHwSCYq_os5yVj0nuxs7qjh8bCXuogIc__BBrq_sEnPy1PdmmJsGqEEnuYuTRdYmKdJ29_df9c-fAxQNfA2qtN9hezw","UiLocales":null,"Nonce":"636957586671797801.ZDdmMTVlYjQtM2ExZS00ZTgzLWFhYTItYjgzNmQ5NDQwZDAwYWY5ZmZjM2ItYjM3Yi00ZmNhLWJmZWEtOTVlNDUxMGRmZDE1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957586671797801.ZDdmMTVlYjQtM2ExZS00ZTgzLWFhYTItYjgzNmQ5NDQwZDAwYWY5ZmZjM2ItYjM3Yi00ZmNhLWJmZWEtOTVlNDUxMGRmZDE1","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoV0IiwEQqf3eUOeypcomwoo_DoWtMkyzWi7bR5tbe4JRHt9Z2nr8OojxjmaBUxljnYfNXfJw4uummb7hlL8D9a7F_bGHPy-4cden0n3-3r_zq1DpnbULlqD5NK3-gPgi46olnx0BGGeCA3aS6QtdM-MaVYILbJqCvKTxP2fonrpAWfV5EC2NCCKT7fQxB1dJqOFbVXL8oZTfvp78y4xHg1OsHlfIZyG33E3zdYBHwSCYq_os5yVj0nuxs7qjh8bCXuogIc__BBrq_sEnPy1PdmmJsGqEEnuYuTRdYmKdJ29_df9c-fAxQNfA2qtN9hezw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 18:17:49.053 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-10 18:17:49.056 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-10 18:17:49.057 +08:00 [DBG] Creating Implicit Flow response.
2019-06-10 18:17:49.057 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-10 18:17:49.057 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-10 18:17:49.060 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****CULA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNDGIATU5CF:00000003","TimeStamp":"2019-06-10T10:17:49.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-10 18:17:49.061 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoV0IiwEQqf3eUOeypcomwoo_DoWtMkyzWi7bR5tbe4JRHt9Z2nr8OojxjmaBUxljnYfNXfJw4uummb7hlL8D9a7F_bGHPy-4cden0n3-3r_zq1DpnbULlqD5NK3-gPgi46olnx0BGGeCA3aS6QtdM-MaVYILbJqCvKTxP2fonrpAWfV5EC2NCCKT7fQxB1dJqOFbVXL8oZTfvp78y4xHg1OsHlfIZyG33E3zdYBHwSCYq_os5yVj0nuxs7qjh8bCXuogIc__BBrq_sEnPy1PdmmJsGqEEnuYuTRdYmKdJ29_df9c-fAxQNfA2qtN9hezw","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-10 18:17:49.066 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 18:17:49.066 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 18:17:49.067 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 18:17:49.067 +08:00 [DBG] Start authorize request
2019-06-10 18:17:49.067 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-10 18:17:49.067 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 18:17:50.039 +08:00 [DBG] mvcImp found in database: true
2019-06-10 18:17:50.039 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 18:17:50.218 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 18:17:50.330 +08:00 [DBG] Found [] API scopes in database
2019-06-10 18:17:50.499 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 18:17:50.610 +08:00 [DBG] Found [] API scopes in database
2019-06-10 18:17:50.610 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 18:17:50.610 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoV0IiwEQqf3eUOeypcomwoo_DoWtMkyzWi7bR5tbe4JRHt9Z2nr8OojxjmaBUxljnYfNXfJw4uummb7hlL8D9a7F_bGHPy-4cden0n3-3r_zq1DpnbULlqD5NK3-gPgi46olnx0BGGeCA3aS6QtdM-MaVYILbJqCvKTxP2fonrpAWfV5EC2NCCKT7fQxB1dJqOFbVXL8oZTfvp78y4xHg1OsHlfIZyG33E3zdYBHwSCYq_os5yVj0nuxs7qjh8bCXuogIc__BBrq_sEnPy1PdmmJsGqEEnuYuTRdYmKdJ29_df9c-fAxQNfA2qtN9hezw","UiLocales":null,"Nonce":"636957586671797801.ZDdmMTVlYjQtM2ExZS00ZTgzLWFhYTItYjgzNmQ5NDQwZDAwYWY5ZmZjM2ItYjM3Yi00ZmNhLWJmZWEtOTVlNDUxMGRmZDE1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957586671797801.ZDdmMTVlYjQtM2ExZS00ZTgzLWFhYTItYjgzNmQ5NDQwZDAwYWY5ZmZjM2ItYjM3Yi00ZmNhLWJmZWEtOTVlNDUxMGRmZDE1","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoV0IiwEQqf3eUOeypcomwoo_DoWtMkyzWi7bR5tbe4JRHt9Z2nr8OojxjmaBUxljnYfNXfJw4uummb7hlL8D9a7F_bGHPy-4cden0n3-3r_zq1DpnbULlqD5NK3-gPgi46olnx0BGGeCA3aS6QtdM-MaVYILbJqCvKTxP2fonrpAWfV5EC2NCCKT7fQxB1dJqOFbVXL8oZTfvp78y4xHg1OsHlfIZyG33E3zdYBHwSCYq_os5yVj0nuxs7qjh8bCXuogIc__BBrq_sEnPy1PdmmJsGqEEnuYuTRdYmKdJ29_df9c-fAxQNfA2qtN9hezw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 18:17:50.830 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-10 18:17:50.833 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-10 18:17:50.833 +08:00 [DBG] Creating Implicit Flow response.
2019-06-10 18:17:50.834 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-10 18:17:50.834 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-10 18:17:50.837 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****uZBQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNDGIATU5CF:00000004","TimeStamp":"2019-06-10T10:17:50.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-10 18:17:50.837 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoV0IiwEQqf3eUOeypcomwoo_DoWtMkyzWi7bR5tbe4JRHt9Z2nr8OojxjmaBUxljnYfNXfJw4uummb7hlL8D9a7F_bGHPy-4cden0n3-3r_zq1DpnbULlqD5NK3-gPgi46olnx0BGGeCA3aS6QtdM-MaVYILbJqCvKTxP2fonrpAWfV5EC2NCCKT7fQxB1dJqOFbVXL8oZTfvp78y4xHg1OsHlfIZyG33E3zdYBHwSCYq_os5yVj0nuxs7qjh8bCXuogIc__BBrq_sEnPy1PdmmJsGqEEnuYuTRdYmKdJ29_df9c-fAxQNfA2qtN9hezw","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-10 18:18:22.486 +08:00 [INF] Removing 0 grants
2019-06-10 18:26:11.364 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-10 18:26:11.364 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-10 18:26:11.365 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-10 18:26:11.365 +08:00 [DBG] Start discovery request
2019-06-10 18:26:12.136 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-10 18:26:12.370 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-10 18:26:12.371 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-10 18:26:12.371 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-10 18:26:12.371 +08:00 [DBG] Start key discovery request
2019-06-10 18:26:12.447 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 18:26:12.448 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 18:26:12.448 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 18:26:12.448 +08:00 [DBG] Start authorize request
2019-06-10 18:26:12.448 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-10 18:26:12.448 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 18:26:13.425 +08:00 [DBG] mvcImp found in database: true
2019-06-10 18:26:13.425 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 18:26:13.598 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 18:26:13.702 +08:00 [DBG] Found [] API scopes in database
2019-06-10 18:26:13.886 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 18:26:13.991 +08:00 [DBG] Found [] API scopes in database
2019-06-10 18:26:13.992 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 18:26:13.992 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqfZlf8PRHktMAwtD0DdUHVeAAoKbBWxbE3gyM_3Y-ksWfz7INsE4EYmoc13KhDwbe3JCZ8fu26zjgkIR25KzuP2A4b7Pds4zU_XgSvkKsegp4cwzN3kXLlFO3upMI1irMDabuAaYRL3bZQ-jY9xSiOFWQAcL_lJ7JjX-bFmLeJ_l6lf2u5pit0pi74FxdGyU68FOSisvzB9-Gwy4BOPw7bBCQ5co8q1QG7vuUizE0GN7iAb7iM2KuANhnQJIVz4gkqLuVhIzawx_EHGP8MGYthvDV9PeKVGEUhjt_qnVIIIhxRGE5CXU7d10Ba9H6X77g","UiLocales":null,"Nonce":"636957591724066435.OThhYjdmOTQtOTQ2MS00MjIyLWJlYzQtNjg1MTMxYWFkMDFiM2RiZGQ2MDctNTE0My00OWUzLThkN2QtZDQ1YzlmYWVhY2Qz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957591724066435.OThhYjdmOTQtOTQ2MS00MjIyLWJlYzQtNjg1MTMxYWFkMDFiM2RiZGQ2MDctNTE0My00OWUzLThkN2QtZDQ1YzlmYWVhY2Qz","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqfZlf8PRHktMAwtD0DdUHVeAAoKbBWxbE3gyM_3Y-ksWfz7INsE4EYmoc13KhDwbe3JCZ8fu26zjgkIR25KzuP2A4b7Pds4zU_XgSvkKsegp4cwzN3kXLlFO3upMI1irMDabuAaYRL3bZQ-jY9xSiOFWQAcL_lJ7JjX-bFmLeJ_l6lf2u5pit0pi74FxdGyU68FOSisvzB9-Gwy4BOPw7bBCQ5co8q1QG7vuUizE0GN7iAb7iM2KuANhnQJIVz4gkqLuVhIzawx_EHGP8MGYthvDV9PeKVGEUhjt_qnVIIIhxRGE5CXU7d10Ba9H6X77g","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 18:26:14.213 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-10 18:26:14.217 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-10 18:26:14.218 +08:00 [DBG] Creating Implicit Flow response.
2019-06-10 18:26:14.218 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-10 18:26:14.218 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-10 18:26:14.222 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****-faQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNDGIATU5CG:00000003","TimeStamp":"2019-06-10T10:26:14.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-10 18:26:14.222 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqfZlf8PRHktMAwtD0DdUHVeAAoKbBWxbE3gyM_3Y-ksWfz7INsE4EYmoc13KhDwbe3JCZ8fu26zjgkIR25KzuP2A4b7Pds4zU_XgSvkKsegp4cwzN3kXLlFO3upMI1irMDabuAaYRL3bZQ-jY9xSiOFWQAcL_lJ7JjX-bFmLeJ_l6lf2u5pit0pi74FxdGyU68FOSisvzB9-Gwy4BOPw7bBCQ5co8q1QG7vuUizE0GN7iAb7iM2KuANhnQJIVz4gkqLuVhIzawx_EHGP8MGYthvDV9PeKVGEUhjt_qnVIIIhxRGE5CXU7d10Ba9H6X77g","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-10 18:34:09.462 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-10 18:34:09.463 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-10 18:34:09.464 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-10 18:34:09.464 +08:00 [DBG] Start discovery request
2019-06-10 18:34:10.238 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-10 18:34:10.443 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-10 18:34:10.443 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-10 18:34:10.444 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-10 18:34:10.444 +08:00 [DBG] Start key discovery request
2019-06-10 18:34:10.867 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 18:34:10.867 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 18:34:10.867 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 18:34:10.867 +08:00 [DBG] Start authorize request
2019-06-10 18:34:10.868 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-10 18:34:10.868 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 18:34:11.855 +08:00 [DBG] mvcImp found in database: true
2019-06-10 18:34:11.855 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 18:34:12.023 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 18:34:12.125 +08:00 [DBG] Found [] API scopes in database
2019-06-10 18:34:12.294 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 18:34:12.395 +08:00 [DBG] Found [] API scopes in database
2019-06-10 18:34:12.395 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 18:34:12.396 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iq_uag66vkhLERYy_zNtMzFyOUR9BJyVgsvfqFVPK37wRYOSMearJ1OC2yqr_PQFr5H50OJEFDQeZM00yyQV7U7TzlmE28pH-h0s5fHHCysTHQ4fP0aKQUEpt6gwktWuPQA1ced-EJG0SNBmRa7UPPODrgr0ZXhynmTqYMTKCCh3IbJyBg0kteuvSAkDVa9WX0gtSkqleU7mOw8jXL9P-Rj8Agbm6yHwUV4EQmfyEm33VX-xtdPdbeFQXJNZK6fPiC4y0i_msUdcviBz90JTza15YyWvyQI7ut8W4odOKxLu2KvRkGDKVRiGELjqnGaMXs","UiLocales":null,"Nonce":"636957596504755942.YTcwMWY2YTUtMDhhYy00MDY3LWIwMjQtNmJjZmRiYTkwNWEzNDQyZmQzYzItNDEzNi00N2M3LThlYjItODM1ZmMwMjlmYzE2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957596504755942.YTcwMWY2YTUtMDhhYy00MDY3LWIwMjQtNmJjZmRiYTkwNWEzNDQyZmQzYzItNDEzNi00N2M3LThlYjItODM1ZmMwMjlmYzE2","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iq_uag66vkhLERYy_zNtMzFyOUR9BJyVgsvfqFVPK37wRYOSMearJ1OC2yqr_PQFr5H50OJEFDQeZM00yyQV7U7TzlmE28pH-h0s5fHHCysTHQ4fP0aKQUEpt6gwktWuPQA1ced-EJG0SNBmRa7UPPODrgr0ZXhynmTqYMTKCCh3IbJyBg0kteuvSAkDVa9WX0gtSkqleU7mOw8jXL9P-Rj8Agbm6yHwUV4EQmfyEm33VX-xtdPdbeFQXJNZK6fPiC4y0i_msUdcviBz90JTza15YyWvyQI7ut8W4odOKxLu2KvRkGDKVRiGELjqnGaMXs","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 18:34:12.497 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-10 18:34:12.502 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-10 18:34:12.502 +08:00 [DBG] Creating Implicit Flow response.
2019-06-10 18:34:12.502 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-10 18:34:12.502 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-10 18:34:12.506 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****Js3A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNDGIATU5CH:00000003","TimeStamp":"2019-06-10T10:34:12.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-10 18:34:12.506 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iq_uag66vkhLERYy_zNtMzFyOUR9BJyVgsvfqFVPK37wRYOSMearJ1OC2yqr_PQFr5H50OJEFDQeZM00yyQV7U7TzlmE28pH-h0s5fHHCysTHQ4fP0aKQUEpt6gwktWuPQA1ced-EJG0SNBmRa7UPPODrgr0ZXhynmTqYMTKCCh3IbJyBg0kteuvSAkDVa9WX0gtSkqleU7mOw8jXL9P-Rj8Agbm6yHwUV4EQmfyEm33VX-xtdPdbeFQXJNZK6fPiC4y0i_msUdcviBz90JTza15YyWvyQI7ut8W4odOKxLu2KvRkGDKVRiGELjqnGaMXs","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-10 18:35:54.606 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-10 18:35:54.607 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-10 18:35:54.608 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-10 18:35:54.609 +08:00 [DBG] Start discovery request
2019-06-10 18:35:55.233 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-10 18:35:55.455 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-10 18:35:55.455 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-10 18:35:55.456 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-10 18:35:55.456 +08:00 [DBG] Start key discovery request
2019-06-10 18:35:55.530 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-10 18:35:55.531 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-10 18:35:55.531 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-10 18:35:55.531 +08:00 [DBG] Start authorize request
2019-06-10 18:35:55.532 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-10 18:35:55.532 +08:00 [DBG] Start authorize request protocol validation
2019-06-10 18:35:56.544 +08:00 [DBG] mvcImp found in database: true
2019-06-10 18:35:56.545 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-10 18:35:56.749 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 18:35:56.865 +08:00 [DBG] Found [] API scopes in database
2019-06-10 18:35:57.051 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-10 18:35:57.152 +08:00 [DBG] Found [] API scopes in database
2019-06-10 18:35:57.152 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-10 18:35:57.152 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ipueoyl_0kYTd5wBVjzVBb0FBOJOBKKzU2-CHZpUBzSv-IVGr-fEy4y3I7kgu9ZkJVzAsmvB_Jg3SsisD19MCwgQoeKi_R6RQrwYm4Hv47JMz5pv5WnlKXc4YOk5UdhNk9IOzDKLnQHrupM-hBt0CnsmWHlEyOfwyNA6iaxu11mP2yMq8WjQX67EgTZ4mrJpwgoP8DC9DeUlhe69F065YsK-gZZyqvAvY46mZjy3CQ2yIR-v1qr7hjYkAaf8JiaJqa9HHXVuQKgaLCLGDWSP7ZHRdiMAKKuyj3CmTevrluo2g7GpPsfeDgsPEPGJgjKHOk","UiLocales":null,"Nonce":"636957597554969134.NzFiNjA0OWQtMTllNi00OGY1LTg4Y2EtYmU4NjBiMmJlNzlkYWQ0MmM3YWItZmZmYy00Y2Q5LTk4NGMtNzc0NGEyNDBjMDdj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636957597554969134.NzFiNjA0OWQtMTllNi00OGY1LTg4Y2EtYmU4NjBiMmJlNzlkYWQ0MmM3YWItZmZmYy00Y2Q5LTk4NGMtNzc0NGEyNDBjMDdj","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ipueoyl_0kYTd5wBVjzVBb0FBOJOBKKzU2-CHZpUBzSv-IVGr-fEy4y3I7kgu9ZkJVzAsmvB_Jg3SsisD19MCwgQoeKi_R6RQrwYm4Hv47JMz5pv5WnlKXc4YOk5UdhNk9IOzDKLnQHrupM-hBt0CnsmWHlEyOfwyNA6iaxu11mP2yMq8WjQX67EgTZ4mrJpwgoP8DC9DeUlhe69F065YsK-gZZyqvAvY46mZjy3CQ2yIR-v1qr7hjYkAaf8JiaJqa9HHXVuQKgaLCLGDWSP7ZHRdiMAKKuyj3CmTevrluo2g7GpPsfeDgsPEPGJgjKHOk","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-10 18:35:57.367 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-10 18:35:57.371 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-10 18:35:57.371 +08:00 [DBG] Creating Implicit Flow response.
2019-06-10 18:35:57.371 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-10 18:35:57.372 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-10 18:35:57.377 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****6rUw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNDGIATU5CI:00000003","TimeStamp":"2019-06-10T10:35:57.0000000Z","ProcessId":23712,"LocalIpAddress":"127.0.0.1:3116","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-10 18:35:57.377 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ipueoyl_0kYTd5wBVjzVBb0FBOJOBKKzU2-CHZpUBzSv-IVGr-fEy4y3I7kgu9ZkJVzAsmvB_Jg3SsisD19MCwgQoeKi_R6RQrwYm4Hv47JMz5pv5WnlKXc4YOk5UdhNk9IOzDKLnQHrupM-hBt0CnsmWHlEyOfwyNA6iaxu11mP2yMq8WjQX67EgTZ4mrJpwgoP8DC9DeUlhe69F065YsK-gZZyqvAvY46mZjy3CQ2yIR-v1qr7hjYkAaf8JiaJqa9HHXVuQKgaLCLGDWSP7ZHRdiMAKKuyj3CmTevrluo2g7GpPsfeDgsPEPGJgjKHOk","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 09:50:28.598 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-11 09:50:28.640 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-11 09:50:28.640 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-11 09:50:28.640 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-11 09:50:28.640 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-11 09:50:28.640 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-11 09:50:29.084 +08:00 [DBG] Starting grant removal
2019-06-11 09:50:29.300 +08:00 [DBG] Login Url: /Account/Login
2019-06-11 09:50:29.303 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-11 09:50:29.303 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-11 09:50:29.303 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-11 09:50:29.303 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-11 09:50:29.303 +08:00 [DBG] Error Url: /home/error
2019-06-11 09:50:29.304 +08:00 [DBG] Error Id Parameter: errorId
2019-06-11 09:50:59.654 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 09:50:59.659 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 09:50:59.660 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 09:50:59.664 +08:00 [DBG] Start discovery request
2019-06-11 09:51:00.660 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 09:51:00.946 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 09:51:00.950 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 09:51:00.950 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 09:51:00.954 +08:00 [DBG] Start key discovery request
2019-06-11 09:51:01.040 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 09:51:01.045 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 09:51:01.045 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 09:51:01.050 +08:00 [DBG] Start authorize request
2019-06-11 09:51:01.065 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 09:51:01.071 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 09:51:02.358 +08:00 [DBG] mvcImp found in database: true
2019-06-11 09:51:02.367 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 09:51:02.595 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 09:51:02.739 +08:00 [DBG] Found [] API scopes in database
2019-06-11 09:51:02.929 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 09:51:03.047 +08:00 [DBG] Found [] API scopes in database
2019-06-11 09:51:03.055 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 09:51:03.068 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iqi4_7-IdSeymLgGCD8CsL-gWPdLbE41krfX9oT9WV6WScuUzM1jMM_Nso0DiBZ6mf7yEuPKrLRYMafOO7vqdmn8hbqZ7FUR59CVhC3QDw9XwF57DdPOkYLAKSZAbqtfxwpxa2PYT7AuTTcm26FukL2FaLNHNA9d17XwXkGBh5isB60S613yHTt2Wvq34shOLPXcQskwO5F-C5HFunDMhUA1bsOMXLh50HS1a35ScB39k2jpLsfQmL7ANhSQrFd2CaRW2bgdkZfg0IrhUihoFuCB8mFEl9T2MUpjCbIOmrfCdwsErsQhu5lQei4tYZQxx8","UiLocales":null,"Nonce":"636958146610088314.MTgwMDI3YjEtNjE5YS00ZThmLWFmZTktNzgyMTlkY2UxNDY1ZmVhNGFlNTAtMGEwZi00MWFkLWI3ZDctZGFhZmNiNGJhNjI1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636958146610088314.MTgwMDI3YjEtNjE5YS00ZThmLWFmZTktNzgyMTlkY2UxNDY1ZmVhNGFlNTAtMGEwZi00MWFkLWI3ZDctZGFhZmNiNGJhNjI1","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iqi4_7-IdSeymLgGCD8CsL-gWPdLbE41krfX9oT9WV6WScuUzM1jMM_Nso0DiBZ6mf7yEuPKrLRYMafOO7vqdmn8hbqZ7FUR59CVhC3QDw9XwF57DdPOkYLAKSZAbqtfxwpxa2PYT7AuTTcm26FukL2FaLNHNA9d17XwXkGBh5isB60S613yHTt2Wvq34shOLPXcQskwO5F-C5HFunDMhUA1bsOMXLh50HS1a35ScB39k2jpLsfQmL7ANhSQrFd2CaRW2bgdkZfg0IrhUihoFuCB8mFEl9T2MUpjCbIOmrfCdwsErsQhu5lQei4tYZQxx8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 09:51:03.180 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 09:51:03.181 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 09:51:03.181 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 09:51:03.184 +08:00 [DBG] Start authorize request
2019-06-11 09:51:03.185 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 09:51:03.185 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 09:51:03.352 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-11 09:51:03.357 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 09:51:03.365 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 09:51:03.376 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-11 09:51:03.387 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 09:51:03.532 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****y-WQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE1SN7H91T:00000003","TimeStamp":"2019-06-11T01:51:03.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 09:51:03.534 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iqi4_7-IdSeymLgGCD8CsL-gWPdLbE41krfX9oT9WV6WScuUzM1jMM_Nso0DiBZ6mf7yEuPKrLRYMafOO7vqdmn8hbqZ7FUR59CVhC3QDw9XwF57DdPOkYLAKSZAbqtfxwpxa2PYT7AuTTcm26FukL2FaLNHNA9d17XwXkGBh5isB60S613yHTt2Wvq34shOLPXcQskwO5F-C5HFunDMhUA1bsOMXLh50HS1a35ScB39k2jpLsfQmL7ANhSQrFd2CaRW2bgdkZfg0IrhUihoFuCB8mFEl9T2MUpjCbIOmrfCdwsErsQhu5lQei4tYZQxx8","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 09:51:04.470 +08:00 [DBG] mvcImp found in database: true
2019-06-11 09:51:04.470 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 09:51:04.662 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 09:51:04.767 +08:00 [DBG] Found [] API scopes in database
2019-06-11 09:51:04.955 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 09:51:05.059 +08:00 [DBG] Found [] API scopes in database
2019-06-11 09:51:05.060 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 09:51:05.060 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iqi4_7-IdSeymLgGCD8CsL-gWPdLbE41krfX9oT9WV6WScuUzM1jMM_Nso0DiBZ6mf7yEuPKrLRYMafOO7vqdmn8hbqZ7FUR59CVhC3QDw9XwF57DdPOkYLAKSZAbqtfxwpxa2PYT7AuTTcm26FukL2FaLNHNA9d17XwXkGBh5isB60S613yHTt2Wvq34shOLPXcQskwO5F-C5HFunDMhUA1bsOMXLh50HS1a35ScB39k2jpLsfQmL7ANhSQrFd2CaRW2bgdkZfg0IrhUihoFuCB8mFEl9T2MUpjCbIOmrfCdwsErsQhu5lQei4tYZQxx8","UiLocales":null,"Nonce":"636958146610088314.MTgwMDI3YjEtNjE5YS00ZThmLWFmZTktNzgyMTlkY2UxNDY1ZmVhNGFlNTAtMGEwZi00MWFkLWI3ZDctZGFhZmNiNGJhNjI1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636958146610088314.MTgwMDI3YjEtNjE5YS00ZThmLWFmZTktNzgyMTlkY2UxNDY1ZmVhNGFlNTAtMGEwZi00MWFkLWI3ZDctZGFhZmNiNGJhNjI1","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iqi4_7-IdSeymLgGCD8CsL-gWPdLbE41krfX9oT9WV6WScuUzM1jMM_Nso0DiBZ6mf7yEuPKrLRYMafOO7vqdmn8hbqZ7FUR59CVhC3QDw9XwF57DdPOkYLAKSZAbqtfxwpxa2PYT7AuTTcm26FukL2FaLNHNA9d17XwXkGBh5isB60S613yHTt2Wvq34shOLPXcQskwO5F-C5HFunDMhUA1bsOMXLh50HS1a35ScB39k2jpLsfQmL7ANhSQrFd2CaRW2bgdkZfg0IrhUihoFuCB8mFEl9T2MUpjCbIOmrfCdwsErsQhu5lQei4tYZQxx8","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 09:51:05.287 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-11 09:51:05.291 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 09:51:05.291 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 09:51:05.291 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-11 09:51:05.291 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 09:51:05.296 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****_N0A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE1SN7H91U:00000003","TimeStamp":"2019-06-11T01:51:05.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 09:51:05.296 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iqi4_7-IdSeymLgGCD8CsL-gWPdLbE41krfX9oT9WV6WScuUzM1jMM_Nso0DiBZ6mf7yEuPKrLRYMafOO7vqdmn8hbqZ7FUR59CVhC3QDw9XwF57DdPOkYLAKSZAbqtfxwpxa2PYT7AuTTcm26FukL2FaLNHNA9d17XwXkGBh5isB60S613yHTt2Wvq34shOLPXcQskwO5F-C5HFunDMhUA1bsOMXLh50HS1a35ScB39k2jpLsfQmL7ANhSQrFd2CaRW2bgdkZfg0IrhUihoFuCB8mFEl9T2MUpjCbIOmrfCdwsErsQhu5lQei4tYZQxx8","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 09:58:29.019 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 09:58:29.020 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 09:58:29.020 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 09:58:29.020 +08:00 [DBG] Start discovery request
2019-06-11 09:58:29.863 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 09:58:30.105 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 09:58:30.105 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 09:58:30.105 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 09:58:30.106 +08:00 [DBG] Start key discovery request
2019-06-11 09:58:30.184 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 09:58:30.185 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 09:58:30.185 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 09:58:30.185 +08:00 [DBG] Start authorize request
2019-06-11 09:58:30.185 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 09:58:30.185 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 09:58:31.226 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 09:58:31.226 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 09:58:31.226 +08:00 [DBG] Checking for PKCE parameters
2019-06-11 09:58:31.228 +08:00 [DBG] No PKCE used.
2019-06-11 09:58:31.411 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 09:58:31.526 +08:00 [DBG] Found [] API scopes in database
2019-06-11 09:58:31.702 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 09:58:31.808 +08:00 [DBG] Found [] API scopes in database
2019-06-11 09:58:31.808 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 09:58:31.809 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile email","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ips3bnTFTevW19C3W4cS0afas6gGstqnLA2V_9itgpOmeVUMEeSGh8QSmefOw8c51VUpOoQYIN3aVnEwlTOhdr5HCnSDcolsSYBiRzBC2SdcL-qWUH9SiXeaxLr3uORKwgh56NYD0-DBUKTKX_2qnWTn9n0m_iUg4rpvVWBIKQkH4T65ODh_Bq22W__gUbBrNbT29ZQfEX9cgwQr1YqitF3KjWp5e8RR8isBnD6yKfEzxVoZBejUNX8OC_ilvyDGkplxyZIGyV8sWwkOEENyq5u2kXKQEU8eHVTYNstAFsgF70yM2IpHkgWHPnlbZiReSQ","UiLocales":null,"Nonce":"636958151101410260.Mzc3NjBmNzUtNmFhZi00N2NjLWEwNmYtNGU5ODk1YmI5YTBlMTA3NDU1MTgtYjk0ZC00Zjk2LThiYWYtNTNkNDJkNTk4M2Fl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"d3e7e92d24ad8eea68afb6af80b5c2bf","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile email","response_mode":"form_post","nonce":"636958151101410260.Mzc3NjBmNzUtNmFhZi00N2NjLWEwNmYtNGU5ODk1YmI5YTBlMTA3NDU1MTgtYjk0ZC00Zjk2LThiYWYtNTNkNDJkNTk4M2Fl","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ips3bnTFTevW19C3W4cS0afas6gGstqnLA2V_9itgpOmeVUMEeSGh8QSmefOw8c51VUpOoQYIN3aVnEwlTOhdr5HCnSDcolsSYBiRzBC2SdcL-qWUH9SiXeaxLr3uORKwgh56NYD0-DBUKTKX_2qnWTn9n0m_iUg4rpvVWBIKQkH4T65ODh_Bq22W__gUbBrNbT29ZQfEX9cgwQr1YqitF3KjWp5e8RR8isBnD6yKfEzxVoZBejUNX8OC_ilvyDGkplxyZIGyV8sWwkOEENyq5u2kXKQEU8eHVTYNstAFsgF70yM2IpHkgWHPnlbZiReSQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 09:58:32.053 +08:00 [DBG] FiTLcYGBYEV8OnKEgTs+U+128Zy+PdC+Fm2zjauszrc= found in database: true
2019-06-11 09:58:32.056 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 09:58:32.059 +08:00 [DBG] Creating Hybrid Flow response.
2019-06-11 09:58:32.195 +08:00 [DBG] 6343Rnw8j1ST9BM+TeTacYABX85Qecu0L9Br++BULO0= not found in database
2019-06-11 09:58:32.414 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 09:58:32.415 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcHybrid
2019-06-11 09:58:32.415 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-11 09:58:32.418 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile email","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****3H3A","$type":"Token"},{"TokenType":"code","TokenValue":"****06b5","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE1SN7H91V:00000003","TimeStamp":"2019-06-11T01:58:32.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 09:58:32.419 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcHybrid","RedirectUri":"http://localhost:5005/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ips3bnTFTevW19C3W4cS0afas6gGstqnLA2V_9itgpOmeVUMEeSGh8QSmefOw8c51VUpOoQYIN3aVnEwlTOhdr5HCnSDcolsSYBiRzBC2SdcL-qWUH9SiXeaxLr3uORKwgh56NYD0-DBUKTKX_2qnWTn9n0m_iUg4rpvVWBIKQkH4T65ODh_Bq22W__gUbBrNbT29ZQfEX9cgwQr1YqitF3KjWp5e8RR8isBnD6yKfEzxVoZBejUNX8OC_ilvyDGkplxyZIGyV8sWwkOEENyq5u2kXKQEU8eHVTYNstAFsgF70yM2IpHkgWHPnlbZiReSQ","Scope":"openid profile email","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 09:58:32.431 +08:00 [DBG] Augmenting SignInContext
2019-06-11 09:58:32.439 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-11 09:58:32.652 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-11 09:58:32.658 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-11 09:58:32.658 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-11 09:58:32.667 +08:00 [DBG] Start token request.
2019-06-11 09:58:32.674 +08:00 [DBG] Start client validation
2019-06-11 09:58:32.681 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-11 09:58:32.685 +08:00 [DBG] Start parsing for secret in post body
2019-06-11 09:58:32.708 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-11 09:58:32.708 +08:00 [DBG] Secret id found: mvcHybrid
2019-06-11 09:58:33.775 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 09:58:33.775 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 09:58:33.784 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-11 09:58:33.784 +08:00 [DBG] Client validation success
2019-06-11 09:58:33.785 +08:00 [INF] {"ClientId":"mvcHybrid","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNE1SN7H91V:00000004","TimeStamp":"2019-06-11T01:58:33.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-11 09:58:33.791 +08:00 [DBG] Start token request validation
2019-06-11 09:58:33.802 +08:00 [DBG] Start validation of authorization code token request
2019-06-11 09:58:33.919 +08:00 [DBG] 6343Rnw8j1ST9BM+TeTacYABX85Qecu0L9Br++BULO0= found in database: true
2019-06-11 09:58:34.045 +08:00 [DBG] removing 6343Rnw8j1ST9BM+TeTacYABX85Qecu0L9Br++BULO0= persisted grant from database
2019-06-11 09:58:34.870 +08:00 [DBG] Validation of authorization code token request success
2019-06-11 09:58:34.873 +08:00 [INF] Token request validation success
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"8b1b3689bfc97050e9bc42693f3c3630b9c5d2aa6b3fefa1bc918a2b9f1306b5","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvcHybrid","client_secret":"***REDACTED***","code":"8b1b3689bfc97050e9bc42693f3c3630b9c5d2aa6b3fefa1bc918a2b9f1306b5","grant_type":"authorization_code","redirect_uri":"http://localhost:5005/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-06-11 09:58:36.093 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 09:58:36.093 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 09:58:36.270 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 09:58:36.383 +08:00 [DBG] Found [] API scopes in database
2019-06-11 09:58:36.394 +08:00 [DBG] Getting claims for access token for client: mvcHybrid
2019-06-11 09:58:36.394 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 09:58:36.394 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 09:58:37.427 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 09:58:37.427 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 09:58:37.608 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 09:58:37.714 +08:00 [DBG] Found [] API scopes in database
2019-06-11 09:58:37.714 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcHybrid
2019-06-11 09:58:37.714 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-11 09:58:37.718 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile email","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****gauA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****4GMQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE1SN7H91V:00000004","TimeStamp":"2019-06-11T01:58:37.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 09:58:37.720 +08:00 [DBG] Token request success.
2019-06-11 09:58:37.796 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-11 09:58:37.799 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-11 09:58:37.799 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-11 09:58:37.807 +08:00 [DBG] Start userinfo request
2019-06-11 09:58:37.812 +08:00 [DBG] Bearer token found in header
2019-06-11 09:58:38.906 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 09:58:38.906 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 09:58:39.943 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 09:58:39.943 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 09:58:40.060 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-11 09:58:40.061 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560218316,"exp":1560218376,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"mvcHybrid","sub":"af61726e-716b-4170-8c26-6568bf294215","auth_time":1560158620,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"shawn","last_name":"wong","card_number":"12123","card_holder":"王曉鋒","card_security_number":"2323","card_expiration":"20/12","address_city":"shanghai","address_country":"中国","address_state":"canials","address_street":"shanghai","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-11 09:58:40.069 +08:00 [DBG] Creating userinfo response
2019-06-11 09:58:40.072 +08:00 [DBG] Scopes in access token: openid profile email
2019-06-11 09:58:40.075 +08:00 [DBG] Scopes in access token: openid profile email
2019-06-11 09:58:40.261 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 09:58:40.262 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-11 09:58:40.262 +08:00 [DBG] Scopes in access token: openid profile email
2019-06-11 09:58:40.456 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 09:58:40.457 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-11 09:58:40.457 +08:00 [DBG] End userinfo request
2019-06-11 09:59:39.746 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 09:59:39.747 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 09:59:39.747 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 09:59:39.747 +08:00 [DBG] Start authorize request
2019-06-11 09:59:39.747 +08:00 [DBG] No user present in authorize request
2019-06-11 09:59:39.747 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 09:59:40.907 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 09:59:40.907 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 09:59:40.907 +08:00 [DBG] Checking for PKCE parameters
2019-06-11 09:59:40.907 +08:00 [DBG] No PKCE used.
2019-06-11 09:59:41.096 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 09:59:41.209 +08:00 [DBG] Found [] API scopes in database
2019-06-11 09:59:41.403 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 09:59:41.516 +08:00 [DBG] Found [] API scopes in database
2019-06-11 09:59:41.516 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 09:59:41.516 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile email","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ip79wEbI9UTf3xaDL0yugEwZJkVQGn23ssLBvqIeotMxRa4OLdExmnVCcDK04YF0EmX21iPuHu8mrliR82Jvh1WcC3Rcpxaqr2Wl5GH0W7BrSid4wY9eXl7nHVCLvGPRGNBtht2XXhXmF2mVs-DLVnas0t4FiMEU-YImaCPRapAfnrgWWQmcG5xxGYq8YKnNeT2Oc5GZ-W7VtgRL8j0JYhB3MZ-5vUfLK5Ml9ReGuVmrlHAGha4iY4Kej503-U5wh0PVjFq9zQZE83UvowiV9g1FT53HY2zbVOYlvUkmewVCO-MtOpFPhJkxx9vBkQ015o","UiLocales":null,"Nonce":"636958151796852403.NjViMGEyNjctNGQ0Yi00MzFhLThmNzctNGNkM2EzZGJlNTAwMGRmNzFkMDQtMDlhNC00ZWZhLTkxNDAtZmE2NGZlNzgwMzcx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile email","response_mode":"form_post","nonce":"636958151796852403.NjViMGEyNjctNGQ0Yi00MzFhLThmNzctNGNkM2EzZGJlNTAwMGRmNzFkMDQtMDlhNC00ZWZhLTkxNDAtZmE2NGZlNzgwMzcx","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ip79wEbI9UTf3xaDL0yugEwZJkVQGn23ssLBvqIeotMxRa4OLdExmnVCcDK04YF0EmX21iPuHu8mrliR82Jvh1WcC3Rcpxaqr2Wl5GH0W7BrSid4wY9eXl7nHVCLvGPRGNBtht2XXhXmF2mVs-DLVnas0t4FiMEU-YImaCPRapAfnrgWWQmcG5xxGYq8YKnNeT2Oc5GZ-W7VtgRL8j0JYhB3MZ-5vUfLK5Ml9ReGuVmrlHAGha4iY4Kej503-U5wh0PVjFq9zQZE83UvowiV9g1FT53HY2zbVOYlvUkmewVCO-MtOpFPhJkxx9vBkQ015o","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 09:59:41.516 +08:00 [INF] Showing login: User is not authenticated
2019-06-11 09:59:41.681 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 09:59:42.774 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 09:59:42.774 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 09:59:42.774 +08:00 [DBG] Checking for PKCE parameters
2019-06-11 09:59:42.774 +08:00 [DBG] No PKCE used.
2019-06-11 09:59:42.957 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 09:59:43.063 +08:00 [DBG] Found [] API scopes in database
2019-06-11 09:59:43.237 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 09:59:43.363 +08:00 [DBG] Found [] API scopes in database
2019-06-11 09:59:43.364 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 09:59:44.413 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 09:59:44.414 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 09:59:59.108 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-11 09:59:59.169 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 10:00:00.306 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 10:00:00.307 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 10:00:00.307 +08:00 [DBG] Checking for PKCE parameters
2019-06-11 10:00:00.307 +08:00 [DBG] No PKCE used.
2019-06-11 10:00:00.518 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 10:00:00.642 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:00:00.853 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 10:00:00.967 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:00:00.967 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 10:00:01.114 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"1223138295@qq.com","DisplayName":"shawn","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNE1SN7H91V:00000008","TimeStamp":"2019-06-11T02:00:01.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-11 10:00:01.375 +08:00 [DBG] Augmenting SignInContext
2019-06-11 10:00:01.375 +08:00 [DBG] Adding idp claim with value: local
2019-06-11 10:00:01.376 +08:00 [DBG] Adding amr claim with value: pwd
2019-06-11 10:00:01.376 +08:00 [DBG] Adding auth_time claim with value: 1560218401
2019-06-11 10:00:01.377 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-11 10:00:01.411 +08:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-11 10:00:01.412 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-11 10:00:01.413 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-11 10:00:01.418 +08:00 [DBG] Start authorize callback request
2019-06-11 10:00:01.422 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 10:00:01.422 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 10:00:02.484 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 10:00:02.484 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 10:00:02.484 +08:00 [DBG] Checking for PKCE parameters
2019-06-11 10:00:02.484 +08:00 [DBG] No PKCE used.
2019-06-11 10:00:02.672 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 10:00:02.785 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:00:03.000 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 10:00:03.124 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:00:03.125 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 10:00:03.125 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile email","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ip79wEbI9UTf3xaDL0yugEwZJkVQGn23ssLBvqIeotMxRa4OLdExmnVCcDK04YF0EmX21iPuHu8mrliR82Jvh1WcC3Rcpxaqr2Wl5GH0W7BrSid4wY9eXl7nHVCLvGPRGNBtht2XXhXmF2mVs-DLVnas0t4FiMEU-YImaCPRapAfnrgWWQmcG5xxGYq8YKnNeT2Oc5GZ-W7VtgRL8j0JYhB3MZ-5vUfLK5Ml9ReGuVmrlHAGha4iY4Kej503-U5wh0PVjFq9zQZE83UvowiV9g1FT53HY2zbVOYlvUkmewVCO-MtOpFPhJkxx9vBkQ015o","UiLocales":null,"Nonce":"636958151796852403.NjViMGEyNjctNGQ0Yi00MzFhLThmNzctNGNkM2EzZGJlNTAwMGRmNzFkMDQtMDlhNC00ZWZhLTkxNDAtZmE2NGZlNzgwMzcx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"b9b68cf91caa6ec44174aa2d71d323f1","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile email","response_mode":"form_post","nonce":"636958151796852403.NjViMGEyNjctNGQ0Yi00MzFhLThmNzctNGNkM2EzZGJlNTAwMGRmNzFkMDQtMDlhNC00ZWZhLTkxNDAtZmE2NGZlNzgwMzcx","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ip79wEbI9UTf3xaDL0yugEwZJkVQGn23ssLBvqIeotMxRa4OLdExmnVCcDK04YF0EmX21iPuHu8mrliR82Jvh1WcC3Rcpxaqr2Wl5GH0W7BrSid4wY9eXl7nHVCLvGPRGNBtht2XXhXmF2mVs-DLVnas0t4FiMEU-YImaCPRapAfnrgWWQmcG5xxGYq8YKnNeT2Oc5GZ-W7VtgRL8j0JYhB3MZ-5vUfLK5Ml9ReGuVmrlHAGha4iY4Kej503-U5wh0PVjFq9zQZE83UvowiV9g1FT53HY2zbVOYlvUkmewVCO-MtOpFPhJkxx9vBkQ015o","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 10:00:03.369 +08:00 [DBG] FiTLcYGBYEV8OnKEgTs+U+128Zy+PdC+Fm2zjauszrc= found in database: true
2019-06-11 10:00:03.373 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 10:00:03.373 +08:00 [DBG] Creating Hybrid Flow response.
2019-06-11 10:00:03.515 +08:00 [DBG] T+ox0L+Uo/U3wPiteNFf201CVI6PNtuFd5MjiNTnnNg= not found in database
2019-06-11 10:00:04.172 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 10:00:04.172 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcHybrid
2019-06-11 10:00:04.172 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-11 10:00:04.176 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile email","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****TKXg","$type":"Token"},{"TokenType":"code","TokenValue":"****b0ea","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE1SN7H91V:00000009","TimeStamp":"2019-06-11T02:00:04.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 10:00:04.176 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcHybrid","RedirectUri":"http://localhost:5005/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ip79wEbI9UTf3xaDL0yugEwZJkVQGn23ssLBvqIeotMxRa4OLdExmnVCcDK04YF0EmX21iPuHu8mrliR82Jvh1WcC3Rcpxaqr2Wl5GH0W7BrSid4wY9eXl7nHVCLvGPRGNBtht2XXhXmF2mVs-DLVnas0t4FiMEU-YImaCPRapAfnrgWWQmcG5xxGYq8YKnNeT2Oc5GZ-W7VtgRL8j0JYhB3MZ-5vUfLK5Ml9ReGuVmrlHAGha4iY4Kej503-U5wh0PVjFq9zQZE83UvowiV9g1FT53HY2zbVOYlvUkmewVCO-MtOpFPhJkxx9vBkQ015o","Scope":"openid profile email","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 10:00:04.178 +08:00 [DBG] Augmenting SignInContext
2019-06-11 10:00:04.178 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-11 10:00:04.283 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-11 10:00:04.284 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-11 10:00:04.284 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-11 10:00:04.284 +08:00 [DBG] Start token request.
2019-06-11 10:00:04.284 +08:00 [DBG] Start client validation
2019-06-11 10:00:04.285 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-11 10:00:04.285 +08:00 [DBG] Start parsing for secret in post body
2019-06-11 10:00:04.285 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-11 10:00:04.285 +08:00 [DBG] Secret id found: mvcHybrid
2019-06-11 10:00:05.403 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 10:00:05.403 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 10:00:05.403 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-11 10:00:05.403 +08:00 [DBG] Client validation success
2019-06-11 10:00:05.404 +08:00 [INF] {"ClientId":"mvcHybrid","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNE1SN7H91V:0000000A","TimeStamp":"2019-06-11T02:00:05.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-11 10:00:05.404 +08:00 [DBG] Start token request validation
2019-06-11 10:00:05.404 +08:00 [DBG] Start validation of authorization code token request
2019-06-11 10:00:05.520 +08:00 [DBG] T+ox0L+Uo/U3wPiteNFf201CVI6PNtuFd5MjiNTnnNg= found in database: true
2019-06-11 10:00:05.653 +08:00 [DBG] removing T+ox0L+Uo/U3wPiteNFf201CVI6PNtuFd5MjiNTnnNg= persisted grant from database
2019-06-11 10:00:06.313 +08:00 [DBG] Validation of authorization code token request success
2019-06-11 10:00:06.314 +08:00 [INF] Token request validation success
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"b68bcc19000e623f8dabe6e676fc54094b0bce43ecd57ae9a9a836a9e338b0ea","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvcHybrid","client_secret":"***REDACTED***","code":"b68bcc19000e623f8dabe6e676fc54094b0bce43ecd57ae9a9a836a9e338b0ea","grant_type":"authorization_code","redirect_uri":"http://localhost:5005/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-06-11 10:00:07.397 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 10:00:07.397 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 10:00:07.601 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 10:00:07.730 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:00:07.730 +08:00 [DBG] Getting claims for access token for client: mvcHybrid
2019-06-11 10:00:07.730 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 10:00:07.730 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 10:00:08.886 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 10:00:08.887 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 10:00:09.080 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 10:00:09.193 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:00:09.193 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcHybrid
2019-06-11 10:00:09.193 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-11 10:00:09.196 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile email","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****UXzA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****RnWg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE1SN7H91V:0000000A","TimeStamp":"2019-06-11T02:00:09.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 10:00:09.196 +08:00 [DBG] Token request success.
2019-06-11 10:00:09.235 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-11 10:00:09.235 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-11 10:00:09.236 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-11 10:00:09.236 +08:00 [DBG] Start userinfo request
2019-06-11 10:00:09.236 +08:00 [DBG] Bearer token found in header
2019-06-11 10:00:10.335 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 10:00:10.335 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 10:00:11.454 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 10:00:11.454 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 10:00:11.578 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-11 10:00:11.578 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560218407,"exp":1560218467,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"mvcHybrid","sub":"af61726e-716b-4170-8c26-6568bf294215","auth_time":1560218401,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"shawn","last_name":"wong","card_number":"12123","card_holder":"王曉鋒","card_security_number":"2323","card_expiration":"20/12","address_city":"shanghai","address_country":"中国","address_state":"canials","address_street":"shanghai","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-11 10:00:11.579 +08:00 [DBG] Creating userinfo response
2019-06-11 10:00:11.579 +08:00 [DBG] Scopes in access token: openid profile email
2019-06-11 10:00:11.579 +08:00 [DBG] Scopes in access token: openid profile email
2019-06-11 10:00:11.793 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 10:00:11.794 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-11 10:00:11.794 +08:00 [DBG] Scopes in access token: openid profile email
2019-06-11 10:00:12.023 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 10:00:12.023 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-11 10:00:12.023 +08:00 [DBG] End userinfo request
2019-06-11 10:01:10.085 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 10:01:10.086 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 10:01:10.086 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 10:01:10.086 +08:00 [DBG] Start discovery request
2019-06-11 10:01:10.930 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 10:01:11.119 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 10:01:11.119 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 10:01:11.119 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 10:01:11.119 +08:00 [DBG] Start key discovery request
2019-06-11 10:01:11.203 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 10:01:11.204 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 10:01:11.204 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 10:01:11.204 +08:00 [DBG] Start authorize request
2019-06-11 10:01:11.204 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 10:01:11.205 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 10:01:12.251 +08:00 [DBG] mvcImp found in database: true
2019-06-11 10:01:12.251 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 10:01:12.432 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 10:01:12.546 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:01:12.735 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 10:01:12.850 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:01:12.851 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 10:01:12.851 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoVav9L0Y3jzTGcs_vN3mkTv8W-HB6YmkVsY23G1vbZU16bGaUva-gaQCSar4rRlsSW4srlk6EPaAJdHPRyBtoP9juAfSfNTCKTBPuAMeTkKgf3W0ngikUOjkYC2AqhiBJqawiRWlc8RZdXISRdKVNb2h7JHGCLHha-W9kbsZONkwM0_thpeO3VoJxr8H14G2CayXGB-Y3OG4FRLiPRWLGLPDUVuC7OMLL5tIH9BUh8S_Cpf4FpyQseDG6cplo4nEKic8oH6F4fI1CX79b6x3DiFZSlQOl4x-xo7c2rlcZAmvcKEKUvBQXDbr5L9SD9pFw","UiLocales":null,"Nonce":"636958152711507246.Y2ZlNGRkNzgtNDQ1Yi00MGQ1LWI1ODQtNWYzMGNmZjMzN2M5YjYxMWM1NGQtYzU1Yy00NThiLTk1YWEtNWZlYWViMzA3OWU3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"b9b68cf91caa6ec44174aa2d71d323f1","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636958152711507246.Y2ZlNGRkNzgtNDQ1Yi00MGQ1LWI1ODQtNWYzMGNmZjMzN2M5YjYxMWM1NGQtYzU1Yy00NThiLTk1YWEtNWZlYWViMzA3OWU3","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoVav9L0Y3jzTGcs_vN3mkTv8W-HB6YmkVsY23G1vbZU16bGaUva-gaQCSar4rRlsSW4srlk6EPaAJdHPRyBtoP9juAfSfNTCKTBPuAMeTkKgf3W0ngikUOjkYC2AqhiBJqawiRWlc8RZdXISRdKVNb2h7JHGCLHha-W9kbsZONkwM0_thpeO3VoJxr8H14G2CayXGB-Y3OG4FRLiPRWLGLPDUVuC7OMLL5tIH9BUh8S_Cpf4FpyQseDG6cplo4nEKic8oH6F4fI1CX79b6x3DiFZSlQOl4x-xo7c2rlcZAmvcKEKUvBQXDbr5L9SD9pFw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 10:01:13.116 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-11 10:01:13.119 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 10:01:13.119 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 10:01:13.120 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-11 10:01:13.120 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 10:01:13.123 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****xQMw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE1SN7H91V:0000000E","TimeStamp":"2019-06-11T02:01:13.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 10:01:13.123 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoVav9L0Y3jzTGcs_vN3mkTv8W-HB6YmkVsY23G1vbZU16bGaUva-gaQCSar4rRlsSW4srlk6EPaAJdHPRyBtoP9juAfSfNTCKTBPuAMeTkKgf3W0ngikUOjkYC2AqhiBJqawiRWlc8RZdXISRdKVNb2h7JHGCLHha-W9kbsZONkwM0_thpeO3VoJxr8H14G2CayXGB-Y3OG4FRLiPRWLGLPDUVuC7OMLL5tIH9BUh8S_Cpf4FpyQseDG6cplo4nEKic8oH6F4fI1CX79b6x3DiFZSlQOl4x-xo7c2rlcZAmvcKEKUvBQXDbr5L9SD9pFw","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 10:01:13.123 +08:00 [DBG] Augmenting SignInContext
2019-06-11 10:01:13.124 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-11 10:03:07.643 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 10:03:07.643 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 10:03:07.644 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 10:03:07.644 +08:00 [DBG] Start authorize request
2019-06-11 10:03:07.644 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 10:03:07.644 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 10:03:08.742 +08:00 [DBG] mvcImp found in database: true
2019-06-11 10:03:08.746 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 10:03:08.949 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 10:03:09.113 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:03:09.391 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 10:03:09.511 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:03:09.511 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 10:03:09.511 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iph2aSIbpJGg4vA6XPyTbo1Sxgkf3Xq0Ykg7F8d2Ra-OhuFXWG8ucTne_UgUSwTiMCfERVaxpfU1SAqdQYHGb6Mi5AceD0s5AV8zN-7mGd6Ecu39CcI22MRTH_6A_wDqt0PYxl1uM0Y7WFdwDefRla2zxpDiUY6TY8vYV0xIvNvFEREHALJGor0s9gM9fxwLsep8oBfXZuPpRyR8cdGvJjh3mtKDdCpBiMrZfaIZJyg7mStkdd6KTliAeQT-M6AnmwY0B_6luip3wpetDZN9SCrgUAu_GSaWZfh5rEb2ijrtT0joCNlVtIBBbzRkqNVyrg","UiLocales":null,"Nonce":"636958153876201537.MDhlN2RhOGUtMzJlZS00ZDdjLTgzZGYtMmNjNmNiMWNhMzY0ZDc0MTBjMDQtNjdiYS00ZDU0LWI0MTgtNzhmZmNiMjYyMmVk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"b9b68cf91caa6ec44174aa2d71d323f1","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636958153876201537.MDhlN2RhOGUtMzJlZS00ZDdjLTgzZGYtMmNjNmNiMWNhMzY0ZDc0MTBjMDQtNjdiYS00ZDU0LWI0MTgtNzhmZmNiMjYyMmVk","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iph2aSIbpJGg4vA6XPyTbo1Sxgkf3Xq0Ykg7F8d2Ra-OhuFXWG8ucTne_UgUSwTiMCfERVaxpfU1SAqdQYHGb6Mi5AceD0s5AV8zN-7mGd6Ecu39CcI22MRTH_6A_wDqt0PYxl1uM0Y7WFdwDefRla2zxpDiUY6TY8vYV0xIvNvFEREHALJGor0s9gM9fxwLsep8oBfXZuPpRyR8cdGvJjh3mtKDdCpBiMrZfaIZJyg7mStkdd6KTliAeQT-M6AnmwY0B_6luip3wpetDZN9SCrgUAu_GSaWZfh5rEb2ijrtT0joCNlVtIBBbzRkqNVyrg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 10:03:09.745 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-11 10:03:09.749 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 10:03:09.749 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 10:03:09.750 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-11 10:03:09.750 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 10:03:09.753 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****tVyA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE1SN7H920:00000001","TimeStamp":"2019-06-11T02:03:09.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 10:03:09.753 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iph2aSIbpJGg4vA6XPyTbo1Sxgkf3Xq0Ykg7F8d2Ra-OhuFXWG8ucTne_UgUSwTiMCfERVaxpfU1SAqdQYHGb6Mi5AceD0s5AV8zN-7mGd6Ecu39CcI22MRTH_6A_wDqt0PYxl1uM0Y7WFdwDefRla2zxpDiUY6TY8vYV0xIvNvFEREHALJGor0s9gM9fxwLsep8oBfXZuPpRyR8cdGvJjh3mtKDdCpBiMrZfaIZJyg7mStkdd6KTliAeQT-M6AnmwY0B_6luip3wpetDZN9SCrgUAu_GSaWZfh5rEb2ijrtT0joCNlVtIBBbzRkqNVyrg","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 10:08:29.294 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 10:08:29.294 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 10:08:29.294 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 10:08:29.294 +08:00 [DBG] Start authorize request
2019-06-11 10:08:29.295 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 10:08:29.295 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 10:08:30.527 +08:00 [DBG] mvcImp found in database: true
2019-06-11 10:08:30.527 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 10:08:30.714 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 10:08:30.838 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:08:31.015 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 10:08:31.123 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:08:31.123 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 10:08:31.123 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrYsu64gPa-C8ostIMEDaSRsibPnLYFGIUisaVGLb-Tgj1EL-Xuw_rcFpyPYISIKB8leNgNzAUwUYy3R8-xUkH4jHgwlPlQiJ3Uf7NeorEU8VqdFlW3LMzaqsRwKBCLymOX6bW1u7PgKBKn20UkhVez9kICkPG_okXV0s1axdiGrFOzCcKTMrnp-n33LYx278rk-bksJqfYzJopLmlWsU_RBsn9ES9nAXBGjaVxAPNRNwJD3kTAV62CCftL8ALn1016QbeZaZ8DgU1pLRR-y0y_mfMnNF-mMvVnH4lforxNYU3dH4aBz7v5cEO-HHCwpyU","UiLocales":null,"Nonce":"636958157092685166.Y2NkOGIzZmQtNjQxMC00NTc1LWExMDYtMzE1NzA2Yjk0Yjc0MDdlOGNjYzctMDBhNS00YzBjLWE4NDMtMjUzMTgyMTNjYTYx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"b9b68cf91caa6ec44174aa2d71d323f1","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636958157092685166.Y2NkOGIzZmQtNjQxMC00NTc1LWExMDYtMzE1NzA2Yjk0Yjc0MDdlOGNjYzctMDBhNS00YzBjLWE4NDMtMjUzMTgyMTNjYTYx","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrYsu64gPa-C8ostIMEDaSRsibPnLYFGIUisaVGLb-Tgj1EL-Xuw_rcFpyPYISIKB8leNgNzAUwUYy3R8-xUkH4jHgwlPlQiJ3Uf7NeorEU8VqdFlW3LMzaqsRwKBCLymOX6bW1u7PgKBKn20UkhVez9kICkPG_okXV0s1axdiGrFOzCcKTMrnp-n33LYx278rk-bksJqfYzJopLmlWsU_RBsn9ES9nAXBGjaVxAPNRNwJD3kTAV62CCftL8ALn1016QbeZaZ8DgU1pLRR-y0y_mfMnNF-mMvVnH4lforxNYU3dH4aBz7v5cEO-HHCwpyU","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 10:08:31.341 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-11 10:08:31.345 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 10:08:31.345 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 10:08:31.345 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-11 10:08:31.345 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 10:08:31.348 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****ZrFg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE1SN7H921:00000001","TimeStamp":"2019-06-11T02:08:31.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 10:08:31.348 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrYsu64gPa-C8ostIMEDaSRsibPnLYFGIUisaVGLb-Tgj1EL-Xuw_rcFpyPYISIKB8leNgNzAUwUYy3R8-xUkH4jHgwlPlQiJ3Uf7NeorEU8VqdFlW3LMzaqsRwKBCLymOX6bW1u7PgKBKn20UkhVez9kICkPG_okXV0s1axdiGrFOzCcKTMrnp-n33LYx278rk-bksJqfYzJopLmlWsU_RBsn9ES9nAXBGjaVxAPNRNwJD3kTAV62CCftL8ALn1016QbeZaZ8DgU1pLRR-y0y_mfMnNF-mMvVnH4lforxNYU3dH4aBz7v5cEO-HHCwpyU","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 10:35:52.778 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 10:35:52.779 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 10:35:52.779 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 10:35:52.780 +08:00 [DBG] Start discovery request
2019-06-11 10:35:53.620 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 10:35:53.855 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 10:35:53.855 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 10:35:53.855 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 10:35:53.856 +08:00 [DBG] Start key discovery request
2019-06-11 10:35:54.249 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 10:35:54.249 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 10:35:54.249 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 10:35:54.250 +08:00 [DBG] Start authorize request
2019-06-11 10:35:54.250 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 10:35:54.250 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 10:35:55.295 +08:00 [DBG] mvcImp found in database: true
2019-06-11 10:35:55.295 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 10:35:55.468 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 10:35:55.580 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:35:55.748 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 10:35:55.851 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:35:55.851 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 10:35:55.852 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrJ_G5mrPJaFkxKvIWnVBivJqKRqREWCvCuKjyaTlZYrbWbK7puvghpz5NV7OkGdQBE0fiDe9zVFRj_aV0wNFh_CSfhP9Z0jOo9ZZuSPuj1lwBLVCikcORbBXcyroQ_yrgb2dLabyXLmBhSWgIlJ-wv8Y9VzF6jbQS4ToAhYDWziyvKmS5BmvqlHk-uCKrSNEfTftERkuz74vK2d0NC_0lHkThth6WPAMQGOvCt42oU2uhiw0izkHyta8kJHxDMPKaK4rNhLoHhInhg0yOH5MXc51K-gMEDhExnVkLAAuBpndL5oqO0jSZJQk15UoOHugk","UiLocales":null,"Nonce":"636958173538861858.YzgzYTk1M2MtM2MxYy00NjU1LThhNDAtM2I3ZWQ4YmY1MDU0YWJmZmQwMTAtZjc5Ny00MWRjLWFkZTMtOTNkNmY4OWQxNjky","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"b9b68cf91caa6ec44174aa2d71d323f1","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636958173538861858.YzgzYTk1M2MtM2MxYy00NjU1LThhNDAtM2I3ZWQ4YmY1MDU0YWJmZmQwMTAtZjc5Ny00MWRjLWFkZTMtOTNkNmY4OWQxNjky","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrJ_G5mrPJaFkxKvIWnVBivJqKRqREWCvCuKjyaTlZYrbWbK7puvghpz5NV7OkGdQBE0fiDe9zVFRj_aV0wNFh_CSfhP9Z0jOo9ZZuSPuj1lwBLVCikcORbBXcyroQ_yrgb2dLabyXLmBhSWgIlJ-wv8Y9VzF6jbQS4ToAhYDWziyvKmS5BmvqlHk-uCKrSNEfTftERkuz74vK2d0NC_0lHkThth6WPAMQGOvCt42oU2uhiw0izkHyta8kJHxDMPKaK4rNhLoHhInhg0yOH5MXc51K-gMEDhExnVkLAAuBpndL5oqO0jSZJQk15UoOHugk","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 10:35:55.962 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-11 10:35:55.966 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 10:35:55.966 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 10:35:55.966 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-11 10:35:55.966 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 10:35:55.970 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****lIMw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE1SN7H922:00000003","TimeStamp":"2019-06-11T02:35:55.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 10:35:55.970 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrJ_G5mrPJaFkxKvIWnVBivJqKRqREWCvCuKjyaTlZYrbWbK7puvghpz5NV7OkGdQBE0fiDe9zVFRj_aV0wNFh_CSfhP9Z0jOo9ZZuSPuj1lwBLVCikcORbBXcyroQ_yrgb2dLabyXLmBhSWgIlJ-wv8Y9VzF6jbQS4ToAhYDWziyvKmS5BmvqlHk-uCKrSNEfTftERkuz74vK2d0NC_0lHkThth6WPAMQGOvCt42oU2uhiw0izkHyta8kJHxDMPKaK4rNhLoHhInhg0yOH5MXc51K-gMEDhExnVkLAAuBpndL5oqO0jSZJQk15UoOHugk","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 10:37:09.938 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 10:37:09.938 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 10:37:09.938 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 10:37:09.939 +08:00 [DBG] Start authorize request
2019-06-11 10:37:09.939 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 10:37:09.939 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 10:37:10.979 +08:00 [DBG] mvcImp found in database: true
2019-06-11 10:37:10.979 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 10:37:11.177 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 10:37:11.289 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:37:11.477 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 10:37:11.579 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:37:11.579 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 10:37:11.579 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoAt44C_a9F9NTfCajREht05B1Ia80NjJElwfkesJ_jzmGZhvEoDMMSt4HfJp52n1kod4_H90pU6J7mbjco-S7XpFnl8251Qhl7K56iMgokIIRgFRsV_5SBYzT2-_h7VGdK8XGpRaGlGOyLEU0CXvf72tazYcm3PrJESnDqxSllipEdBBdKBsXsrOHUpP1r9hwSF0w4y1ZqwrHRIZ6FJCYCkGtk1Ro9j7KK6A6Mh-1ggawX7-DDSzLP0N-xu15PbsrThMIOMNI8D8toomgb-yxUdnGBKIZyvgrjdm5cZjRk1q4qtm6PHXdUj8AP1ToBGn4","UiLocales":null,"Nonce":"636958174299123398.OTlkMGEyYzItODEyNC00MDI4LWE2NzEtNDhmZTIxNmFkZWMzMmMzYTZmNDktYTJlMy00ZjNhLWEzMzAtNjMyNGI0MjlkOWEw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"b9b68cf91caa6ec44174aa2d71d323f1","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636958174299123398.OTlkMGEyYzItODEyNC00MDI4LWE2NzEtNDhmZTIxNmFkZWMzMmMzYTZmNDktYTJlMy00ZjNhLWEzMzAtNjMyNGI0MjlkOWEw","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoAt44C_a9F9NTfCajREht05B1Ia80NjJElwfkesJ_jzmGZhvEoDMMSt4HfJp52n1kod4_H90pU6J7mbjco-S7XpFnl8251Qhl7K56iMgokIIRgFRsV_5SBYzT2-_h7VGdK8XGpRaGlGOyLEU0CXvf72tazYcm3PrJESnDqxSllipEdBBdKBsXsrOHUpP1r9hwSF0w4y1ZqwrHRIZ6FJCYCkGtk1Ro9j7KK6A6Mh-1ggawX7-DDSzLP0N-xu15PbsrThMIOMNI8D8toomgb-yxUdnGBKIZyvgrjdm5cZjRk1q4qtm6PHXdUj8AP1ToBGn4","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 10:37:11.806 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-11 10:37:11.811 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 10:37:11.811 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 10:37:11.811 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-11 10:37:11.811 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 10:37:11.815 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****L3Dg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE1SN7H923:00000001","TimeStamp":"2019-06-11T02:37:11.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 10:37:11.815 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoAt44C_a9F9NTfCajREht05B1Ia80NjJElwfkesJ_jzmGZhvEoDMMSt4HfJp52n1kod4_H90pU6J7mbjco-S7XpFnl8251Qhl7K56iMgokIIRgFRsV_5SBYzT2-_h7VGdK8XGpRaGlGOyLEU0CXvf72tazYcm3PrJESnDqxSllipEdBBdKBsXsrOHUpP1r9hwSF0w4y1ZqwrHRIZ6FJCYCkGtk1Ro9j7KK6A6Mh-1ggawX7-DDSzLP0N-xu15PbsrThMIOMNI8D8toomgb-yxUdnGBKIZyvgrjdm5cZjRk1q4qtm6PHXdUj8AP1ToBGn4","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 10:41:27.166 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 10:41:27.167 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 10:41:27.167 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 10:41:27.167 +08:00 [DBG] Start discovery request
2019-06-11 10:41:28.125 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 10:41:28.330 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 10:41:28.331 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 10:41:28.331 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 10:41:28.331 +08:00 [DBG] Start key discovery request
2019-06-11 10:41:28.409 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 10:41:28.409 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 10:41:28.409 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 10:41:28.409 +08:00 [DBG] Start authorize request
2019-06-11 10:41:28.410 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 10:41:28.410 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 10:41:29.591 +08:00 [DBG] mvcImp found in database: true
2019-06-11 10:41:29.591 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 10:41:29.812 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 10:41:29.933 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:41:30.145 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 10:41:30.278 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:41:30.278 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 10:41:30.278 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ioy-3Zp5xNbX_3o875viUXMU47UWc6yUQTtwdR6v0Lx5CnPkRrMibVmGJDDext8l2VjufkNs1tM2eGwPxBAHtKpMN75bXtrxTatOuvA4bfa9jEogUxUhAh9ehumncHYcYTu0lNMc7ftSy2WAjlLNSDvGH2fkslWqIJMBed4BPO-_H6k4m3F2ulqKewaRZsZtE1qh9vDbGi3EOcpZelMxNT-Vb1RdEOungw8Mg308pMuK2NC7Vb9IeWJWRBhbbxNSusAjI2GUDXENc6V0uiEbHu-5Hgi2O6swLSkF08xjn4v5K-o3vi6XLtPBk2I4HtmNnY","UiLocales":null,"Nonce":"636958176883663374.OTk4MzRhZWQtZjUyOS00ODY3LWE1N2EtMjdkYjA5OWUwNzIzMDE3ZTdmOGUtNzA4Yi00NDRlLWI3NmEtZDcxYTAyZTY0ZjVm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"b9b68cf91caa6ec44174aa2d71d323f1","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636958176883663374.OTk4MzRhZWQtZjUyOS00ODY3LWE1N2EtMjdkYjA5OWUwNzIzMDE3ZTdmOGUtNzA4Yi00NDRlLWI3NmEtZDcxYTAyZTY0ZjVm","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ioy-3Zp5xNbX_3o875viUXMU47UWc6yUQTtwdR6v0Lx5CnPkRrMibVmGJDDext8l2VjufkNs1tM2eGwPxBAHtKpMN75bXtrxTatOuvA4bfa9jEogUxUhAh9ehumncHYcYTu0lNMc7ftSy2WAjlLNSDvGH2fkslWqIJMBed4BPO-_H6k4m3F2ulqKewaRZsZtE1qh9vDbGi3EOcpZelMxNT-Vb1RdEOungw8Mg308pMuK2NC7Vb9IeWJWRBhbbxNSusAjI2GUDXENc6V0uiEbHu-5Hgi2O6swLSkF08xjn4v5K-o3vi6XLtPBk2I4HtmNnY","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 10:41:30.524 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-11 10:41:30.528 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 10:41:30.528 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 10:41:30.528 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-11 10:41:30.528 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 10:41:30.531 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****d_cQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE1SN7H924:00000003","TimeStamp":"2019-06-11T02:41:30.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 10:41:30.531 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ioy-3Zp5xNbX_3o875viUXMU47UWc6yUQTtwdR6v0Lx5CnPkRrMibVmGJDDext8l2VjufkNs1tM2eGwPxBAHtKpMN75bXtrxTatOuvA4bfa9jEogUxUhAh9ehumncHYcYTu0lNMc7ftSy2WAjlLNSDvGH2fkslWqIJMBed4BPO-_H6k4m3F2ulqKewaRZsZtE1qh9vDbGi3EOcpZelMxNT-Vb1RdEOungw8Mg308pMuK2NC7Vb9IeWJWRBhbbxNSusAjI2GUDXENc6V0uiEbHu-5Hgi2O6swLSkF08xjn4v5K-o3vi6XLtPBk2I4HtmNnY","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 10:43:34.952 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 10:43:34.954 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 10:43:34.954 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 10:43:34.957 +08:00 [DBG] Start discovery request
2019-06-11 10:43:35.697 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 10:43:35.893 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 10:43:35.894 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 10:43:35.894 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 10:43:35.894 +08:00 [DBG] Start key discovery request
2019-06-11 10:43:35.957 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 10:43:35.957 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 10:43:35.958 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 10:43:35.958 +08:00 [DBG] Start authorize request
2019-06-11 10:43:35.958 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 10:43:35.958 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 10:43:37.097 +08:00 [DBG] mvcImp found in database: true
2019-06-11 10:43:37.097 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 10:43:37.292 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 10:43:37.426 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:43:37.645 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 10:43:37.767 +08:00 [DBG] Found [] API scopes in database
2019-06-11 10:43:37.767 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 10:43:37.768 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoJFfYakb5P4a43ItKOVeo1wGkksPYEu1rLUyeAt5c0zjlQh1AIodhF2rwF8Uu8Wlc25bPzjcc3Ju3ynV9dQ1QiAynoJVsX83Rixlp06NzTeqzxJ1BVO6K7itAAMiwQ-2i6pxliFCaKqXk-MomhEfRG-xh5eU7662pCxIW8Ntxz4_4XmUvCcx2GG8gyVRJF7d_0tovyXhkc19xRDToEIZu-ydStOsTTT79hpmwn5y6-JPBOIHMcIxyyOkgWqcDutImAzGK6oAcQOF0i6-YdzbrYShmOMV9xIMfEQFJ801bbVEq7Zad3dj57ZKBtIr7kM4g","UiLocales":null,"Nonce":"636958178159255560.MzdhMmIyMTEtMjEwMS00ZGFiLThmODAtZGU3MDE4MmY4NTg0MThhMjkzNzktYTFjOS00NTM3LTlkOTEtNjRlMDhkMWRiMzUx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"b9b68cf91caa6ec44174aa2d71d323f1","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636958178159255560.MzdhMmIyMTEtMjEwMS00ZGFiLThmODAtZGU3MDE4MmY4NTg0MThhMjkzNzktYTFjOS00NTM3LTlkOTEtNjRlMDhkMWRiMzUx","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoJFfYakb5P4a43ItKOVeo1wGkksPYEu1rLUyeAt5c0zjlQh1AIodhF2rwF8Uu8Wlc25bPzjcc3Ju3ynV9dQ1QiAynoJVsX83Rixlp06NzTeqzxJ1BVO6K7itAAMiwQ-2i6pxliFCaKqXk-MomhEfRG-xh5eU7662pCxIW8Ntxz4_4XmUvCcx2GG8gyVRJF7d_0tovyXhkc19xRDToEIZu-ydStOsTTT79hpmwn5y6-JPBOIHMcIxyyOkgWqcDutImAzGK6oAcQOF0i6-YdzbrYShmOMV9xIMfEQFJ801bbVEq7Zad3dj57ZKBtIr7kM4g","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 10:43:38.041 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-11 10:43:38.044 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 10:43:38.045 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 10:43:38.045 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-11 10:43:38.045 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 10:43:38.048 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****6uOw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE1SN7H925:00000003","TimeStamp":"2019-06-11T02:43:38.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 10:43:38.048 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoJFfYakb5P4a43ItKOVeo1wGkksPYEu1rLUyeAt5c0zjlQh1AIodhF2rwF8Uu8Wlc25bPzjcc3Ju3ynV9dQ1QiAynoJVsX83Rixlp06NzTeqzxJ1BVO6K7itAAMiwQ-2i6pxliFCaKqXk-MomhEfRG-xh5eU7662pCxIW8Ntxz4_4XmUvCcx2GG8gyVRJF7d_0tovyXhkc19xRDToEIZu-ydStOsTTT79hpmwn5y6-JPBOIHMcIxyyOkgWqcDutImAzGK6oAcQOF0i6-YdzbrYShmOMV9xIMfEQFJ801bbVEq7Zad3dj57ZKBtIr7kM4g","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 10:50:29.392 +08:00 [INF] Removing 0 grants
2019-06-11 11:50:29.823 +08:00 [INF] Removing 0 grants
2019-06-11 12:50:30.160 +08:00 [INF] Removing 0 grants
2019-06-11 13:37:42.688 +08:00 [DBG] 2 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-06-11 13:37:43.736 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 13:37:43.737 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 13:37:43.963 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 13:37:44.096 +08:00 [DBG] Found [] API scopes in database
2019-06-11 13:37:45.116 +08:00 [DBG] mvcImp found in database: true
2019-06-11 13:37:45.116 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 13:37:45.307 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 13:37:45.430 +08:00 [DBG] Found [] API scopes in database
2019-06-11 13:38:00.287 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 13:38:00.291 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 13:38:00.292 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 13:38:00.292 +08:00 [DBG] Start discovery request
2019-06-11 13:38:00.962 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 13:38:05.210 +08:00 [DBG] 2 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-06-11 13:38:06.227 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 13:38:06.227 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 13:38:06.437 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 13:38:06.550 +08:00 [DBG] Found [] API scopes in database
2019-06-11 13:38:07.572 +08:00 [DBG] mvcImp found in database: true
2019-06-11 13:38:07.572 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 13:38:07.741 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 13:38:07.853 +08:00 [DBG] Found [] API scopes in database
2019-06-11 13:38:08.647 +08:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-11 13:38:08.708 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-06-11 13:38:08.709 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLNE1SN7H927:00000003","TimeStamp":"2019-06-11T05:38:08.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-06-11 13:38:08.784 +08:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2019-06-11 13:38:08.794 +08:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2019-06-11 13:38:08.794 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2019-06-11 13:38:08.800 +08:00 [DBG] Processing signout callback request
2019-06-11 13:38:10.107 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 13:38:10.108 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 13:38:11.152 +08:00 [DBG] mvcImp found in database: true
2019-06-11 13:38:11.153 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 13:38:11.153 +08:00 [DBG] No client front-channel logout URLs
2019-06-11 13:38:11.153 +08:00 [DBG] No client back-channel logout URLs
2019-06-11 13:38:11.153 +08:00 [INF] Successful signout callback.
2019-06-11 13:38:11.154 +08:00 [DBG] No client front-channel iframe urls
2019-06-11 13:38:11.154 +08:00 [DBG] No client back-channel iframe urls
2019-06-11 13:38:14.046 +08:00 [DBG] 2 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-06-11 13:38:15.042 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 13:38:15.042 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 13:38:15.227 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 13:38:15.332 +08:00 [DBG] Found [] API scopes in database
2019-06-11 13:38:16.353 +08:00 [DBG] mvcImp found in database: true
2019-06-11 13:38:16.353 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 13:38:16.526 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 13:38:16.630 +08:00 [DBG] Found [] API scopes in database
2019-06-11 13:38:26.502 +08:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-06-11 13:39:23.186 +08:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-06-11 13:39:30.229 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-11 13:39:30.409 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"1223138295@qq.com","DisplayName":"shawn","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNE1SN7H929:00000008","TimeStamp":"2019-06-11T05:39:30.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-11 13:39:30.689 +08:00 [DBG] Augmenting SignInContext
2019-06-11 13:39:30.689 +08:00 [DBG] Adding idp claim with value: local
2019-06-11 13:39:30.689 +08:00 [DBG] Adding amr claim with value: pwd
2019-06-11 13:39:30.689 +08:00 [DBG] Adding auth_time claim with value: 1560231570
2019-06-11 13:39:30.690 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-11 13:39:30.872 +08:00 [DBG] 2 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-06-11 13:39:31.990 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 13:39:31.990 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 13:39:32.176 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 13:39:32.288 +08:00 [DBG] Found [] API scopes in database
2019-06-11 13:39:33.313 +08:00 [DBG] mvcImp found in database: true
2019-06-11 13:39:33.313 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 13:39:33.511 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 13:39:33.630 +08:00 [DBG] Found [] API scopes in database
2019-06-11 13:40:06.409 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-06-11 13:40:07.124 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLNE1SN7H929:00000009","TimeStamp":"2019-06-11T05:40:07.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-06-11 13:40:15.621 +08:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-11 13:40:18.747 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-06-11 13:40:18.748 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLNE1SN7H927:0000000A","TimeStamp":"2019-06-11T05:40:18.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-06-11 13:40:37.187 +08:00 [DBG] 2 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-06-11 13:40:38.240 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 13:40:38.240 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 13:40:38.435 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 13:40:38.543 +08:00 [DBG] Found [] API scopes in database
2019-06-11 13:40:39.583 +08:00 [DBG] mvcImp found in database: true
2019-06-11 13:40:39.584 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 13:40:39.772 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 13:40:39.902 +08:00 [DBG] Found [] API scopes in database
2019-06-11 13:41:03.905 +08:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-11 13:42:02.504 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-06-11 13:42:04.715 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLNE1SN7H929:0000000B","TimeStamp":"2019-06-11T05:42:04.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-06-11 13:42:17.980 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-06-11 13:42:26.103 +08:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-11 13:42:29.671 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-06-11 13:42:30.170 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLNE1SN7H929:0000000D","TimeStamp":"2019-06-11T05:42:30.0000000Z","ProcessId":29084,"LocalIpAddress":"127.0.0.1:19674","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-06-11 13:51:00.809 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-11 13:51:00.839 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-11 13:51:00.839 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-11 13:51:00.839 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-11 13:51:00.839 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-11 13:51:00.839 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-11 13:51:01.291 +08:00 [DBG] Starting grant removal
2019-06-11 13:51:01.492 +08:00 [DBG] Login Url: /Account/Login
2019-06-11 13:51:01.496 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-11 13:51:01.496 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-11 13:51:01.496 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-11 13:51:01.496 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-11 13:51:01.497 +08:00 [DBG] Error Url: /home/error
2019-06-11 13:51:01.497 +08:00 [DBG] Error Id Parameter: errorId
2019-06-11 13:52:18.798 +08:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-11 13:52:36.805 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-06-11 13:52:42.497 +08:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-06-11 13:53:00.941 +08:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty.
Parameter name: url
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at IdentityServer4.Quickstart.UI.AccountController.Logout(LogoutInputModel model) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Quickstart\Account\AccountController.cs:line 305
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-06-11 13:53:08.395 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-06-11 13:53:08.395 +08:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-06-11 13:53:09.092 +08:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty.
Parameter name: url
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at IdentityServer4.Quickstart.UI.AccountController.Logout(LogoutInputModel model) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Quickstart\Account\AccountController.cs:line 305
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-06-11 13:53:24.090 +08:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-11 13:53:26.102 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-06-11 13:53:26.104 +08:00 [INF] AuthenticationScheme: Identity.Application signed out.
2019-06-11 13:53:26.837 +08:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentException: Value cannot be null or empty.
Parameter name: url
   at Microsoft.AspNetCore.Mvc.ControllerBase.Redirect(String url)
   at IdentityServer4.Quickstart.UI.AccountController.Logout(LogoutInputModel model) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Quickstart\Account\AccountController.cs:line 305
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-06-11 13:57:33.003 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-11 13:57:33.061 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-11 13:57:33.062 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-11 13:57:33.062 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-11 13:57:33.075 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-11 13:57:33.076 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-11 13:57:33.657 +08:00 [DBG] Starting grant removal
2019-06-11 13:57:34.006 +08:00 [DBG] Login Url: /Account/Login
2019-06-11 13:57:34.010 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-11 13:57:34.010 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-11 13:57:34.010 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-11 13:57:34.010 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-11 13:57:34.010 +08:00 [DBG] Error Url: /home/error
2019-06-11 13:57:34.010 +08:00 [DBG] Error Id Parameter: errorId
2019-06-11 13:58:00.719 +08:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-11 13:58:01.852 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-06-11 13:58:02.371 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","DisplayName":"1223138295@qq.com","Category":"Authentication","Name":"User Logout Success","EventType":"Success","Id":1002,"Message":null,"ActivityId":"0HLNE66PB29PK:00000002","TimeStamp":"2019-06-11T05:58:02.0000000Z","ProcessId":14244,"LocalIpAddress":"127.0.0.1:16393","RemoteIpAddress":"::1","$type":"UserLogoutSuccessEvent"}
2019-06-11 14:27:54.808 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-11 14:27:54.836 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-11 14:27:54.836 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-11 14:27:54.836 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-11 14:27:54.837 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-11 14:27:54.837 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-11 14:27:55.236 +08:00 [DBG] Starting grant removal
2019-06-11 14:27:55.680 +08:00 [DBG] Login Url: /Account/Login
2019-06-11 14:27:55.684 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-11 14:27:55.684 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-11 14:27:55.684 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-11 14:27:55.685 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-11 14:27:55.685 +08:00 [DBG] Error Url: /home/error
2019-06-11 14:27:55.685 +08:00 [DBG] Error Id Parameter: errorId
2019-06-11 14:28:23.637 +08:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-06-11 14:28:31.395 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-11 14:28:31.753 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"1223138295@qq.com","DisplayName":"shawn","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNE6NO7QD10:00000003","TimeStamp":"2019-06-11T06:28:31.0000000Z","ProcessId":18888,"LocalIpAddress":"127.0.0.1:39986","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-11 14:28:32.121 +08:00 [DBG] Augmenting SignInContext
2019-06-11 14:28:32.123 +08:00 [DBG] Adding idp claim with value: local
2019-06-11 14:28:32.123 +08:00 [DBG] Adding amr claim with value: pwd
2019-06-11 14:28:32.124 +08:00 [DBG] Adding auth_time claim with value: 1560234512
2019-06-11 14:28:32.137 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-11 14:28:32.328 +08:00 [DBG] 2 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-06-11 14:28:33.662 +08:00 [DBG] mvcHybrid found in database: true
2019-06-11 14:28:33.670 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-11 14:28:33.934 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-11 14:28:34.161 +08:00 [DBG] Found [] API scopes in database
2019-06-11 14:28:35.430 +08:00 [DBG] mvcImp found in database: true
2019-06-11 14:28:35.431 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 14:28:35.636 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 14:28:35.754 +08:00 [DBG] Found [] API scopes in database
2019-06-11 14:28:44.301 +08:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-11 14:28:44.373 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-06-11 14:28:51.503 +08:00 [INF] AuthenticationScheme: idsrv signed out.
2019-06-11 14:32:31.981 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-11 14:32:32.012 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-11 14:32:32.012 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-11 14:32:32.013 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-11 14:32:32.013 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-11 14:32:32.013 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-11 14:32:32.442 +08:00 [DBG] Starting grant removal
2019-06-11 14:32:32.817 +08:00 [DBG] Login Url: /Account/Login
2019-06-11 14:32:32.819 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-11 14:32:32.819 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-11 14:32:32.820 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-11 14:32:32.820 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-11 14:32:32.820 +08:00 [DBG] Error Url: /home/error
2019-06-11 14:32:32.820 +08:00 [DBG] Error Id Parameter: errorId
2019-06-11 14:32:45.787 +08:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-11 14:32:45.879 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-06-11 14:32:58.726 +08:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No sign-out authentication handler is registered for the scheme 'idsrv.session'. The registered sign-out schemes are: Identity.Application, Identity.External, Identity.TwoFactorRememberMe, Identity.TwoFactorUserId, idsrv, idsrv.external. Did you forget to call AddAuthentication().AddCookies("idsrv.session",...)?
   at Microsoft.AspNetCore.Authentication.AuthenticationService.SignOutAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at IdentityServer4.Hosting.IdentityServerAuthenticationService.SignOutAsync(HttpContext context, String scheme, AuthenticationProperties properties) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerAuthenticationService.cs:line 107
   at IdentityServer4.Quickstart.UI.AccountController.Logout(LogoutInputModel model) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Quickstart\Account\AccountController.cs:line 274
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-06-11 15:09:17.878 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-11 15:09:17.934 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-11 15:09:17.934 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-11 15:09:17.935 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-11 15:09:17.935 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-11 15:09:17.935 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-11 15:09:18.436 +08:00 [DBG] Starting grant removal
2019-06-11 15:09:18.662 +08:00 [DBG] Login Url: /Account/Login
2019-06-11 15:09:18.668 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-11 15:09:18.668 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-11 15:09:18.669 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-11 15:09:18.669 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-11 15:09:18.669 +08:00 [DBG] Error Url: /home/error
2019-06-11 15:09:18.669 +08:00 [DBG] Error Id Parameter: errorId
2019-06-11 15:10:31.066 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 15:10:31.071 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 15:10:31.071 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 15:10:31.075 +08:00 [DBG] Start discovery request
2019-06-11 15:10:32.109 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 15:10:32.279 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 15:10:32.280 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 15:10:32.281 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 15:10:32.284 +08:00 [DBG] Start key discovery request
2019-06-11 15:10:33.199 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-11 15:10:33.205 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-11 15:10:33.205 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-11 15:10:33.214 +08:00 [DBG] Start token request.
2019-06-11 15:10:33.223 +08:00 [DBG] Start client validation
2019-06-11 15:10:33.230 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-11 15:10:33.234 +08:00 [DBG] Start parsing for secret in post body
2019-06-11 15:10:33.256 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-11 15:10:33.257 +08:00 [DBG] Secret id found: client
2019-06-11 15:10:34.788 +08:00 [DBG] client found in database: true
2019-06-11 15:10:34.799 +08:00 [DBG] client configuration validation for client client succeeded.
2019-06-11 15:10:34.811 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-11 15:10:34.811 +08:00 [DBG] Client validation success
2019-06-11 15:10:34.826 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNE7ES771J0:00000003","TimeStamp":"2019-06-11T07:10:34.0000000Z","ProcessId":39352,"LocalIpAddress":"127.0.0.1:21194","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-11 15:10:34.835 +08:00 [DBG] Start token request validation
2019-06-11 15:10:34.847 +08:00 [DBG] Start client credentials token request validation
2019-06-11 15:10:34.999 +08:00 [DBG] Found [] identity scopes in database
2019-06-11 15:10:35.655 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-11 15:10:35.803 +08:00 [DBG] Found [] identity scopes in database
2019-06-11 15:10:36.401 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-11 15:10:36.405 +08:00 [DBG] client credentials token request validation success
2019-06-11 15:10:36.412 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-06-11 15:10:36.437 +08:00 [DBG] Getting claims for access token for client: client
2019-06-11 15:10:36.568 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****KsPg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE7ES771J0:00000003","TimeStamp":"2019-06-11T07:10:36.0000000Z","ProcessId":39352,"LocalIpAddress":"127.0.0.1:21194","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 15:10:36.570 +08:00 [DBG] Token request success.
2019-06-11 15:10:39.715 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 15:10:39.715 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 15:10:39.715 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 15:10:39.716 +08:00 [DBG] Start discovery request
2019-06-11 15:10:40.493 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 15:10:40.722 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 15:10:40.724 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 15:10:40.724 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 15:10:40.724 +08:00 [DBG] Start key discovery request
2019-06-11 15:11:40.801 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 15:11:40.810 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 15:11:40.810 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 15:11:40.810 +08:00 [DBG] Start discovery request
2019-06-11 15:11:41.513 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 15:11:41.574 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 15:11:41.574 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 15:11:41.574 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 15:11:41.575 +08:00 [DBG] Start key discovery request
2019-06-11 15:11:42.236 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-11 15:11:42.244 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-11 15:11:42.245 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-11 15:11:42.245 +08:00 [DBG] Start token request.
2019-06-11 15:11:42.245 +08:00 [DBG] Start client validation
2019-06-11 15:11:42.245 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-11 15:11:42.245 +08:00 [DBG] Start parsing for secret in post body
2019-06-11 15:11:42.258 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-11 15:11:42.258 +08:00 [DBG] Secret id found: client
2019-06-11 15:11:43.428 +08:00 [DBG] client found in database: true
2019-06-11 15:11:43.428 +08:00 [DBG] client configuration validation for client client succeeded.
2019-06-11 15:11:43.428 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-11 15:11:43.428 +08:00 [DBG] Client validation success
2019-06-11 15:11:43.429 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNE7ES771J1:00000003","TimeStamp":"2019-06-11T07:11:43.0000000Z","ProcessId":39352,"LocalIpAddress":"127.0.0.1:21194","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-11 15:11:43.429 +08:00 [DBG] Start token request validation
2019-06-11 15:11:43.429 +08:00 [DBG] Start client credentials token request validation
2019-06-11 15:11:43.560 +08:00 [DBG] Found [] identity scopes in database
2019-06-11 15:11:44.179 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-11 15:11:44.311 +08:00 [DBG] Found [] identity scopes in database
2019-06-11 15:11:44.906 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-11 15:11:44.906 +08:00 [DBG] client credentials token request validation success
2019-06-11 15:11:44.906 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-06-11 15:11:44.907 +08:00 [DBG] Getting claims for access token for client: client
2019-06-11 15:11:44.910 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****g8rw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE7ES771J1:00000003","TimeStamp":"2019-06-11T07:11:44.0000000Z","ProcessId":39352,"LocalIpAddress":"127.0.0.1:21194","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 15:11:44.910 +08:00 [DBG] Token request success.
2019-06-11 15:15:31.446 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 15:15:31.455 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 15:15:31.455 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 15:15:31.455 +08:00 [DBG] Start discovery request
2019-06-11 15:15:32.398 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 15:15:32.457 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 15:15:32.458 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 15:15:32.458 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 15:15:32.458 +08:00 [DBG] Start key discovery request
2019-06-11 15:15:33.237 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-11 15:15:33.237 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-11 15:15:33.237 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-11 15:15:33.237 +08:00 [DBG] Start token request.
2019-06-11 15:15:33.238 +08:00 [DBG] Start client validation
2019-06-11 15:15:33.238 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-11 15:15:33.238 +08:00 [DBG] Start parsing for secret in post body
2019-06-11 15:15:33.238 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-11 15:15:33.238 +08:00 [DBG] Secret id found: client
2019-06-11 15:15:34.408 +08:00 [DBG] client found in database: true
2019-06-11 15:15:34.408 +08:00 [DBG] client configuration validation for client client succeeded.
2019-06-11 15:15:34.408 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-11 15:15:34.409 +08:00 [DBG] Client validation success
2019-06-11 15:15:34.409 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNE7ES771J2:00000003","TimeStamp":"2019-06-11T07:15:34.0000000Z","ProcessId":39352,"LocalIpAddress":"127.0.0.1:21194","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-11 15:15:34.409 +08:00 [DBG] Start token request validation
2019-06-11 15:15:34.409 +08:00 [DBG] Start client credentials token request validation
2019-06-11 15:15:34.545 +08:00 [DBG] Found [] identity scopes in database
2019-06-11 15:15:35.147 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-11 15:15:35.279 +08:00 [DBG] Found [] identity scopes in database
2019-06-11 15:15:35.897 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-11 15:15:35.897 +08:00 [DBG] client credentials token request validation success
2019-06-11 15:15:35.897 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-06-11 15:15:35.897 +08:00 [DBG] Getting claims for access token for client: client
2019-06-11 15:15:35.901 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****tAPA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE7ES771J2:00000003","TimeStamp":"2019-06-11T07:15:35.0000000Z","ProcessId":39352,"LocalIpAddress":"127.0.0.1:21194","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 15:15:35.901 +08:00 [DBG] Token request success.
2019-06-11 15:15:38.003 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 15:15:38.003 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 15:15:38.004 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 15:15:38.004 +08:00 [DBG] Start discovery request
2019-06-11 15:15:38.782 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 15:15:38.988 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 15:15:38.989 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 15:15:38.989 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 15:15:38.989 +08:00 [DBG] Start key discovery request
2019-06-11 15:17:12.445 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 15:17:12.461 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 15:17:12.476 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 15:17:12.476 +08:00 [DBG] Start discovery request
2019-06-11 15:17:13.191 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 15:17:13.212 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 15:17:13.213 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 15:17:13.213 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 15:17:13.213 +08:00 [DBG] Start key discovery request
2019-06-11 15:17:13.232 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-11 15:17:13.233 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-11 15:17:13.233 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-11 15:17:13.233 +08:00 [DBG] Start token request.
2019-06-11 15:17:13.233 +08:00 [DBG] Start client validation
2019-06-11 15:17:13.234 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-11 15:17:13.234 +08:00 [DBG] Start parsing for secret in post body
2019-06-11 15:17:13.235 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-11 15:17:13.235 +08:00 [DBG] Secret id found: client
2019-06-11 15:17:14.393 +08:00 [DBG] client found in database: true
2019-06-11 15:17:14.394 +08:00 [DBG] client configuration validation for client client succeeded.
2019-06-11 15:17:14.394 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-11 15:17:14.394 +08:00 [DBG] Client validation success
2019-06-11 15:17:14.394 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNE7ES771J3:00000003","TimeStamp":"2019-06-11T07:17:14.0000000Z","ProcessId":39352,"LocalIpAddress":"127.0.0.1:21194","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-11 15:17:14.394 +08:00 [DBG] Start token request validation
2019-06-11 15:17:14.394 +08:00 [DBG] Start client credentials token request validation
2019-06-11 15:17:14.521 +08:00 [DBG] Found [] identity scopes in database
2019-06-11 15:17:15.147 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-11 15:17:15.271 +08:00 [DBG] Found [] identity scopes in database
2019-06-11 15:17:15.889 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-11 15:17:15.889 +08:00 [DBG] client credentials token request validation success
2019-06-11 15:17:15.889 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-06-11 15:17:15.889 +08:00 [DBG] Getting claims for access token for client: client
2019-06-11 15:17:15.892 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****mH8Q","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE7ES771J3:00000003","TimeStamp":"2019-06-11T07:17:15.0000000Z","ProcessId":39352,"LocalIpAddress":"127.0.0.1:21194","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 15:17:15.892 +08:00 [DBG] Token request success.
2019-06-11 15:42:42.424 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 15:42:42.424 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 15:42:42.425 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 15:42:42.425 +08:00 [DBG] Start discovery request
2019-06-11 15:42:43.224 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 15:42:43.437 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 15:42:43.437 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 15:42:43.438 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 15:42:43.438 +08:00 [DBG] Start key discovery request
2019-06-11 15:42:43.843 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 15:42:43.845 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 15:42:43.845 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 15:42:43.850 +08:00 [DBG] Start authorize request
2019-06-11 15:42:43.858 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 15:42:43.863 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 15:42:44.872 +08:00 [DBG] mvcImp found in database: true
2019-06-11 15:42:44.872 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 15:42:45.081 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 15:42:45.193 +08:00 [DBG] Found [] API scopes in database
2019-06-11 15:42:45.365 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 15:42:45.465 +08:00 [DBG] Found [] API scopes in database
2019-06-11 15:42:45.473 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 15:42:45.476 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iq8agVo3BehTsJI-8HCucC3DKZHD1vQ0by0IHFQ4EgqU278ZVXEzUEZ5dG5fvV3xusvpHQTRx-Mx8Syd6rc99nXPxsEdZdhbkCaRgbyitJdzMKELvyd0IPxSiRfJgPzpAv1I37qAilppYlDP_c7V-KtRYALmL8NiJAeXdiRIkArpqxP8cXMGDykuYwav1hwTvzrAFe8h78tULonPzj-9ekYjjtUlaqM-nnFehmtVG7A2WV0bkMrf5H7fqNCYnj_aFcBj5VQIcc5a1ete2SFPMk9oOyOzu4RucgkAgY6BhXIQcDXCt1b0mwoPfy5PfiP36M","UiLocales":null,"Nonce":"636958357634686627.OWVhNGIzYjUtYjYwYi00NWFmLTliNmEtOGU5MWZkODg1ZDMwMjRlMjY1N2ItNjFmYS00Y2I0LThmMjQtZmFhNzI5YmNiODk5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636958357634686627.OWVhNGIzYjUtYjYwYi00NWFmLTliNmEtOGU5MWZkODg1ZDMwMjRlMjY1N2ItNjFmYS00Y2I0LThmMjQtZmFhNzI5YmNiODk5","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iq8agVo3BehTsJI-8HCucC3DKZHD1vQ0by0IHFQ4EgqU278ZVXEzUEZ5dG5fvV3xusvpHQTRx-Mx8Syd6rc99nXPxsEdZdhbkCaRgbyitJdzMKELvyd0IPxSiRfJgPzpAv1I37qAilppYlDP_c7V-KtRYALmL8NiJAeXdiRIkArpqxP8cXMGDykuYwav1hwTvzrAFe8h78tULonPzj-9ekYjjtUlaqM-nnFehmtVG7A2WV0bkMrf5H7fqNCYnj_aFcBj5VQIcc5a1ete2SFPMk9oOyOzu4RucgkAgY6BhXIQcDXCt1b0mwoPfy5PfiP36M","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 15:42:45.632 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-11 15:42:45.639 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 15:42:45.646 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 15:42:45.657 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-11 15:42:45.667 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 15:42:45.677 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****Plcw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNE7ES771J4:00000003","TimeStamp":"2019-06-11T07:42:45.0000000Z","ProcessId":39352,"LocalIpAddress":"127.0.0.1:21194","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 15:42:45.679 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iq8agVo3BehTsJI-8HCucC3DKZHD1vQ0by0IHFQ4EgqU278ZVXEzUEZ5dG5fvV3xusvpHQTRx-Mx8Syd6rc99nXPxsEdZdhbkCaRgbyitJdzMKELvyd0IPxSiRfJgPzpAv1I37qAilppYlDP_c7V-KtRYALmL8NiJAeXdiRIkArpqxP8cXMGDykuYwav1hwTvzrAFe8h78tULonPzj-9ekYjjtUlaqM-nnFehmtVG7A2WV0bkMrf5H7fqNCYnj_aFcBj5VQIcc5a1ete2SFPMk9oOyOzu4RucgkAgY6BhXIQcDXCt1b0mwoPfy5PfiP36M","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 15:42:45.708 +08:00 [DBG] Augmenting SignInContext
2019-06-11 15:42:45.721 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-11 15:43:32.512 +08:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: https://jwt.io
2019-06-11 15:43:32.634 +08:00 [DBG] Origin https://jwt.io is allowed: false
2019-06-11 15:43:32.634 +08:00 [WRN] CorsPolicyService did not allow origin: https://jwt.io
2019-06-11 15:43:32.634 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 15:43:32.634 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 15:43:32.635 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 15:43:32.635 +08:00 [DBG] Start discovery request
2019-06-11 15:43:33.297 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 16:09:18.754 +08:00 [INF] Removing 0 grants
2019-06-11 17:35:51.519 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-11 17:35:51.550 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-11 17:35:51.550 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-11 17:35:51.550 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-11 17:35:51.551 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-11 17:35:51.551 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-11 17:35:52.006 +08:00 [DBG] Starting grant removal
2019-06-11 17:35:52.321 +08:00 [DBG] Login Url: /Account/Login
2019-06-11 17:35:52.324 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-11 17:35:52.324 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-11 17:35:52.324 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-11 17:35:52.324 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-11 17:35:52.324 +08:00 [DBG] Error Url: /home/error
2019-06-11 17:35:52.324 +08:00 [DBG] Error Id Parameter: errorId
2019-06-11 17:36:43.775 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 17:36:43.780 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 17:36:43.781 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 17:36:43.785 +08:00 [DBG] Start discovery request
2019-06-11 17:36:44.751 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 17:36:45.009 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 17:36:45.011 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 17:36:45.011 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 17:36:45.017 +08:00 [DBG] Start key discovery request
2019-06-11 17:36:45.114 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 17:36:45.120 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 17:36:45.121 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 17:36:45.126 +08:00 [DBG] Start authorize request
2019-06-11 17:36:45.139 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 17:36:45.144 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 17:36:46.388 +08:00 [DBG] mvcImp found in database: true
2019-06-11 17:36:46.396 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 17:36:46.644 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 17:36:46.788 +08:00 [DBG] Found [] API scopes in database
2019-06-11 17:36:46.992 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 17:36:47.099 +08:00 [DBG] Found [] API scopes in database
2019-06-11 17:36:47.106 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 17:36:47.120 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqpGxNIrwa6rlkEwjnkpx7Bb0k7kVV7ezewtiSMte9YmUrMWpvYOnhF5GfU5q9WmzRvH0TL2ePgUq48YrfK-H94haN4rAxmZg_FtwnxdudCbwUxTsLCreWFKXlkShXmF5ouw26fXJePqcWuOkgEp-3O-kN7e5KxDzCMDhsbleEleT1u9NxRgUIdp_0B0INIaiBLvwcffpWyyEPr_HBbllRtxR4wrNmJTNbhmhO8fBXZtmnLKONU8cW25Qd4JuVlWNmqq0PBpAZV5rJhoWCd2Ngcd49X4YepOlh8L0sHxkGURNAgpkKKj9fuXUO4Wu4R_gE","UiLocales":null,"Nonce":"636958426050809211.MmRjYmVhYmQtZmE4OC00ZDE3LTg4MzItZjU1ZDUwY2IzMGMyZWVjNWUxZDAtNTFkMC00YjQ0LWJjYmEtZjgwODhiNDkzNWEw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636958426050809211.MmRjYmVhYmQtZmE4OC00ZDE3LTg4MzItZjU1ZDUwY2IzMGMyZWVjNWUxZDAtNTFkMC00YjQ0LWJjYmEtZjgwODhiNDkzNWEw","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqpGxNIrwa6rlkEwjnkpx7Bb0k7kVV7ezewtiSMte9YmUrMWpvYOnhF5GfU5q9WmzRvH0TL2ePgUq48YrfK-H94haN4rAxmZg_FtwnxdudCbwUxTsLCreWFKXlkShXmF5ouw26fXJePqcWuOkgEp-3O-kN7e5KxDzCMDhsbleEleT1u9NxRgUIdp_0B0INIaiBLvwcffpWyyEPr_HBbllRtxR4wrNmJTNbhmhO8fBXZtmnLKONU8cW25Qd4JuVlWNmqq0PBpAZV5rJhoWCd2Ngcd49X4YepOlh8L0sHxkGURNAgpkKKj9fuXUO4Wu4R_gE","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 17:36:47.394 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-11 17:36:47.400 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 17:36:47.408 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 17:36:47.420 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-11 17:36:47.427 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 17:36:47.629 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****YKtw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNEA0OU33A5:00000003","TimeStamp":"2019-06-11T09:36:47.0000000Z","ProcessId":39564,"LocalIpAddress":"127.0.0.1:11593","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 17:36:47.632 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqpGxNIrwa6rlkEwjnkpx7Bb0k7kVV7ezewtiSMte9YmUrMWpvYOnhF5GfU5q9WmzRvH0TL2ePgUq48YrfK-H94haN4rAxmZg_FtwnxdudCbwUxTsLCreWFKXlkShXmF5ouw26fXJePqcWuOkgEp-3O-kN7e5KxDzCMDhsbleEleT1u9NxRgUIdp_0B0INIaiBLvwcffpWyyEPr_HBbllRtxR4wrNmJTNbhmhO8fBXZtmnLKONU8cW25Qd4JuVlWNmqq0PBpAZV5rJhoWCd2Ngcd49X4YepOlh8L0sHxkGURNAgpkKKj9fuXUO4Wu4R_gE","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 17:41:59.069 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 17:41:59.070 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 17:41:59.075 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 17:41:59.076 +08:00 [DBG] Start discovery request
2019-06-11 17:41:59.892 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 17:42:00.084 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 17:42:00.085 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 17:42:00.085 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 17:42:00.085 +08:00 [DBG] Start key discovery request
2019-06-11 17:42:00.163 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 17:42:00.165 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 17:42:00.165 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 17:42:00.165 +08:00 [DBG] Start authorize request
2019-06-11 17:42:00.166 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 17:42:00.166 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 17:42:01.183 +08:00 [DBG] mvcImp found in database: true
2019-06-11 17:42:01.183 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 17:42:01.355 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 17:42:01.468 +08:00 [DBG] Found [] API scopes in database
2019-06-11 17:42:01.639 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 17:42:01.751 +08:00 [DBG] Found [] API scopes in database
2019-06-11 17:42:01.752 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 17:42:01.752 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrdXjCNrFuW4YX6RPUXlI5aeHkuUi3apxgxOllANQdeYuR1WXVqPxS_NTsSmMFXsDEa5d6zyFnTGKcMLN9lZJTn_LytYF9tzd3NoVgD07szWJjWlu8YXxciw8ULmQFBMUa2qEJvzFRvSd4upMFHYTPTvck9glm-chmECO7QqX5bJtb_2eVNxTFB58a9AKg19uSEW-aShgGm7r5X79MKVZJqqWOsdG1WyfmWm6iUEiajQu7By-izVCRA9YjSFL2HW3xC5WxeCsW44ufBgieCS3Gux2umwAoGC0BtWIxVH859W1YfnserTqlj8wn7_Lpd5Bw","UiLocales":null,"Nonce":"636958429201276198.MDllY2I0NTMtZGUwNi00NDNlLWFiNTQtMmFmYTkzNDkzOTczMThjNDU2NWYtZTgzYy00MGJlLThiNjgtM2VlYTI1MGY3MjA2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636958429201276198.MDllY2I0NTMtZGUwNi00NDNlLWFiNTQtMmFmYTkzNDkzOTczMThjNDU2NWYtZTgzYy00MGJlLThiNjgtM2VlYTI1MGY3MjA2","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrdXjCNrFuW4YX6RPUXlI5aeHkuUi3apxgxOllANQdeYuR1WXVqPxS_NTsSmMFXsDEa5d6zyFnTGKcMLN9lZJTn_LytYF9tzd3NoVgD07szWJjWlu8YXxciw8ULmQFBMUa2qEJvzFRvSd4upMFHYTPTvck9glm-chmECO7QqX5bJtb_2eVNxTFB58a9AKg19uSEW-aShgGm7r5X79MKVZJqqWOsdG1WyfmWm6iUEiajQu7By-izVCRA9YjSFL2HW3xC5WxeCsW44ufBgieCS3Gux2umwAoGC0BtWIxVH859W1YfnserTqlj8wn7_Lpd5Bw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 17:42:01.970 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-11 17:42:01.974 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 17:42:01.974 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 17:42:01.974 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-11 17:42:01.974 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 17:42:01.978 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****2LAQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNEA0OU33A6:00000003","TimeStamp":"2019-06-11T09:42:01.0000000Z","ProcessId":39564,"LocalIpAddress":"127.0.0.1:11593","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 17:42:01.978 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrdXjCNrFuW4YX6RPUXlI5aeHkuUi3apxgxOllANQdeYuR1WXVqPxS_NTsSmMFXsDEa5d6zyFnTGKcMLN9lZJTn_LytYF9tzd3NoVgD07szWJjWlu8YXxciw8ULmQFBMUa2qEJvzFRvSd4upMFHYTPTvck9glm-chmECO7QqX5bJtb_2eVNxTFB58a9AKg19uSEW-aShgGm7r5X79MKVZJqqWOsdG1WyfmWm6iUEiajQu7By-izVCRA9YjSFL2HW3xC5WxeCsW44ufBgieCS3Gux2umwAoGC0BtWIxVH859W1YfnserTqlj8wn7_Lpd5Bw","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 17:42:06.501 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 17:42:06.501 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 17:42:06.502 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 17:42:06.502 +08:00 [DBG] Start discovery request
2019-06-11 17:42:07.126 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 17:42:07.261 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 17:42:07.261 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 17:42:07.262 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 17:42:07.262 +08:00 [DBG] Start key discovery request
2019-06-11 17:44:12.247 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 17:44:12.255 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 17:44:12.255 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 17:44:12.255 +08:00 [DBG] Start discovery request
2019-06-11 17:44:12.943 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 17:44:13.075 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 17:44:13.075 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 17:44:13.076 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 17:44:13.076 +08:00 [DBG] Start key discovery request
2019-06-11 17:44:13.252 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-11 17:44:13.256 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-11 17:44:13.256 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-11 17:44:13.271 +08:00 [DBG] Start token request.
2019-06-11 17:44:13.280 +08:00 [DBG] Start client validation
2019-06-11 17:44:13.285 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-11 17:44:13.288 +08:00 [DBG] Start parsing for secret in post body
2019-06-11 17:44:13.309 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-11 17:44:13.309 +08:00 [DBG] Secret id found: client
2019-06-11 17:44:14.327 +08:00 [DBG] client found in database: true
2019-06-11 17:44:14.327 +08:00 [DBG] client configuration validation for client client succeeded.
2019-06-11 17:44:14.338 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-11 17:44:14.338 +08:00 [DBG] Client validation success
2019-06-11 17:44:14.339 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNEA0OU33A7:00000003","TimeStamp":"2019-06-11T09:44:14.0000000Z","ProcessId":39564,"LocalIpAddress":"127.0.0.1:11593","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-11 17:44:14.345 +08:00 [DBG] Start token request validation
2019-06-11 17:44:14.352 +08:00 [DBG] Start client credentials token request validation
2019-06-11 17:44:14.462 +08:00 [DBG] Found [] identity scopes in database
2019-06-11 17:44:14.976 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-11 17:44:15.090 +08:00 [DBG] Found [] identity scopes in database
2019-06-11 17:44:15.577 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-11 17:44:15.580 +08:00 [DBG] client credentials token request validation success
2019-06-11 17:44:15.582 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-06-11 17:44:15.602 +08:00 [DBG] Getting claims for access token for client: client
2019-06-11 17:44:15.609 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****bafw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNEA0OU33A7:00000003","TimeStamp":"2019-06-11T09:44:15.0000000Z","ProcessId":39564,"LocalIpAddress":"127.0.0.1:11593","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 17:44:15.610 +08:00 [DBG] Token request success.
2019-06-11 17:44:15.896 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 17:44:15.898 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 17:44:15.898 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 17:44:15.898 +08:00 [DBG] Start discovery request
2019-06-11 17:44:16.524 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 17:44:16.716 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 17:44:16.717 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 17:44:16.717 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 17:44:16.717 +08:00 [DBG] Start key discovery request
2019-06-11 17:44:50.819 +08:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: https://jwt.io
2019-06-11 17:44:50.940 +08:00 [DBG] Origin https://jwt.io is allowed: false
2019-06-11 17:44:50.940 +08:00 [WRN] CorsPolicyService did not allow origin: https://jwt.io
2019-06-11 17:44:50.940 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 17:44:50.940 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 17:44:50.940 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 17:44:50.941 +08:00 [DBG] Start discovery request
2019-06-11 17:44:51.625 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 17:47:43.034 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 17:47:43.035 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 17:47:43.035 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 17:47:43.035 +08:00 [DBG] Start discovery request
2019-06-11 17:47:43.713 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 17:47:43.915 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 17:47:43.915 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 17:47:43.916 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 17:47:43.916 +08:00 [DBG] Start key discovery request
2019-06-11 17:47:43.995 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 17:47:43.995 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 17:47:43.996 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 17:47:43.996 +08:00 [DBG] Start authorize request
2019-06-11 17:47:43.996 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 17:47:43.996 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 17:47:45.014 +08:00 [DBG] mvcImp found in database: true
2019-06-11 17:47:45.014 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 17:47:45.191 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 17:47:45.312 +08:00 [DBG] Found [] API scopes in database
2019-06-11 17:47:45.487 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 17:47:45.591 +08:00 [DBG] Found [] API scopes in database
2019-06-11 17:47:45.591 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 17:47:45.592 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoV1ITqDYG0zgIMTKDRoYYnQx0xNt50Exhv4HGZyrWnifj39jUuPq76Y7KKI8Yy8r34HNDfpDWz21km5pFMtyRh_z2yFtQCHpEbq-Ycp0P04U2bpJOorAcrth6E-apmWy2EFOHmMmL1OJ6E8sd3vpnZpZ_x6RjaUTUPBoOIG-ckdFHBABKbwt7-HtSHBOo2oeiezWhOPTRgHFMxNi3JA857rWsd-ddZusMOhfpsc57ZNjphOrxO5bv92RTSGnq2KvcKx7wEyPM7JOa9CPm0gNYJlkM2gONVW5P-6UbvhedZlmm-pgpY4z6NDS0VOGlnRWw","UiLocales":null,"Nonce":"636958432639473174.YzhjNGI0MGYtYjEyNi00ZGI2LWJjZWUtZjNlOWE5NDI5MzE3MzhmM2RhMDAtZTk4NC00MTcxLWIwYzgtZjE2NjI2NWEwMGQ3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636958432639473174.YzhjNGI0MGYtYjEyNi00ZGI2LWJjZWUtZjNlOWE5NDI5MzE3MzhmM2RhMDAtZTk4NC00MTcxLWIwYzgtZjE2NjI2NWEwMGQ3","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoV1ITqDYG0zgIMTKDRoYYnQx0xNt50Exhv4HGZyrWnifj39jUuPq76Y7KKI8Yy8r34HNDfpDWz21km5pFMtyRh_z2yFtQCHpEbq-Ycp0P04U2bpJOorAcrth6E-apmWy2EFOHmMmL1OJ6E8sd3vpnZpZ_x6RjaUTUPBoOIG-ckdFHBABKbwt7-HtSHBOo2oeiezWhOPTRgHFMxNi3JA857rWsd-ddZusMOhfpsc57ZNjphOrxO5bv92RTSGnq2KvcKx7wEyPM7JOa9CPm0gNYJlkM2gONVW5P-6UbvhedZlmm-pgpY4z6NDS0VOGlnRWw","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 17:47:45.829 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-11 17:47:45.833 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 17:47:45.833 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 17:47:45.833 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-11 17:47:45.833 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 17:47:45.836 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****_8Lw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNEA0OU33A8:00000003","TimeStamp":"2019-06-11T09:47:45.0000000Z","ProcessId":39564,"LocalIpAddress":"127.0.0.1:11593","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 17:47:45.837 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoV1ITqDYG0zgIMTKDRoYYnQx0xNt50Exhv4HGZyrWnifj39jUuPq76Y7KKI8Yy8r34HNDfpDWz21km5pFMtyRh_z2yFtQCHpEbq-Ycp0P04U2bpJOorAcrth6E-apmWy2EFOHmMmL1OJ6E8sd3vpnZpZ_x6RjaUTUPBoOIG-ckdFHBABKbwt7-HtSHBOo2oeiezWhOPTRgHFMxNi3JA857rWsd-ddZusMOhfpsc57ZNjphOrxO5bv92RTSGnq2KvcKx7wEyPM7JOa9CPm0gNYJlkM2gONVW5P-6UbvhedZlmm-pgpY4z6NDS0VOGlnRWw","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 17:48:09.737 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 17:48:09.738 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 17:48:09.738 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 17:48:09.738 +08:00 [DBG] Start discovery request
2019-06-11 17:48:10.369 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 17:48:10.631 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 17:48:10.632 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 17:48:10.632 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 17:48:10.633 +08:00 [DBG] Start key discovery request
2019-06-11 17:52:14.520 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 17:52:14.521 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 17:52:14.521 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 17:52:14.521 +08:00 [DBG] Start discovery request
2019-06-11 17:52:15.363 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 17:52:15.505 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 17:52:15.506 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 17:52:15.506 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 17:52:15.506 +08:00 [DBG] Start key discovery request
2019-06-11 17:52:15.590 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 17:52:15.591 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 17:52:15.591 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 17:52:15.591 +08:00 [DBG] Start authorize request
2019-06-11 17:52:15.591 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 17:52:15.591 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 17:52:16.647 +08:00 [DBG] mvcImp found in database: true
2019-06-11 17:52:16.647 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 17:52:16.825 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 17:52:16.936 +08:00 [DBG] Found [] API scopes in database
2019-06-11 17:52:17.110 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 17:52:17.228 +08:00 [DBG] Found [] API scopes in database
2019-06-11 17:52:17.228 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 17:52:17.228 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iq2av30wnHTMTPC50he9XLJ_kVnM0My3hniBNpgnJ9GBBDqssPIUfljwCq9PbqmcGXZQ_7qKEMv2tMi2pRzogiL-MJueWIUsdFDA_EWeffXRKa5ugqzvctSZ4P-lCf1_p3HF4FM1G8WaJ5OjNUGgaqd_Z_ZrWL1h8nQ-xpj3XUlq0Vk83KanphRzwj96vaz7BiBLNx4Rn1KRGl8zRyNjtLi0G-0zmpBtT_U985PDb1WVeVt3a45UctM7le1vGUb20GSR9S5AwN82AnmED2iSARQap2Num9_7Df_SEhWdzZQi-FJX1xmQDzMZhy2avNM7pI","UiLocales":null,"Nonce":"636958435355377913.NjY0NzRkZjgtZDEyZS00NWM0LWE0NzUtNzJkMjg1YmZlYWYyMzk1OGJiNTYtOTJjMi00ODM0LWJmMTEtYmUxNzI3OTM5YTUx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636958435355377913.NjY0NzRkZjgtZDEyZS00NWM0LWE0NzUtNzJkMjg1YmZlYWYyMzk1OGJiNTYtOTJjMi00ODM0LWJmMTEtYmUxNzI3OTM5YTUx","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iq2av30wnHTMTPC50he9XLJ_kVnM0My3hniBNpgnJ9GBBDqssPIUfljwCq9PbqmcGXZQ_7qKEMv2tMi2pRzogiL-MJueWIUsdFDA_EWeffXRKa5ugqzvctSZ4P-lCf1_p3HF4FM1G8WaJ5OjNUGgaqd_Z_ZrWL1h8nQ-xpj3XUlq0Vk83KanphRzwj96vaz7BiBLNx4Rn1KRGl8zRyNjtLi0G-0zmpBtT_U985PDb1WVeVt3a45UctM7le1vGUb20GSR9S5AwN82AnmED2iSARQap2Num9_7Df_SEhWdzZQi-FJX1xmQDzMZhy2avNM7pI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 17:52:17.441 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-11 17:52:17.444 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 17:52:17.444 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 17:52:17.444 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-11 17:52:17.444 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 17:52:17.449 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****CGsw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNEA0OU33A9:00000003","TimeStamp":"2019-06-11T09:52:17.0000000Z","ProcessId":39564,"LocalIpAddress":"127.0.0.1:11593","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 17:52:17.449 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iq2av30wnHTMTPC50he9XLJ_kVnM0My3hniBNpgnJ9GBBDqssPIUfljwCq9PbqmcGXZQ_7qKEMv2tMi2pRzogiL-MJueWIUsdFDA_EWeffXRKa5ugqzvctSZ4P-lCf1_p3HF4FM1G8WaJ5OjNUGgaqd_Z_ZrWL1h8nQ-xpj3XUlq0Vk83KanphRzwj96vaz7BiBLNx4Rn1KRGl8zRyNjtLi0G-0zmpBtT_U985PDb1WVeVt3a45UctM7le1vGUb20GSR9S5AwN82AnmED2iSARQap2Num9_7Df_SEhWdzZQi-FJX1xmQDzMZhy2avNM7pI","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 17:54:35.920 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 17:54:35.921 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 17:54:35.921 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 17:54:35.921 +08:00 [DBG] Start discovery request
2019-06-11 17:54:36.559 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 17:54:36.764 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 17:54:36.765 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 17:54:36.765 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 17:54:36.765 +08:00 [DBG] Start key discovery request
2019-06-11 17:55:08.021 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-11 17:55:08.021 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-11 17:55:08.021 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-11 17:55:08.021 +08:00 [DBG] Start authorize request
2019-06-11 17:55:08.022 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-11 17:55:08.022 +08:00 [DBG] Start authorize request protocol validation
2019-06-11 17:55:09.021 +08:00 [DBG] mvcImp found in database: true
2019-06-11 17:55:09.022 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-11 17:55:09.191 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 17:55:09.295 +08:00 [DBG] Found [] API scopes in database
2019-06-11 17:55:09.496 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-11 17:55:09.608 +08:00 [DBG] Found [] API scopes in database
2019-06-11 17:55:09.608 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-11 17:55:09.609 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqUjqV1raEvC_Ucstcr9nDKQblsZ9y7GhcTl8ucpIbYaroFntgehGjuWhCxjqY8qAyzvGdb6So3hsVRIbteVSSl1LEtoVBaHeievuIWXxcnIkVoGPIu46buuGi4gPaUluZIXqoV4zpym59JDGLU7B-VbsgTp1wuL5b0_I7yMTmNuDRT4cEKY-8OKP2ncNQEwbroeacMMvLIls_rOUcFtKMzMEWOX5uc5vufPW0Rb5WIsT-VP56_53N03ITiTRFaZtrhln9rwi3TqgPAoGnZjkoogmacA5R-B58NbTx3_xG8gOmLOEIMSjadApGTrxY1TAo","UiLocales":null,"Nonce":"636958437080009488.NTkyNDQyMTQtMTllZi00NjAwLThmZTUtZGQwYzAzYThlZTZmYmNkZjlhNDMtOTZmZi00ODgxLTkzNzktNTVhZmQ4YTFlNmEx","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636958437080009488.NTkyNDQyMTQtMTllZi00NjAwLThmZTUtZGQwYzAzYThlZTZmYmNkZjlhNDMtOTZmZi00ODgxLTkzNzktNTVhZmQ4YTFlNmEx","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqUjqV1raEvC_Ucstcr9nDKQblsZ9y7GhcTl8ucpIbYaroFntgehGjuWhCxjqY8qAyzvGdb6So3hsVRIbteVSSl1LEtoVBaHeievuIWXxcnIkVoGPIu46buuGi4gPaUluZIXqoV4zpym59JDGLU7B-VbsgTp1wuL5b0_I7yMTmNuDRT4cEKY-8OKP2ncNQEwbroeacMMvLIls_rOUcFtKMzMEWOX5uc5vufPW0Rb5WIsT-VP56_53N03ITiTRFaZtrhln9rwi3TqgPAoGnZjkoogmacA5R-B58NbTx3_xG8gOmLOEIMSjadApGTrxY1TAo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-11 17:55:09.823 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-11 17:55:09.827 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-11 17:55:09.827 +08:00 [DBG] Creating Implicit Flow response.
2019-06-11 17:55:09.827 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-11 17:55:09.827 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-11 17:55:09.830 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****vU3g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNEA0OU33AA:00000003","TimeStamp":"2019-06-11T09:55:09.0000000Z","ProcessId":39564,"LocalIpAddress":"127.0.0.1:11593","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 17:55:09.831 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqUjqV1raEvC_Ucstcr9nDKQblsZ9y7GhcTl8ucpIbYaroFntgehGjuWhCxjqY8qAyzvGdb6So3hsVRIbteVSSl1LEtoVBaHeievuIWXxcnIkVoGPIu46buuGi4gPaUluZIXqoV4zpym59JDGLU7B-VbsgTp1wuL5b0_I7yMTmNuDRT4cEKY-8OKP2ncNQEwbroeacMMvLIls_rOUcFtKMzMEWOX5uc5vufPW0Rb5WIsT-VP56_53N03ITiTRFaZtrhln9rwi3TqgPAoGnZjkoogmacA5R-B58NbTx3_xG8gOmLOEIMSjadApGTrxY1TAo","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-11 17:58:33.642 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 17:58:33.643 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 17:58:33.643 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 17:58:33.643 +08:00 [DBG] Start discovery request
2019-06-11 17:58:34.268 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 17:58:34.328 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 17:58:34.329 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 17:58:34.329 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 17:58:34.329 +08:00 [DBG] Start key discovery request
2019-06-11 17:58:34.464 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-11 17:58:34.465 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-11 17:58:34.465 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-11 17:58:34.465 +08:00 [DBG] Start token request.
2019-06-11 17:58:34.465 +08:00 [DBG] Start client validation
2019-06-11 17:58:34.466 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-11 17:58:34.466 +08:00 [DBG] Start parsing for secret in post body
2019-06-11 17:58:34.466 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-11 17:58:34.466 +08:00 [DBG] Secret id found: client
2019-06-11 17:58:35.531 +08:00 [DBG] client found in database: true
2019-06-11 17:58:35.531 +08:00 [DBG] client configuration validation for client client succeeded.
2019-06-11 17:58:35.532 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-11 17:58:35.532 +08:00 [DBG] Client validation success
2019-06-11 17:58:35.532 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNEA0OU33AB:00000003","TimeStamp":"2019-06-11T09:58:35.0000000Z","ProcessId":39564,"LocalIpAddress":"127.0.0.1:11593","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-11 17:58:35.532 +08:00 [DBG] Start token request validation
2019-06-11 17:58:35.532 +08:00 [DBG] Start client credentials token request validation
2019-06-11 17:58:35.651 +08:00 [DBG] Found [] identity scopes in database
2019-06-11 17:58:36.164 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-11 17:58:36.277 +08:00 [DBG] Found [] identity scopes in database
2019-06-11 17:58:36.811 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-11 17:58:36.811 +08:00 [DBG] client credentials token request validation success
2019-06-11 17:58:36.811 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-06-11 17:58:36.812 +08:00 [DBG] Getting claims for access token for client: client
2019-06-11 17:58:36.815 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****CD0g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNEA0OU33AB:00000003","TimeStamp":"2019-06-11T09:58:36.0000000Z","ProcessId":39564,"LocalIpAddress":"127.0.0.1:11593","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 17:58:36.815 +08:00 [DBG] Token request success.
2019-06-11 17:58:37.125 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 17:58:37.126 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 17:58:37.126 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 17:58:37.127 +08:00 [DBG] Start discovery request
2019-06-11 17:58:37.734 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 17:58:37.927 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 17:58:37.927 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 17:58:37.927 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 17:58:37.928 +08:00 [DBG] Start key discovery request
2019-06-11 17:58:54.940 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 17:58:54.941 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 17:58:54.941 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 17:58:54.941 +08:00 [DBG] Start discovery request
2019-06-11 17:58:55.567 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 17:58:55.590 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 17:58:55.591 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 17:58:55.591 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 17:58:55.591 +08:00 [DBG] Start key discovery request
2019-06-11 17:58:55.602 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-11 17:58:55.604 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-11 17:58:55.605 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-11 17:58:55.605 +08:00 [DBG] Start token request.
2019-06-11 17:58:55.605 +08:00 [DBG] Start client validation
2019-06-11 17:58:55.605 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-11 17:58:55.605 +08:00 [DBG] Start parsing for secret in post body
2019-06-11 17:58:55.605 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-11 17:58:55.606 +08:00 [DBG] Secret id found: client
2019-06-11 17:58:56.612 +08:00 [DBG] client found in database: true
2019-06-11 17:58:56.612 +08:00 [DBG] client configuration validation for client client succeeded.
2019-06-11 17:58:56.612 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-11 17:58:56.612 +08:00 [DBG] Client validation success
2019-06-11 17:58:56.612 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNEA0OU33AB:00000008","TimeStamp":"2019-06-11T09:58:56.0000000Z","ProcessId":39564,"LocalIpAddress":"127.0.0.1:11593","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-11 17:58:56.613 +08:00 [DBG] Start token request validation
2019-06-11 17:58:56.613 +08:00 [DBG] Start client credentials token request validation
2019-06-11 17:58:56.714 +08:00 [DBG] Found [] identity scopes in database
2019-06-11 17:58:57.602 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-11 17:58:57.705 +08:00 [DBG] Found [] identity scopes in database
2019-06-11 17:58:58.188 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-11 17:58:58.188 +08:00 [DBG] client credentials token request validation success
2019-06-11 17:58:58.188 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-06-11 17:58:58.188 +08:00 [DBG] Getting claims for access token for client: client
2019-06-11 17:58:58.191 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****TVIQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNEA0OU33AB:00000008","TimeStamp":"2019-06-11T09:58:58.0000000Z","ProcessId":39564,"LocalIpAddress":"127.0.0.1:11593","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 17:58:58.191 +08:00 [DBG] Token request success.
2019-06-11 18:03:31.297 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-11 18:03:31.297 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-11 18:03:31.297 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-11 18:03:31.297 +08:00 [DBG] Start discovery request
2019-06-11 18:03:32.100 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-11 18:03:32.143 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-11 18:03:32.144 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-11 18:03:32.144 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-11 18:03:32.144 +08:00 [DBG] Start key discovery request
2019-06-11 18:03:32.178 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-11 18:03:32.179 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-11 18:03:32.181 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-11 18:03:32.182 +08:00 [DBG] Start token request.
2019-06-11 18:03:32.182 +08:00 [DBG] Start client validation
2019-06-11 18:03:32.182 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-11 18:03:32.182 +08:00 [DBG] Start parsing for secret in post body
2019-06-11 18:03:32.182 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-11 18:03:32.183 +08:00 [DBG] Secret id found: client
2019-06-11 18:03:33.201 +08:00 [DBG] client found in database: true
2019-06-11 18:03:33.201 +08:00 [DBG] client configuration validation for client client succeeded.
2019-06-11 18:03:33.201 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-11 18:03:33.201 +08:00 [DBG] Client validation success
2019-06-11 18:03:33.202 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNEA0OU33AC:00000003","TimeStamp":"2019-06-11T10:03:33.0000000Z","ProcessId":39564,"LocalIpAddress":"127.0.0.1:11593","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-11 18:03:33.202 +08:00 [DBG] Start token request validation
2019-06-11 18:03:33.202 +08:00 [DBG] Start client credentials token request validation
2019-06-11 18:03:33.302 +08:00 [DBG] Found [] identity scopes in database
2019-06-11 18:03:33.812 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-11 18:03:33.912 +08:00 [DBG] Found [] identity scopes in database
2019-06-11 18:03:34.408 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-11 18:03:34.408 +08:00 [DBG] client credentials token request validation success
2019-06-11 18:03:34.408 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-06-11 18:03:34.408 +08:00 [DBG] Getting claims for access token for client: client
2019-06-11 18:03:34.411 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****kt_A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNEA0OU33AC:00000003","TimeStamp":"2019-06-11T10:03:34.0000000Z","ProcessId":39564,"LocalIpAddress":"127.0.0.1:11593","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-11 18:03:34.411 +08:00 [DBG] Token request success.
2019-06-13 14:08:30.871 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 14:08:30.922 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 14:08:30.922 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 14:08:30.922 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 14:08:30.923 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 14:08:30.923 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 14:08:31.417 +08:00 [DBG] Starting grant removal
2019-06-13 14:08:31.700 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 14:08:31.703 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 14:08:31.703 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 14:08:31.703 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 14:08:31.703 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 14:08:31.703 +08:00 [DBG] Error Url: /home/error
2019-06-13 14:08:31.703 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 14:16:44.760 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 14:16:44.764 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 14:16:44.764 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 14:16:44.769 +08:00 [DBG] Start discovery request
2019-06-13 14:16:45.995 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 14:16:46.266 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 14:16:46.268 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 14:16:46.268 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 14:16:46.272 +08:00 [DBG] Start key discovery request
2019-06-13 14:16:46.392 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 14:16:46.394 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 14:16:46.395 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 14:16:46.400 +08:00 [DBG] Start authorize request
2019-06-13 14:16:46.410 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 14:16:46.416 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 14:16:47.869 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:16:47.877 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:16:48.145 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:16:48.318 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:16:48.544 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:16:48.680 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:16:48.688 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 14:16:48.703 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrqTcbR7EMhx8X801X6PO1JcZCecVamenI_EqV236li8qquAvwn6NoT7dxmDz6O8g87iAnGK8Edgzj36Vzx2Dla8b8SEIJizveysZLZ2S6yofuw23HIEbKx_agHTM3uOYoYsqKcrlqVtz4oTbil37A0YYtaaFJNOY-nyFq-erNXfyUb1uiCeGoi6aXMjeEnrubKo8vMIu_JQwGvr6gZ7YvIqHMf6lPR2t07s_5sMuB7VemdHHkxUSsB2vXWX6P6gqDgTqfL3ZxOty0oDw0TS8ShrsO89rXomZqiX_idz2eqQyASdlBtX9XRHJD3smGvwcI","UiLocales":null,"Nonce":"636960034063268177.MmFhMTU4ZGMtMDM4MS00MGVhLTg0MmMtMDI4MmQ2Yzk4YTg4NmY1ODgzMTctNTNlMi00MTgyLTk5MzMtNTU0NDM4OWFhMzIw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636960034063268177.MmFhMTU4ZGMtMDM4MS00MGVhLTg0MmMtMDI4MmQ2Yzk4YTg4NmY1ODgzMTctNTNlMi00MTgyLTk5MzMtNTU0NDM4OWFhMzIw","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrqTcbR7EMhx8X801X6PO1JcZCecVamenI_EqV236li8qquAvwn6NoT7dxmDz6O8g87iAnGK8Edgzj36Vzx2Dla8b8SEIJizveysZLZ2S6yofuw23HIEbKx_agHTM3uOYoYsqKcrlqVtz4oTbil37A0YYtaaFJNOY-nyFq-erNXfyUb1uiCeGoi6aXMjeEnrubKo8vMIu_JQwGvr6gZ7YvIqHMf6lPR2t07s_5sMuB7VemdHHkxUSsB2vXWX6P6gqDgTqfL3ZxOty0oDw0TS8ShrsO89rXomZqiX_idz2eqQyASdlBtX9XRHJD3smGvwcI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 14:16:49.021 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-13 14:16:49.027 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 14:16:49.035 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 14:16:49.045 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-13 14:16:49.053 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 14:16:49.229 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****qeRg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFOM7ON71L:00000003","TimeStamp":"2019-06-13T06:16:49.0000000Z","ProcessId":32304,"LocalIpAddress":"127.0.0.1:38438","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 14:16:49.233 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrqTcbR7EMhx8X801X6PO1JcZCecVamenI_EqV236li8qquAvwn6NoT7dxmDz6O8g87iAnGK8Edgzj36Vzx2Dla8b8SEIJizveysZLZ2S6yofuw23HIEbKx_agHTM3uOYoYsqKcrlqVtz4oTbil37A0YYtaaFJNOY-nyFq-erNXfyUb1uiCeGoi6aXMjeEnrubKo8vMIu_JQwGvr6gZ7YvIqHMf6lPR2t07s_5sMuB7VemdHHkxUSsB2vXWX6P6gqDgTqfL3ZxOty0oDw0TS8ShrsO89rXomZqiX_idz2eqQyASdlBtX9XRHJD3smGvwcI","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 14:20:26.638 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 14:20:26.638 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 14:20:26.639 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 14:20:26.639 +08:00 [DBG] Start authorize request
2019-06-13 14:20:26.639 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 14:20:26.640 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 14:20:27.926 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:20:27.926 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:20:28.126 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:20:28.236 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:20:28.447 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:20:28.568 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:20:28.569 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 14:20:28.569 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Irg_tWRI_tZK_MpbiQV8t_8cRsz4wlgoNTT3e__3uBsov3vxt-DZhjIzFjHhBxaC5taoOSfGrT_hqbuLO6Pzg6rDM_RDRTuwWxVCxa4VBivfoEl05eoVyGL27GfhUcT5BjXYCW2DWKAxOn_AtBA5pLRX1qIMxIEpQ6is2klpdz6RAyoYaX2fhOcPQYVkNmn5DDNFsCoeIxN6Sme7Y6019lmzWKiB9At_25LDn7-qRGlrBo5tt2MsKZzMSfvFZlqSxixNpJBGmDlLVtOBo3fXQoVTret4Ug_WrVoHKyGj1ZJoDy2_8ndxM4va_kerv7Dbhk","UiLocales":null,"Nonce":"636960036265970727.ODEwMjkzMWMtYWMzNC00MTYwLThhNDItNGU2OGNiOThjZjBhZTJmMWQxNzAtMDNmNS00ODllLTk3NjgtMzBkNzhmMzBjMzJl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636960036265970727.ODEwMjkzMWMtYWMzNC00MTYwLThhNDItNGU2OGNiOThjZjBhZTJmMWQxNzAtMDNmNS00ODllLTk3NjgtMzBkNzhmMzBjMzJl","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Irg_tWRI_tZK_MpbiQV8t_8cRsz4wlgoNTT3e__3uBsov3vxt-DZhjIzFjHhBxaC5taoOSfGrT_hqbuLO6Pzg6rDM_RDRTuwWxVCxa4VBivfoEl05eoVyGL27GfhUcT5BjXYCW2DWKAxOn_AtBA5pLRX1qIMxIEpQ6is2klpdz6RAyoYaX2fhOcPQYVkNmn5DDNFsCoeIxN6Sme7Y6019lmzWKiB9At_25LDn7-qRGlrBo5tt2MsKZzMSfvFZlqSxixNpJBGmDlLVtOBo3fXQoVTret4Ug_WrVoHKyGj1ZJoDy2_8ndxM4va_kerv7Dbhk","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 14:20:28.837 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-13 14:20:28.841 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 14:20:28.842 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 14:20:28.842 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-13 14:20:28.842 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 14:20:28.845 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****5CUA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFOM7ON71M:00000001","TimeStamp":"2019-06-13T06:20:28.0000000Z","ProcessId":32304,"LocalIpAddress":"127.0.0.1:38438","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 14:20:28.846 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Irg_tWRI_tZK_MpbiQV8t_8cRsz4wlgoNTT3e__3uBsov3vxt-DZhjIzFjHhBxaC5taoOSfGrT_hqbuLO6Pzg6rDM_RDRTuwWxVCxa4VBivfoEl05eoVyGL27GfhUcT5BjXYCW2DWKAxOn_AtBA5pLRX1qIMxIEpQ6is2klpdz6RAyoYaX2fhOcPQYVkNmn5DDNFsCoeIxN6Sme7Y6019lmzWKiB9At_25LDn7-qRGlrBo5tt2MsKZzMSfvFZlqSxixNpJBGmDlLVtOBo3fXQoVTret4Ug_WrVoHKyGj1ZJoDy2_8ndxM4va_kerv7Dbhk","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 14:23:45.997 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 14:23:45.998 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 14:23:45.998 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 14:23:45.998 +08:00 [DBG] Start discovery request
2019-06-13 14:23:46.747 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 14:23:46.937 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 14:23:46.938 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 14:23:46.938 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 14:23:46.938 +08:00 [DBG] Start key discovery request
2019-06-13 14:23:47.023 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 14:23:47.023 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 14:23:47.023 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 14:23:47.023 +08:00 [DBG] Start authorize request
2019-06-13 14:23:47.024 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 14:23:47.024 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 14:23:48.115 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:23:48.115 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:23:48.314 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:23:48.435 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:23:48.641 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:23:48.757 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:23:48.757 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 14:23:48.757 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ip10L95Dn3t1bmwnILtogll97Wy1Sm_kaI577qAHm31hd1rWzIOmGppl9D3jizRUl-ZJzqbQ2YbyEEKEuzYPfL1gl0d1DFbFhkHyeLd3BuhfhS6bhOa3ofBsg6lqgY_Y8dtgdBUpL4zEE0RojI7PM20iqocFG18depauiWMuRk4ewC3L3ZhHponpiXjWufezWJgQUctchc6rdyuN_My9XbXLwkmTRX2vTR1RI8AAPpFcGtkRJv592rTdQX5OQCYPAk_ls02ZygPzzrWkOa5SL8_2cTViMrEqwHWjP2FKxXXKAPL2bgS9x-FSCxQPPAm6Dg","UiLocales":null,"Nonce":"636960038269799836.MWM0ODM5MmEtMDhiZS00NzM0LWJlOGYtOTYzOTk2Mjc0Y2U0YjU1ZTMxMTctNDhmYS00Nzg3LWEyYTQtMTZhNDJlMzkyYjgy","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636960038269799836.MWM0ODM5MmEtMDhiZS00NzM0LWJlOGYtOTYzOTk2Mjc0Y2U0YjU1ZTMxMTctNDhmYS00Nzg3LWEyYTQtMTZhNDJlMzkyYjgy","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ip10L95Dn3t1bmwnILtogll97Wy1Sm_kaI577qAHm31hd1rWzIOmGppl9D3jizRUl-ZJzqbQ2YbyEEKEuzYPfL1gl0d1DFbFhkHyeLd3BuhfhS6bhOa3ofBsg6lqgY_Y8dtgdBUpL4zEE0RojI7PM20iqocFG18depauiWMuRk4ewC3L3ZhHponpiXjWufezWJgQUctchc6rdyuN_My9XbXLwkmTRX2vTR1RI8AAPpFcGtkRJv592rTdQX5OQCYPAk_ls02ZygPzzrWkOa5SL8_2cTViMrEqwHWjP2FKxXXKAPL2bgS9x-FSCxQPPAm6Dg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 14:23:48.985 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-13 14:23:48.989 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 14:23:48.989 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 14:23:48.989 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-13 14:23:48.989 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 14:23:48.993 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****TvjQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFOM7ON71N:00000003","TimeStamp":"2019-06-13T06:23:48.0000000Z","ProcessId":32304,"LocalIpAddress":"127.0.0.1:38438","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 14:23:48.993 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ip10L95Dn3t1bmwnILtogll97Wy1Sm_kaI577qAHm31hd1rWzIOmGppl9D3jizRUl-ZJzqbQ2YbyEEKEuzYPfL1gl0d1DFbFhkHyeLd3BuhfhS6bhOa3ofBsg6lqgY_Y8dtgdBUpL4zEE0RojI7PM20iqocFG18depauiWMuRk4ewC3L3ZhHponpiXjWufezWJgQUctchc6rdyuN_My9XbXLwkmTRX2vTR1RI8AAPpFcGtkRJv592rTdQX5OQCYPAk_ls02ZygPzzrWkOa5SL8_2cTViMrEqwHWjP2FKxXXKAPL2bgS9x-FSCxQPPAm6Dg","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 14:29:50.103 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 14:29:50.104 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 14:29:50.105 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 14:29:50.105 +08:00 [DBG] Start discovery request
2019-06-13 14:29:50.998 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 14:29:51.201 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 14:29:51.202 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 14:29:51.202 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 14:29:51.202 +08:00 [DBG] Start key discovery request
2019-06-13 14:29:51.295 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 14:29:51.295 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 14:29:51.295 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 14:29:51.295 +08:00 [DBG] Start authorize request
2019-06-13 14:29:51.295 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 14:29:51.296 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 14:29:52.460 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:29:52.461 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:29:52.681 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:29:52.815 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:29:53.026 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:29:53.148 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:29:53.148 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 14:29:53.148 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpDSF5ZSfRndpDb4o5hpEmmkq3ivtRvnpP9Ls7EkyLr0900gIWlpSGLWb8dYmcpg172jRexfvvfvn49FbyJsNQ49wl1PCUeIzlzHAczqpDxKhJ66Tr16wZ2u-wod4Ze_-qkG_5Pit1p7YltmdjPNb6HerG4Lw6Wwq73N86zH4jt7N-PGFJq45gy6_dzVYE_1Kmdsug0lNOVTyZLVV01F-1x2SkJ2cj4KX66r1hxufp7Ei4htw1l_xIcUnpUSAsxQSBbgZl8nLr-bkclevc1bM_W0E7RDk-NbRqa37M269EMcyCDsfqAq_io4gUoSJDdPQo","UiLocales":null,"Nonce":"636960041912423035.YjcyZjY4NDItOTY1MC00YWM1LThiODUtYzE2Mzc1MzgyNGNlMzI2NjY2Y2EtMjY3MC00MGVhLWE5NTktNjdiNjQ3MTQ3NTA2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636960041912423035.YjcyZjY4NDItOTY1MC00YWM1LThiODUtYzE2Mzc1MzgyNGNlMzI2NjY2Y2EtMjY3MC00MGVhLWE5NTktNjdiNjQ3MTQ3NTA2","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpDSF5ZSfRndpDb4o5hpEmmkq3ivtRvnpP9Ls7EkyLr0900gIWlpSGLWb8dYmcpg172jRexfvvfvn49FbyJsNQ49wl1PCUeIzlzHAczqpDxKhJ66Tr16wZ2u-wod4Ze_-qkG_5Pit1p7YltmdjPNb6HerG4Lw6Wwq73N86zH4jt7N-PGFJq45gy6_dzVYE_1Kmdsug0lNOVTyZLVV01F-1x2SkJ2cj4KX66r1hxufp7Ei4htw1l_xIcUnpUSAsxQSBbgZl8nLr-bkclevc1bM_W0E7RDk-NbRqa37M269EMcyCDsfqAq_io4gUoSJDdPQo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 14:29:53.402 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-13 14:29:53.406 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 14:29:53.406 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 14:29:53.407 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-13 14:29:53.407 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 14:29:53.410 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****8rSg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFOM7ON71O:00000003","TimeStamp":"2019-06-13T06:29:53.0000000Z","ProcessId":32304,"LocalIpAddress":"127.0.0.1:38438","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 14:29:53.410 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpDSF5ZSfRndpDb4o5hpEmmkq3ivtRvnpP9Ls7EkyLr0900gIWlpSGLWb8dYmcpg172jRexfvvfvn49FbyJsNQ49wl1PCUeIzlzHAczqpDxKhJ66Tr16wZ2u-wod4Ze_-qkG_5Pit1p7YltmdjPNb6HerG4Lw6Wwq73N86zH4jt7N-PGFJq45gy6_dzVYE_1Kmdsug0lNOVTyZLVV01F-1x2SkJ2cj4KX66r1hxufp7Ei4htw1l_xIcUnpUSAsxQSBbgZl8nLr-bkclevc1bM_W0E7RDk-NbRqa37M269EMcyCDsfqAq_io4gUoSJDdPQo","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 14:29:53.422 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 14:29:53.422 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 14:29:53.422 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 14:29:53.423 +08:00 [DBG] Start authorize request
2019-06-13 14:29:53.423 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 14:29:53.423 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 14:29:54.546 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:29:54.546 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:29:54.761 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:29:54.890 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:29:55.091 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:29:55.201 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:29:55.202 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 14:29:55.202 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpDSF5ZSfRndpDb4o5hpEmmkq3ivtRvnpP9Ls7EkyLr0900gIWlpSGLWb8dYmcpg172jRexfvvfvn49FbyJsNQ49wl1PCUeIzlzHAczqpDxKhJ66Tr16wZ2u-wod4Ze_-qkG_5Pit1p7YltmdjPNb6HerG4Lw6Wwq73N86zH4jt7N-PGFJq45gy6_dzVYE_1Kmdsug0lNOVTyZLVV01F-1x2SkJ2cj4KX66r1hxufp7Ei4htw1l_xIcUnpUSAsxQSBbgZl8nLr-bkclevc1bM_W0E7RDk-NbRqa37M269EMcyCDsfqAq_io4gUoSJDdPQo","UiLocales":null,"Nonce":"636960041912423035.YjcyZjY4NDItOTY1MC00YWM1LThiODUtYzE2Mzc1MzgyNGNlMzI2NjY2Y2EtMjY3MC00MGVhLWE5NTktNjdiNjQ3MTQ3NTA2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636960041912423035.YjcyZjY4NDItOTY1MC00YWM1LThiODUtYzE2Mzc1MzgyNGNlMzI2NjY2Y2EtMjY3MC00MGVhLWE5NTktNjdiNjQ3MTQ3NTA2","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpDSF5ZSfRndpDb4o5hpEmmkq3ivtRvnpP9Ls7EkyLr0900gIWlpSGLWb8dYmcpg172jRexfvvfvn49FbyJsNQ49wl1PCUeIzlzHAczqpDxKhJ66Tr16wZ2u-wod4Ze_-qkG_5Pit1p7YltmdjPNb6HerG4Lw6Wwq73N86zH4jt7N-PGFJq45gy6_dzVYE_1Kmdsug0lNOVTyZLVV01F-1x2SkJ2cj4KX66r1hxufp7Ei4htw1l_xIcUnpUSAsxQSBbgZl8nLr-bkclevc1bM_W0E7RDk-NbRqa37M269EMcyCDsfqAq_io4gUoSJDdPQo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 14:29:55.446 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-13 14:29:55.450 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 14:29:55.450 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 14:29:55.450 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-13 14:29:55.450 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 14:29:55.453 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****Wy2w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFOM7ON71O:00000004","TimeStamp":"2019-06-13T06:29:55.0000000Z","ProcessId":32304,"LocalIpAddress":"127.0.0.1:38438","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 14:29:55.454 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpDSF5ZSfRndpDb4o5hpEmmkq3ivtRvnpP9Ls7EkyLr0900gIWlpSGLWb8dYmcpg172jRexfvvfvn49FbyJsNQ49wl1PCUeIzlzHAczqpDxKhJ66Tr16wZ2u-wod4Ze_-qkG_5Pit1p7YltmdjPNb6HerG4Lw6Wwq73N86zH4jt7N-PGFJq45gy6_dzVYE_1Kmdsug0lNOVTyZLVV01F-1x2SkJ2cj4KX66r1hxufp7Ei4htw1l_xIcUnpUSAsxQSBbgZl8nLr-bkclevc1bM_W0E7RDk-NbRqa37M269EMcyCDsfqAq_io4gUoSJDdPQo","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 14:29:57.124 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 14:29:57.124 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 14:29:57.125 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 14:29:57.125 +08:00 [DBG] Start discovery request
2019-06-13 14:29:57.851 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 14:29:57.976 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 14:29:57.977 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 14:29:57.977 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 14:29:57.977 +08:00 [DBG] Start key discovery request
2019-06-13 14:37:51.588 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 14:37:51.589 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 14:37:51.589 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 14:37:51.589 +08:00 [DBG] Start discovery request
2019-06-13 14:37:52.819 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 14:37:53.010 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 14:37:53.011 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 14:37:53.011 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 14:37:53.011 +08:00 [DBG] Start key discovery request
2019-06-13 14:37:53.111 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 14:37:53.111 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 14:37:53.111 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 14:37:53.111 +08:00 [DBG] Start authorize request
2019-06-13 14:37:53.111 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 14:37:53.111 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 14:37:54.348 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:37:54.349 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:37:54.585 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:37:54.705 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:37:54.896 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:37:55.032 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:37:55.032 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 14:37:55.032 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqKHhjbh5AM87Y_d5YlOwt9StAbG6bEu607Xx1cnYrDTuA9BisIln1SJZbWb6UFzHdr3RSbwm0S7hbz_Zo6gpCRTXw57kuyYa2_zllRCQKXw6rFAPBSHvSlM5H3XQMG6I14YzmqTEcR8_go_cXOggz53jjIBdEcez85fmV1D5VN0zIXU3_4pc-KhXK0cCS1jaTy4E1fVvtG_uSjryrs7-i6kAYFNRmJICk6Y3PWM5QRMcYl1MRNc-5vDKorpjRZ0HkLK9XgSXA_2FN-INSAKPVnxYPSNV_JdnzSfbCN7S-HkxjoCuW7grl9ZdwTYXt7jsU","UiLocales":null,"Nonce":"636960046730485872.ZTk0NDQyMDgtODBjYS00OGUwLWE2NzEtZWEyNjgzMThlZDE4NTE2YWRlYTktMWNkNy00ZTg1LWFiNDEtNjkxZGIzNDIwNWNm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token","scope":"openid profile","response_mode":"form_post","nonce":"636960046730485872.ZTk0NDQyMDgtODBjYS00OGUwLWE2NzEtZWEyNjgzMThlZDE4NTE2YWRlYTktMWNkNy00ZTg1LWFiNDEtNjkxZGIzNDIwNWNm","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqKHhjbh5AM87Y_d5YlOwt9StAbG6bEu607Xx1cnYrDTuA9BisIln1SJZbWb6UFzHdr3RSbwm0S7hbz_Zo6gpCRTXw57kuyYa2_zllRCQKXw6rFAPBSHvSlM5H3XQMG6I14YzmqTEcR8_go_cXOggz53jjIBdEcez85fmV1D5VN0zIXU3_4pc-KhXK0cCS1jaTy4E1fVvtG_uSjryrs7-i6kAYFNRmJICk6Y3PWM5QRMcYl1MRNc-5vDKorpjRZ0HkLK9XgSXA_2FN-INSAKPVnxYPSNV_JdnzSfbCN7S-HkxjoCuW7grl9ZdwTYXt7jsU","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 14:37:55.303 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-13 14:37:55.307 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 14:37:55.307 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 14:37:55.307 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-13 14:37:55.308 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 14:37:55.311 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****Pupw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFOM7ON71P:00000003","TimeStamp":"2019-06-13T06:37:55.0000000Z","ProcessId":32304,"LocalIpAddress":"127.0.0.1:38438","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 14:37:55.311 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqKHhjbh5AM87Y_d5YlOwt9StAbG6bEu607Xx1cnYrDTuA9BisIln1SJZbWb6UFzHdr3RSbwm0S7hbz_Zo6gpCRTXw57kuyYa2_zllRCQKXw6rFAPBSHvSlM5H3XQMG6I14YzmqTEcR8_go_cXOggz53jjIBdEcez85fmV1D5VN0zIXU3_4pc-KhXK0cCS1jaTy4E1fVvtG_uSjryrs7-i6kAYFNRmJICk6Y3PWM5QRMcYl1MRNc-5vDKorpjRZ0HkLK9XgSXA_2FN-INSAKPVnxYPSNV_JdnzSfbCN7S-HkxjoCuW7grl9ZdwTYXt7jsU","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 14:47:24.375 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 14:47:24.408 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 14:47:24.409 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 14:47:24.409 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 14:47:24.409 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 14:47:24.409 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 14:47:24.856 +08:00 [DBG] Starting grant removal
2019-06-13 14:47:25.129 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 14:47:25.133 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 14:47:25.133 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 14:47:25.133 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 14:47:25.133 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 14:47:25.133 +08:00 [DBG] Error Url: /home/error
2019-06-13 14:47:25.133 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 14:50:45.014 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 14:50:45.022 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 14:50:45.023 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 14:50:45.028 +08:00 [DBG] Start discovery request
2019-06-13 14:50:45.967 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 14:50:46.193 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 14:50:46.194 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 14:50:46.195 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 14:50:46.199 +08:00 [DBG] Start key discovery request
2019-06-13 14:50:46.287 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 14:50:46.290 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 14:50:46.290 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 14:50:46.294 +08:00 [DBG] Start authorize request
2019-06-13 14:50:46.302 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 14:50:46.308 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 14:50:47.519 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:50:47.529 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:50:47.552 +08:00 [ERR] Client requested access token - but client is not configured to receive access tokens via browser
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iq-eJtcbF4D7Z-KcXzCQJD-hGRwE7JRF381NYhfxZ88eT7pPElj--5xB82BBUYKl6qun1u2OT8iI3Lt3wQiieyiGebFtCHsTYXLrbz-nX6mZKwnvqbR_uM6HvKCnJ1-viNaTUBofzGQqxpOBDoI7wJvb-03zo1VROz6Rd2HDWMaOzsR3JBPn3-qL82fynNa1X4WQQeqSHulGZJ1fBtgGf0ImFcVDp1LOsdYAHaBus4At44XJeVRk-Ep47_M-rH193UYjChB--mJhZgnmtQBR_MT0JLHmYlzZKE-jlNP7Lnx6XoqlNcrVTzHIDL3rvRU55s","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile","response_mode":"form_post","nonce":"636960054462493180.MjliZGRmNGEtMzdiMi00ODM1LTliYmMtZTA3MGFkZGNkNWQxZjdiOGU4NWQtNDExOS00MzAzLThjMzgtN2EwNmJkOWVmZmJi","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iq-eJtcbF4D7Z-KcXzCQJD-hGRwE7JRF381NYhfxZ88eT7pPElj--5xB82BBUYKl6qun1u2OT8iI3Lt3wQiieyiGebFtCHsTYXLrbz-nX6mZKwnvqbR_uM6HvKCnJ1-viNaTUBofzGQqxpOBDoI7wJvb-03zo1VROz6Rd2HDWMaOzsR3JBPn3-qL82fynNa1X4WQQeqSHulGZJ1fBtgGf0ImFcVDp1LOsdYAHaBus4At44XJeVRk-Ep47_M-rH193UYjChB--mJhZgnmtQBR_MT0JLHmYlzZKE-jlNP7Lnx6XoqlNcrVTzHIDL3rvRU55s","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 14:50:47.560 +08:00 [ERR] Request validation failed
2019-06-13 14:50:47.560 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iq-eJtcbF4D7Z-KcXzCQJD-hGRwE7JRF381NYhfxZ88eT7pPElj--5xB82BBUYKl6qun1u2OT8iI3Lt3wQiieyiGebFtCHsTYXLrbz-nX6mZKwnvqbR_uM6HvKCnJ1-viNaTUBofzGQqxpOBDoI7wJvb-03zo1VROz6Rd2HDWMaOzsR3JBPn3-qL82fynNa1X4WQQeqSHulGZJ1fBtgGf0ImFcVDp1LOsdYAHaBus4At44XJeVRk-Ep47_M-rH193UYjChB--mJhZgnmtQBR_MT0JLHmYlzZKE-jlNP7Lnx6XoqlNcrVTzHIDL3rvRU55s","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile","response_mode":"form_post","nonce":"636960054462493180.MjliZGRmNGEtMzdiMi00ODM1LTliYmMtZTA3MGFkZGNkNWQxZjdiOGU4NWQtNDExOS00MzAzLThjMzgtN2EwNmJkOWVmZmJi","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iq-eJtcbF4D7Z-KcXzCQJD-hGRwE7JRF381NYhfxZ88eT7pPElj--5xB82BBUYKl6qun1u2OT8iI3Lt3wQiieyiGebFtCHsTYXLrbz-nX6mZKwnvqbR_uM6HvKCnJ1-viNaTUBofzGQqxpOBDoI7wJvb-03zo1VROz6Rd2HDWMaOzsR3JBPn3-qL82fynNa1X4WQQeqSHulGZJ1fBtgGf0ImFcVDp1LOsdYAHaBus4At44XJeVRk-Ep47_M-rH193UYjChB--mJhZgnmtQBR_MT0JLHmYlzZKE-jlNP7Lnx6XoqlNcrVTzHIDL3rvRU55s","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 14:50:47.572 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"","GrantType":"implicit","Error":"invalid_request","ErrorDescription":"Client not configured to receive access tokens via browser","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLNFPBV61O3K:00000003","TimeStamp":"2019-06-13T06:50:47.0000000Z","ProcessId":40228,"LocalIpAddress":"127.0.0.1:22687","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-06-13 14:53:07.345 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 14:53:07.374 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 14:53:07.374 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 14:53:07.374 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 14:53:07.374 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 14:53:07.375 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 14:53:07.790 +08:00 [DBG] Starting grant removal
2019-06-13 14:53:08.177 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 14:53:08.181 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 14:53:08.181 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 14:53:08.181 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 14:53:08.181 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 14:53:08.181 +08:00 [DBG] Error Url: /home/error
2019-06-13 14:53:08.181 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 14:53:26.118 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 14:53:26.123 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 14:53:26.123 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 14:53:26.128 +08:00 [DBG] Start discovery request
2019-06-13 14:53:27.081 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 14:53:27.327 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 14:53:27.328 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 14:53:27.328 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 14:53:27.331 +08:00 [DBG] Start key discovery request
2019-06-13 14:53:27.418 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 14:53:27.422 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 14:53:27.422 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 14:53:27.425 +08:00 [DBG] Start authorize request
2019-06-13 14:53:27.436 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 14:53:27.442 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 14:53:28.662 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:53:28.672 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:53:28.898 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:53:29.044 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:53:29.227 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:53:29.335 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:53:29.343 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 14:53:29.359 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoonrbMMY-XZv2FIjuP3h9mgbq5aLoeSa4iBxY5hROUMN57H6qwzXwobsA0o7vJ-DtqGhabEjRnS-2gcbgk3_vENy1N4kVZS2BUp2hnsji2iETeJF4ujlI1cdKbkdppBk9qJnoxzaepQM9kF9DGpFGjYPyTf5js_7sh06F2Dzca_JA9Fcv8dZcDQypEFQnoe8nWaTLtUFSiW6l2zH-zdeRPF2OHCToCRSoCfzKswt0bx07JuGJVqtOhEgN0iayNtm5BY3c0ojBn7pH_CVBcGP56O2PhmGwJl3N9GB8YVRNXZxF5rX6aUZ4ql7zFlgQcXQc","UiLocales":null,"Nonce":"636960056073808282.ZjE4MjAyNDYtOTczNS00YjRkLWE0Y2QtN2JlYWJkZWIwNTA0MzAzZTlkYTUtYTliZi00NzA2LTk4YmYtNTBkMGI5ZjE1ZjFi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile","response_mode":"form_post","nonce":"636960056073808282.ZjE4MjAyNDYtOTczNS00YjRkLWE0Y2QtN2JlYWJkZWIwNTA0MzAzZTlkYTUtYTliZi00NzA2LTk4YmYtNTBkMGI5ZjE1ZjFi","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoonrbMMY-XZv2FIjuP3h9mgbq5aLoeSa4iBxY5hROUMN57H6qwzXwobsA0o7vJ-DtqGhabEjRnS-2gcbgk3_vENy1N4kVZS2BUp2hnsji2iETeJF4ujlI1cdKbkdppBk9qJnoxzaepQM9kF9DGpFGjYPyTf5js_7sh06F2Dzca_JA9Fcv8dZcDQypEFQnoe8nWaTLtUFSiW6l2zH-zdeRPF2OHCToCRSoCfzKswt0bx07JuGJVqtOhEgN0iayNtm5BY3c0ojBn7pH_CVBcGP56O2PhmGwJl3N9GB8YVRNXZxF5rX6aUZ4ql7zFlgQcXQc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 14:53:29.746 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-13 14:53:29.751 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 14:53:29.759 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 14:53:29.772 +08:00 [DBG] Getting claims for access token for client: mvcImp
2019-06-13 14:53:29.773 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 14:53:29.781 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 14:53:29.893 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-13 14:53:29.893 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 14:53:29.911 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****p4nA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****Sy_Q","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFPF5DLSHN:00000003","TimeStamp":"2019-06-13T06:53:29.0000000Z","ProcessId":220,"LocalIpAddress":"127.0.0.1:5274","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 14:53:29.915 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoonrbMMY-XZv2FIjuP3h9mgbq5aLoeSa4iBxY5hROUMN57H6qwzXwobsA0o7vJ-DtqGhabEjRnS-2gcbgk3_vENy1N4kVZS2BUp2hnsji2iETeJF4ujlI1cdKbkdppBk9qJnoxzaepQM9kF9DGpFGjYPyTf5js_7sh06F2Dzca_JA9Fcv8dZcDQypEFQnoe8nWaTLtUFSiW6l2zH-zdeRPF2OHCToCRSoCfzKswt0bx07JuGJVqtOhEgN0iayNtm5BY3c0ojBn7pH_CVBcGP56O2PhmGwJl3N9GB8YVRNXZxF5rX6aUZ4ql7zFlgQcXQc","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 14:53:30.131 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 14:53:30.136 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 14:53:30.137 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 14:53:30.144 +08:00 [DBG] Start userinfo request
2019-06-13 14:53:30.148 +08:00 [DBG] Bearer token found in header
2019-06-13 14:53:31.183 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:53:31.183 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:53:32.204 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:53:32.204 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:53:32.331 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 14:53:32.332 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560408809,"exp":1560412409,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"mvcImp","sub":"af61726e-716b-4170-8c26-6568bf294215","auth_time":1560234512,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"shawn","last_name":"wong","card_number":"12123","card_holder":"王曉鋒","card_security_number":"2323","card_expiration":"20/12","address_city":"shanghai","address_country":"中国","address_state":"canials","address_street":"shanghai","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 14:53:32.341 +08:00 [DBG] Creating userinfo response
2019-06-13 14:53:32.345 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 14:53:32.348 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 14:53:32.535 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:53:32.535 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile
2019-06-13 14:53:32.536 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 14:53:32.713 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:53:32.714 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 14:53:32.714 +08:00 [DBG] End userinfo request
2019-06-13 14:53:46.737 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 14:53:46.738 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 14:53:46.738 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 14:53:46.738 +08:00 [DBG] Start discovery request
2019-06-13 14:53:47.373 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 14:53:47.532 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 14:53:47.533 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 14:53:47.533 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 14:53:47.534 +08:00 [DBG] Start key discovery request
2019-06-13 14:54:55.825 +08:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: https://jwt.io
2019-06-13 14:54:55.952 +08:00 [DBG] Origin https://jwt.io is allowed: false
2019-06-13 14:54:55.952 +08:00 [WRN] CorsPolicyService did not allow origin: https://jwt.io
2019-06-13 14:54:55.952 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 14:54:55.953 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 14:54:55.953 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 14:54:55.953 +08:00 [DBG] Start discovery request
2019-06-13 14:54:56.589 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 14:55:50.375 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 14:55:50.386 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 14:55:50.386 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 14:55:50.386 +08:00 [DBG] Start authorize request
2019-06-13 14:55:50.386 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 14:55:50.386 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 14:55:51.494 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:55:51.495 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:55:51.737 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:55:51.892 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:55:52.118 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:55:52.253 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:55:52.254 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 14:55:52.254 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrZTUUToQoIRxq8FBscsxnFUu891gELioR-0SzxePIDLlBjcAU9bpDHu2z_81TkvTRtD9fiDsRg-0WdIwCzchgaufG1exeATmUXcJEdwlkAgh-Ey2TqPLAIY4PH3WDdCBmBXAO7dVZ1Wysd2qhDDxVB5ca7LSyKVW3zAucxMVpqN4E5LaBsFWF3E7IU8Kf2P4K6FxM3TyjeV7T1xQYrCoxubAVY3qtEpXtNnDFdymlsv4xJmbRpYmetcBTOTmFrlKJsEEWi-Mo5wrnDgLqKilVQl-l7wHYe_Q94P-vOBtM6E_Wn8TUpnD0hB3PnpAziIec","UiLocales":null,"Nonce":"636960057503458338.ZTExZTZlZTgtN2I3Mi00ZmZhLTk4ODctMmFlYjkzMzcyYmQ4NzhmYTg2NWMtOGQ5OS00NTUwLTk2YjQtZGI3NTc3YTNlY2Vk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile","response_mode":"form_post","nonce":"636960057503458338.ZTExZTZlZTgtN2I3Mi00ZmZhLTk4ODctMmFlYjkzMzcyYmQ4NzhmYTg2NWMtOGQ5OS00NTUwLTk2YjQtZGI3NTc3YTNlY2Vk","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrZTUUToQoIRxq8FBscsxnFUu891gELioR-0SzxePIDLlBjcAU9bpDHu2z_81TkvTRtD9fiDsRg-0WdIwCzchgaufG1exeATmUXcJEdwlkAgh-Ey2TqPLAIY4PH3WDdCBmBXAO7dVZ1Wysd2qhDDxVB5ca7LSyKVW3zAucxMVpqN4E5LaBsFWF3E7IU8Kf2P4K6FxM3TyjeV7T1xQYrCoxubAVY3qtEpXtNnDFdymlsv4xJmbRpYmetcBTOTmFrlKJsEEWi-Mo5wrnDgLqKilVQl-l7wHYe_Q94P-vOBtM6E_Wn8TUpnD0hB3PnpAziIec","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 14:55:52.498 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-13 14:55:52.502 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 14:55:52.502 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 14:55:52.502 +08:00 [DBG] Getting claims for access token for client: mvcImp
2019-06-13 14:55:52.502 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 14:55:52.502 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 14:55:52.505 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-13 14:55:52.506 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 14:55:52.510 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****VIqA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****stAw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFPF5DLSHP:00000002","TimeStamp":"2019-06-13T06:55:52.0000000Z","ProcessId":220,"LocalIpAddress":"127.0.0.1:5274","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 14:55:52.511 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrZTUUToQoIRxq8FBscsxnFUu891gELioR-0SzxePIDLlBjcAU9bpDHu2z_81TkvTRtD9fiDsRg-0WdIwCzchgaufG1exeATmUXcJEdwlkAgh-Ey2TqPLAIY4PH3WDdCBmBXAO7dVZ1Wysd2qhDDxVB5ca7LSyKVW3zAucxMVpqN4E5LaBsFWF3E7IU8Kf2P4K6FxM3TyjeV7T1xQYrCoxubAVY3qtEpXtNnDFdymlsv4xJmbRpYmetcBTOTmFrlKJsEEWi-Mo5wrnDgLqKilVQl-l7wHYe_Q94P-vOBtM6E_Wn8TUpnD0hB3PnpAziIec","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 14:55:52.612 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 14:55:52.614 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 14:55:52.614 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 14:55:52.614 +08:00 [DBG] Start userinfo request
2019-06-13 14:55:52.614 +08:00 [DBG] Bearer token found in header
2019-06-13 14:55:53.667 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:55:53.667 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:55:54.724 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:55:54.724 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:55:54.828 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 14:55:54.828 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560408952,"exp":1560412552,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"mvcImp","sub":"af61726e-716b-4170-8c26-6568bf294215","auth_time":1560234512,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"shawn","last_name":"wong","card_number":"12123","card_holder":"王曉鋒","card_security_number":"2323","card_expiration":"20/12","address_city":"shanghai","address_country":"中国","address_state":"canials","address_street":"shanghai","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 14:55:54.828 +08:00 [DBG] Creating userinfo response
2019-06-13 14:55:54.828 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 14:55:54.828 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 14:55:55.019 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:55:55.019 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile
2019-06-13 14:55:55.020 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 14:55:55.198 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:55:55.198 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 14:55:55.198 +08:00 [DBG] End userinfo request
2019-06-13 14:58:03.711 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 14:58:03.712 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 14:58:03.712 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 14:58:03.712 +08:00 [DBG] Start authorize request
2019-06-13 14:58:03.712 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 14:58:03.712 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 14:58:04.722 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:58:04.722 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:58:04.931 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:58:05.034 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:58:05.231 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:58:05.331 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:58:05.332 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 14:58:05.332 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpfYkQi5P17PqTxjZYrPyxxx-PbxzjxAllfRAr58VQMBlkRUhx9wF8ra2-nWEAeph_880zvDinDdLc5vUK5wQsBDmp6CoD3PIMm8gxNPD-cR20catEyUKbggxR75Wn_KtVNCgAOAY7zKoxXD3hcdDa-ykskaVls4LAcfICgEsqTz59_1r2IVGSuPaXtO5_OUb3JdqJrnw9Aa-UozXspe_rodcuxUVdcOvf7jsXuxf9xPKfN38xoIXTCH_H7rBRYBfg2fHrdNjqH1e0gq5MZ2lZs4YF1tT5AWuoutTf0_88m0OWIkvuYiW1VjZR3iz6VuRo","UiLocales":null,"Nonce":"636960058836820527.NGJjODY4YmUtNTRiZS00Mjc1LWE5MTItMDJmNTMxN2JhNDgzYzU5ZmFhZTctYmU3OS00ZDMxLTkxYjMtZDc1MThiMmE1ZTk1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile","response_mode":"form_post","nonce":"636960058836820527.NGJjODY4YmUtNTRiZS00Mjc1LWE5MTItMDJmNTMxN2JhNDgzYzU5ZmFhZTctYmU3OS00ZDMxLTkxYjMtZDc1MThiMmE1ZTk1","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpfYkQi5P17PqTxjZYrPyxxx-PbxzjxAllfRAr58VQMBlkRUhx9wF8ra2-nWEAeph_880zvDinDdLc5vUK5wQsBDmp6CoD3PIMm8gxNPD-cR20catEyUKbggxR75Wn_KtVNCgAOAY7zKoxXD3hcdDa-ykskaVls4LAcfICgEsqTz59_1r2IVGSuPaXtO5_OUb3JdqJrnw9Aa-UozXspe_rodcuxUVdcOvf7jsXuxf9xPKfN38xoIXTCH_H7rBRYBfg2fHrdNjqH1e0gq5MZ2lZs4YF1tT5AWuoutTf0_88m0OWIkvuYiW1VjZR3iz6VuRo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 14:58:05.563 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-13 14:58:05.566 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 14:58:05.566 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 14:58:05.567 +08:00 [DBG] Getting claims for access token for client: mvcImp
2019-06-13 14:58:05.567 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 14:58:05.567 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 14:58:05.570 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-13 14:58:05.570 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 14:58:05.573 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****O9Gw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****xc7g","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFPF5DLSHQ:00000001","TimeStamp":"2019-06-13T06:58:05.0000000Z","ProcessId":220,"LocalIpAddress":"127.0.0.1:5274","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 14:58:05.573 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpfYkQi5P17PqTxjZYrPyxxx-PbxzjxAllfRAr58VQMBlkRUhx9wF8ra2-nWEAeph_880zvDinDdLc5vUK5wQsBDmp6CoD3PIMm8gxNPD-cR20catEyUKbggxR75Wn_KtVNCgAOAY7zKoxXD3hcdDa-ykskaVls4LAcfICgEsqTz59_1r2IVGSuPaXtO5_OUb3JdqJrnw9Aa-UozXspe_rodcuxUVdcOvf7jsXuxf9xPKfN38xoIXTCH_H7rBRYBfg2fHrdNjqH1e0gq5MZ2lZs4YF1tT5AWuoutTf0_88m0OWIkvuYiW1VjZR3iz6VuRo","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 14:58:06.035 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 14:58:06.036 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 14:58:06.038 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 14:58:06.038 +08:00 [DBG] Start userinfo request
2019-06-13 14:58:06.038 +08:00 [DBG] Bearer token found in header
2019-06-13 14:58:07.063 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:58:07.063 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:58:08.127 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:58:08.127 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:58:08.238 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 14:58:08.239 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560409085,"exp":1560412685,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"mvcImp","sub":"af61726e-716b-4170-8c26-6568bf294215","auth_time":1560234512,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"shawn","last_name":"wong","card_number":"12123","card_holder":"王曉鋒","card_security_number":"2323","card_expiration":"20/12","address_city":"shanghai","address_country":"中国","address_state":"canials","address_street":"shanghai","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 14:58:08.239 +08:00 [DBG] Creating userinfo response
2019-06-13 14:58:08.239 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 14:58:08.239 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 14:58:08.437 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:58:08.437 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile
2019-06-13 14:58:08.437 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 14:58:08.615 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:58:08.615 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 14:58:08.615 +08:00 [DBG] End userinfo request
2019-06-13 14:59:45.422 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 14:59:45.423 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 14:59:45.423 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 14:59:45.423 +08:00 [DBG] Start authorize request
2019-06-13 14:59:45.423 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 14:59:45.423 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 14:59:46.415 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:59:46.416 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:59:46.588 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:59:46.704 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:59:46.898 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:59:47.002 +08:00 [DBG] Found [] API scopes in database
2019-06-13 14:59:47.002 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 14:59:47.002 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrLd0erpgtAaJ9IlU9hXXcj9kWusmu68rKzjgYTUwiHgZTjSSIZLVLbeLEKjUWFPNIQ7U8TqEpzepbeAIzeG2KcQO8Fk__LguVCGvpjrnY3ttE9Lk8nJotsqqxf2ZZKqQRNF5Fr6J5l74UAdk-VMNpzJuG0PFW3pXjboN6b0-EEXRnSEj_2OT_pTifVeR-oW7zFAdSNxLLusfKCILYR3yUuK5A97z2NsnmHfhUnrSgaLRaI1zP4-JN_SUj1in10AP6sQba6-Uad71iWWL9_uaeqpdByM1WcDZomhXgnupuosx8ZLDGVQdrlG1Dn6YPEVdY","UiLocales":null,"Nonce":"636960059853827749.NDI4Y2E2OTAtODc0MS00ZmQ3LWJmNTUtNzY2ZmUzMWI2OGExNzdhMGMxNDEtNjcyYS00MThhLTg2YTEtOTkxYjNlYzUxMTNl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile","response_mode":"form_post","nonce":"636960059853827749.NDI4Y2E2OTAtODc0MS00ZmQ3LWJmNTUtNzY2ZmUzMWI2OGExNzdhMGMxNDEtNjcyYS00MThhLTg2YTEtOTkxYjNlYzUxMTNl","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrLd0erpgtAaJ9IlU9hXXcj9kWusmu68rKzjgYTUwiHgZTjSSIZLVLbeLEKjUWFPNIQ7U8TqEpzepbeAIzeG2KcQO8Fk__LguVCGvpjrnY3ttE9Lk8nJotsqqxf2ZZKqQRNF5Fr6J5l74UAdk-VMNpzJuG0PFW3pXjboN6b0-EEXRnSEj_2OT_pTifVeR-oW7zFAdSNxLLusfKCILYR3yUuK5A97z2NsnmHfhUnrSgaLRaI1zP4-JN_SUj1in10AP6sQba6-Uad71iWWL9_uaeqpdByM1WcDZomhXgnupuosx8ZLDGVQdrlG1Dn6YPEVdY","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 14:59:47.241 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-13 14:59:47.245 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 14:59:47.245 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 14:59:47.245 +08:00 [DBG] Getting claims for access token for client: mvcImp
2019-06-13 14:59:47.245 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 14:59:47.245 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 14:59:47.249 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-13 14:59:47.249 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 14:59:47.252 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****wepw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****yB1A","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFPF5DLSHR:00000001","TimeStamp":"2019-06-13T06:59:47.0000000Z","ProcessId":220,"LocalIpAddress":"127.0.0.1:5274","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 14:59:47.252 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrLd0erpgtAaJ9IlU9hXXcj9kWusmu68rKzjgYTUwiHgZTjSSIZLVLbeLEKjUWFPNIQ7U8TqEpzepbeAIzeG2KcQO8Fk__LguVCGvpjrnY3ttE9Lk8nJotsqqxf2ZZKqQRNF5Fr6J5l74UAdk-VMNpzJuG0PFW3pXjboN6b0-EEXRnSEj_2OT_pTifVeR-oW7zFAdSNxLLusfKCILYR3yUuK5A97z2NsnmHfhUnrSgaLRaI1zP4-JN_SUj1in10AP6sQba6-Uad71iWWL9_uaeqpdByM1WcDZomhXgnupuosx8ZLDGVQdrlG1Dn6YPEVdY","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 14:59:47.397 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 14:59:47.398 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 14:59:47.398 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 14:59:47.399 +08:00 [DBG] Start userinfo request
2019-06-13 14:59:47.399 +08:00 [DBG] Bearer token found in header
2019-06-13 14:59:48.471 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:59:48.471 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:59:49.566 +08:00 [DBG] mvcImp found in database: true
2019-06-13 14:59:49.567 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 14:59:49.671 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 14:59:49.671 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560409187,"exp":1560412787,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"mvcImp","sub":"af61726e-716b-4170-8c26-6568bf294215","auth_time":1560234512,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"shawn","last_name":"wong","card_number":"12123","card_holder":"王曉鋒","card_security_number":"2323","card_expiration":"20/12","address_city":"shanghai","address_country":"中国","address_state":"canials","address_street":"shanghai","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 14:59:49.671 +08:00 [DBG] Creating userinfo response
2019-06-13 14:59:49.671 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 14:59:49.671 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 14:59:49.876 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:59:49.876 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile
2019-06-13 14:59:49.876 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 14:59:50.047 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 14:59:50.048 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 14:59:50.048 +08:00 [DBG] End userinfo request
2019-06-13 15:03:33.388 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 15:03:33.389 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 15:03:33.389 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 15:03:33.389 +08:00 [DBG] Start discovery request
2019-06-13 15:03:34.543 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 15:03:34.721 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 15:03:34.722 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 15:03:34.722 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 15:03:34.722 +08:00 [DBG] Start key discovery request
2019-06-13 15:03:34.793 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 15:03:34.794 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 15:03:34.794 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 15:03:34.794 +08:00 [DBG] Start authorize request
2019-06-13 15:03:34.794 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:03:34.794 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:03:35.950 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:03:35.950 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:03:36.165 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:03:36.267 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:03:36.440 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:03:36.553 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:03:36.553 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:03:36.553 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrHk4lIeqOw3B8ezhjUdFCOQcrQSCfCuOPqRyEnghdQYqqWyjlLqyIVbUVPoKYd2IhhbGIgAfuClnuWlw2nP-JEjEl-qVr35Q_HoDqZWTo7QLjpNO47esXwtnkFKii0er4l7s2iV7Qe0P_icJNbPaJMHD0PmjQDgg0VC6x3PjWGN5iASHZOnB9NZ4iYMProY2v2PRx3PJZumdSGVCuj9Ni-buvu5787Z6H0qHY1vW4j2M3I0o81EnQ6l4hRPDPQxehpRdEIVwVJvLdbSe_Ey-X4c6HX8HoESAFaH-lHJtW3o-mnjODf6xTM3uNwuMVqyZc","UiLocales":null,"Nonce":"636960062147526655.ZmUzNjdlODctYTVmZS00NDVmLTljY2UtNWRkOGQ4MTE4ZjY3YmRhYzg1NDItMGFjMi00ZjI2LTlmMTYtZDUzZjhhMjExMzZj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile","response_mode":"form_post","nonce":"636960062147526655.ZmUzNjdlODctYTVmZS00NDVmLTljY2UtNWRkOGQ4MTE4ZjY3YmRhYzg1NDItMGFjMi00ZjI2LTlmMTYtZDUzZjhhMjExMzZj","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrHk4lIeqOw3B8ezhjUdFCOQcrQSCfCuOPqRyEnghdQYqqWyjlLqyIVbUVPoKYd2IhhbGIgAfuClnuWlw2nP-JEjEl-qVr35Q_HoDqZWTo7QLjpNO47esXwtnkFKii0er4l7s2iV7Qe0P_icJNbPaJMHD0PmjQDgg0VC6x3PjWGN5iASHZOnB9NZ4iYMProY2v2PRx3PJZumdSGVCuj9Ni-buvu5787Z6H0qHY1vW4j2M3I0o81EnQ6l4hRPDPQxehpRdEIVwVJvLdbSe_Ey-X4c6HX8HoESAFaH-lHJtW3o-mnjODf6xTM3uNwuMVqyZc","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 15:03:37.019 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-13 15:03:37.023 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 15:03:37.023 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 15:03:37.023 +08:00 [DBG] Getting claims for access token for client: mvcImp
2019-06-13 15:03:37.024 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:03:37.024 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 15:03:37.027 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-13 15:03:37.027 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 15:03:37.030 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****oq6g","$type":"Token"},{"TokenType":"access_token","TokenValue":"****dyUA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFPF5DLSHS:00000003","TimeStamp":"2019-06-13T07:03:37.0000000Z","ProcessId":220,"LocalIpAddress":"127.0.0.1:5274","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 15:03:37.030 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrHk4lIeqOw3B8ezhjUdFCOQcrQSCfCuOPqRyEnghdQYqqWyjlLqyIVbUVPoKYd2IhhbGIgAfuClnuWlw2nP-JEjEl-qVr35Q_HoDqZWTo7QLjpNO47esXwtnkFKii0er4l7s2iV7Qe0P_icJNbPaJMHD0PmjQDgg0VC6x3PjWGN5iASHZOnB9NZ4iYMProY2v2PRx3PJZumdSGVCuj9Ni-buvu5787Z6H0qHY1vW4j2M3I0o81EnQ6l4hRPDPQxehpRdEIVwVJvLdbSe_Ey-X4c6HX8HoESAFaH-lHJtW3o-mnjODf6xTM3uNwuMVqyZc","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 15:03:37.244 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 15:03:37.245 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 15:03:37.245 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 15:03:37.245 +08:00 [DBG] Start userinfo request
2019-06-13 15:03:37.245 +08:00 [DBG] Bearer token found in header
2019-06-13 15:03:38.247 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:03:38.247 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:03:39.301 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:03:39.301 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:03:39.433 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 15:03:39.433 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560409417,"exp":1560413017,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"mvcImp","sub":"af61726e-716b-4170-8c26-6568bf294215","auth_time":1560234512,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"shawn","last_name":"wong","card_number":"12123","card_holder":"王曉鋒","card_security_number":"2323","card_expiration":"20/12","address_city":"shanghai","address_country":"中国","address_state":"canials","address_street":"shanghai","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 15:03:39.434 +08:00 [DBG] Creating userinfo response
2019-06-13 15:03:39.434 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 15:03:39.434 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 15:03:39.851 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:03:39.851 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile
2019-06-13 15:03:39.852 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 15:03:40.074 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:03:40.075 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 15:03:40.075 +08:00 [DBG] End userinfo request
2019-06-13 15:03:40.457 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 15:03:40.460 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 15:03:40.460 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 15:03:40.460 +08:00 [DBG] Start discovery request
2019-06-13 15:03:41.129 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 15:03:41.249 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 15:03:41.250 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 15:03:41.250 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 15:03:41.250 +08:00 [DBG] Start key discovery request
2019-06-13 15:05:20.851 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 15:05:20.851 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 15:05:20.851 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 15:05:20.851 +08:00 [DBG] Start discovery request
2019-06-13 15:05:21.542 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 15:05:21.728 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 15:05:21.730 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 15:05:21.730 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 15:05:21.730 +08:00 [DBG] Start key discovery request
2019-06-13 15:05:21.801 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 15:05:21.802 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 15:05:21.802 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 15:05:21.802 +08:00 [DBG] Start authorize request
2019-06-13 15:05:21.802 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:05:21.802 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:05:22.861 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:05:22.861 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:05:23.059 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:05:23.170 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:05:23.369 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:05:23.480 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:05:23.480 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:05:23.480 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqusiUWIscjEbZqYMSbDR8HFBrgo8GqLLfKRDYVrkH9zVf6fkCsEaWmyv1dxAi91vKftga7wT-vy-c5VuvvRfRlWESzRDd0TS2OeAQHElRInntCtkDOWxxdFgAuSpdoa7yNzgTiYKMMe3T1Rch8SJebu--h6HoHMfQlGV5Y-WOM5ITJvuqMY-aEreP-VvtIXHTh8nq1TP5He3Kh2ZvqT5KDRCrAPSnhtc_GbCJz-6ktdrzC8TEV0mwdqkgDr4jKyuxzouxczZHP61jB1vy0ren5M8LUUvWKqVY2MyG9OA6kKhZ-HAnQJsj7Ajphp7I-EJQ","UiLocales":null,"Nonce":"636960063217663454.NDllZTJiNTUtNzZmNy00NzM0LWFhZDYtODZmN2YwZmVmNTk5YjA1NjcxNDQtYTJkNC00YmNiLWEzZTktNTlkMzE0MDQzM2I0","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile","response_mode":"form_post","nonce":"636960063217663454.NDllZTJiNTUtNzZmNy00NzM0LWFhZDYtODZmN2YwZmVmNTk5YjA1NjcxNDQtYTJkNC00YmNiLWEzZTktNTlkMzE0MDQzM2I0","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqusiUWIscjEbZqYMSbDR8HFBrgo8GqLLfKRDYVrkH9zVf6fkCsEaWmyv1dxAi91vKftga7wT-vy-c5VuvvRfRlWESzRDd0TS2OeAQHElRInntCtkDOWxxdFgAuSpdoa7yNzgTiYKMMe3T1Rch8SJebu--h6HoHMfQlGV5Y-WOM5ITJvuqMY-aEreP-VvtIXHTh8nq1TP5He3Kh2ZvqT5KDRCrAPSnhtc_GbCJz-6ktdrzC8TEV0mwdqkgDr4jKyuxzouxczZHP61jB1vy0ren5M8LUUvWKqVY2MyG9OA6kKhZ-HAnQJsj7Ajphp7I-EJQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 15:05:24.174 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-13 15:05:24.177 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 15:05:24.178 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 15:05:24.178 +08:00 [DBG] Getting claims for access token for client: mvcImp
2019-06-13 15:05:24.178 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:05:24.178 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 15:05:24.182 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-13 15:05:24.182 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 15:05:24.185 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****IV6Q","$type":"Token"},{"TokenType":"access_token","TokenValue":"****v1Nw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFPF5DLSHT:00000003","TimeStamp":"2019-06-13T07:05:24.0000000Z","ProcessId":220,"LocalIpAddress":"127.0.0.1:5274","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 15:05:24.185 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqusiUWIscjEbZqYMSbDR8HFBrgo8GqLLfKRDYVrkH9zVf6fkCsEaWmyv1dxAi91vKftga7wT-vy-c5VuvvRfRlWESzRDd0TS2OeAQHElRInntCtkDOWxxdFgAuSpdoa7yNzgTiYKMMe3T1Rch8SJebu--h6HoHMfQlGV5Y-WOM5ITJvuqMY-aEreP-VvtIXHTh8nq1TP5He3Kh2ZvqT5KDRCrAPSnhtc_GbCJz-6ktdrzC8TEV0mwdqkgDr4jKyuxzouxczZHP61jB1vy0ren5M8LUUvWKqVY2MyG9OA6kKhZ-HAnQJsj7Ajphp7I-EJQ","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 15:05:24.384 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 15:05:24.385 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 15:05:24.385 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 15:05:24.385 +08:00 [DBG] Start userinfo request
2019-06-13 15:05:24.386 +08:00 [DBG] Bearer token found in header
2019-06-13 15:05:25.728 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:05:25.728 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:05:26.846 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:05:26.846 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:05:27.201 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 15:05:27.202 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560409524,"exp":1560413124,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"mvcImp","sub":"af61726e-716b-4170-8c26-6568bf294215","auth_time":1560234512,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"shawn","last_name":"wong","card_number":"12123","card_holder":"王曉鋒","card_security_number":"2323","card_expiration":"20/12","address_city":"shanghai","address_country":"中国","address_state":"canials","address_street":"shanghai","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 15:05:27.202 +08:00 [DBG] Creating userinfo response
2019-06-13 15:05:27.202 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 15:05:27.202 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 15:05:27.399 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:05:27.399 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile
2019-06-13 15:05:27.399 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 15:05:27.862 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:05:27.862 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 15:05:27.862 +08:00 [DBG] End userinfo request
2019-06-13 15:05:28.157 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 15:05:28.158 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 15:05:28.158 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 15:05:28.158 +08:00 [DBG] Start discovery request
2019-06-13 15:05:28.876 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 15:05:28.986 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 15:05:28.987 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 15:05:28.987 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 15:05:28.987 +08:00 [DBG] Start key discovery request
2019-06-13 15:06:33.948 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 15:06:33.948 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 15:06:33.949 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 15:06:33.949 +08:00 [DBG] Start authorize request
2019-06-13 15:06:33.949 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:06:33.949 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:06:35.195 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:06:35.195 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:06:35.367 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:06:35.480 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:06:35.672 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:06:35.786 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:06:35.786 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:06:35.786 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ir3Gxp7QCEwU9bwpDCgnQ57inSZDd6PAdu4vp4qhsDwPr7gOY6qdLZpMPbk-UiKMIZNeuOkiTpx8jJ-KFdQoSa2UNmXBY6zRnSu8PulrPeSVa3NZpBtPAWk9YgmdVa46HXiU7FDJqqLMYmq361SaPJPZGkQY2ErTCfa1yPE5RjdAvikkkl3jCO6lfMGb6CBdYVq6sJU3Su728_FBw7zNWyPF0grzprXwcn633jCr5oxNzjBKoqzxVQ88NgS0I0JWoeQ6sdiquP52Z8JVyHxUYWrls-OFGM_n7ZyX7RtvPyCu8JKlY7ZEGSkXfsG3uops94","UiLocales":null,"Nonce":"636960063939212826.MzA2NzRlZDAtMTA1Ny00NDQ5LTg0ZGQtZDkzNWEzZTEzNzM3NTcyYmI4YTctMTRlNS00MzE4LWI1Y2MtYWMyNjZlYjQxM2Rm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile","response_mode":"form_post","nonce":"636960063939212826.MzA2NzRlZDAtMTA1Ny00NDQ5LTg0ZGQtZDkzNWEzZTEzNzM3NTcyYmI4YTctMTRlNS00MzE4LWI1Y2MtYWMyNjZlYjQxM2Rm","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ir3Gxp7QCEwU9bwpDCgnQ57inSZDd6PAdu4vp4qhsDwPr7gOY6qdLZpMPbk-UiKMIZNeuOkiTpx8jJ-KFdQoSa2UNmXBY6zRnSu8PulrPeSVa3NZpBtPAWk9YgmdVa46HXiU7FDJqqLMYmq361SaPJPZGkQY2ErTCfa1yPE5RjdAvikkkl3jCO6lfMGb6CBdYVq6sJU3Su728_FBw7zNWyPF0grzprXwcn633jCr5oxNzjBKoqzxVQ88NgS0I0JWoeQ6sdiquP52Z8JVyHxUYWrls-OFGM_n7ZyX7RtvPyCu8JKlY7ZEGSkXfsG3uops94","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 15:06:36.033 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-13 15:06:36.037 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 15:06:36.037 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 15:06:36.037 +08:00 [DBG] Getting claims for access token for client: mvcImp
2019-06-13 15:06:36.037 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:06:36.037 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 15:06:36.041 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-13 15:06:36.041 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 15:06:36.044 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****rkGw","$type":"Token"},{"TokenType":"access_token","TokenValue":"****DO8w","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFPF5DLSHU:00000001","TimeStamp":"2019-06-13T07:06:36.0000000Z","ProcessId":220,"LocalIpAddress":"127.0.0.1:5274","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 15:06:36.045 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ir3Gxp7QCEwU9bwpDCgnQ57inSZDd6PAdu4vp4qhsDwPr7gOY6qdLZpMPbk-UiKMIZNeuOkiTpx8jJ-KFdQoSa2UNmXBY6zRnSu8PulrPeSVa3NZpBtPAWk9YgmdVa46HXiU7FDJqqLMYmq361SaPJPZGkQY2ErTCfa1yPE5RjdAvikkkl3jCO6lfMGb6CBdYVq6sJU3Su728_FBw7zNWyPF0grzprXwcn633jCr5oxNzjBKoqzxVQ88NgS0I0JWoeQ6sdiquP52Z8JVyHxUYWrls-OFGM_n7ZyX7RtvPyCu8JKlY7ZEGSkXfsG3uops94","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 15:06:36.138 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 15:06:36.138 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 15:06:36.140 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 15:06:36.140 +08:00 [DBG] Start userinfo request
2019-06-13 15:06:36.140 +08:00 [DBG] Bearer token found in header
2019-06-13 15:06:37.706 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:06:37.706 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:06:39.041 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:06:39.041 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:06:39.147 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 15:06:39.148 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560409596,"exp":1560413196,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"mvcImp","sub":"af61726e-716b-4170-8c26-6568bf294215","auth_time":1560234512,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"shawn","last_name":"wong","card_number":"12123","card_holder":"王曉鋒","card_security_number":"2323","card_expiration":"20/12","address_city":"shanghai","address_country":"中国","address_state":"canials","address_street":"shanghai","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 15:06:39.148 +08:00 [DBG] Creating userinfo response
2019-06-13 15:06:39.148 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 15:06:39.148 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 15:06:39.360 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:06:39.360 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile
2019-06-13 15:06:39.360 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 15:06:39.563 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:06:39.563 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 15:06:39.563 +08:00 [DBG] End userinfo request
2019-06-13 15:09:43.163 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 15:09:43.163 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 15:09:43.163 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 15:09:43.163 +08:00 [DBG] Start authorize request
2019-06-13 15:09:43.163 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:09:43.164 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:09:44.462 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:09:44.462 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:09:44.887 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:09:44.995 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:09:45.413 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:09:45.519 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:09:45.520 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:09:45.520 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoBVG6Tm9zykPR2NTGGnWqGKWZS-nleLv4qZNylad63IMjvulxO--SxnaRFPjpR8pqRCb20GzW1SJmkGaDQjVmUb4MEuLE0AnuNf7n8b4ofCS-VCN2BU3o1-eovXysvywdGRvobc1NYh3i1bkOwV6BdvWGDHRfqM8BjD1A7UeKUrUcTnAWTVM4BANVWYd2PzfPavDlemqLYXSXlSZNpXv-AG0CVVkviGhdRlxUCSz1G7b8ZcL-YiEKlk370mZW7CmgFJJFF5OvauXQP-K9c2up5crDooOYv7RSkSBPb7WI6sBKf0cFFXURKCiu1-hosExg","UiLocales":null,"Nonce":"636960065831161902.MTEwODkwMTYtNzE1MC00OGJkLTljYjEtNTY4YjM3ZGQ4ZTMwY2NmNGFhMGUtZjZkNC00YWE3LTk4NjYtMWE0YzQ5ZDZkOWNi","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile","response_mode":"form_post","nonce":"636960065831161902.MTEwODkwMTYtNzE1MC00OGJkLTljYjEtNTY4YjM3ZGQ4ZTMwY2NmNGFhMGUtZjZkNC00YWE3LTk4NjYtMWE0YzQ5ZDZkOWNi","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoBVG6Tm9zykPR2NTGGnWqGKWZS-nleLv4qZNylad63IMjvulxO--SxnaRFPjpR8pqRCb20GzW1SJmkGaDQjVmUb4MEuLE0AnuNf7n8b4ofCS-VCN2BU3o1-eovXysvywdGRvobc1NYh3i1bkOwV6BdvWGDHRfqM8BjD1A7UeKUrUcTnAWTVM4BANVWYd2PzfPavDlemqLYXSXlSZNpXv-AG0CVVkviGhdRlxUCSz1G7b8ZcL-YiEKlk370mZW7CmgFJJFF5OvauXQP-K9c2up5crDooOYv7RSkSBPb7WI6sBKf0cFFXURKCiu1-hosExg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 15:09:45.805 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-13 15:09:45.808 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 15:09:45.808 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 15:09:45.809 +08:00 [DBG] Getting claims for access token for client: mvcImp
2019-06-13 15:09:45.809 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:09:45.809 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 15:09:45.812 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-13 15:09:45.812 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 15:09:45.815 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****8sow","$type":"Token"},{"TokenType":"access_token","TokenValue":"****P6Rg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFPF5DLSHV:00000001","TimeStamp":"2019-06-13T07:09:45.0000000Z","ProcessId":220,"LocalIpAddress":"127.0.0.1:5274","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 15:09:45.815 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IoBVG6Tm9zykPR2NTGGnWqGKWZS-nleLv4qZNylad63IMjvulxO--SxnaRFPjpR8pqRCb20GzW1SJmkGaDQjVmUb4MEuLE0AnuNf7n8b4ofCS-VCN2BU3o1-eovXysvywdGRvobc1NYh3i1bkOwV6BdvWGDHRfqM8BjD1A7UeKUrUcTnAWTVM4BANVWYd2PzfPavDlemqLYXSXlSZNpXv-AG0CVVkviGhdRlxUCSz1G7b8ZcL-YiEKlk370mZW7CmgFJJFF5OvauXQP-K9c2up5crDooOYv7RSkSBPb7WI6sBKf0cFFXURKCiu1-hosExg","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 15:09:45.931 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 15:09:45.931 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 15:09:45.931 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 15:09:45.932 +08:00 [DBG] Start userinfo request
2019-06-13 15:09:45.932 +08:00 [DBG] Bearer token found in header
2019-06-13 15:09:47.571 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:09:47.571 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:09:48.885 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:09:48.885 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:09:49.009 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 15:09:49.009 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560409785,"exp":1560413385,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"mvcImp","sub":"af61726e-716b-4170-8c26-6568bf294215","auth_time":1560234512,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"shawn","last_name":"wong","card_number":"12123","card_holder":"王曉鋒","card_security_number":"2323","card_expiration":"20/12","address_city":"shanghai","address_country":"中国","address_state":"canials","address_street":"shanghai","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 15:09:49.010 +08:00 [DBG] Creating userinfo response
2019-06-13 15:09:49.010 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 15:09:49.010 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 15:09:49.216 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:09:49.216 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile
2019-06-13 15:09:49.216 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 15:09:49.409 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:09:49.410 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 15:09:49.410 +08:00 [DBG] End userinfo request
2019-06-13 15:13:48.279 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 15:13:48.280 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 15:13:48.280 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 15:13:48.280 +08:00 [DBG] Start discovery request
2019-06-13 15:13:49.142 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 15:13:49.334 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 15:13:49.335 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 15:13:49.335 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 15:13:49.335 +08:00 [DBG] Start key discovery request
2019-06-13 15:13:49.425 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 15:13:49.428 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 15:13:49.429 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 15:13:49.429 +08:00 [DBG] Start authorize request
2019-06-13 15:13:49.429 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:13:49.429 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:13:50.601 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:13:50.601 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:13:50.602 +08:00 [ERR] Response type not supported: id_token access_token
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IozVxkYPuR9PhTNWUttE5KSeTFWY6noim-pRwLIyCaNcuYiAJhag4BSFK7ng3Z8xSDI-OMQgxNZf1F9hz_gk_-8Xi-fqE2jyvMxchulkus3s3n7BaZHCEozxoqUT2LOoDvMmV2ywNaN0tMGSyLH6MJM6bvHnsFNDhO4IPub5Csue5q3zU5DQJWPDKX4emNMmPBiGoIG4_QRc32x-vjrAwOJuNmZa97xXKhe4HjsONt2gLnWioqMeFBnraEx3eFIq7blJ-CeGwZMlMFqzzHi0fUUqqSV8CWu0GR6w4quxZqYqCmYuCWOOrvxBwEgN-Ie2YI","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token access_token","scope":"openid profile","response_mode":"form_post","nonce":"636960068293674989.MmQyOTkxNGItOGJjMi00MzZlLWE0NGMtZmUwZGQ4NWZiOGE1MGY4MGVmZTYtZjBmMS00YTE3LTg5M2YtNjIxYmNmNjcwZTgy","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IozVxkYPuR9PhTNWUttE5KSeTFWY6noim-pRwLIyCaNcuYiAJhag4BSFK7ng3Z8xSDI-OMQgxNZf1F9hz_gk_-8Xi-fqE2jyvMxchulkus3s3n7BaZHCEozxoqUT2LOoDvMmV2ywNaN0tMGSyLH6MJM6bvHnsFNDhO4IPub5Csue5q3zU5DQJWPDKX4emNMmPBiGoIG4_QRc32x-vjrAwOJuNmZa97xXKhe4HjsONt2gLnWioqMeFBnraEx3eFIq7blJ-CeGwZMlMFqzzHi0fUUqqSV8CWu0GR6w4quxZqYqCmYuCWOOrvxBwEgN-Ie2YI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 15:13:50.605 +08:00 [ERR] Request validation failed
2019-06-13 15:13:50.605 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IozVxkYPuR9PhTNWUttE5KSeTFWY6noim-pRwLIyCaNcuYiAJhag4BSFK7ng3Z8xSDI-OMQgxNZf1F9hz_gk_-8Xi-fqE2jyvMxchulkus3s3n7BaZHCEozxoqUT2LOoDvMmV2ywNaN0tMGSyLH6MJM6bvHnsFNDhO4IPub5Csue5q3zU5DQJWPDKX4emNMmPBiGoIG4_QRc32x-vjrAwOJuNmZa97xXKhe4HjsONt2gLnWioqMeFBnraEx3eFIq7blJ-CeGwZMlMFqzzHi0fUUqqSV8CWu0GR6w4quxZqYqCmYuCWOOrvxBwEgN-Ie2YI","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token access_token","scope":"openid profile","response_mode":"form_post","nonce":"636960068293674989.MmQyOTkxNGItOGJjMi00MzZlLWE0NGMtZmUwZGQ4NWZiOGE1MGY4MGVmZTYtZjBmMS00YTE3LTg5M2YtNjIxYmNmNjcwZTgy","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IozVxkYPuR9PhTNWUttE5KSeTFWY6noim-pRwLIyCaNcuYiAJhag4BSFK7ng3Z8xSDI-OMQgxNZf1F9hz_gk_-8Xi-fqE2jyvMxchulkus3s3n7BaZHCEozxoqUT2LOoDvMmV2ywNaN0tMGSyLH6MJM6bvHnsFNDhO4IPub5Csue5q3zU5DQJWPDKX4emNMmPBiGoIG4_QRc32x-vjrAwOJuNmZa97xXKhe4HjsONt2gLnWioqMeFBnraEx3eFIq7blJ-CeGwZMlMFqzzHi0fUUqqSV8CWu0GR6w4quxZqYqCmYuCWOOrvxBwEgN-Ie2YI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 15:13:50.607 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"","GrantType":null,"Error":"unsupported_response_type","ErrorDescription":"Response type not supported","Category":"Token","Name":"Token Issued Failure","EventType":"Failure","Id":2001,"Message":null,"ActivityId":"0HLNFPF5DLSI0:00000003","TimeStamp":"2019-06-13T07:13:50.0000000Z","ProcessId":220,"LocalIpAddress":"127.0.0.1:5274","RemoteIpAddress":"::1","$type":"TokenIssuedFailureEvent"}
2019-06-13 15:14:40.698 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 15:14:40.702 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 15:14:40.704 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 15:14:40.704 +08:00 [DBG] Start discovery request
2019-06-13 15:14:41.382 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 15:14:41.562 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 15:14:41.563 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 15:14:41.563 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 15:14:41.563 +08:00 [DBG] Start key discovery request
2019-06-13 15:14:41.645 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 15:14:41.645 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 15:14:41.646 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 15:14:41.646 +08:00 [DBG] Start authorize request
2019-06-13 15:14:41.646 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:14:41.646 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:14:42.793 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:14:42.793 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:14:42.976 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:14:43.103 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:14:43.313 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:14:43.435 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:14:43.435 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:14:43.435 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpDyZow1SoQ4bxViwtxiMtrOOKzmR4miBIbx7YP4ZnV3fCpv2xHBtC4yYrSod-NkvrG88jVM2LLA4jAH3o_587xZ6-dBzUJL1MpvpDQJxD_ssZImSYTIsP72zxpPUcpOtko1TBumi_lAuOTDRgCJdF9Casaym-3VrSr_wDLPPtkEztSPMpHLsm5cKt8bmFiLyKafC8pICz0QWutEWqcrVKIWaPCJ0hpOABpC7SZltz1Pi7nyp7EUNi07E6wDDykyfy6-czx9mEsj95Owb2CaO_WDw48mWRtoKBfuxno-SH-EHb_v9Q7kt90OlwQqjiAiyQ","UiLocales":null,"Nonce":"636960068815938841.MmI5MDgzYmEtMGM4OC00OGY5LWE5YzAtYTZiZDQ1MGNhYzg2ZGRkYmUzNmEtZTY4Yy00YjY2LTgzMGMtMDE5MDgzYzU5MzJh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile","response_mode":"form_post","nonce":"636960068815938841.MmI5MDgzYmEtMGM4OC00OGY5LWE5YzAtYTZiZDQ1MGNhYzg2ZGRkYmUzNmEtZTY4Yy00YjY2LTgzMGMtMDE5MDgzYzU5MzJh","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpDyZow1SoQ4bxViwtxiMtrOOKzmR4miBIbx7YP4ZnV3fCpv2xHBtC4yYrSod-NkvrG88jVM2LLA4jAH3o_587xZ6-dBzUJL1MpvpDQJxD_ssZImSYTIsP72zxpPUcpOtko1TBumi_lAuOTDRgCJdF9Casaym-3VrSr_wDLPPtkEztSPMpHLsm5cKt8bmFiLyKafC8pICz0QWutEWqcrVKIWaPCJ0hpOABpC7SZltz1Pi7nyp7EUNi07E6wDDykyfy6-czx9mEsj95Owb2CaO_WDw48mWRtoKBfuxno-SH-EHb_v9Q7kt90OlwQqjiAiyQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 15:14:43.682 +08:00 [DBG] VHwV9SWfzW/EQXuBTL6MQ//T5xXc1u82LMCGIn0Ko/U= found in database: true
2019-06-13 15:14:43.687 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 15:14:43.687 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 15:14:43.687 +08:00 [DBG] Getting claims for access token for client: mvcImp
2019-06-13 15:14:43.687 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:14:43.687 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 15:14:43.690 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcImp
2019-06-13 15:14:43.690 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 15:14:43.695 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****2yXQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****hJ4Q","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFPF5DLSI0:00000007","TimeStamp":"2019-06-13T07:14:43.0000000Z","ProcessId":220,"LocalIpAddress":"127.0.0.1:5274","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 15:14:43.696 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpDyZow1SoQ4bxViwtxiMtrOOKzmR4miBIbx7YP4ZnV3fCpv2xHBtC4yYrSod-NkvrG88jVM2LLA4jAH3o_587xZ6-dBzUJL1MpvpDQJxD_ssZImSYTIsP72zxpPUcpOtko1TBumi_lAuOTDRgCJdF9Casaym-3VrSr_wDLPPtkEztSPMpHLsm5cKt8bmFiLyKafC8pICz0QWutEWqcrVKIWaPCJ0hpOABpC7SZltz1Pi7nyp7EUNi07E6wDDykyfy6-czx9mEsj95Owb2CaO_WDw48mWRtoKBfuxno-SH-EHb_v9Q7kt90OlwQqjiAiyQ","Scope":"openid profile","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 15:14:43.866 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 15:14:43.867 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 15:14:43.867 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 15:14:43.867 +08:00 [DBG] Start userinfo request
2019-06-13 15:14:43.867 +08:00 [DBG] Bearer token found in header
2019-06-13 15:14:44.998 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:14:44.999 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:14:46.145 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:14:46.145 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:14:46.268 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 15:14:46.268 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560410083,"exp":1560413683,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"mvcImp","sub":"af61726e-716b-4170-8c26-6568bf294215","auth_time":1560234512,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"shawn","last_name":"wong","card_number":"12123","card_holder":"王曉鋒","card_security_number":"2323","card_expiration":"20/12","address_city":"shanghai","address_country":"中国","address_state":"canials","address_street":"shanghai","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 15:14:46.268 +08:00 [DBG] Creating userinfo response
2019-06-13 15:14:46.268 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 15:14:46.268 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 15:14:46.486 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:14:46.486 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile
2019-06-13 15:14:46.486 +08:00 [DBG] Scopes in access token: openid profile
2019-06-13 15:14:46.708 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:14:46.708 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 15:14:46.709 +08:00 [DBG] End userinfo request
2019-06-13 15:14:46.993 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 15:14:46.993 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 15:14:46.993 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 15:14:46.994 +08:00 [DBG] Start discovery request
2019-06-13 15:14:47.672 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 15:14:47.791 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 15:14:47.792 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 15:14:47.792 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 15:14:47.792 +08:00 [DBG] Start key discovery request
2019-06-13 15:18:14.135 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 15:18:14.136 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 15:18:14.136 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 15:18:14.136 +08:00 [DBG] Start discovery request
2019-06-13 15:18:15.042 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 15:18:15.235 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 15:18:15.236 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 15:18:15.236 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 15:18:15.236 +08:00 [DBG] Start key discovery request
2019-06-13 15:18:15.798 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 15:18:15.798 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 15:18:15.798 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 15:18:15.798 +08:00 [DBG] Start authorize request
2019-06-13 15:18:15.798 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:18:15.798 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:18:16.871 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 15:18:16.871 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 15:18:16.871 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 15:18:16.872 +08:00 [DBG] No PKCE used.
2019-06-13 15:18:17.075 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 15:18:17.189 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:18:17.393 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 15:18:17.508 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:18:17.508 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:18:17.508 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile email","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqGYCq97VK_TmYEITQ-zsbvrRTBRs2YIQsfXyyo1qVrAt3l5TpddBwVXhubC6baHKff2xlUpP3a4B5KUyFrZidqzJBLgaTap0pSr8UCsqYQyknkvperbTU12GRd9GQ6qCdVGF1y4Kmg004Pi9AVViZV9YgQHuMrUOPkoHY9oNQI4vIC4xqwz7r0_kfpNFs6-4TTnzHlUrD8lkV-eOaDx8PREBI1UWpCM88HC7gbzfv_Q-IgAHUK8AsMjLve3Ph-P9tDCONNt4cQVRLu36FG-1IUyosA8D5gXWizwJRnZOox1nXCtZc_zWdJ2DD9p024WWM","UiLocales":null,"Nonce":"636960070952759308.ZTEwZDM0YmMtYWM1NS00NWVlLThjNDgtYTRlZjRjNmZlNjMwM2I4NWRmNjYtMjIwMi00ZmIwLThjYWUtM2I3YmU5MjQ1YWQ4","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile email","response_mode":"form_post","nonce":"636960070952759308.ZTEwZDM0YmMtYWM1NS00NWVlLThjNDgtYTRlZjRjNmZlNjMwM2I4NWRmNjYtMjIwMi00ZmIwLThjYWUtM2I3YmU5MjQ1YWQ4","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqGYCq97VK_TmYEITQ-zsbvrRTBRs2YIQsfXyyo1qVrAt3l5TpddBwVXhubC6baHKff2xlUpP3a4B5KUyFrZidqzJBLgaTap0pSr8UCsqYQyknkvperbTU12GRd9GQ6qCdVGF1y4Kmg004Pi9AVViZV9YgQHuMrUOPkoHY9oNQI4vIC4xqwz7r0_kfpNFs6-4TTnzHlUrD8lkV-eOaDx8PREBI1UWpCM88HC7gbzfv_Q-IgAHUK8AsMjLve3Ph-P9tDCONNt4cQVRLu36FG-1IUyosA8D5gXWizwJRnZOox1nXCtZc_zWdJ2DD9p024WWM","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 15:18:17.622 +08:00 [DBG] FiTLcYGBYEV8OnKEgTs+U+128Zy+PdC+Fm2zjauszrc= found in database: true
2019-06-13 15:18:17.626 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 15:18:17.629 +08:00 [DBG] Creating Hybrid Flow response.
2019-06-13 15:18:17.780 +08:00 [DBG] xxvEHwLO0jTLH+NS9eEmqiQBqf2a6EGXxntrbZwjzl4= not found in database
2019-06-13 15:18:18.019 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 15:18:18.019 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcHybrid
2019-06-13 15:18:18.019 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 15:18:18.023 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile email","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****GdvA","$type":"Token"},{"TokenType":"code","TokenValue":"****4e1a","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFPF5DLSI1:00000003","TimeStamp":"2019-06-13T07:18:18.0000000Z","ProcessId":220,"LocalIpAddress":"127.0.0.1:5274","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 15:18:18.025 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcHybrid","RedirectUri":"http://localhost:5005/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqGYCq97VK_TmYEITQ-zsbvrRTBRs2YIQsfXyyo1qVrAt3l5TpddBwVXhubC6baHKff2xlUpP3a4B5KUyFrZidqzJBLgaTap0pSr8UCsqYQyknkvperbTU12GRd9GQ6qCdVGF1y4Kmg004Pi9AVViZV9YgQHuMrUOPkoHY9oNQI4vIC4xqwz7r0_kfpNFs6-4TTnzHlUrD8lkV-eOaDx8PREBI1UWpCM88HC7gbzfv_Q-IgAHUK8AsMjLve3Ph-P9tDCONNt4cQVRLu36FG-1IUyosA8D5gXWizwJRnZOox1nXCtZc_zWdJ2DD9p024WWM","Scope":"openid profile email","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 15:18:18.036 +08:00 [DBG] Augmenting SignInContext
2019-06-13 15:18:18.051 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-13 15:18:18.284 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-13 15:18:18.292 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-13 15:18:18.292 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-13 15:18:18.300 +08:00 [DBG] Start token request.
2019-06-13 15:18:18.310 +08:00 [DBG] Start client validation
2019-06-13 15:18:18.316 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-13 15:18:18.321 +08:00 [DBG] Start parsing for secret in post body
2019-06-13 15:18:18.347 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-13 15:18:18.348 +08:00 [DBG] Secret id found: mvcHybrid
2019-06-13 15:18:19.429 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 15:18:19.430 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 15:18:19.439 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-13 15:18:19.439 +08:00 [DBG] Client validation success
2019-06-13 15:18:19.440 +08:00 [INF] {"ClientId":"mvcHybrid","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNFPF5DLSI1:00000004","TimeStamp":"2019-06-13T07:18:19.0000000Z","ProcessId":220,"LocalIpAddress":"127.0.0.1:5274","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-13 15:18:19.445 +08:00 [DBG] Start token request validation
2019-06-13 15:18:19.456 +08:00 [DBG] Start validation of authorization code token request
2019-06-13 15:18:19.560 +08:00 [DBG] xxvEHwLO0jTLH+NS9eEmqiQBqf2a6EGXxntrbZwjzl4= found in database: true
2019-06-13 15:18:19.685 +08:00 [DBG] removing xxvEHwLO0jTLH+NS9eEmqiQBqf2a6EGXxntrbZwjzl4= persisted grant from database
2019-06-13 15:18:20.036 +08:00 [DBG] Validation of authorization code token request success
2019-06-13 15:18:20.039 +08:00 [INF] Token request validation success
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"62dda219f302c6e698735e269a0d7b30ecddb686f69245a8f835faf677984e1a","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvcHybrid","client_secret":"***REDACTED***","code":"62dda219f302c6e698735e269a0d7b30ecddb686f69245a8f835faf677984e1a","grant_type":"authorization_code","redirect_uri":"http://localhost:5005/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-06-13 15:18:21.125 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 15:18:21.126 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 15:18:21.331 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 15:18:21.445 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:18:21.445 +08:00 [DBG] Getting claims for access token for client: mvcHybrid
2019-06-13 15:18:21.445 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:18:21.446 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 15:18:22.491 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 15:18:22.491 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 15:18:22.671 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 15:18:22.773 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:18:22.773 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcHybrid
2019-06-13 15:18:22.773 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 15:18:22.778 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile email","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****WjaA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****lYsA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFPF5DLSI1:00000004","TimeStamp":"2019-06-13T07:18:22.0000000Z","ProcessId":220,"LocalIpAddress":"127.0.0.1:5274","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 15:18:22.780 +08:00 [DBG] Token request success.
2019-06-13 15:18:22.829 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 15:18:22.830 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 15:18:22.830 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 15:18:22.830 +08:00 [DBG] Start userinfo request
2019-06-13 15:18:22.830 +08:00 [DBG] Bearer token found in header
2019-06-13 15:18:23.897 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 15:18:23.897 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 15:18:25.192 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 15:18:25.193 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 15:18:25.297 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 15:18:25.297 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560410301,"exp":1560410361,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"mvcHybrid","sub":"af61726e-716b-4170-8c26-6568bf294215","auth_time":1560234512,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"shawn","last_name":"wong","card_number":"12123","card_holder":"王曉鋒","card_security_number":"2323","card_expiration":"20/12","address_city":"shanghai","address_country":"中国","address_state":"canials","address_street":"shanghai","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 15:18:25.297 +08:00 [DBG] Creating userinfo response
2019-06-13 15:18:25.297 +08:00 [DBG] Scopes in access token: openid profile email
2019-06-13 15:18:25.297 +08:00 [DBG] Scopes in access token: openid profile email
2019-06-13 15:18:25.471 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 15:18:25.471 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-13 15:18:25.471 +08:00 [DBG] Scopes in access token: openid profile email
2019-06-13 15:18:25.656 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 15:18:25.656 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 15:18:25.656 +08:00 [DBG] End userinfo request
2019-06-13 15:19:12.410 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 15:19:12.413 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 15:19:12.414 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 15:19:12.414 +08:00 [DBG] Start discovery request
2019-06-13 15:19:13.137 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 15:19:13.301 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 15:19:13.304 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 15:19:13.304 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 15:19:13.304 +08:00 [DBG] Start key discovery request
2019-06-13 15:26:26.590 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 15:26:26.619 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 15:26:26.619 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 15:26:26.619 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 15:26:26.619 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 15:26:26.619 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 15:26:27.114 +08:00 [DBG] Starting grant removal
2019-06-13 15:26:27.394 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 15:26:27.398 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 15:26:27.398 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 15:26:27.398 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 15:26:27.399 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 15:26:27.399 +08:00 [DBG] Error Url: /home/error
2019-06-13 15:26:27.399 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 15:26:46.277 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 15:26:46.283 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 15:26:46.283 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 15:26:46.297 +08:00 [DBG] Start discovery request
2019-06-13 15:26:47.331 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 15:26:47.556 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 15:26:47.557 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 15:26:47.557 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 15:26:47.563 +08:00 [DBG] Start key discovery request
2019-06-13 15:26:47.658 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 15:26:47.662 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 15:26:47.662 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 15:26:47.669 +08:00 [DBG] Start authorize request
2019-06-13 15:26:47.681 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:26:47.686 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:26:48.982 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 15:26:48.992 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 15:26:48.996 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 15:26:48.997 +08:00 [DBG] No PKCE used.
2019-06-13 15:26:49.238 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 15:26:49.393 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:26:49.608 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 15:26:49.720 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:26:49.727 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:26:49.741 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile email","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrEPjungHYKbaDb-df4h5RHpi7vIj1J31HQ48AE0KUf682P7O6dZ_yz4ay9_23Xg6aXAiBL3hV_0YZ2BSHa_SiNidxBtCmg1xFkiBrkXqGwlJrJGwylCgpJ1mURnf5sx3bi6kZu0ILE5VQf7oogpFaQYm0v63n_frzQQx1SZ4C2iABTMh4x9KXoKa3jh2ipBW_hoAeIuGrqBAWcRWS0Jast24CxfIKmKszyJl4LESFQNCtlyYA1ZjbGXC-MoprwAIejCU2M5siQ1hbTaoCYO7Cv-26i17b49jdErWYrp8HD8bM6leRTO6EvakFzRY-8ohk","UiLocales":null,"Nonce":"636960076076109796.MWQ4Y2Y4N2ItMDAyNC00NWJiLThjMWMtNTg4N2UyM2E5YWYxMGRhNWExZTMtZjg2Mi00ODdiLThlNTMtZWExYzE0NjI0ZDlh","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile email","response_mode":"form_post","nonce":"636960076076109796.MWQ4Y2Y4N2ItMDAyNC00NWJiLThjMWMtNTg4N2UyM2E5YWYxMGRhNWExZTMtZjg2Mi00ODdiLThlNTMtZWExYzE0NjI0ZDlh","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrEPjungHYKbaDb-df4h5RHpi7vIj1J31HQ48AE0KUf682P7O6dZ_yz4ay9_23Xg6aXAiBL3hV_0YZ2BSHa_SiNidxBtCmg1xFkiBrkXqGwlJrJGwylCgpJ1mURnf5sx3bi6kZu0ILE5VQf7oogpFaQYm0v63n_frzQQx1SZ4C2iABTMh4x9KXoKa3jh2ipBW_hoAeIuGrqBAWcRWS0Jast24CxfIKmKszyJl4LESFQNCtlyYA1ZjbGXC-MoprwAIejCU2M5siQ1hbTaoCYO7Cv-26i17b49jdErWYrp8HD8bM6leRTO6EvakFzRY-8ohk","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 15:26:50.034 +08:00 [DBG] FiTLcYGBYEV8OnKEgTs+U+128Zy+PdC+Fm2zjauszrc= found in database: true
2019-06-13 15:26:50.040 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 15:26:50.046 +08:00 [DBG] Creating Hybrid Flow response.
2019-06-13 15:26:50.201 +08:00 [DBG] 3VNJupiNyz5kfDVWQl+li6GJcDspSdg9qSVWLyP+ZwY= not found in database
2019-06-13 15:26:50.456 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 15:26:50.465 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcHybrid
2019-06-13 15:26:50.467 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 15:26:50.576 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af61726e-716b-4170-8c26-6568bf294215","Scopes":"openid profile email","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****Q4Sg","$type":"Token"},{"TokenType":"code","TokenValue":"****2d3d","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFQ1P7I77L:00000003","TimeStamp":"2019-06-13T07:26:50.0000000Z","ProcessId":33928,"LocalIpAddress":"127.0.0.1:19930","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 15:26:50.578 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcHybrid","RedirectUri":"http://localhost:5005/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrEPjungHYKbaDb-df4h5RHpi7vIj1J31HQ48AE0KUf682P7O6dZ_yz4ay9_23Xg6aXAiBL3hV_0YZ2BSHa_SiNidxBtCmg1xFkiBrkXqGwlJrJGwylCgpJ1mURnf5sx3bi6kZu0ILE5VQf7oogpFaQYm0v63n_frzQQx1SZ4C2iABTMh4x9KXoKa3jh2ipBW_hoAeIuGrqBAWcRWS0Jast24CxfIKmKszyJl4LESFQNCtlyYA1ZjbGXC-MoprwAIejCU2M5siQ1hbTaoCYO7Cv-26i17b49jdErWYrp8HD8bM6leRTO6EvakFzRY-8ohk","Scope":"openid profile email","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 15:26:50.930 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-13 15:26:50.936 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-13 15:26:50.936 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-13 15:26:50.945 +08:00 [DBG] Start token request.
2019-06-13 15:26:50.951 +08:00 [DBG] Start client validation
2019-06-13 15:26:50.956 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-13 15:26:50.961 +08:00 [DBG] Start parsing for secret in post body
2019-06-13 15:26:50.981 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-13 15:26:50.981 +08:00 [DBG] Secret id found: mvcHybrid
2019-06-13 15:26:52.087 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 15:26:52.088 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 15:26:52.095 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-13 15:26:52.096 +08:00 [DBG] Client validation success
2019-06-13 15:26:52.096 +08:00 [INF] {"ClientId":"mvcHybrid","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNFQ1P7I77K:00000003","TimeStamp":"2019-06-13T07:26:52.0000000Z","ProcessId":33928,"LocalIpAddress":"127.0.0.1:19930","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-13 15:26:52.102 +08:00 [DBG] Start token request validation
2019-06-13 15:26:52.111 +08:00 [DBG] Start validation of authorization code token request
2019-06-13 15:26:52.229 +08:00 [DBG] 3VNJupiNyz5kfDVWQl+li6GJcDspSdg9qSVWLyP+ZwY= found in database: true
2019-06-13 15:26:52.379 +08:00 [DBG] removing 3VNJupiNyz5kfDVWQl+li6GJcDspSdg9qSVWLyP+ZwY= persisted grant from database
2019-06-13 15:26:52.737 +08:00 [DBG] Validation of authorization code token request success
2019-06-13 15:26:52.740 +08:00 [INF] Token request validation success
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"e10bf659a3662d06b6e0a068bbdb7dfa877d267f97cf2074e7c4aca928412d3d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvcHybrid","client_secret":"***REDACTED***","code":"e10bf659a3662d06b6e0a068bbdb7dfa877d267f97cf2074e7c4aca928412d3d","grant_type":"authorization_code","redirect_uri":"http://localhost:5005/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-06-13 15:26:53.875 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 15:26:53.875 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 15:26:54.087 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 15:26:54.210 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:26:54.220 +08:00 [DBG] Getting claims for access token for client: mvcHybrid
2019-06-13 15:26:54.221 +08:00 [DBG] Getting claims for access token for subject: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:26:54.226 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 15:26:55.392 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 15:26:55.392 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 15:26:55.602 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 15:26:55.733 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:26:55.734 +08:00 [DBG] Getting claims for identity token for subject: af61726e-716b-4170-8c26-6568bf294215 and client: mvcHybrid
2019-06-13 15:26:55.734 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 15:26:55.738 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile email","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****VDiA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****HdLA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFQ1P7I77K:00000003","TimeStamp":"2019-06-13T07:26:55.0000000Z","ProcessId":33928,"LocalIpAddress":"127.0.0.1:19930","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 15:26:55.740 +08:00 [DBG] Token request success.
2019-06-13 15:26:55.799 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 15:26:55.801 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 15:26:55.801 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 15:26:55.810 +08:00 [DBG] Start userinfo request
2019-06-13 15:26:55.813 +08:00 [DBG] Bearer token found in header
2019-06-13 15:26:57.026 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 15:26:57.026 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 15:26:58.142 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 15:26:58.142 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 15:26:58.275 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 15:26:58.276 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560410814,"exp":1560410874,"iss":"http://localhost:5000","aud":"http://localhost:5000/resources","client_id":"mvcHybrid","sub":"af61726e-716b-4170-8c26-6568bf294215","auth_time":1560234512,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"shawn","last_name":"wong","card_number":"12123","card_holder":"王曉鋒","card_security_number":"2323","card_expiration":"20/12","address_city":"shanghai","address_country":"中国","address_state":"canials","address_street":"shanghai","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 15:26:58.284 +08:00 [DBG] Creating userinfo response
2019-06-13 15:26:58.288 +08:00 [DBG] Scopes in access token: openid profile email
2019-06-13 15:26:58.291 +08:00 [DBG] Scopes in access token: openid profile email
2019-06-13 15:26:58.508 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 15:26:58.508 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-13 15:26:58.509 +08:00 [DBG] Scopes in access token: openid profile email
2019-06-13 15:26:58.730 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 15:26:58.730 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 15:26:58.731 +08:00 [DBG] End userinfo request
2019-06-13 15:27:04.226 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 15:27:04.227 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 15:27:04.227 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 15:27:04.227 +08:00 [DBG] Start discovery request
2019-06-13 15:27:04.922 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 15:27:05.113 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 15:27:05.114 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 15:27:05.114 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 15:27:05.114 +08:00 [DBG] Start key discovery request
2019-06-13 15:28:08.539 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 15:28:08.568 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 15:28:08.568 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 15:28:08.568 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 15:28:08.569 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 15:28:08.569 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 15:28:09.085 +08:00 [DBG] Starting grant removal
2019-06-13 15:28:09.349 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 15:28:09.353 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 15:28:09.356 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 15:28:09.356 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 15:28:09.356 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 15:28:09.356 +08:00 [DBG] Error Url: /home/error
2019-06-13 15:28:09.356 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 15:29:08.616 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 15:29:08.620 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 15:29:08.620 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 15:29:08.624 +08:00 [DBG] Start discovery request
2019-06-13 15:29:09.662 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 15:29:09.747 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 15:29:09.748 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 15:29:09.748 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 15:29:09.751 +08:00 [DBG] Start key discovery request
2019-06-13 15:29:09.877 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-13 15:29:09.886 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-13 15:29:09.886 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-13 15:29:09.897 +08:00 [DBG] Start token request.
2019-06-13 15:29:09.903 +08:00 [DBG] Start client validation
2019-06-13 15:29:09.909 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-13 15:29:09.916 +08:00 [DBG] Start parsing for secret in post body
2019-06-13 15:29:09.933 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-13 15:29:09.933 +08:00 [DBG] Secret id found: client
2019-06-13 15:29:11.282 +08:00 [DBG] client found in database: true
2019-06-13 15:29:11.294 +08:00 [DBG] client configuration validation for client client succeeded.
2019-06-13 15:29:11.304 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-13 15:29:11.304 +08:00 [DBG] Client validation success
2019-06-13 15:29:11.317 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNFQ2NJBLGT:00000003","TimeStamp":"2019-06-13T07:29:11.0000000Z","ProcessId":16588,"LocalIpAddress":"127.0.0.1:34795","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-13 15:29:11.328 +08:00 [DBG] Start token request validation
2019-06-13 15:29:11.340 +08:00 [DBG] Start client credentials token request validation
2019-06-13 15:29:11.505 +08:00 [DBG] Found [] identity scopes in database
2019-06-13 15:29:12.128 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:29:12.262 +08:00 [DBG] Found [] identity scopes in database
2019-06-13 15:29:12.919 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:29:12.922 +08:00 [DBG] client credentials token request validation success
2019-06-13 15:29:12.931 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-06-13 15:29:12.953 +08:00 [DBG] Getting claims for access token for client: client
2019-06-13 15:29:13.060 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****QrLA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFQ2NJBLGT:00000003","TimeStamp":"2019-06-13T07:29:13.0000000Z","ProcessId":16588,"LocalIpAddress":"127.0.0.1:34795","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 15:29:13.062 +08:00 [DBG] Token request success.
2019-06-13 15:29:38.346 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 15:29:38.347 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 15:29:38.347 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 15:29:38.347 +08:00 [DBG] Start discovery request
2019-06-13 15:29:39.137 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 15:29:39.151 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 15:29:39.151 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 15:29:39.151 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 15:29:39.152 +08:00 [DBG] Start key discovery request
2019-06-13 15:29:45.183 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-13 15:29:45.184 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-13 15:29:45.184 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-13 15:29:45.184 +08:00 [DBG] Start token request.
2019-06-13 15:29:45.184 +08:00 [DBG] Start client validation
2019-06-13 15:29:45.184 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-13 15:29:45.184 +08:00 [DBG] Start parsing for secret in post body
2019-06-13 15:29:45.185 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-13 15:29:45.185 +08:00 [DBG] Secret id found: client
2019-06-13 15:29:46.405 +08:00 [DBG] client found in database: true
2019-06-13 15:29:46.405 +08:00 [DBG] client configuration validation for client client succeeded.
2019-06-13 15:29:46.406 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-13 15:29:46.406 +08:00 [DBG] Client validation success
2019-06-13 15:29:46.406 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNFQ2NJBLGS:00000004","TimeStamp":"2019-06-13T07:29:46.0000000Z","ProcessId":16588,"LocalIpAddress":"127.0.0.1:34795","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-13 15:29:46.406 +08:00 [DBG] Start token request validation
2019-06-13 15:29:46.406 +08:00 [DBG] Start client credentials token request validation
2019-06-13 15:29:46.536 +08:00 [DBG] Found [] identity scopes in database
2019-06-13 15:29:47.136 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:29:47.272 +08:00 [DBG] Found [] identity scopes in database
2019-06-13 15:29:47.881 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:29:47.881 +08:00 [DBG] client credentials token request validation success
2019-06-13 15:29:47.881 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-06-13 15:29:47.881 +08:00 [DBG] Getting claims for access token for client: client
2019-06-13 15:29:47.884 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****itvg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFQ2NJBLGS:00000004","TimeStamp":"2019-06-13T07:29:47.0000000Z","ProcessId":16588,"LocalIpAddress":"127.0.0.1:34795","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 15:29:47.884 +08:00 [DBG] Token request success.
2019-06-13 15:30:47.786 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 15:30:47.795 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 15:30:47.795 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 15:30:47.795 +08:00 [DBG] Start discovery request
2019-06-13 15:30:48.531 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 15:30:48.617 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 15:30:48.618 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 15:30:48.618 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 15:30:48.618 +08:00 [DBG] Start key discovery request
2019-06-13 15:30:50.147 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-13 15:30:50.148 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-13 15:30:50.148 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-13 15:30:50.148 +08:00 [DBG] Start token request.
2019-06-13 15:30:50.148 +08:00 [DBG] Start client validation
2019-06-13 15:30:50.148 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-13 15:30:50.148 +08:00 [DBG] Start parsing for secret in post body
2019-06-13 15:30:50.149 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-13 15:30:50.149 +08:00 [DBG] Secret id found: client
2019-06-13 15:30:51.324 +08:00 [DBG] client found in database: true
2019-06-13 15:30:51.324 +08:00 [DBG] client configuration validation for client client succeeded.
2019-06-13 15:30:51.324 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-13 15:30:51.324 +08:00 [DBG] Client validation success
2019-06-13 15:30:51.324 +08:00 [INF] {"ClientId":"client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNFQ2NJBLGS:00000007","TimeStamp":"2019-06-13T07:30:51.0000000Z","ProcessId":16588,"LocalIpAddress":"127.0.0.1:34795","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-13 15:30:51.324 +08:00 [DBG] Start token request validation
2019-06-13 15:30:51.325 +08:00 [DBG] Start client credentials token request validation
2019-06-13 15:30:51.438 +08:00 [DBG] Found [] identity scopes in database
2019-06-13 15:30:52.009 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:30:52.132 +08:00 [DBG] Found [] identity scopes in database
2019-06-13 15:30:52.718 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:30:52.718 +08:00 [DBG] client credentials token request validation success
2019-06-13 15:30:52.718 +08:00 [INF] Token request validation success
{"ClientId":"client","ClientName":"Client Credentials Client","GrantType":"client_credentials","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"client_credentials","scope":"api1","client_id":"client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-06-13 15:30:52.719 +08:00 [DBG] Getting claims for access token for client: client
2019-06-13 15:30:52.721 +08:00 [INF] {"ClientId":"client","ClientName":"Client Credentials Client","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"api1","GrantType":"client_credentials","Tokens":[{"TokenType":"access_token","TokenValue":"****8nGA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFQ2NJBLGS:00000007","TimeStamp":"2019-06-13T07:30:52.0000000Z","ProcessId":16588,"LocalIpAddress":"127.0.0.1:34795","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 15:30:52.722 +08:00 [DBG] Token request success.
2019-06-13 15:30:55.140 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 15:30:55.141 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 15:30:55.141 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 15:30:55.141 +08:00 [DBG] Start discovery request
2019-06-13 15:30:55.875 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 15:30:56.050 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 15:30:56.051 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 15:30:56.051 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 15:30:56.051 +08:00 [DBG] Start key discovery request
2019-06-13 15:34:22.419 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 15:34:22.449 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 15:34:22.449 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 15:34:22.449 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 15:34:22.449 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 15:34:22.449 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 15:34:22.872 +08:00 [DBG] Starting grant removal
2019-06-13 15:34:23.228 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 15:34:23.231 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 15:34:23.231 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 15:34:23.231 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 15:34:23.231 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 15:34:23.231 +08:00 [DBG] Error Url: /home/error
2019-06-13 15:34:23.231 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 15:34:36.149 +08:00 [DBG] 2 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:34:37.448 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 15:34:37.457 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 15:34:37.734 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 15:34:37.946 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:34:38.948 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:34:38.948 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:34:39.139 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:34:39.249 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:34:52.532 +08:00 [DBG] CORS request made for path: /grants/Revoke from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-13 15:34:52.746 +08:00 [DBG] removing 1 persisted grants from database for subject af61726e-716b-4170-8c26-6568bf294215, clientId mvcHybrid
2019-06-13 15:34:52.990 +08:00 [INF] {"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ClientId":"mvcHybrid","Category":"Grants","Name":"Grants revoked","EventType":"Information","Id":4002,"Message":null,"ActivityId":"0HLNFQ671FMOB:00000002","TimeStamp":"2019-06-13T07:34:52.0000000Z","ProcessId":20720,"LocalIpAddress":"127.0.0.1:18741","RemoteIpAddress":"::1","$type":"GrantsRevokedEvent"}
2019-06-13 15:34:53.140 +08:00 [DBG] 1 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:34:54.213 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:34:54.214 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:34:54.429 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:34:54.535 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:34:58.289 +08:00 [DBG] 1 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:34:59.440 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:34:59.441 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:34:59.644 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:34:59.756 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:35:20.057 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 15:35:20.091 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 15:35:20.091 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 15:35:20.091 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 15:35:20.091 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 15:35:20.092 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 15:35:20.577 +08:00 [DBG] Starting grant removal
2019-06-13 15:35:20.899 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 15:35:20.902 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 15:35:20.902 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 15:35:20.902 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 15:35:20.902 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 15:35:20.902 +08:00 [DBG] Error Url: /home/error
2019-06-13 15:35:20.903 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 15:35:23.567 +08:00 [DBG] 1 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:35:24.924 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:35:24.932 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:35:25.167 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:35:25.397 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:37:30.835 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 15:37:30.864 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 15:37:30.864 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 15:37:30.864 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 15:37:30.864 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 15:37:30.865 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 15:37:31.283 +08:00 [DBG] Starting grant removal
2019-06-13 15:37:31.531 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 15:37:31.534 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 15:37:31.534 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 15:37:31.534 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 15:37:31.534 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 15:37:31.535 +08:00 [DBG] Error Url: /home/error
2019-06-13 15:37:31.535 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 15:37:37.194 +08:00 [DBG] 1 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:37:38.480 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:37:38.486 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:37:38.716 +08:00 [DBG] Found ["profile","openid"] identity scopes in database
2019-06-13 15:37:38.901 +08:00 [DBG] Found [] API scopes in database
2019-06-13 15:40:00.850 +08:00 [ERR] Failed executing DbCommand (484ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE `ApiResources` (
    `Id` int NOT NULL AUTO_INCREMENT,
    `Enabled` bit NOT NULL,
    `Name` varchar(200) NOT NULL,
    `DisplayName` varchar(200) NULL,
    `Description` varchar(1000) NULL,
    `Created` datetime(6) NOT NULL,
    `Updated` datetime(6) NULL,
    `LastAccessed` datetime(6) NULL,
    `NonEditable` bit NOT NULL,
    CONSTRAINT `PK_ApiResources` PRIMARY KEY (`Id`)
);
MySql.Data.MySqlClient.MySqlException (0x80004005): Unknown database 'IndentityCenter' ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Unknown database 'IndentityCenter'
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
2019-06-13 15:40:01.030 +08:00 [FTL] Application startup exception
MySql.Data.MySqlClient.MySqlException (0x80004005): Unknown database 'IndentityCenter' ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Unknown database 'IndentityCenter'
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 80
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 302
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 287
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQueryAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 261
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery() in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlCommand.cs:line 62
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IEnumerable`1 migrationCommands, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at IdentityCenter.Startup.InitializeDatabase(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 130
   at IdentityCenter.Startup.Configure(IApplicationBuilder app) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Startup.cs:line 104
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter.<>c__DisplayClass4_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2019-06-13 15:40:01.052 +08:00 [DBG] Starting grant removal
2019-06-13 15:40:52.461 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 15:40:52.495 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 15:40:52.495 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 15:40:52.495 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 15:40:52.495 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 15:40:52.495 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 15:40:52.953 +08:00 [DBG] Starting grant removal
2019-06-13 15:40:53.128 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 15:40:53.131 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 15:40:53.131 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 15:40:53.131 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 15:40:53.131 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 15:40:53.132 +08:00 [DBG] Error Url: /home/error
2019-06-13 15:40:53.134 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 15:41:35.716 +08:00 [DBG] 0 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:41:55.700 +08:00 [DBG] 0 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:46:23.752 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 15:46:23.756 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 15:46:23.756 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 15:46:23.760 +08:00 [DBG] Start discovery request
2019-06-13 15:46:24.895 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 15:46:25.142 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 15:46:25.143 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 15:46:25.143 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 15:46:25.150 +08:00 [DBG] Start key discovery request
2019-06-13 15:46:25.230 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 15:46:25.233 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 15:46:25.233 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 15:46:25.237 +08:00 [DBG] Start authorize request
2019-06-13 15:46:25.248 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:46:25.253 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:46:26.609 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:46:26.618 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:46:26.870 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:46:27.519 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:46:27.734 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:46:28.361 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:46:28.372 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:46:28.387 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile api1","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpKwH0as6PtoheBb4qYzz9Q_9lXxuE_UtxP8vNnSo_xpWw7iIjEtF3kKHVU2DQsDD4KnmcQytJW-kse9CKUDbaqJO_uky7W2-NiU7Szg0RUIZjTkiTfpRtwgRImGthFDVLT8X-_bQlCanJbh1v76LLLSu8ygodUQuv7hc7WXfoK9_1f6YdA9fTjYwsY0k_QWrA_cBRH8AssQU21476-OpkZ4JJFv-Dh__1Cp5dGVVKE7YdGo_jwvEJ1oA2CBgcEP5tOJU7GZLfbobZWAhodyH-Oxsxd3ucCgZ6crfnC-s2k-NNE9H2aq2-K_q94uX6Ovfg","UiLocales":null,"Nonce":"636960087851918890.YzdjZTk1MWQtOTQyMS00Njg1LThmNDUtNmNkOWYwZjQ1OGVlZjAwMmI3NTItNjM0OS00OGNkLTlkYTItZTNmZTRkMjU2ZWRl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile api1","response_mode":"form_post","nonce":"636960087851918890.YzdjZTk1MWQtOTQyMS00Njg1LThmNDUtNmNkOWYwZjQ1OGVlZjAwMmI3NTItNjM0OS00OGNkLTlkYTItZTNmZTRkMjU2ZWRl","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpKwH0as6PtoheBb4qYzz9Q_9lXxuE_UtxP8vNnSo_xpWw7iIjEtF3kKHVU2DQsDD4KnmcQytJW-kse9CKUDbaqJO_uky7W2-NiU7Szg0RUIZjTkiTfpRtwgRImGthFDVLT8X-_bQlCanJbh1v76LLLSu8ygodUQuv7hc7WXfoK9_1f6YdA9fTjYwsY0k_QWrA_cBRH8AssQU21476-OpkZ4JJFv-Dh__1Cp5dGVVKE7YdGo_jwvEJ1oA2CBgcEP5tOJU7GZLfbobZWAhodyH-Oxsxd3ucCgZ6crfnC-s2k-NNE9H2aq2-K_q94uX6Ovfg","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 15:46:28.609 +08:00 [INF] Showing login: User is not active
2019-06-13 15:46:28.714 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:46:29.987 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:46:29.988 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:46:30.219 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:46:30.905 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:46:31.131 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:46:31.730 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:46:31.731 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:46:32.971 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:46:32.972 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:46:55.862 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-13 15:46:55.934 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:46:57.100 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:46:57.100 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:46:57.318 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:46:58.003 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:46:58.213 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:46:58.818 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:46:58.818 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:46:58.969 +08:00 [INF] {"Username":"1223138295@qq.com","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLNFQ9R7U92P:00000005","TimeStamp":"2019-06-13T07:46:58.0000000Z","ProcessId":15128,"LocalIpAddress":"127.0.0.1:2253","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-06-13 15:46:58.970 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:47:00.097 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:47:00.097 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:47:00.310 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:47:00.876 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:47:01.071 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:47:01.644 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:47:01.644 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:47:02.783 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:47:02.783 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:47:11.254 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-13 15:47:11.280 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:47:12.417 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:47:12.417 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:47:12.639 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:47:13.241 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:47:13.458 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:47:14.052 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:47:14.052 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:47:14.183 +08:00 [INF] {"Username":"1223138295@qq.com","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLNFQ9R7U92P:00000006","TimeStamp":"2019-06-13T07:47:14.0000000Z","ProcessId":15128,"LocalIpAddress":"127.0.0.1:2253","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-06-13 15:47:14.183 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:47:15.446 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:47:15.446 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:47:15.680 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:47:16.300 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:47:16.561 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:47:17.238 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:47:17.238 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:47:18.471 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:47:18.472 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:47:31.190 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-13 15:47:31.215 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:47:32.378 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:47:32.378 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:47:32.583 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:47:33.139 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:47:33.332 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:47:33.981 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:47:33.982 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:47:34.113 +08:00 [INF] {"Username":"1223138295@qq.com","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLNFQ9R7U92P:00000007","TimeStamp":"2019-06-13T07:47:34.0000000Z","ProcessId":15128,"LocalIpAddress":"127.0.0.1:2253","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-06-13 15:47:34.113 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:47:35.440 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:47:35.440 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:47:35.622 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:47:36.172 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:47:36.366 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:47:36.916 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:47:36.916 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:47:38.002 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:47:38.002 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:49:16.603 +08:00 [DBG] CORS request made for path: /Account/Register from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-13 15:49:19.259 +08:00 [DBG] 0 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:49:28.956 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 15:49:28.956 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 15:49:28.956 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 15:49:28.957 +08:00 [DBG] Start authorize request
2019-06-13 15:49:28.957 +08:00 [DBG] User in authorize request: af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:49:28.957 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:49:30.067 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:49:30.067 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:49:30.278 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:49:30.833 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:49:31.042 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:49:31.658 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:49:31.659 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:49:31.659 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af61726e-716b-4170-8c26-6568bf294215","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile api1","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IphhsYYOgJoYH4nhIacVNQDsvBs5sEaEbIjohCwlRXCmYZ1SAUIl7TXIn4okl02ggLlx7d6UJ61uOFSvZQSf4tGbY_GNlFZWkvEAJ6YeNdVnV8paq7CS8_MnwZy2rfIpTDkpMwffFasEFlaPhFW4roiHmPRcPI9YcpdU-aWq7yb4cdYNopZ6WPSZ7TCBlJM0i1jFVelmuHBWRsutI4EQvJBFV8rUfGOywvTgQdE8Vv_HWk9pRJFKbRhrkIrqYK9uCHiHuGhPK29XOmxadwgZhLjjJay6IQMnRTQuHUYNLo1rVqHhVB3xVnzVl81kLpbyBs","UiLocales":null,"Nonce":"636960089689329514.NmQzNTE5ZmItNjY3OS00NTQwLTgyYmItYjhiMmQ1Mzc0MWUyODU1N2M3ODYtZmVmMy00ZGIxLTljYmMtNGIwNWNlMDc0ODFm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a1e32b0d81a0efc321fe7cd0d7743f24","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile api1","response_mode":"form_post","nonce":"636960089689329514.NmQzNTE5ZmItNjY3OS00NTQwLTgyYmItYjhiMmQ1Mzc0MWUyODU1N2M3ODYtZmVmMy00ZGIxLTljYmMtNGIwNWNlMDc0ODFm","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IphhsYYOgJoYH4nhIacVNQDsvBs5sEaEbIjohCwlRXCmYZ1SAUIl7TXIn4okl02ggLlx7d6UJ61uOFSvZQSf4tGbY_GNlFZWkvEAJ6YeNdVnV8paq7CS8_MnwZy2rfIpTDkpMwffFasEFlaPhFW4roiHmPRcPI9YcpdU-aWq7yb4cdYNopZ6WPSZ7TCBlJM0i1jFVelmuHBWRsutI4EQvJBFV8rUfGOywvTgQdE8Vv_HWk9pRJFKbRhrkIrqYK9uCHiHuGhPK29XOmxadwgZhLjjJay6IQMnRTQuHUYNLo1rVqHhVB3xVnzVl81kLpbyBs","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 15:49:31.783 +08:00 [INF] Showing login: User is not active
2019-06-13 15:49:31.943 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:49:32.884 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:49:33.139 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:49:33.139 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:49:33.330 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:49:33.951 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:49:34.163 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:49:34.172 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:49:34.172 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:49:34.380 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:49:34.719 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:49:34.720 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:49:34.930 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:49:35.132 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:49:35.716 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:49:35.717 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:49:35.850 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:49:35.851 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:49:36.839 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:49:36.839 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:49:45.674 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-13 15:49:45.704 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:49:46.845 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:49:46.845 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:49:47.058 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:49:47.644 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:49:47.844 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:49:48.435 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:49:48.435 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:49:48.557 +08:00 [INF] {"Username":"1223138295@qq.com","Endpoint":"UI","Category":"Authentication","Name":"User Login Failure","EventType":"Failure","Id":1001,"Message":"invalid credentials","ActivityId":"0HLNFQ9R7U92R:00000006","TimeStamp":"2019-06-13T07:49:48.0000000Z","ProcessId":15128,"LocalIpAddress":"127.0.0.1:2253","RemoteIpAddress":"::1","$type":"UserLoginFailureEvent"}
2019-06-13 15:49:48.557 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 15:49:49.648 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:49:49.648 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:49:49.851 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:49:50.442 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:49:50.650 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 15:49:51.192 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 15:49:51.192 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 15:49:52.266 +08:00 [DBG] mvcImp found in database: true
2019-06-13 15:49:52.266 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 15:50:27.689 +08:00 [DBG] CORS request made for path: /Account/Register from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-13 15:50:49.989 +08:00 [DBG] 0 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:50:51.178 +08:00 [DBG] 0 persisted grants found for af61726e-716b-4170-8c26-6568bf294215
2019-06-13 15:50:57.028 +08:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-13 15:50:57.078 +08:00 [INF] AuthenticationScheme: Identity.External signed out.
2019-06-13 15:51:00.176 +08:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No sign-out authentication handler is registered for the scheme 'idsrv.session'. The registered sign-out schemes are: Identity.Application, Identity.External, Identity.TwoFactorRememberMe, Identity.TwoFactorUserId, idsrv, idsrv.external. Did you forget to call AddAuthentication().AddCookies("idsrv.session",...)?
   at Microsoft.AspNetCore.Authentication.AuthenticationService.SignOutAsync(HttpContext context, String scheme, AuthenticationProperties properties)
   at IdentityServer4.Hosting.IdentityServerAuthenticationService.SignOutAsync(HttpContext context, String scheme, AuthenticationProperties properties) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerAuthenticationService.cs:line 107
   at IdentityServer4.Quickstart.UI.AccountController.Logout(LogoutInputModel model) in G:\项目\AuthticationAndAuthtization\IndentityServerCenter\IdentityCenter\Quickstart\Account\AccountController.cs:line 274
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2019-06-13 15:51:42.021 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 15:51:42.053 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 15:51:42.054 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 15:51:42.054 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 15:51:42.054 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 15:51:42.055 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 15:51:42.534 +08:00 [DBG] Starting grant removal
2019-06-13 15:51:42.843 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 15:51:42.846 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 15:51:42.846 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 15:51:42.846 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 15:51:42.846 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 15:51:42.847 +08:00 [DBG] Error Url: /home/error
2019-06-13 15:51:42.847 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 15:52:13.061 +08:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-06-13 15:52:56.199 +08:00 [DBG] CORS request made for path: /Account/Register from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-13 15:53:23.803 +08:00 [DBG] CORS request made for path: /Account/Register from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-13 15:55:46.250 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 15:55:46.279 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 15:55:46.280 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 15:55:46.280 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 15:55:46.280 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 15:55:46.280 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 15:55:46.699 +08:00 [DBG] Starting grant removal
2019-06-13 15:55:46.977 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 15:55:46.982 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 15:55:46.983 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 15:55:46.983 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 15:55:46.983 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 15:55:46.983 +08:00 [DBG] Error Url: /home/error
2019-06-13 15:55:46.983 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 15:56:53.321 +08:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-06-13 15:57:48.567 +08:00 [DBG] CORS request made for path: /Account/Register from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-13 15:59:42.796 +08:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2019-06-13 15:59:48.628 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-13 15:59:48.822 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"1223138295@qq.com","DisplayName":"晓锋","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNFQI5KASSN:00000009","TimeStamp":"2019-06-13T07:59:48.0000000Z","ProcessId":5756,"LocalIpAddress":"127.0.0.1:43153","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-13 15:59:49.168 +08:00 [DBG] Augmenting SignInContext
2019-06-13 15:59:49.170 +08:00 [DBG] Adding idp claim with value: local
2019-06-13 15:59:49.170 +08:00 [DBG] Adding amr claim with value: pwd
2019-06-13 15:59:49.170 +08:00 [DBG] Adding auth_time claim with value: 1560412789
2019-06-13 15:59:49.183 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-13 15:59:49.355 +08:00 [DBG] 0 persisted grants found for af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 16:00:26.611 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 16:00:26.641 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 16:00:26.641 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 16:00:26.641 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 16:00:26.641 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 16:00:26.642 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 16:00:27.062 +08:00 [DBG] Starting grant removal
2019-06-13 16:00:27.348 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 16:00:27.354 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 16:00:27.354 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 16:00:27.354 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 16:00:27.354 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 16:00:27.354 +08:00 [DBG] Error Url: /home/error
2019-06-13 16:00:27.354 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 16:00:31.115 +08:00 [DBG] 0 persisted grants found for af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 16:01:08.452 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 16:01:08.456 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 16:01:08.456 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 16:01:08.459 +08:00 [DBG] Start discovery request
2019-06-13 16:01:09.872 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 16:01:10.082 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 16:01:10.083 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 16:01:10.083 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 16:01:10.089 +08:00 [DBG] Start key discovery request
2019-06-13 16:01:10.199 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 16:01:10.202 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 16:01:10.202 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 16:01:10.207 +08:00 [DBG] Start authorize request
2019-06-13 16:01:10.216 +08:00 [DBG] User in authorize request: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 16:01:10.221 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 16:01:11.687 +08:00 [DBG] mvcImp found in database: true
2019-06-13 16:01:11.693 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 16:01:11.982 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 16:01:12.580 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:01:12.795 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 16:01:13.375 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:01:13.384 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 16:01:13.397 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile api1","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iqb_-xVIbJk8cvq4MwxwO0U_qfZGspzIoJZf-etIhfdXV6knjXq1Riz3hHuD8FQFgWGgjFwYD4zkLnOUr0qDRLqmIKnxiYuVtCKsAsxeHXi7bqEuWc7WLp4wwdJEbehIR00MXvsIzLUwip4dGVWZ9kd8aD4-s4KxS7d9aMmy8k7k_IhOmd6pKV6_xyG6xMdn9-xOmG8iL5_KAxwJ-DXWkdLqMYxWBTl4c4ZnFZDGLFVsESCTdRyp4QA3tPwlK69bp-5mezGwSNkJzWXQLFJu98Y3EGI5tdyC4eEzPNSxFUMRIr3x8mTcXSclcRDzvF2TV0","UiLocales":null,"Nonce":"636960096701496657.YzE2OGQ1YTUtZmYyZS00MGMyLWE3OWMtNjNlMWQ4MWJiMDA5MDJiNGQzNzYtODAyYy00OGZiLTkzZjctMmViZDc3OTU1ODAz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"5b9946b1cd6fbef9617bcd048c5f8eda","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile api1","response_mode":"form_post","nonce":"636960096701496657.YzE2OGQ1YTUtZmYyZS00MGMyLWE3OWMtNjNlMWQ4MWJiMDA5MDJiNGQzNzYtODAyYy00OGZiLTkzZjctMmViZDc3OTU1ODAz","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iqb_-xVIbJk8cvq4MwxwO0U_qfZGspzIoJZf-etIhfdXV6knjXq1Riz3hHuD8FQFgWGgjFwYD4zkLnOUr0qDRLqmIKnxiYuVtCKsAsxeHXi7bqEuWc7WLp4wwdJEbehIR00MXvsIzLUwip4dGVWZ9kd8aD4-s4KxS7d9aMmy8k7k_IhOmd6pKV6_xyG6xMdn9-xOmG8iL5_KAxwJ-DXWkdLqMYxWBTl4c4ZnFZDGLFVsESCTdRyp4QA3tPwlK69bp-5mezGwSNkJzWXQLFJu98Y3EGI5tdyC4eEzPNSxFUMRIr3x8mTcXSclcRDzvF2TV0","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 16:01:13.791 +08:00 [DBG] 2DblLcoWEpsfI5cQMBWCdPB6FbTucq7UTTfTiMK6w9I= found in database: false
2019-06-13 16:01:13.792 +08:00 [DBG] user_consent grant with value: mvcImp|af67182f-859b-42aa-a1aa-ee2f0321b4af not found in store.
2019-06-13 16:01:13.792 +08:00 [DBG] Found no prior consent from consent store, consent is required
2019-06-13 16:01:13.792 +08:00 [INF] Showing consent: User has not yet consented
2019-06-13 16:01:13.939 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 16:01:15.089 +08:00 [DBG] mvcImp found in database: true
2019-06-13 16:01:15.089 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 16:01:15.283 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 16:01:15.844 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:01:16.062 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 16:01:16.647 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:01:16.647 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 16:01:17.882 +08:00 [DBG] mvcImp found in database: true
2019-06-13 16:01:17.882 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 16:01:18.092 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 16:01:18.672 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:01:32.516 +08:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-13 16:01:32.601 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 16:01:33.797 +08:00 [DBG] mvcImp found in database: true
2019-06-13 16:01:33.797 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 16:01:33.991 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 16:01:34.574 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:01:34.814 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 16:01:35.414 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:01:35.414 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 16:01:35.422 +08:00 [INF] {"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ClientId":"mvcImp","RequestedScopes":["openid","profile","api1"],"GrantedScopes":["openid","profile","api1"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLNFQKP65Q4B:00000005","TimeStamp":"2019-06-13T08:01:35.0000000Z","ProcessId":35164,"LocalIpAddress":"127.0.0.1:15169","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-06-13 16:01:36.606 +08:00 [DBG] mvcImp found in database: true
2019-06-13 16:01:36.606 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 16:01:36.634 +08:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-13 16:01:36.636 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-13 16:01:36.636 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-13 16:01:36.642 +08:00 [DBG] Start authorize callback request
2019-06-13 16:01:36.647 +08:00 [DBG] User in authorize request: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 16:01:36.647 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 16:01:37.757 +08:00 [DBG] mvcImp found in database: true
2019-06-13 16:01:37.757 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 16:01:37.948 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 16:01:38.517 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:01:38.730 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 16:01:39.299 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:01:39.300 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 16:01:39.300 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile api1","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iqb_-xVIbJk8cvq4MwxwO0U_qfZGspzIoJZf-etIhfdXV6knjXq1Riz3hHuD8FQFgWGgjFwYD4zkLnOUr0qDRLqmIKnxiYuVtCKsAsxeHXi7bqEuWc7WLp4wwdJEbehIR00MXvsIzLUwip4dGVWZ9kd8aD4-s4KxS7d9aMmy8k7k_IhOmd6pKV6_xyG6xMdn9-xOmG8iL5_KAxwJ-DXWkdLqMYxWBTl4c4ZnFZDGLFVsESCTdRyp4QA3tPwlK69bp-5mezGwSNkJzWXQLFJu98Y3EGI5tdyC4eEzPNSxFUMRIr3x8mTcXSclcRDzvF2TV0","UiLocales":null,"Nonce":"636960096701496657.YzE2OGQ1YTUtZmYyZS00MGMyLWE3OWMtNjNlMWQ4MWJiMDA5MDJiNGQzNzYtODAyYy00OGZiLTkzZjctMmViZDc3OTU1ODAz","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"5b9946b1cd6fbef9617bcd048c5f8eda","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile api1","response_mode":"form_post","nonce":"636960096701496657.YzE2OGQ1YTUtZmYyZS00MGMyLWE3OWMtNjNlMWQ4MWJiMDA5MDJiNGQzNzYtODAyYy00OGZiLTkzZjctMmViZDc3OTU1ODAz","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iqb_-xVIbJk8cvq4MwxwO0U_qfZGspzIoJZf-etIhfdXV6knjXq1Riz3hHuD8FQFgWGgjFwYD4zkLnOUr0qDRLqmIKnxiYuVtCKsAsxeHXi7bqEuWc7WLp4wwdJEbehIR00MXvsIzLUwip4dGVWZ9kd8aD4-s4KxS7d9aMmy8k7k_IhOmd6pKV6_xyG6xMdn9-xOmG8iL5_KAxwJ-DXWkdLqMYxWBTl4c4ZnFZDGLFVsESCTdRyp4QA3tPwlK69bp-5mezGwSNkJzWXQLFJu98Y3EGI5tdyC4eEzPNSxFUMRIr3x8mTcXSclcRDzvF2TV0","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 16:01:39.545 +08:00 [DBG] 2DblLcoWEpsfI5cQMBWCdPB6FbTucq7UTTfTiMK6w9I= found in database: false
2019-06-13 16:01:39.545 +08:00 [DBG] user_consent grant with value: mvcImp|af67182f-859b-42aa-a1aa-ee2f0321b4af not found in store.
2019-06-13 16:01:39.545 +08:00 [DBG] Found no prior consent from consent store, consent is required
2019-06-13 16:01:39.551 +08:00 [INF] User consented to scopes: ["openid","profile","api1"]
2019-06-13 16:01:39.552 +08:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1"]
2019-06-13 16:01:39.556 +08:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 16:01:39.689 +08:00 [DBG] 2DblLcoWEpsfI5cQMBWCdPB6FbTucq7UTTfTiMK6w9I= not found in database
2019-06-13 16:01:39.999 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 16:01:40.010 +08:00 [DBG] Getting claims for access token for client: mvcImp
2019-06-13 16:01:40.011 +08:00 [DBG] Getting claims for access token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 16:01:40.018 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 16:01:40.128 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcImp
2019-06-13 16:01:40.128 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 16:01:40.138 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","Scopes":"openid profile api1","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****LKUA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****u-Lg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFQKP65Q4C:00000005","TimeStamp":"2019-06-13T08:01:40.0000000Z","ProcessId":35164,"LocalIpAddress":"127.0.0.1:15169","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 16:01:40.140 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Iqb_-xVIbJk8cvq4MwxwO0U_qfZGspzIoJZf-etIhfdXV6knjXq1Riz3hHuD8FQFgWGgjFwYD4zkLnOUr0qDRLqmIKnxiYuVtCKsAsxeHXi7bqEuWc7WLp4wwdJEbehIR00MXvsIzLUwip4dGVWZ9kd8aD4-s4KxS7d9aMmy8k7k_IhOmd6pKV6_xyG6xMdn9-xOmG8iL5_KAxwJ-DXWkdLqMYxWBTl4c4ZnFZDGLFVsESCTdRyp4QA3tPwlK69bp-5mezGwSNkJzWXQLFJu98Y3EGI5tdyC4eEzPNSxFUMRIr3x8mTcXSclcRDzvF2TV0","Scope":"openid profile api1","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 16:01:40.164 +08:00 [DBG] Augmenting SignInContext
2019-06-13 16:01:40.176 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-13 16:01:40.434 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 16:01:40.438 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 16:01:40.438 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 16:01:40.446 +08:00 [DBG] Start userinfo request
2019-06-13 16:01:40.450 +08:00 [DBG] Bearer token found in header
2019-06-13 16:01:41.613 +08:00 [DBG] mvcImp found in database: true
2019-06-13 16:01:41.613 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 16:01:42.743 +08:00 [DBG] mvcImp found in database: true
2019-06-13 16:01:42.743 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 16:01:42.877 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 16:01:42.879 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560412900,"exp":1560416500,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcImp","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560412789,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","api1"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 16:01:42.888 +08:00 [DBG] Creating userinfo response
2019-06-13 16:01:42.891 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 16:01:42.893 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 16:01:43.102 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 16:01:43.102 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile
2019-06-13 16:01:43.102 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 16:01:43.311 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 16:01:43.312 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 16:01:43.312 +08:00 [DBG] End userinfo request
2019-06-13 16:01:43.703 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 16:01:43.704 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 16:01:43.704 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 16:01:43.704 +08:00 [DBG] Start discovery request
2019-06-13 16:01:44.455 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 16:01:44.581 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 16:01:44.581 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 16:01:44.582 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 16:01:44.582 +08:00 [DBG] Start key discovery request
2019-06-13 16:03:38.903 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 16:03:38.934 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 16:03:38.935 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 16:03:38.935 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 16:03:38.935 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 16:03:38.935 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 16:03:39.363 +08:00 [DBG] Starting grant removal
2019-06-13 16:03:39.660 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 16:03:39.664 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 16:03:39.665 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 16:03:39.665 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 16:03:39.665 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 16:03:39.665 +08:00 [DBG] Error Url: /home/error
2019-06-13 16:03:39.665 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 16:25:59.900 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 16:25:59.904 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 16:25:59.904 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 16:25:59.908 +08:00 [DBG] Start discovery request
2019-06-13 16:26:01.467 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 16:26:01.686 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 16:26:01.687 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 16:26:01.687 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 16:26:01.695 +08:00 [DBG] Start key discovery request
2019-06-13 16:26:01.810 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 16:26:01.813 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 16:26:01.813 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 16:26:01.817 +08:00 [DBG] Start authorize request
2019-06-13 16:26:01.830 +08:00 [DBG] User in authorize request: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 16:26:01.835 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 16:26:03.261 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:26:03.271 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:26:03.277 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 16:26:03.278 +08:00 [DBG] No PKCE used.
2019-06-13 16:26:03.506 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:26:04.054 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:26:04.240 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:26:04.739 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:26:04.749 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 16:26:04.765 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 email","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ipw3HuAUQUXUB66LXqW2nhFhIDpTfN82XwnhovD8K9uFiyGuhxz01sM95Lxu5y0fBb7DJby7SHeBh4eR9rFHlMaM5152m8hWFCht62ZU8pbuCcegA5miqRSfUiqzh2annyfJvE9P3NEi8Zco2pnobbaQjvtxQf8aopjO6BRgRCsUpL_Ld1SMb200rlu1k_Rr9ykl7v9vYrFrJcOpQfvMLIWpI96fM2Yoo9tQuy_5wVqXZ_PN6seKOJ6sNysMxUWBbnNy-4QAIqrdKxhPARErInJvu-DuCPSjxpW-YeU5zEZOoQeYOg6dsXrsdAHoFaXazI","UiLocales":null,"Nonce":"636960111617657181.MmZmM2MyZDctM2ViZS00MGEzLTgyZmQtZjQzODJhMjk2MGMzNGY5ZmI5YjAtZDMwOC00YThiLWFjMWUtZmY2YjcyZmNkZmRl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"5b9946b1cd6fbef9617bcd048c5f8eda","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile api1 email","response_mode":"form_post","nonce":"636960111617657181.MmZmM2MyZDctM2ViZS00MGEzLTgyZmQtZjQzODJhMjk2MGMzNGY5ZmI5YjAtZDMwOC00YThiLWFjMWUtZmY2YjcyZmNkZmRl","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ipw3HuAUQUXUB66LXqW2nhFhIDpTfN82XwnhovD8K9uFiyGuhxz01sM95Lxu5y0fBb7DJby7SHeBh4eR9rFHlMaM5152m8hWFCht62ZU8pbuCcegA5miqRSfUiqzh2annyfJvE9P3NEi8Zco2pnobbaQjvtxQf8aopjO6BRgRCsUpL_Ld1SMb200rlu1k_Rr9ykl7v9vYrFrJcOpQfvMLIWpI96fM2Yoo9tQuy_5wVqXZ_PN6seKOJ6sNysMxUWBbnNy-4QAIqrdKxhPARErInJvu-DuCPSjxpW-YeU5zEZOoQeYOg6dsXrsdAHoFaXazI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 16:26:05.140 +08:00 [DBG] 4ODIvwkbcMVGMwptW6wXCBMORKxKV2CaEIiv0vjd/uE= found in database: false
2019-06-13 16:26:05.141 +08:00 [DBG] user_consent grant with value: mvcHybrid|af67182f-859b-42aa-a1aa-ee2f0321b4af not found in store.
2019-06-13 16:26:05.141 +08:00 [DBG] Found no prior consent from consent store, consent is required
2019-06-13 16:26:05.141 +08:00 [INF] Showing consent: User has not yet consented
2019-06-13 16:26:05.290 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 16:26:06.278 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:26:06.278 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:26:06.278 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 16:26:06.278 +08:00 [DBG] No PKCE used.
2019-06-13 16:26:06.451 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:26:06.938 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:26:07.118 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:26:07.607 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:26:07.607 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 16:26:08.585 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:26:08.586 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:26:08.812 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:26:09.324 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:26:14.778 +08:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-13 16:26:14.872 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 16:26:15.951 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:26:15.951 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:26:15.951 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 16:26:15.951 +08:00 [DBG] No PKCE used.
2019-06-13 16:26:16.127 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:26:16.644 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:26:16.864 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:26:17.424 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:26:17.424 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 16:26:17.433 +08:00 [INF] {"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ClientId":"mvcHybrid","RequestedScopes":["openid","profile","api1","email"],"GrantedScopes":["openid","profile","email","api1"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLNFQMIG2OBE:00000005","TimeStamp":"2019-06-13T08:26:17.0000000Z","ProcessId":5876,"LocalIpAddress":"127.0.0.1:20574","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-06-13 16:26:18.509 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:26:18.510 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:26:18.531 +08:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-13 16:26:18.532 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-13 16:26:18.532 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-13 16:26:18.540 +08:00 [DBG] Start authorize callback request
2019-06-13 16:26:18.548 +08:00 [DBG] User in authorize request: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 16:26:18.548 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 16:26:19.642 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:26:19.642 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:26:19.642 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 16:26:19.642 +08:00 [DBG] No PKCE used.
2019-06-13 16:26:19.848 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:26:20.364 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:26:20.552 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:26:21.100 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:26:21.100 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 16:26:21.101 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 email","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ipw3HuAUQUXUB66LXqW2nhFhIDpTfN82XwnhovD8K9uFiyGuhxz01sM95Lxu5y0fBb7DJby7SHeBh4eR9rFHlMaM5152m8hWFCht62ZU8pbuCcegA5miqRSfUiqzh2annyfJvE9P3NEi8Zco2pnobbaQjvtxQf8aopjO6BRgRCsUpL_Ld1SMb200rlu1k_Rr9ykl7v9vYrFrJcOpQfvMLIWpI96fM2Yoo9tQuy_5wVqXZ_PN6seKOJ6sNysMxUWBbnNy-4QAIqrdKxhPARErInJvu-DuCPSjxpW-YeU5zEZOoQeYOg6dsXrsdAHoFaXazI","UiLocales":null,"Nonce":"636960111617657181.MmZmM2MyZDctM2ViZS00MGEzLTgyZmQtZjQzODJhMjk2MGMzNGY5ZmI5YjAtZDMwOC00YThiLWFjMWUtZmY2YjcyZmNkZmRl","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"5b9946b1cd6fbef9617bcd048c5f8eda","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile api1 email","response_mode":"form_post","nonce":"636960111617657181.MmZmM2MyZDctM2ViZS00MGEzLTgyZmQtZjQzODJhMjk2MGMzNGY5ZmI5YjAtZDMwOC00YThiLWFjMWUtZmY2YjcyZmNkZmRl","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ipw3HuAUQUXUB66LXqW2nhFhIDpTfN82XwnhovD8K9uFiyGuhxz01sM95Lxu5y0fBb7DJby7SHeBh4eR9rFHlMaM5152m8hWFCht62ZU8pbuCcegA5miqRSfUiqzh2annyfJvE9P3NEi8Zco2pnobbaQjvtxQf8aopjO6BRgRCsUpL_Ld1SMb200rlu1k_Rr9ykl7v9vYrFrJcOpQfvMLIWpI96fM2Yoo9tQuy_5wVqXZ_PN6seKOJ6sNysMxUWBbnNy-4QAIqrdKxhPARErInJvu-DuCPSjxpW-YeU5zEZOoQeYOg6dsXrsdAHoFaXazI","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 16:26:21.315 +08:00 [DBG] 4ODIvwkbcMVGMwptW6wXCBMORKxKV2CaEIiv0vjd/uE= found in database: false
2019-06-13 16:26:21.315 +08:00 [DBG] user_consent grant with value: mvcHybrid|af67182f-859b-42aa-a1aa-ee2f0321b4af not found in store.
2019-06-13 16:26:21.315 +08:00 [DBG] Found no prior consent from consent store, consent is required
2019-06-13 16:26:21.321 +08:00 [INF] User consented to scopes: ["openid","profile","email","api1"]
2019-06-13 16:26:21.322 +08:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1"]
2019-06-13 16:26:21.326 +08:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 16:26:21.447 +08:00 [DBG] 4ODIvwkbcMVGMwptW6wXCBMORKxKV2CaEIiv0vjd/uE= not found in database
2019-06-13 16:26:21.747 +08:00 [DBG] Creating Hybrid Flow response.
2019-06-13 16:26:21.890 +08:00 [DBG] 0stBM3clQ6Cdr0GKF++2gY5ketJP8awq7MSzlQkqiBU= not found in database
2019-06-13 16:26:22.126 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 16:26:22.135 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcHybrid
2019-06-13 16:26:22.138 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 16:26:22.235 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","Scopes":"openid profile email api1","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****OSKA","$type":"Token"},{"TokenType":"code","TokenValue":"****1256","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFQMIG2OBE:00000006","TimeStamp":"2019-06-13T08:26:22.0000000Z","ProcessId":5876,"LocalIpAddress":"127.0.0.1:20574","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 16:26:22.236 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ClientId":"mvcHybrid","RedirectUri":"http://localhost:5005/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ipw3HuAUQUXUB66LXqW2nhFhIDpTfN82XwnhovD8K9uFiyGuhxz01sM95Lxu5y0fBb7DJby7SHeBh4eR9rFHlMaM5152m8hWFCht62ZU8pbuCcegA5miqRSfUiqzh2annyfJvE9P3NEi8Zco2pnobbaQjvtxQf8aopjO6BRgRCsUpL_Ld1SMb200rlu1k_Rr9ykl7v9vYrFrJcOpQfvMLIWpI96fM2Yoo9tQuy_5wVqXZ_PN6seKOJ6sNysMxUWBbnNy-4QAIqrdKxhPARErInJvu-DuCPSjxpW-YeU5zEZOoQeYOg6dsXrsdAHoFaXazI","Scope":"openid profile email api1","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 16:26:22.269 +08:00 [DBG] Augmenting SignInContext
2019-06-13 16:26:22.285 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-13 16:26:22.526 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-13 16:26:22.533 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-13 16:26:22.533 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-13 16:26:22.543 +08:00 [DBG] Start token request.
2019-06-13 16:26:22.549 +08:00 [DBG] Start client validation
2019-06-13 16:26:22.555 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-13 16:26:22.559 +08:00 [DBG] Start parsing for secret in post body
2019-06-13 16:26:22.560 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-13 16:26:22.560 +08:00 [DBG] Secret id found: mvcHybrid
2019-06-13 16:26:23.561 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:26:23.561 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:26:23.570 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-13 16:26:23.570 +08:00 [DBG] Client validation success
2019-06-13 16:26:23.570 +08:00 [INF] {"ClientId":"mvcHybrid","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNFQMIG2OBE:00000007","TimeStamp":"2019-06-13T08:26:23.0000000Z","ProcessId":5876,"LocalIpAddress":"127.0.0.1:20574","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-13 16:26:23.575 +08:00 [DBG] Start token request validation
2019-06-13 16:26:23.585 +08:00 [DBG] Start validation of authorization code token request
2019-06-13 16:26:23.934 +08:00 [DBG] 0stBM3clQ6Cdr0GKF++2gY5ketJP8awq7MSzlQkqiBU= found in database: true
2019-06-13 16:26:24.071 +08:00 [DBG] removing 0stBM3clQ6Cdr0GKF++2gY5ketJP8awq7MSzlQkqiBU= persisted grant from database
2019-06-13 16:26:24.424 +08:00 [DBG] Validation of authorization code token request success
2019-06-13 16:26:24.427 +08:00 [INF] Token request validation success
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"3d98d6c790f51d631e0b167d11c32b7ce94f6ef6fa87d71b189c5b57f4361256","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvcHybrid","client_secret":"***REDACTED***","code":"3d98d6c790f51d631e0b167d11c32b7ce94f6ef6fa87d71b189c5b57f4361256","grant_type":"authorization_code","redirect_uri":"http://localhost:5005/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-06-13 16:26:25.436 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:26:25.436 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:26:25.620 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:26:26.158 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:26:26.168 +08:00 [DBG] Getting claims for access token for client: mvcHybrid
2019-06-13 16:26:26.169 +08:00 [DBG] Getting claims for access token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 16:26:26.174 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 16:26:27.171 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:26:27.171 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:26:27.342 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:26:27.856 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:26:27.857 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcHybrid
2019-06-13 16:26:27.857 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 16:26:27.861 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile email api1","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****fXxA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****xGpQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFQMIG2OBE:00000007","TimeStamp":"2019-06-13T08:26:27.0000000Z","ProcessId":5876,"LocalIpAddress":"127.0.0.1:20574","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 16:26:27.863 +08:00 [DBG] Token request success.
2019-06-13 16:26:27.918 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 16:26:27.920 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 16:26:27.920 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 16:26:27.930 +08:00 [DBG] Start userinfo request
2019-06-13 16:26:27.934 +08:00 [DBG] Bearer token found in header
2019-06-13 16:26:29.007 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:26:29.007 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:26:30.021 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:26:30.021 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:26:30.137 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 16:26:30.139 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560414386,"exp":1560414446,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcHybrid","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560412789,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email","api1"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 16:26:30.148 +08:00 [DBG] Creating userinfo response
2019-06-13 16:26:30.152 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 16:26:30.154 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 16:26:30.340 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:26:30.341 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-13 16:26:30.341 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 16:26:30.545 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:26:30.546 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 16:26:30.546 +08:00 [DBG] End userinfo request
2019-06-13 16:48:09.626 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 16:48:09.656 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 16:48:09.656 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 16:48:09.656 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 16:48:09.656 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 16:48:09.656 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 16:48:09.751 +08:00 [DBG] Starting grant removal
2019-06-13 16:48:09.933 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 16:48:09.935 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 16:48:09.935 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 16:48:09.935 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 16:48:09.935 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 16:48:09.935 +08:00 [DBG] Error Url: /home/error
2019-06-13 16:48:09.935 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 16:48:09.960 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 16:48:09.967 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 16:48:09.967 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 16:48:09.970 +08:00 [DBG] Start discovery request
2019-06-13 16:48:11.329 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 16:48:11.559 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 16:48:11.560 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 16:48:11.560 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 16:48:11.563 +08:00 [DBG] Start key discovery request
2019-06-13 16:48:12.293 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 16:48:12.297 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 16:48:12.297 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 16:48:12.300 +08:00 [DBG] Start authorize request
2019-06-13 16:48:12.312 +08:00 [DBG] User in authorize request: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 16:48:12.316 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 16:48:13.717 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:48:13.725 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:48:13.732 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 16:48:13.733 +08:00 [DBG] No PKCE used.
2019-06-13 16:48:13.973 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:48:14.589 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:48:14.807 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:48:15.370 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:48:15.379 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 16:48:15.392 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 email","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqGYXcHDJuMDd7yhFxRoBRiIIAt_z8C29RfSBhulfHn_fQ7V5yNYx42pMQG5ZzVkfHKRJ6z49Ar1R80FRoDIHIngwAcLWUVC2Z4RqTQMyaa6iJZw3SSpB_yR5_I8oT9XQUGraDIp_LyuuK1Ati2tziSVlOl7c467k59fJxkdXRE2oGEg09OIBlLvY_IZdJC2XZNbGvypr-vtcEwn3FkpKWNqzUh3sx8Dkr260SCQek_MzXbu23XcQ4O4Zo1Amk92zMwlofNC_XKHXB3bnHulLVv5Dk6T3KDl8-a2QweXslTx1qFAwm1A_RhPxt_GpjuMCA","UiLocales":null,"Nonce":"636960124916185260.MDg1MDVhN2UtOGEzNS00YmI5LWJkMmEtNmNhOWU3MDk3MmM0MDgwZjAxMWUtMjc3Mi00NTM5LWI1NjctOTI0NDVkMmRiOWNk","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"5b9946b1cd6fbef9617bcd048c5f8eda","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile api1 email","response_mode":"form_post","nonce":"636960124916185260.MDg1MDVhN2UtOGEzNS00YmI5LWJkMmEtNmNhOWU3MDk3MmM0MDgwZjAxMWUtMjc3Mi00NTM5LWI1NjctOTI0NDVkMmRiOWNk","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqGYXcHDJuMDd7yhFxRoBRiIIAt_z8C29RfSBhulfHn_fQ7V5yNYx42pMQG5ZzVkfHKRJ6z49Ar1R80FRoDIHIngwAcLWUVC2Z4RqTQMyaa6iJZw3SSpB_yR5_I8oT9XQUGraDIp_LyuuK1Ati2tziSVlOl7c467k59fJxkdXRE2oGEg09OIBlLvY_IZdJC2XZNbGvypr-vtcEwn3FkpKWNqzUh3sx8Dkr260SCQek_MzXbu23XcQ4O4Zo1Amk92zMwlofNC_XKHXB3bnHulLVv5Dk6T3KDl8-a2QweXslTx1qFAwm1A_RhPxt_GpjuMCA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 16:48:15.550 +08:00 [DBG] 4ODIvwkbcMVGMwptW6wXCBMORKxKV2CaEIiv0vjd/uE= found in database: true
2019-06-13 16:48:15.556 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 16:48:15.561 +08:00 [DBG] Creating Hybrid Flow response.
2019-06-13 16:48:15.705 +08:00 [DBG] VX6YBzDFHkKS6gj5vv17kRLSno5gbFYffZlpju28gwA= not found in database
2019-06-13 16:48:15.995 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 16:48:16.005 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcHybrid
2019-06-13 16:48:16.007 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 16:48:16.094 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","Scopes":"openid profile email api1","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****ai7w","$type":"Token"},{"TokenType":"code","TokenValue":"****1fd7","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFRFEACCSF:00000003","TimeStamp":"2019-06-13T08:48:16.0000000Z","ProcessId":26764,"LocalIpAddress":"127.0.0.1:22738","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 16:48:16.096 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ClientId":"mvcHybrid","RedirectUri":"http://localhost:5005/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqGYXcHDJuMDd7yhFxRoBRiIIAt_z8C29RfSBhulfHn_fQ7V5yNYx42pMQG5ZzVkfHKRJ6z49Ar1R80FRoDIHIngwAcLWUVC2Z4RqTQMyaa6iJZw3SSpB_yR5_I8oT9XQUGraDIp_LyuuK1Ati2tziSVlOl7c467k59fJxkdXRE2oGEg09OIBlLvY_IZdJC2XZNbGvypr-vtcEwn3FkpKWNqzUh3sx8Dkr260SCQek_MzXbu23XcQ4O4Zo1Amk92zMwlofNC_XKHXB3bnHulLVv5Dk6T3KDl8-a2QweXslTx1qFAwm1A_RhPxt_GpjuMCA","Scope":"openid profile email api1","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 16:48:16.358 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-13 16:48:16.363 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-13 16:48:16.363 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-13 16:48:16.373 +08:00 [DBG] Start token request.
2019-06-13 16:48:16.381 +08:00 [DBG] Start client validation
2019-06-13 16:48:16.386 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-13 16:48:16.391 +08:00 [DBG] Start parsing for secret in post body
2019-06-13 16:48:16.407 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-13 16:48:16.407 +08:00 [DBG] Secret id found: mvcHybrid
2019-06-13 16:48:17.529 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:48:17.529 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:48:17.537 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-13 16:48:17.537 +08:00 [DBG] Client validation success
2019-06-13 16:48:17.538 +08:00 [INF] {"ClientId":"mvcHybrid","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNFRFEACCSF:00000004","TimeStamp":"2019-06-13T08:48:17.0000000Z","ProcessId":26764,"LocalIpAddress":"127.0.0.1:22738","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-13 16:48:17.544 +08:00 [DBG] Start token request validation
2019-06-13 16:48:17.554 +08:00 [DBG] Start validation of authorization code token request
2019-06-13 16:48:17.687 +08:00 [DBG] VX6YBzDFHkKS6gj5vv17kRLSno5gbFYffZlpju28gwA= found in database: true
2019-06-13 16:48:17.830 +08:00 [DBG] removing VX6YBzDFHkKS6gj5vv17kRLSno5gbFYffZlpju28gwA= persisted grant from database
2019-06-13 16:48:18.174 +08:00 [DBG] Validation of authorization code token request success
2019-06-13 16:48:18.178 +08:00 [INF] Token request validation success
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"e400098989829fcd9d5168ac0f1fca10b66a5967f013dadd7fb2a35ac4ec1fd7","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvcHybrid","client_secret":"***REDACTED***","code":"e400098989829fcd9d5168ac0f1fca10b66a5967f013dadd7fb2a35ac4ec1fd7","grant_type":"authorization_code","redirect_uri":"http://localhost:5005/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-06-13 16:48:19.311 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:48:19.311 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:48:19.523 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:48:20.098 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:48:20.108 +08:00 [DBG] Getting claims for access token for client: mvcHybrid
2019-06-13 16:48:20.109 +08:00 [DBG] Getting claims for access token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 16:48:20.114 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 16:48:21.244 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:48:21.244 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:48:21.457 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:48:22.096 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 16:48:22.096 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcHybrid
2019-06-13 16:48:22.096 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 16:48:22.100 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile email api1","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****mJkg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****1_ew","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFRFEACCSF:00000004","TimeStamp":"2019-06-13T08:48:22.0000000Z","ProcessId":26764,"LocalIpAddress":"127.0.0.1:22738","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 16:48:22.104 +08:00 [DBG] Token request success.
2019-06-13 16:48:22.166 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 16:48:22.167 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 16:48:22.167 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 16:48:22.174 +08:00 [DBG] Start userinfo request
2019-06-13 16:48:22.179 +08:00 [DBG] Bearer token found in header
2019-06-13 16:48:23.377 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:48:23.377 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:48:24.444 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 16:48:24.444 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 16:48:24.566 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 16:48:24.567 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560415700,"exp":1560415760,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcHybrid","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560412789,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email","api1"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 16:48:24.576 +08:00 [DBG] Creating userinfo response
2019-06-13 16:48:24.579 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 16:48:24.581 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 16:48:24.783 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:48:24.783 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-13 16:48:24.784 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 16:48:24.985 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 16:48:24.985 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 16:48:24.986 +08:00 [DBG] End userinfo request
2019-06-13 16:49:49.283 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 16:49:49.287 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 16:49:49.287 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 16:49:49.288 +08:00 [DBG] Start discovery request
2019-06-13 16:49:50.009 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 16:49:50.139 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 16:49:50.139 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 16:49:50.140 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 16:49:50.140 +08:00 [DBG] Start key discovery request
2019-06-13 16:53:50.184 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 16:53:50.215 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 16:53:50.215 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 16:53:50.215 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 16:53:50.216 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 16:53:50.216 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 16:53:50.685 +08:00 [DBG] Starting grant removal
2019-06-13 16:53:51.088 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 16:53:51.090 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 16:53:51.091 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 16:53:51.091 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 16:53:51.091 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 16:53:51.091 +08:00 [DBG] Error Url: /home/error
2019-06-13 16:53:51.091 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 16:53:54.349 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 16:53:54.357 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 16:53:54.357 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 16:53:54.361 +08:00 [DBG] Start discovery request
2019-06-13 16:53:55.775 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 17:00:03.300 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 17:00:03.302 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 17:00:03.302 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 17:00:03.303 +08:00 [DBG] Start discovery request
2019-06-13 17:00:04.169 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 17:00:04.374 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 17:00:04.375 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 17:00:04.375 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 17:00:04.378 +08:00 [DBG] Start key discovery request
2019-06-13 17:00:04.481 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 17:00:04.484 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 17:00:04.484 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 17:00:04.487 +08:00 [DBG] Start authorize request
2019-06-13 17:00:04.498 +08:00 [DBG] User in authorize request: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:00:04.502 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 17:00:05.968 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:00:05.977 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:00:05.983 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 17:00:05.985 +08:00 [DBG] No PKCE used.
2019-06-13 17:00:06.242 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:00:06.840 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:00:07.055 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:00:07.606 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:00:07.616 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 17:00:07.630 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 email","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrQI2P6M2GAy8T4ioLsYJ9EjHZdCIVCmPoDl3RBOhvdt1YTKve_cs3Veyv-NROnd9dHYBToitcovpfDI9m4ZqpSqwVNUM58nH3Tv1Yy71B2jB6G7TjCICO4ZkbYyv3DzAAbLZmsWr0mB6KgeMcv1chuLHlYbPoU52mpkl4TsGJZa-d9BB1c9hWBYE4fxgQ69uUGbsEWxdmoadMS95Zl3Iyy0ZpYFR4QQfJruk_o_ideqvlQGwN7tgoCbl-9Pf8M7ecwEO5xmMha2fwK8C5qP5X9OyTEpiAeFA4bBWULtB_gxWVSiJT4xyBC8avGItzkEwk","UiLocales":null,"Nonce":"636960132044377309.YzZhNWQyYWUtNTVjOS00YmVhLThhNDAtMzBmYTlmYjk4YzJjMDY4MjliZDEtMTllOC00NzA5LTgzNDMtYWMyZDFkYzA0NGFj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"5b9946b1cd6fbef9617bcd048c5f8eda","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile api1 email","response_mode":"form_post","nonce":"636960132044377309.YzZhNWQyYWUtNTVjOS00YmVhLThhNDAtMzBmYTlmYjk4YzJjMDY4MjliZDEtMTllOC00NzA5LTgzNDMtYWMyZDFkYzA0NGFj","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrQI2P6M2GAy8T4ioLsYJ9EjHZdCIVCmPoDl3RBOhvdt1YTKve_cs3Veyv-NROnd9dHYBToitcovpfDI9m4ZqpSqwVNUM58nH3Tv1Yy71B2jB6G7TjCICO4ZkbYyv3DzAAbLZmsWr0mB6KgeMcv1chuLHlYbPoU52mpkl4TsGJZa-d9BB1c9hWBYE4fxgQ69uUGbsEWxdmoadMS95Zl3Iyy0ZpYFR4QQfJruk_o_ideqvlQGwN7tgoCbl-9Pf8M7ecwEO5xmMha2fwK8C5qP5X9OyTEpiAeFA4bBWULtB_gxWVSiJT4xyBC8avGItzkEwk","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 17:00:08.012 +08:00 [DBG] 4ODIvwkbcMVGMwptW6wXCBMORKxKV2CaEIiv0vjd/uE= found in database: true
2019-06-13 17:00:08.018 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 17:00:08.025 +08:00 [DBG] Creating Hybrid Flow response.
2019-06-13 17:00:08.185 +08:00 [DBG] hqvnEHWt2pWGAWlKg1ea5oPappjR0uFHiXilWN6ve5g= not found in database
2019-06-13 17:00:08.580 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 17:00:08.589 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcHybrid
2019-06-13 17:00:08.592 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 17:00:08.725 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","Scopes":"openid profile email api1","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****WsCg","$type":"Token"},{"TokenType":"code","TokenValue":"****a97e","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFRIJV3KD4:00000003","TimeStamp":"2019-06-13T09:00:08.0000000Z","ProcessId":33464,"LocalIpAddress":"127.0.0.1:2292","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 17:00:08.728 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ClientId":"mvcHybrid","RedirectUri":"http://localhost:5005/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrQI2P6M2GAy8T4ioLsYJ9EjHZdCIVCmPoDl3RBOhvdt1YTKve_cs3Veyv-NROnd9dHYBToitcovpfDI9m4ZqpSqwVNUM58nH3Tv1Yy71B2jB6G7TjCICO4ZkbYyv3DzAAbLZmsWr0mB6KgeMcv1chuLHlYbPoU52mpkl4TsGJZa-d9BB1c9hWBYE4fxgQ69uUGbsEWxdmoadMS95Zl3Iyy0ZpYFR4QQfJruk_o_ideqvlQGwN7tgoCbl-9Pf8M7ecwEO5xmMha2fwK8C5qP5X9OyTEpiAeFA4bBWULtB_gxWVSiJT4xyBC8avGItzkEwk","Scope":"openid profile email api1","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 17:00:08.963 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-13 17:00:08.968 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-13 17:00:08.969 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-13 17:00:08.980 +08:00 [DBG] Start token request.
2019-06-13 17:00:08.987 +08:00 [DBG] Start client validation
2019-06-13 17:00:08.995 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-13 17:00:08.998 +08:00 [DBG] Start parsing for secret in post body
2019-06-13 17:00:09.018 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-13 17:00:09.018 +08:00 [DBG] Secret id found: mvcHybrid
2019-06-13 17:00:10.118 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:00:10.118 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:00:10.127 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-13 17:00:10.127 +08:00 [DBG] Client validation success
2019-06-13 17:00:10.127 +08:00 [INF] {"ClientId":"mvcHybrid","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNFRIJV3KD4:00000004","TimeStamp":"2019-06-13T09:00:10.0000000Z","ProcessId":33464,"LocalIpAddress":"127.0.0.1:2292","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-13 17:00:10.133 +08:00 [DBG] Start token request validation
2019-06-13 17:00:10.143 +08:00 [DBG] Start validation of authorization code token request
2019-06-13 17:00:10.256 +08:00 [DBG] hqvnEHWt2pWGAWlKg1ea5oPappjR0uFHiXilWN6ve5g= found in database: true
2019-06-13 17:00:10.379 +08:00 [DBG] removing hqvnEHWt2pWGAWlKg1ea5oPappjR0uFHiXilWN6ve5g= persisted grant from database
2019-06-13 17:00:10.727 +08:00 [DBG] Validation of authorization code token request success
2019-06-13 17:00:10.731 +08:00 [INF] Token request validation success
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"02dac70f59d182e36965d82830ae43584b2daa449030d9426d6da957c4fda97e","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvcHybrid","client_secret":"***REDACTED***","code":"02dac70f59d182e36965d82830ae43584b2daa449030d9426d6da957c4fda97e","grant_type":"authorization_code","redirect_uri":"http://localhost:5005/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-06-13 17:00:11.879 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:00:11.879 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:00:12.074 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:00:12.610 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:00:12.622 +08:00 [DBG] Getting claims for access token for client: mvcHybrid
2019-06-13 17:00:12.622 +08:00 [DBG] Getting claims for access token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:00:12.628 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 17:00:13.732 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:00:13.732 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:00:13.932 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:00:14.500 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:00:14.501 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcHybrid
2019-06-13 17:00:14.501 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 17:00:14.507 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile email api1","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****bJWA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****br4Q","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFRIJV3KD4:00000004","TimeStamp":"2019-06-13T09:00:14.0000000Z","ProcessId":33464,"LocalIpAddress":"127.0.0.1:2292","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 17:00:14.508 +08:00 [DBG] Token request success.
2019-06-13 17:00:14.566 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:00:14.569 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:00:14.569 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:00:14.577 +08:00 [DBG] Start userinfo request
2019-06-13 17:00:14.581 +08:00 [DBG] Bearer token found in header
2019-06-13 17:00:15.743 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:00:15.743 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:00:16.772 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:00:16.772 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:00:16.900 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 17:00:16.901 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560416412,"exp":1560416472,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcHybrid","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560412789,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email","api1"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 17:00:16.910 +08:00 [DBG] Creating userinfo response
2019-06-13 17:00:16.914 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:00:16.917 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:00:17.127 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:00:17.127 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-13 17:00:17.127 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:00:17.318 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:00:17.319 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 17:00:17.319 +08:00 [DBG] End userinfo request
2019-06-13 17:00:59.186 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:00:59.187 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:00:59.187 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:00:59.188 +08:00 [DBG] Start userinfo request
2019-06-13 17:00:59.188 +08:00 [DBG] Bearer token found in header
2019-06-13 17:01:00.279 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:01:00.279 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:01:01.345 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:01:01.345 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:01:01.470 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 17:01:01.470 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560416412,"exp":1560416472,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcHybrid","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560412789,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email","api1"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 17:01:01.471 +08:00 [DBG] Creating userinfo response
2019-06-13 17:01:01.471 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:01:01.471 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:01:01.670 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:01:01.670 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-13 17:01:01.670 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:01:01.870 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:01:01.870 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 17:01:01.870 +08:00 [DBG] End userinfo request
2019-06-13 17:13:51.278 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 17:13:51.306 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 17:13:51.306 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 17:13:51.306 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 17:13:51.306 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 17:13:51.306 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 17:13:51.385 +08:00 [DBG] Starting grant removal
2019-06-13 17:13:51.671 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 17:13:51.673 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 17:13:51.673 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 17:13:51.673 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 17:13:51.673 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 17:13:51.673 +08:00 [DBG] Error Url: /home/error
2019-06-13 17:13:51.673 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 17:14:17.090 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 17:14:17.120 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 17:14:17.120 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 17:14:17.120 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 17:14:17.121 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 17:14:17.121 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 17:14:17.573 +08:00 [DBG] Starting grant removal
2019-06-13 17:14:17.875 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 17:14:17.878 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 17:14:17.879 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 17:14:17.880 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 17:14:17.880 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 17:14:17.880 +08:00 [DBG] Error Url: /home/error
2019-06-13 17:14:17.881 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 17:14:22.546 +08:00 [DBG] 2 persisted grants found for af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:14:23.791 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:14:23.797 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:14:24.026 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:14:24.722 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:14:25.720 +08:00 [DBG] mvcImp found in database: true
2019-06-13 17:14:25.720 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 17:14:25.909 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:14:26.387 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:14:32.717 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 17:14:32.721 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 17:14:32.721 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 17:14:32.725 +08:00 [DBG] Start discovery request
2019-06-13 17:14:33.439 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 17:19:07.721 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 17:19:07.722 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 17:19:07.722 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 17:19:07.722 +08:00 [DBG] Start discovery request
2019-06-13 17:19:08.588 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 17:19:08.781 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 17:19:08.783 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 17:19:08.783 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 17:19:08.788 +08:00 [DBG] Start key discovery request
2019-06-13 17:19:09.443 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 17:19:09.445 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 17:19:09.445 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 17:19:09.449 +08:00 [DBG] Start authorize request
2019-06-13 17:19:09.455 +08:00 [DBG] User in authorize request: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:19:09.460 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 17:19:10.500 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:19:10.500 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:19:10.506 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 17:19:10.507 +08:00 [DBG] No PKCE used.
2019-06-13 17:19:10.708 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:19:11.221 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:19:11.422 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:19:11.935 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:19:11.945 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 17:19:11.959 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 email","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ip-6coVcRPRUbkEN7W6lT0miwqH1LU4MWp4QN4jNAVc5aRrZ5qQUWNxnNKu6FTUttGM94XAdNY2WjV8ABXMlVWUSEK62xxd_YdLrxJlgfHCWRQz_v7F8OKVd6Py6s4gZW0AqGv1W5jdjfCvzkGi8lmFfCwracEzcRDQhZzItii8mtk5HqgOzhWPUiP8fzh3RxOOQBor-g7n8vqjnOnoQacICO9bhYx5z1QcD8ilqoS7bKoLqTheNiU2b8Cytxngs2IFuoG8CAqucHsVgj5IX_rLmOD_ddzD4pEGsA8cea3ccfELge-O722MWQ9hjJOssFQ","UiLocales":null,"Nonce":"636960143488322487.ZWMwZDM5YjUtMWU4My00ZTNmLWJlMzQtMjYwYzBlMzk2ZGU1ZWY2NDkzNGQtZTYyNi00ZjVhLWFlM2EtZTQwZWI5YzlhMDMw","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"5b9946b1cd6fbef9617bcd048c5f8eda","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile api1 email","response_mode":"form_post","nonce":"636960143488322487.ZWMwZDM5YjUtMWU4My00ZTNmLWJlMzQtMjYwYzBlMzk2ZGU1ZWY2NDkzNGQtZTYyNi00ZjVhLWFlM2EtZTQwZWI5YzlhMDMw","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ip-6coVcRPRUbkEN7W6lT0miwqH1LU4MWp4QN4jNAVc5aRrZ5qQUWNxnNKu6FTUttGM94XAdNY2WjV8ABXMlVWUSEK62xxd_YdLrxJlgfHCWRQz_v7F8OKVd6Py6s4gZW0AqGv1W5jdjfCvzkGi8lmFfCwracEzcRDQhZzItii8mtk5HqgOzhWPUiP8fzh3RxOOQBor-g7n8vqjnOnoQacICO9bhYx5z1QcD8ilqoS7bKoLqTheNiU2b8Cytxngs2IFuoG8CAqucHsVgj5IX_rLmOD_ddzD4pEGsA8cea3ccfELge-O722MWQ9hjJOssFQ","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 17:19:12.124 +08:00 [DBG] 4ODIvwkbcMVGMwptW6wXCBMORKxKV2CaEIiv0vjd/uE= found in database: true
2019-06-13 17:19:12.128 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 17:19:12.134 +08:00 [DBG] Creating Hybrid Flow response.
2019-06-13 17:19:12.283 +08:00 [DBG] 9JJ1U4DoS/ZFek+Z0TiVvFSFvcI/CrGCiyy0iLYLIGw= not found in database
2019-06-13 17:19:12.547 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 17:19:12.557 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcHybrid
2019-06-13 17:19:12.559 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 17:19:12.681 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","Scopes":"openid profile email api1","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****1snw","$type":"Token"},{"TokenType":"code","TokenValue":"****3636","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFRU1IV7J9:00000003","TimeStamp":"2019-06-13T09:19:12.0000000Z","ProcessId":15580,"LocalIpAddress":"127.0.0.1:35991","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 17:19:12.684 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ClientId":"mvcHybrid","RedirectUri":"http://localhost:5005/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ip-6coVcRPRUbkEN7W6lT0miwqH1LU4MWp4QN4jNAVc5aRrZ5qQUWNxnNKu6FTUttGM94XAdNY2WjV8ABXMlVWUSEK62xxd_YdLrxJlgfHCWRQz_v7F8OKVd6Py6s4gZW0AqGv1W5jdjfCvzkGi8lmFfCwracEzcRDQhZzItii8mtk5HqgOzhWPUiP8fzh3RxOOQBor-g7n8vqjnOnoQacICO9bhYx5z1QcD8ilqoS7bKoLqTheNiU2b8Cytxngs2IFuoG8CAqucHsVgj5IX_rLmOD_ddzD4pEGsA8cea3ccfELge-O722MWQ9hjJOssFQ","Scope":"openid profile email api1","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 17:19:12.957 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-13 17:19:12.965 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-13 17:19:12.965 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-13 17:19:12.977 +08:00 [DBG] Start token request.
2019-06-13 17:19:12.985 +08:00 [DBG] Start client validation
2019-06-13 17:19:12.992 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-13 17:19:12.996 +08:00 [DBG] Start parsing for secret in post body
2019-06-13 17:19:13.016 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-13 17:19:13.016 +08:00 [DBG] Secret id found: mvcHybrid
2019-06-13 17:19:14.029 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:19:14.029 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:19:14.038 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-13 17:19:14.039 +08:00 [DBG] Client validation success
2019-06-13 17:19:14.039 +08:00 [INF] {"ClientId":"mvcHybrid","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNFRU1IV7J9:00000004","TimeStamp":"2019-06-13T09:19:14.0000000Z","ProcessId":15580,"LocalIpAddress":"127.0.0.1:35991","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-13 17:19:14.044 +08:00 [DBG] Start token request validation
2019-06-13 17:19:14.054 +08:00 [DBG] Start validation of authorization code token request
2019-06-13 17:19:14.167 +08:00 [DBG] 9JJ1U4DoS/ZFek+Z0TiVvFSFvcI/CrGCiyy0iLYLIGw= found in database: true
2019-06-13 17:19:14.293 +08:00 [DBG] removing 9JJ1U4DoS/ZFek+Z0TiVvFSFvcI/CrGCiyy0iLYLIGw= persisted grant from database
2019-06-13 17:19:14.613 +08:00 [DBG] Validation of authorization code token request success
2019-06-13 17:19:14.616 +08:00 [INF] Token request validation success
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"4296a9011d1d310a9fdc00cff72d60a9d6bcadf72cdd41b77de9e9cc4c233636","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvcHybrid","client_secret":"***REDACTED***","code":"4296a9011d1d310a9fdc00cff72d60a9d6bcadf72cdd41b77de9e9cc4c233636","grant_type":"authorization_code","redirect_uri":"http://localhost:5005/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-06-13 17:19:15.612 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:19:15.612 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:19:15.808 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:19:16.321 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:19:16.331 +08:00 [DBG] Getting claims for access token for client: mvcHybrid
2019-06-13 17:19:16.332 +08:00 [DBG] Getting claims for access token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:19:16.338 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 17:19:17.354 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:19:17.355 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:19:17.560 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:19:18.069 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:19:18.069 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcHybrid
2019-06-13 17:19:18.069 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 17:19:18.074 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile email api1","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****zJEA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****qTmg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFRU1IV7J9:00000004","TimeStamp":"2019-06-13T09:19:18.0000000Z","ProcessId":15580,"LocalIpAddress":"127.0.0.1:35991","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 17:19:18.075 +08:00 [DBG] Token request success.
2019-06-13 17:19:18.132 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:19:18.136 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:19:18.136 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:19:18.142 +08:00 [DBG] Start userinfo request
2019-06-13 17:19:18.145 +08:00 [DBG] Bearer token found in header
2019-06-13 17:19:19.206 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:19:19.206 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:19:20.216 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:19:20.216 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:19:20.324 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 17:19:20.325 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560417556,"exp":1560418156,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcHybrid","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560412789,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email","api1"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 17:19:20.334 +08:00 [DBG] Creating userinfo response
2019-06-13 17:19:20.338 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:19:20.340 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:19:20.533 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:19:20.534 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-13 17:19:20.534 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:19:20.710 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:19:20.711 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 17:19:20.711 +08:00 [DBG] End userinfo request
2019-06-13 17:19:52.689 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:19:52.690 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:19:52.690 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:19:52.690 +08:00 [DBG] Start userinfo request
2019-06-13 17:19:52.690 +08:00 [DBG] Bearer token not found
2019-06-13 17:19:52.690 +08:00 [ERR] No access token found.
2019-06-13 17:19:52.712 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:19:52.719 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:19:52.719 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:19:52.719 +08:00 [DBG] Start userinfo request
2019-06-13 17:19:52.719 +08:00 [DBG] Bearer token not found
2019-06-13 17:19:52.719 +08:00 [ERR] No access token found.
2019-06-13 17:20:32.763 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:20:32.765 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:20:32.765 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:20:32.765 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:20:32.772 +08:00 [DBG] Start userinfo request
2019-06-13 17:20:32.774 +08:00 [DBG] Bearer token found in header
2019-06-13 17:20:32.790 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:20:32.790 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:20:32.790 +08:00 [DBG] Start userinfo request
2019-06-13 17:20:32.810 +08:00 [DBG] Bearer token found in header
2019-06-13 17:20:33.940 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:20:33.941 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:20:34.032 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:20:34.032 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:20:35.030 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:20:35.030 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:20:35.142 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 17:20:35.142 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560417556,"exp":1560418156,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcHybrid","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560412789,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email","api1"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 17:20:35.142 +08:00 [DBG] Creating userinfo response
2019-06-13 17:20:35.142 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:20:35.143 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:20:35.162 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:20:35.162 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:20:35.312 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 17:20:35.312 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560417556,"exp":1560418156,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcHybrid","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560412789,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email","api1"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 17:20:35.313 +08:00 [DBG] Creating userinfo response
2019-06-13 17:20:35.313 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:20:35.313 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:20:35.358 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:20:35.358 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-13 17:20:35.358 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:20:35.533 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:20:35.533 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-13 17:20:35.533 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:20:35.556 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:20:35.556 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 17:20:35.556 +08:00 [DBG] End userinfo request
2019-06-13 17:20:35.747 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:20:35.748 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 17:20:35.748 +08:00 [DBG] End userinfo request
2019-06-13 17:21:12.137 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 17:21:12.139 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 17:21:12.142 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 17:21:12.142 +08:00 [DBG] Start discovery request
2019-06-13 17:21:12.861 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 17:21:13.043 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 17:21:13.044 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 17:21:13.044 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 17:21:13.044 +08:00 [DBG] Start key discovery request
2019-06-13 17:21:53.413 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 17:21:53.416 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 17:21:53.416 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 17:21:53.416 +08:00 [DBG] Start discovery request
2019-06-13 17:21:54.163 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 17:21:54.408 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 17:21:54.408 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 17:21:54.409 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 17:21:54.409 +08:00 [DBG] Start key discovery request
2019-06-13 17:21:54.526 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 17:21:54.526 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 17:21:54.527 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 17:21:54.527 +08:00 [DBG] Start authorize request
2019-06-13 17:21:54.527 +08:00 [DBG] User in authorize request: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:21:54.527 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 17:21:55.652 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:21:55.652 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:21:55.652 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 17:21:55.653 +08:00 [DBG] No PKCE used.
2019-06-13 17:21:55.868 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:21:56.436 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:21:56.641 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:21:57.223 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:21:57.223 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 17:21:57.224 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 email","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrI1PJbwAu72H2M-FjR83l-wgVZrfWIDK3WwC5RgMqHJ-XMvqAQKf_a6A905xrrOmrKJh2ndTPBmoVWW-k_QDoT2mY8KVdGq5UTS458F95CLyyeEVpRHnjLUiWWCSsUhcx9KrZxYa5Pjj8J0gbQEwxF6VHSArtbBG6j4dP5Fc1znAk1Rfim75_aMY-0ctF8-OYYlNSOxrV7jVC4LyVHFzLmrkKF_e4za56mAP2D9gprZSxZypKLUAKwbSpUoRoQ649QxXZc72Qc6twHmAVciz9wYUxZJYJvrM_PbG6QQzH7TikKBn-adYKCgjQsBBFoJHA","UiLocales":null,"Nonce":"636960145144686666.NmZkMmMzZjAtYjA5Ny00MTg4LWJkYWQtNDQ2Mzc3OGM5OTZjMjU1YTc5MjYtN2Q5ZS00NzI0LWE5MmYtMDNlZDVkOWFiOTZm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"5b9946b1cd6fbef9617bcd048c5f8eda","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile api1 email","response_mode":"form_post","nonce":"636960145144686666.NmZkMmMzZjAtYjA5Ny00MTg4LWJkYWQtNDQ2Mzc3OGM5OTZjMjU1YTc5MjYtN2Q5ZS00NzI0LWE5MmYtMDNlZDVkOWFiOTZm","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrI1PJbwAu72H2M-FjR83l-wgVZrfWIDK3WwC5RgMqHJ-XMvqAQKf_a6A905xrrOmrKJh2ndTPBmoVWW-k_QDoT2mY8KVdGq5UTS458F95CLyyeEVpRHnjLUiWWCSsUhcx9KrZxYa5Pjj8J0gbQEwxF6VHSArtbBG6j4dP5Fc1znAk1Rfim75_aMY-0ctF8-OYYlNSOxrV7jVC4LyVHFzLmrkKF_e4za56mAP2D9gprZSxZypKLUAKwbSpUoRoQ649QxXZc72Qc6twHmAVciz9wYUxZJYJvrM_PbG6QQzH7TikKBn-adYKCgjQsBBFoJHA","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 17:21:57.470 +08:00 [DBG] 4ODIvwkbcMVGMwptW6wXCBMORKxKV2CaEIiv0vjd/uE= found in database: true
2019-06-13 17:21:57.474 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 17:21:57.475 +08:00 [DBG] Creating Hybrid Flow response.
2019-06-13 17:21:57.606 +08:00 [DBG] OuEzQXq0YJKcFbtI5yJTcR9aGDz3jnjTmc2AgrdJgzg= not found in database
2019-06-13 17:21:57.857 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 17:21:57.857 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcHybrid
2019-06-13 17:21:57.857 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 17:21:57.860 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","Scopes":"openid profile email api1","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****-g_A","$type":"Token"},{"TokenType":"code","TokenValue":"****27b3","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFRU1IV7JA:00000004","TimeStamp":"2019-06-13T09:21:57.0000000Z","ProcessId":15580,"LocalIpAddress":"127.0.0.1:35991","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 17:21:57.861 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ClientId":"mvcHybrid","RedirectUri":"http://localhost:5005/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IrI1PJbwAu72H2M-FjR83l-wgVZrfWIDK3WwC5RgMqHJ-XMvqAQKf_a6A905xrrOmrKJh2ndTPBmoVWW-k_QDoT2mY8KVdGq5UTS458F95CLyyeEVpRHnjLUiWWCSsUhcx9KrZxYa5Pjj8J0gbQEwxF6VHSArtbBG6j4dP5Fc1znAk1Rfim75_aMY-0ctF8-OYYlNSOxrV7jVC4LyVHFzLmrkKF_e4za56mAP2D9gprZSxZypKLUAKwbSpUoRoQ649QxXZc72Qc6twHmAVciz9wYUxZJYJvrM_PbG6QQzH7TikKBn-adYKCgjQsBBFoJHA","Scope":"openid profile email api1","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 17:21:58.077 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-13 17:21:58.078 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-13 17:21:58.078 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-13 17:21:58.078 +08:00 [DBG] Start token request.
2019-06-13 17:21:58.078 +08:00 [DBG] Start client validation
2019-06-13 17:21:58.079 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-13 17:21:58.079 +08:00 [DBG] Start parsing for secret in post body
2019-06-13 17:21:58.080 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-13 17:21:58.080 +08:00 [DBG] Secret id found: mvcHybrid
2019-06-13 17:21:59.257 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:21:59.257 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:21:59.257 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-13 17:21:59.258 +08:00 [DBG] Client validation success
2019-06-13 17:21:59.258 +08:00 [INF] {"ClientId":"mvcHybrid","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNFRU1IV7J9:0000000B","TimeStamp":"2019-06-13T09:21:59.0000000Z","ProcessId":15580,"LocalIpAddress":"127.0.0.1:35991","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-13 17:21:59.258 +08:00 [DBG] Start token request validation
2019-06-13 17:21:59.258 +08:00 [DBG] Start validation of authorization code token request
2019-06-13 17:21:59.392 +08:00 [DBG] OuEzQXq0YJKcFbtI5yJTcR9aGDz3jnjTmc2AgrdJgzg= found in database: true
2019-06-13 17:21:59.526 +08:00 [DBG] removing OuEzQXq0YJKcFbtI5yJTcR9aGDz3jnjTmc2AgrdJgzg= persisted grant from database
2019-06-13 17:21:59.886 +08:00 [DBG] Validation of authorization code token request success
2019-06-13 17:21:59.886 +08:00 [INF] Token request validation success
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"ba9d25b0163a22b39c961b414de000f696cbc9575d19713a7f4852ffba2027b3","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvcHybrid","client_secret":"***REDACTED***","code":"ba9d25b0163a22b39c961b414de000f696cbc9575d19713a7f4852ffba2027b3","grant_type":"authorization_code","redirect_uri":"http://localhost:5005/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-06-13 17:22:01.019 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:22:01.019 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:22:01.244 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:22:01.816 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:22:01.816 +08:00 [DBG] Getting claims for access token for client: mvcHybrid
2019-06-13 17:22:01.816 +08:00 [DBG] Getting claims for access token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:22:01.816 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 17:22:02.892 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:22:02.892 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:22:03.098 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:22:03.678 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:22:03.679 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcHybrid
2019-06-13 17:22:03.679 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 17:22:03.682 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile email api1","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****mMUg","$type":"Token"},{"TokenType":"access_token","TokenValue":"****JdWQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFRU1IV7J9:0000000B","TimeStamp":"2019-06-13T09:22:03.0000000Z","ProcessId":15580,"LocalIpAddress":"127.0.0.1:35991","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 17:22:03.682 +08:00 [DBG] Token request success.
2019-06-13 17:22:03.733 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:22:03.734 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:22:03.734 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:22:03.734 +08:00 [DBG] Start userinfo request
2019-06-13 17:22:03.734 +08:00 [DBG] Bearer token found in header
2019-06-13 17:22:04.827 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:22:04.828 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:22:05.941 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:22:05.941 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:22:06.058 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 17:22:06.058 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560417721,"exp":1560418321,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcHybrid","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560412789,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email","api1"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 17:22:06.059 +08:00 [DBG] Creating userinfo response
2019-06-13 17:22:06.059 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:22:06.059 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:22:06.252 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:22:06.252 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-13 17:22:06.252 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:22:06.457 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:22:06.458 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 17:22:06.458 +08:00 [DBG] End userinfo request
2019-06-13 17:22:06.608 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:22:06.609 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:22:06.609 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:22:06.609 +08:00 [DBG] Start userinfo request
2019-06-13 17:22:06.610 +08:00 [DBG] Bearer token found in header
2019-06-13 17:22:07.823 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:22:07.823 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:22:08.919 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:22:08.919 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:22:09.029 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 17:22:09.029 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560417721,"exp":1560418321,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcHybrid","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560412789,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email","api1"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 17:22:09.029 +08:00 [DBG] Creating userinfo response
2019-06-13 17:22:09.029 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:22:09.029 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:22:09.235 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:22:09.236 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-13 17:22:09.236 +08:00 [DBG] Scopes in access token: openid profile email api1
2019-06-13 17:22:09.423 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:22:09.423 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 17:22:09.423 +08:00 [DBG] End userinfo request
2019-06-13 17:22:22.707 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 17:22:22.708 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 17:22:22.708 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 17:22:22.708 +08:00 [DBG] Start discovery request
2019-06-13 17:22:23.423 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 17:22:23.577 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 17:22:23.578 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 17:22:23.578 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 17:22:23.578 +08:00 [DBG] Start key discovery request
2019-06-13 17:23:40.457 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:23:40.458 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:23:40.458 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:23:40.460 +08:00 [DBG] Start userinfo request
2019-06-13 17:23:40.461 +08:00 [DBG] Bearer token not found
2019-06-13 17:23:40.461 +08:00 [ERR] No access token found.
2019-06-13 17:23:58.045 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:23:58.046 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:23:58.046 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:23:58.046 +08:00 [DBG] Start userinfo request
2019-06-13 17:23:58.046 +08:00 [DBG] Bearer token not found
2019-06-13 17:23:58.046 +08:00 [ERR] No access token found.
2019-06-13 17:29:36.117 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 17:29:36.117 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 17:29:36.118 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 17:29:36.118 +08:00 [DBG] Start discovery request
2019-06-13 17:29:36.978 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 17:29:37.194 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 17:29:37.195 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 17:29:37.195 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 17:29:37.195 +08:00 [DBG] Start key discovery request
2019-06-13 17:29:37.281 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 17:29:37.282 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 17:29:37.282 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 17:29:37.282 +08:00 [DBG] Start authorize request
2019-06-13 17:29:37.283 +08:00 [DBG] No user present in authorize request
2019-06-13 17:29:37.284 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 17:29:38.298 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:29:38.298 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:29:38.298 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 17:29:38.298 +08:00 [DBG] No PKCE used.
2019-06-13 17:29:38.497 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:29:39.058 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:29:39.263 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:29:39.852 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:29:39.852 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 17:29:39.852 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"anonymous","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 email offline_access","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpPSkBZK9A0XxoPJSaaTUvaSEqfXLZd99U1XVMVL33SMI0fKCkdSDbA7hxzPbxwQ4BCsJofw8XZZBt7045CHzFwEdIcOQRux6cEG_U7hpWsE6qhwdlMtyCuoTx8x4-gJJoMvJayw3oaI-F6kWpW4bOrDlfVi9XIaOWAItON1Lf25HC2eeqTNd29Po7esgSkDqN71xQhpnNNDDSjN0CaCZ93EPfYZsmKqZP2mti6xP6NKye8ens6SNCyzeupSYoMlFAkX_rSgPONvFXhJR76o0f7yE4TKYEzpKE9f2VFf9LoG5hA-Bvi6NVZRu4g7RmX2yo","UiLocales":null,"Nonce":"636960149772318368.MWNiZTQ1MDgtM2MyOC00OTZjLTk0YTEtZGNiMGMyNDgwNTU2YjEyY2UyZGYtZWRmYi00MzZiLTlmODQtZDY4NjgwYjY3ODE2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile api1 email offline_access","response_mode":"form_post","nonce":"636960149772318368.MWNiZTQ1MDgtM2MyOC00OTZjLTk0YTEtZGNiMGMyNDgwNTU2YjEyY2UyZGYtZWRmYi00MzZiLTlmODQtZDY4NjgwYjY3ODE2","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpPSkBZK9A0XxoPJSaaTUvaSEqfXLZd99U1XVMVL33SMI0fKCkdSDbA7hxzPbxwQ4BCsJofw8XZZBt7045CHzFwEdIcOQRux6cEG_U7hpWsE6qhwdlMtyCuoTx8x4-gJJoMvJayw3oaI-F6kWpW4bOrDlfVi9XIaOWAItON1Lf25HC2eeqTNd29Po7esgSkDqN71xQhpnNNDDSjN0CaCZ93EPfYZsmKqZP2mti6xP6NKye8ens6SNCyzeupSYoMlFAkX_rSgPONvFXhJR76o0f7yE4TKYEzpKE9f2VFf9LoG5hA-Bvi6NVZRu4g7RmX2yo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 17:29:39.852 +08:00 [INF] Showing login: User is not authenticated
2019-06-13 17:29:39.992 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 17:29:40.823 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 17:29:41.043 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:29:41.043 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:29:41.043 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 17:29:41.043 +08:00 [DBG] No PKCE used.
2019-06-13 17:29:41.231 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:29:41.777 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:29:41.967 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:29:42.072 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:29:42.073 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:29:42.073 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 17:29:42.073 +08:00 [DBG] No PKCE used.
2019-06-13 17:29:42.246 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:29:42.510 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:29:42.510 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 17:29:42.780 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:29:42.967 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:29:43.492 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:29:43.493 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 17:29:43.587 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:29:43.588 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:29:44.731 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:29:44.731 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:29:56.535 +08:00 [DBG] CORS request made for path: /Account/Login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-13 17:29:56.588 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 17:29:57.620 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:29:57.620 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:29:57.620 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 17:29:57.621 +08:00 [DBG] No PKCE used.
2019-06-13 17:29:57.831 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:29:58.338 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:29:58.765 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:29:59.261 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:29:59.261 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 17:29:59.416 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"1223138295@qq.com","DisplayName":"晓锋","Endpoint":"UI","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNFRU1IV7JC:00000005","TimeStamp":"2019-06-13T09:29:59.0000000Z","ProcessId":15580,"LocalIpAddress":"127.0.0.1:35991","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-13 17:29:59.638 +08:00 [DBG] Augmenting SignInContext
2019-06-13 17:29:59.640 +08:00 [DBG] Adding idp claim with value: local
2019-06-13 17:29:59.640 +08:00 [DBG] Adding amr claim with value: pwd
2019-06-13 17:29:59.640 +08:00 [DBG] Adding auth_time claim with value: 1560418199
2019-06-13 17:29:59.648 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-13 17:29:59.685 +08:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-13 17:29:59.686 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-13 17:29:59.687 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-13 17:29:59.693 +08:00 [DBG] Start authorize callback request
2019-06-13 17:29:59.698 +08:00 [DBG] User in authorize request: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:29:59.698 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 17:30:00.685 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:30:00.685 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:30:00.685 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 17:30:00.685 +08:00 [DBG] No PKCE used.
2019-06-13 17:30:00.868 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:30:01.367 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:30:01.558 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:30:02.084 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:30:02.084 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 17:30:02.085 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 email offline_access","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpPSkBZK9A0XxoPJSaaTUvaSEqfXLZd99U1XVMVL33SMI0fKCkdSDbA7hxzPbxwQ4BCsJofw8XZZBt7045CHzFwEdIcOQRux6cEG_U7hpWsE6qhwdlMtyCuoTx8x4-gJJoMvJayw3oaI-F6kWpW4bOrDlfVi9XIaOWAItON1Lf25HC2eeqTNd29Po7esgSkDqN71xQhpnNNDDSjN0CaCZ93EPfYZsmKqZP2mti6xP6NKye8ens6SNCyzeupSYoMlFAkX_rSgPONvFXhJR76o0f7yE4TKYEzpKE9f2VFf9LoG5hA-Bvi6NVZRu4g7RmX2yo","UiLocales":null,"Nonce":"636960149772318368.MWNiZTQ1MDgtM2MyOC00OTZjLTk0YTEtZGNiMGMyNDgwNTU2YjEyY2UyZGYtZWRmYi00MzZiLTlmODQtZDY4NjgwYjY3ODE2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"402450cab079c1117d6f04b630d01503","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile api1 email offline_access","response_mode":"form_post","nonce":"636960149772318368.MWNiZTQ1MDgtM2MyOC00OTZjLTk0YTEtZGNiMGMyNDgwNTU2YjEyY2UyZGYtZWRmYi00MzZiLTlmODQtZDY4NjgwYjY3ODE2","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpPSkBZK9A0XxoPJSaaTUvaSEqfXLZd99U1XVMVL33SMI0fKCkdSDbA7hxzPbxwQ4BCsJofw8XZZBt7045CHzFwEdIcOQRux6cEG_U7hpWsE6qhwdlMtyCuoTx8x4-gJJoMvJayw3oaI-F6kWpW4bOrDlfVi9XIaOWAItON1Lf25HC2eeqTNd29Po7esgSkDqN71xQhpnNNDDSjN0CaCZ93EPfYZsmKqZP2mti6xP6NKye8ens6SNCyzeupSYoMlFAkX_rSgPONvFXhJR76o0f7yE4TKYEzpKE9f2VFf9LoG5hA-Bvi6NVZRu4g7RmX2yo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 17:30:02.192 +08:00 [DBG] Scopes contains offline_access, consent is required
2019-06-13 17:30:02.192 +08:00 [INF] Showing consent: User has not yet consented
2019-06-13 17:30:02.236 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 17:30:03.289 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:30:03.289 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:30:03.289 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 17:30:03.290 +08:00 [DBG] No PKCE used.
2019-06-13 17:30:03.491 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:30:04.030 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:30:04.229 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:30:04.755 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:30:04.755 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 17:30:05.794 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:30:05.794 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:30:05.974 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:30:06.469 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:30:37.502 +08:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-06-13 17:30:37.547 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 17:30:38.605 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:30:38.605 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:30:38.605 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 17:30:38.605 +08:00 [DBG] No PKCE used.
2019-06-13 17:30:38.790 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:30:39.303 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:30:39.493 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:30:40.006 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:30:40.006 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 17:30:40.008 +08:00 [INF] {"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ClientId":"mvcHybrid","RequestedScopes":["openid","profile","api1","email","offline_access"],"GrantedScopes":["openid","profile","email","api1","offline_access"],"ConsentRemembered":true,"Category":"Grants","Name":"Consent granted","EventType":"Information","Id":4000,"Message":null,"ActivityId":"0HLNFRU1IV7JD:00000003","TimeStamp":"2019-06-13T09:30:40.0000000Z","ProcessId":15580,"LocalIpAddress":"127.0.0.1:35991","RemoteIpAddress":"::1","$type":"ConsentGrantedEvent"}
2019-06-13 17:30:41.029 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:30:41.029 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:30:41.059 +08:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-06-13 17:30:41.060 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-06-13 17:30:41.060 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-06-13 17:30:41.060 +08:00 [DBG] Start authorize callback request
2019-06-13 17:30:41.063 +08:00 [DBG] User in authorize request: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:30:41.063 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 17:30:42.114 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:30:42.115 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:30:42.115 +08:00 [DBG] Checking for PKCE parameters
2019-06-13 17:30:42.115 +08:00 [DBG] No PKCE used.
2019-06-13 17:30:42.298 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:30:42.833 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:30:43.015 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:30:43.744 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:30:43.745 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 17:30:43.745 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","AllowedRedirectUris":["http://localhost:5005/signin-oidc"],"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ResponseType":"code id_token","ResponseMode":"form_post","GrantType":"hybrid","RequestedScopes":"openid profile api1 email offline_access","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpPSkBZK9A0XxoPJSaaTUvaSEqfXLZd99U1XVMVL33SMI0fKCkdSDbA7hxzPbxwQ4BCsJofw8XZZBt7045CHzFwEdIcOQRux6cEG_U7hpWsE6qhwdlMtyCuoTx8x4-gJJoMvJayw3oaI-F6kWpW4bOrDlfVi9XIaOWAItON1Lf25HC2eeqTNd29Po7esgSkDqN71xQhpnNNDDSjN0CaCZ93EPfYZsmKqZP2mti6xP6NKye8ens6SNCyzeupSYoMlFAkX_rSgPONvFXhJR76o0f7yE4TKYEzpKE9f2VFf9LoG5hA-Bvi6NVZRu4g7RmX2yo","UiLocales":null,"Nonce":"636960149772318368.MWNiZTQ1MDgtM2MyOC00OTZjLTk0YTEtZGNiMGMyNDgwNTU2YjEyY2UyZGYtZWRmYi00MzZiLTlmODQtZDY4NjgwYjY3ODE2","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"402450cab079c1117d6f04b630d01503","Raw":{"client_id":"mvcHybrid","redirect_uri":"http://localhost:5005/signin-oidc","response_type":"code id_token","scope":"openid profile api1 email offline_access","response_mode":"form_post","nonce":"636960149772318368.MWNiZTQ1MDgtM2MyOC00OTZjLTk0YTEtZGNiMGMyNDgwNTU2YjEyY2UyZGYtZWRmYi00MzZiLTlmODQtZDY4NjgwYjY3ODE2","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpPSkBZK9A0XxoPJSaaTUvaSEqfXLZd99U1XVMVL33SMI0fKCkdSDbA7hxzPbxwQ4BCsJofw8XZZBt7045CHzFwEdIcOQRux6cEG_U7hpWsE6qhwdlMtyCuoTx8x4-gJJoMvJayw3oaI-F6kWpW4bOrDlfVi9XIaOWAItON1Lf25HC2eeqTNd29Po7esgSkDqN71xQhpnNNDDSjN0CaCZ93EPfYZsmKqZP2mti6xP6NKye8ens6SNCyzeupSYoMlFAkX_rSgPONvFXhJR76o0f7yE4TKYEzpKE9f2VFf9LoG5hA-Bvi6NVZRu4g7RmX2yo","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 17:30:43.863 +08:00 [DBG] Scopes contains offline_access, consent is required
2019-06-13 17:30:43.869 +08:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2019-06-13 17:30:43.869 +08:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2019-06-13 17:30:43.872 +08:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:30:43.980 +08:00 [DBG] 4ODIvwkbcMVGMwptW6wXCBMORKxKV2CaEIiv0vjd/uE= found in database
2019-06-13 17:30:44.360 +08:00 [DBG] Creating Hybrid Flow response.
2019-06-13 17:30:44.478 +08:00 [DBG] yX2w9jOkKlEntlmsPFW+qXtnu7SNM7itiJUKR8iggxo= not found in database
2019-06-13 17:30:44.675 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 17:30:44.676 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcHybrid
2019-06-13 17:30:44.676 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 17:30:44.679 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":"http://localhost:5005/signin-oidc","Endpoint":"Authorize","SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","Scopes":"openid profile email api1 offline_access","GrantType":"hybrid","Tokens":[{"TokenType":"id_token","TokenValue":"****DJeQ","$type":"Token"},{"TokenType":"code","TokenValue":"****049d","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFRU1IV7JC:00000007","TimeStamp":"2019-06-13T09:30:44.0000000Z","ProcessId":15580,"LocalIpAddress":"127.0.0.1:35991","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 17:30:44.679 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ClientId":"mvcHybrid","RedirectUri":"http://localhost:5005/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpPSkBZK9A0XxoPJSaaTUvaSEqfXLZd99U1XVMVL33SMI0fKCkdSDbA7hxzPbxwQ4BCsJofw8XZZBt7045CHzFwEdIcOQRux6cEG_U7hpWsE6qhwdlMtyCuoTx8x4-gJJoMvJayw3oaI-F6kWpW4bOrDlfVi9XIaOWAItON1Lf25HC2eeqTNd29Po7esgSkDqN71xQhpnNNDDSjN0CaCZ93EPfYZsmKqZP2mti6xP6NKye8ens6SNCyzeupSYoMlFAkX_rSgPONvFXhJR76o0f7yE4TKYEzpKE9f2VFf9LoG5hA-Bvi6NVZRu4g7RmX2yo","Scope":"openid profile email api1 offline_access","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 17:30:44.685 +08:00 [DBG] Augmenting SignInContext
2019-06-13 17:30:44.686 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-13 17:30:45.045 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-13 17:30:45.046 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-13 17:30:45.046 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-13 17:30:45.046 +08:00 [DBG] Start token request.
2019-06-13 17:30:45.046 +08:00 [DBG] Start client validation
2019-06-13 17:30:45.046 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-13 17:30:45.047 +08:00 [DBG] Start parsing for secret in post body
2019-06-13 17:30:45.047 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-13 17:30:45.047 +08:00 [DBG] Secret id found: mvcHybrid
2019-06-13 17:30:46.095 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:30:46.095 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:30:46.095 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-13 17:30:46.096 +08:00 [DBG] Client validation success
2019-06-13 17:30:46.096 +08:00 [INF] {"ClientId":"mvcHybrid","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNFRU1IV7JD:00000004","TimeStamp":"2019-06-13T09:30:46.0000000Z","ProcessId":15580,"LocalIpAddress":"127.0.0.1:35991","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-13 17:30:46.096 +08:00 [DBG] Start token request validation
2019-06-13 17:30:46.096 +08:00 [DBG] Start validation of authorization code token request
2019-06-13 17:30:46.209 +08:00 [DBG] yX2w9jOkKlEntlmsPFW+qXtnu7SNM7itiJUKR8iggxo= found in database: true
2019-06-13 17:30:46.329 +08:00 [DBG] removing yX2w9jOkKlEntlmsPFW+qXtnu7SNM7itiJUKR8iggxo= persisted grant from database
2019-06-13 17:30:46.679 +08:00 [DBG] Validation of authorization code token request success
2019-06-13 17:30:46.679 +08:00 [INF] Token request validation success
{"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"20b4d8bc6c3c4d00b8c576d32784fd72ab728b616729c86e024ef3636364049d","RefreshToken":null,"UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"client_id":"mvcHybrid","client_secret":"***REDACTED***","code":"20b4d8bc6c3c4d00b8c576d32784fd72ab728b616729c86e024ef3636364049d","grant_type":"authorization_code","redirect_uri":"http://localhost:5005/signin-oidc"},"$type":"TokenRequestValidationLog"}
2019-06-13 17:30:47.702 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:30:47.703 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:30:47.900 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:30:48.453 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:30:48.453 +08:00 [DBG] Getting claims for access token for client: mvcHybrid
2019-06-13 17:30:48.453 +08:00 [DBG] Getting claims for access token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:30:48.453 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 17:30:48.459 +08:00 [DBG] Creating refresh token
2019-06-13 17:30:48.459 +08:00 [DBG] Setting a sliding lifetime: 1296000
2019-06-13 17:30:48.595 +08:00 [DBG] nfnhQZOVb3xeF1g6FGGbXVHEQ+uTkgxiLkXuxWVFQoE= not found in database
2019-06-13 17:30:49.852 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:30:49.853 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:30:50.042 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:30:50.541 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:30:50.541 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcHybrid
2019-06-13 17:30:50.541 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 17:30:50.544 +08:00 [INF] {"ClientId":"mvcHybrid","ClientName":"MVC Client Hybrid","RedirectUri":null,"Endpoint":"Token","SubjectId":null,"Scopes":"openid profile email api1 offline_access","GrantType":"authorization_code","Tokens":[{"TokenType":"id_token","TokenValue":"****0XnA","$type":"Token"},{"TokenType":"refresh_token","TokenValue":"****2ed8","$type":"Token"},{"TokenType":"access_token","TokenValue":"****cQTg","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFRU1IV7JD:00000004","TimeStamp":"2019-06-13T09:30:50.0000000Z","ProcessId":15580,"LocalIpAddress":"127.0.0.1:35991","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 17:30:50.544 +08:00 [DBG] Token request success.
2019-06-13 17:30:50.603 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:30:50.604 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:30:50.604 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:30:50.604 +08:00 [DBG] Start userinfo request
2019-06-13 17:30:50.604 +08:00 [DBG] Bearer token found in header
2019-06-13 17:30:51.667 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:30:51.667 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:30:52.725 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:30:52.725 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:30:52.843 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 17:30:52.843 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560418248,"exp":1560418848,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcHybrid","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560418199,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 17:30:52.843 +08:00 [DBG] Creating userinfo response
2019-06-13 17:30:52.844 +08:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2019-06-13 17:30:52.844 +08:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2019-06-13 17:30:53.025 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:30:53.025 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-13 17:30:53.025 +08:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2019-06-13 17:30:53.206 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:30:53.207 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 17:30:53.207 +08:00 [DBG] End userinfo request
2019-06-13 17:30:53.389 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:30:53.390 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:30:53.390 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:30:53.390 +08:00 [DBG] Start userinfo request
2019-06-13 17:30:53.390 +08:00 [DBG] Bearer token found in header
2019-06-13 17:30:54.435 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:30:54.435 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:30:55.502 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:30:55.502 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:30:55.616 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 17:30:55.616 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560418248,"exp":1560418848,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcHybrid","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560418199,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 17:30:55.616 +08:00 [DBG] Creating userinfo response
2019-06-13 17:30:55.616 +08:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2019-06-13 17:30:55.616 +08:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2019-06-13 17:30:55.818 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:30:55.818 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-13 17:30:55.818 +08:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2019-06-13 17:30:56.019 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:30:56.019 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 17:30:56.019 +08:00 [DBG] End userinfo request
2019-06-13 17:31:02.076 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 17:31:02.078 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 17:31:02.078 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 17:31:02.078 +08:00 [DBG] Start discovery request
2019-06-13 17:31:02.753 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 17:31:02.866 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 17:31:02.867 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 17:31:02.867 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 17:31:02.867 +08:00 [DBG] Start key discovery request
2019-06-13 17:31:52.815 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:31:52.816 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:31:52.816 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:31:52.816 +08:00 [DBG] Start userinfo request
2019-06-13 17:31:52.817 +08:00 [DBG] Bearer token found in header
2019-06-13 17:31:53.839 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:31:53.839 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:31:54.854 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:31:54.854 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:31:54.984 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 17:31:54.984 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560418248,"exp":1560418848,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcHybrid","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560418199,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 17:31:54.984 +08:00 [DBG] Creating userinfo response
2019-06-13 17:31:54.985 +08:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2019-06-13 17:31:54.985 +08:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2019-06-13 17:31:55.192 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:31:55.192 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-13 17:31:55.193 +08:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2019-06-13 17:31:55.375 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:31:55.376 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 17:31:55.376 +08:00 [DBG] End userinfo request
2019-06-13 17:32:01.704 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:32:01.705 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:32:01.705 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:32:01.705 +08:00 [DBG] Start userinfo request
2019-06-13 17:32:01.706 +08:00 [DBG] Bearer token found in header
2019-06-13 17:32:02.985 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:32:02.985 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:32:04.037 +08:00 [DBG] mvcHybrid found in database: true
2019-06-13 17:32:04.037 +08:00 [DBG] client configuration validation for client mvcHybrid succeeded.
2019-06-13 17:32:04.155 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 17:32:04.156 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560418248,"exp":1560418848,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcHybrid","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560418199,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","email","api1","offline_access"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 17:32:04.156 +08:00 [DBG] Creating userinfo response
2019-06-13 17:32:04.156 +08:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2019-06-13 17:32:04.156 +08:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2019-06-13 17:32:04.343 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:32:04.343 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile email email_verified
2019-06-13 17:32:04.343 +08:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2019-06-13 17:32:04.525 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2019-06-13 17:32:04.525 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 17:32:04.525 +08:00 [DBG] End userinfo request
2019-06-13 17:34:44.463 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 17:34:44.464 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 17:34:44.467 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 17:34:44.467 +08:00 [DBG] Start discovery request
2019-06-13 17:34:45.193 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 17:34:45.393 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 17:34:45.394 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 17:34:45.394 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 17:34:45.394 +08:00 [DBG] Start key discovery request
2019-06-13 17:34:45.495 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 17:34:45.495 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 17:34:45.495 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 17:34:45.495 +08:00 [DBG] Start authorize request
2019-06-13 17:34:45.496 +08:00 [DBG] User in authorize request: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:34:45.496 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 17:34:46.565 +08:00 [DBG] mvcImp found in database: true
2019-06-13 17:34:46.565 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 17:34:46.785 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:34:47.321 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:34:47.522 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:34:48.065 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 17:34:48.065 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 17:34:48.065 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 17:34:48.065 +08:00 [DBG] Start authorize request
2019-06-13 17:34:48.065 +08:00 [DBG] User in authorize request: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:34:48.066 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 17:34:48.112 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:34:48.113 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 17:34:48.113 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile api1","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqSkVcAob60G6LZeBUw5QGLThyABUhl8V4opmr3KfS6PK1Mchz_BM9-npWn10-FpO7n6V_MQVfTozJ3-tRBuVSwFFmwQpAoP5NnPiGBFdwwuEt1umcWKPN65W9Z6eZfeQQeF-yUDWjOqwpLchfbKHDQHWGh_oI8ehShuzTWXlWsG_zcI7EUFAEqDaLIX2IyOcM9IhMH24THxPgem2V6C_2gfYpLjkzTSSSITsKPUankDXxOiKJyiOopU-A37eGQNXg20xO5LyU2I7-8ZkTlCVb-BVnbwoE2bIp6tUFUi8_kKRlOvvMuY4RlQzWqqYYOX1w","UiLocales":null,"Nonce":"636960152854303255.MWFlZjJjZGQtYTM4MS00YzMxLWI0YWEtNjI4OTdhZDZhMTBiYmE0MzhiODgtZTEwOC00NDBhLWJiNWUtMWNmNzNlZDA3MTI1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"402450cab079c1117d6f04b630d01503","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile api1","response_mode":"form_post","nonce":"636960152854303255.MWFlZjJjZGQtYTM4MS00YzMxLWI0YWEtNjI4OTdhZDZhMTBiYmE0MzhiODgtZTEwOC00NDBhLWJiNWUtMWNmNzNlZDA3MTI1","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqSkVcAob60G6LZeBUw5QGLThyABUhl8V4opmr3KfS6PK1Mchz_BM9-npWn10-FpO7n6V_MQVfTozJ3-tRBuVSwFFmwQpAoP5NnPiGBFdwwuEt1umcWKPN65W9Z6eZfeQQeF-yUDWjOqwpLchfbKHDQHWGh_oI8ehShuzTWXlWsG_zcI7EUFAEqDaLIX2IyOcM9IhMH24THxPgem2V6C_2gfYpLjkzTSSSITsKPUankDXxOiKJyiOopU-A37eGQNXg20xO5LyU2I7-8ZkTlCVb-BVnbwoE2bIp6tUFUi8_kKRlOvvMuY4RlQzWqqYYOX1w","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 17:34:48.340 +08:00 [DBG] 2DblLcoWEpsfI5cQMBWCdPB6FbTucq7UTTfTiMK6w9I= found in database: true
2019-06-13 17:34:48.344 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 17:34:48.344 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 17:34:48.344 +08:00 [DBG] Getting claims for access token for client: mvcImp
2019-06-13 17:34:48.344 +08:00 [DBG] Getting claims for access token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:34:48.344 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 17:34:48.347 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcImp
2019-06-13 17:34:48.347 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 17:34:48.352 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","Scopes":"openid profile api1","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****iA3g","$type":"Token"},{"TokenType":"access_token","TokenValue":"****TBYw","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFRU1IV7JE:00000003","TimeStamp":"2019-06-13T09:34:48.0000000Z","ProcessId":15580,"LocalIpAddress":"127.0.0.1:35991","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 17:34:48.352 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqSkVcAob60G6LZeBUw5QGLThyABUhl8V4opmr3KfS6PK1Mchz_BM9-npWn10-FpO7n6V_MQVfTozJ3-tRBuVSwFFmwQpAoP5NnPiGBFdwwuEt1umcWKPN65W9Z6eZfeQQeF-yUDWjOqwpLchfbKHDQHWGh_oI8ehShuzTWXlWsG_zcI7EUFAEqDaLIX2IyOcM9IhMH24THxPgem2V6C_2gfYpLjkzTSSSITsKPUankDXxOiKJyiOopU-A37eGQNXg20xO5LyU2I7-8ZkTlCVb-BVnbwoE2bIp6tUFUi8_kKRlOvvMuY4RlQzWqqYYOX1w","Scope":"openid profile api1","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 17:34:48.352 +08:00 [DBG] Augmenting SignInContext
2019-06-13 17:34:48.353 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-13 17:34:49.408 +08:00 [DBG] mvcImp found in database: true
2019-06-13 17:34:49.408 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 17:34:49.622 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:34:50.188 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:34:50.395 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:34:50.961 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:34:50.962 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 17:34:50.962 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile api1","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqSkVcAob60G6LZeBUw5QGLThyABUhl8V4opmr3KfS6PK1Mchz_BM9-npWn10-FpO7n6V_MQVfTozJ3-tRBuVSwFFmwQpAoP5NnPiGBFdwwuEt1umcWKPN65W9Z6eZfeQQeF-yUDWjOqwpLchfbKHDQHWGh_oI8ehShuzTWXlWsG_zcI7EUFAEqDaLIX2IyOcM9IhMH24THxPgem2V6C_2gfYpLjkzTSSSITsKPUankDXxOiKJyiOopU-A37eGQNXg20xO5LyU2I7-8ZkTlCVb-BVnbwoE2bIp6tUFUi8_kKRlOvvMuY4RlQzWqqYYOX1w","UiLocales":null,"Nonce":"636960152854303255.MWFlZjJjZGQtYTM4MS00YzMxLWI0YWEtNjI4OTdhZDZhMTBiYmE0MzhiODgtZTEwOC00NDBhLWJiNWUtMWNmNzNlZDA3MTI1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"402450cab079c1117d6f04b630d01503","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile api1","response_mode":"form_post","nonce":"636960152854303255.MWFlZjJjZGQtYTM4MS00YzMxLWI0YWEtNjI4OTdhZDZhMTBiYmE0MzhiODgtZTEwOC00NDBhLWJiNWUtMWNmNzNlZDA3MTI1","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqSkVcAob60G6LZeBUw5QGLThyABUhl8V4opmr3KfS6PK1Mchz_BM9-npWn10-FpO7n6V_MQVfTozJ3-tRBuVSwFFmwQpAoP5NnPiGBFdwwuEt1umcWKPN65W9Z6eZfeQQeF-yUDWjOqwpLchfbKHDQHWGh_oI8ehShuzTWXlWsG_zcI7EUFAEqDaLIX2IyOcM9IhMH24THxPgem2V6C_2gfYpLjkzTSSSITsKPUankDXxOiKJyiOopU-A37eGQNXg20xO5LyU2I7-8ZkTlCVb-BVnbwoE2bIp6tUFUi8_kKRlOvvMuY4RlQzWqqYYOX1w","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 17:34:51.212 +08:00 [DBG] 2DblLcoWEpsfI5cQMBWCdPB6FbTucq7UTTfTiMK6w9I= found in database: true
2019-06-13 17:34:51.215 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 17:34:51.215 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 17:34:51.215 +08:00 [DBG] Getting claims for access token for client: mvcImp
2019-06-13 17:34:51.215 +08:00 [DBG] Getting claims for access token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:34:51.215 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 17:34:51.218 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcImp
2019-06-13 17:34:51.218 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 17:34:51.221 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","Scopes":"openid profile api1","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****41YA","$type":"Token"},{"TokenType":"access_token","TokenValue":"****EhBA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFRU1IV7JF:00000001","TimeStamp":"2019-06-13T09:34:51.0000000Z","ProcessId":15580,"LocalIpAddress":"127.0.0.1:35991","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 17:34:51.222 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IqSkVcAob60G6LZeBUw5QGLThyABUhl8V4opmr3KfS6PK1Mchz_BM9-npWn10-FpO7n6V_MQVfTozJ3-tRBuVSwFFmwQpAoP5NnPiGBFdwwuEt1umcWKPN65W9Z6eZfeQQeF-yUDWjOqwpLchfbKHDQHWGh_oI8ehShuzTWXlWsG_zcI7EUFAEqDaLIX2IyOcM9IhMH24THxPgem2V6C_2gfYpLjkzTSSSITsKPUankDXxOiKJyiOopU-A37eGQNXg20xO5LyU2I7-8ZkTlCVb-BVnbwoE2bIp6tUFUi8_kKRlOvvMuY4RlQzWqqYYOX1w","Scope":"openid profile api1","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 17:34:51.222 +08:00 [DBG] Augmenting SignInContext
2019-06-13 17:34:51.222 +08:00 [INF] AuthenticationScheme: Identity.Application signed in.
2019-06-13 17:34:51.441 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:34:51.446 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:34:51.446 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:34:51.446 +08:00 [DBG] Start userinfo request
2019-06-13 17:34:51.446 +08:00 [DBG] Bearer token found in header
2019-06-13 17:34:52.616 +08:00 [DBG] mvcImp found in database: true
2019-06-13 17:34:52.617 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 17:34:53.796 +08:00 [DBG] mvcImp found in database: true
2019-06-13 17:34:53.796 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 17:34:53.916 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 17:34:53.917 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560418491,"exp":1560422091,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcImp","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560418199,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","api1"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 17:34:53.917 +08:00 [DBG] Creating userinfo response
2019-06-13 17:34:53.917 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 17:34:53.917 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 17:34:54.117 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:34:54.118 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile
2019-06-13 17:34:54.118 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 17:34:54.325 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:34:54.326 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 17:34:54.326 +08:00 [DBG] End userinfo request
2019-06-13 17:35:15.207 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 17:35:15.211 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 17:35:15.211 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 17:35:15.211 +08:00 [DBG] Start discovery request
2019-06-13 17:35:15.938 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 17:35:16.111 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 17:35:16.111 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 17:35:16.111 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 17:35:16.112 +08:00 [DBG] Start key discovery request
2019-06-13 17:48:30.920 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-06-13 17:48:30.948 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-06-13 17:48:30.949 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-06-13 17:48:30.949 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-06-13 17:48:30.949 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-06-13 17:48:30.949 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-06-13 17:48:31.037 +08:00 [DBG] Starting grant removal
2019-06-13 17:48:31.372 +08:00 [DBG] Login Url: /Account/Login
2019-06-13 17:48:31.374 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-06-13 17:48:31.374 +08:00 [DBG] Logout Url: /Account/Logout
2019-06-13 17:48:31.374 +08:00 [DBG] ConsentUrl Url: /consent
2019-06-13 17:48:31.374 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2019-06-13 17:48:31.374 +08:00 [DBG] Error Url: /home/error
2019-06-13 17:48:31.375 +08:00 [DBG] Error Id Parameter: errorId
2019-06-13 17:48:31.400 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 17:48:31.407 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 17:48:31.407 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 17:48:31.414 +08:00 [DBG] Start discovery request
2019-06-13 17:48:32.400 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 17:48:32.624 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 17:48:32.626 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 17:48:32.626 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 17:48:32.632 +08:00 [DBG] Start key discovery request
2019-06-13 17:48:32.744 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 17:48:32.748 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 17:48:32.748 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 17:48:32.752 +08:00 [DBG] Start authorize request
2019-06-13 17:48:32.762 +08:00 [DBG] User in authorize request: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:48:32.766 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 17:48:34.110 +08:00 [DBG] mvcImp found in database: true
2019-06-13 17:48:34.120 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 17:48:34.357 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:48:34.943 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:48:35.135 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:48:35.943 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:48:35.952 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 17:48:35.964 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile api1","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpaPz8XaZSYBLZkA4LbIROlYq48UUEx5lRFFY8DxEVwlO4OKN-YpYWZQaxQMR45qmKAHMJTciXTqR7VEwEHyz8JUM61-WxMIGRjVwLoj7VXcisD7cyftn8OiObbmfiGEyPuxdfFS9pVd7XjlLNsfeSTBbWQ7uNR9fSDKnrzpN9YZgzI_0J11mtnlvaU0DCdreVo82LnfcQ2IfpmrfHGb4RoKp27FdwMjrV_OvU7CyCzf3i1sqPGin1fLnEVHhL0aEbY7P2hoFFSFI3tGjAniZ6fJaRt3QXp7x0fIAQinyccpz49J8vn2qexsTLrJpCMqzY","UiLocales":null,"Nonce":"636960161126840872.MTcwNmJhODAtMDk1ZS00MDcxLTkyNGYtNGJlOTY1NWEzYzU5ODllYWMwZTUtMDRiOC00ZDk4LWE5YzUtYzBlYmNlNTZiNDVm","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"402450cab079c1117d6f04b630d01503","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile api1","response_mode":"form_post","nonce":"636960161126840872.MTcwNmJhODAtMDk1ZS00MDcxLTkyNGYtNGJlOTY1NWEzYzU5ODllYWMwZTUtMDRiOC00ZDk4LWE5YzUtYzBlYmNlNTZiNDVm","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpaPz8XaZSYBLZkA4LbIROlYq48UUEx5lRFFY8DxEVwlO4OKN-YpYWZQaxQMR45qmKAHMJTciXTqR7VEwEHyz8JUM61-WxMIGRjVwLoj7VXcisD7cyftn8OiObbmfiGEyPuxdfFS9pVd7XjlLNsfeSTBbWQ7uNR9fSDKnrzpN9YZgzI_0J11mtnlvaU0DCdreVo82LnfcQ2IfpmrfHGb4RoKp27FdwMjrV_OvU7CyCzf3i1sqPGin1fLnEVHhL0aEbY7P2hoFFSFI3tGjAniZ6fJaRt3QXp7x0fIAQinyccpz49J8vn2qexsTLrJpCMqzY","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 17:48:36.368 +08:00 [DBG] 2DblLcoWEpsfI5cQMBWCdPB6FbTucq7UTTfTiMK6w9I= found in database: true
2019-06-13 17:48:36.373 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 17:48:36.381 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 17:48:36.391 +08:00 [DBG] Getting claims for access token for client: mvcImp
2019-06-13 17:48:36.392 +08:00 [DBG] Getting claims for access token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:48:36.399 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 17:48:36.473 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcImp
2019-06-13 17:48:36.473 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 17:48:36.489 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","Scopes":"openid profile api1","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****8LrQ","$type":"Token"},{"TokenType":"access_token","TokenValue":"****Uz9Q","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFSH5J69G5:00000003","TimeStamp":"2019-06-13T09:48:36.0000000Z","ProcessId":33776,"LocalIpAddress":"127.0.0.1:30489","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 17:48:36.492 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_IpaPz8XaZSYBLZkA4LbIROlYq48UUEx5lRFFY8DxEVwlO4OKN-YpYWZQaxQMR45qmKAHMJTciXTqR7VEwEHyz8JUM61-WxMIGRjVwLoj7VXcisD7cyftn8OiObbmfiGEyPuxdfFS9pVd7XjlLNsfeSTBbWQ7uNR9fSDKnrzpN9YZgzI_0J11mtnlvaU0DCdreVo82LnfcQ2IfpmrfHGb4RoKp27FdwMjrV_OvU7CyCzf3i1sqPGin1fLnEVHhL0aEbY7P2hoFFSFI3tGjAniZ6fJaRt3QXp7x0fIAQinyccpz49J8vn2qexsTLrJpCMqzY","Scope":"openid profile api1","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 17:48:36.746 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:48:36.749 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:48:36.749 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:48:36.758 +08:00 [DBG] Start userinfo request
2019-06-13 17:48:36.763 +08:00 [DBG] Bearer token found in header
2019-06-13 17:48:37.957 +08:00 [DBG] mvcImp found in database: true
2019-06-13 17:48:37.957 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 17:48:39.100 +08:00 [DBG] mvcImp found in database: true
2019-06-13 17:48:39.100 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 17:48:39.228 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 17:48:39.229 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560419316,"exp":1560422916,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcImp","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560418199,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","api1"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 17:48:39.236 +08:00 [DBG] Creating userinfo response
2019-06-13 17:48:39.239 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 17:48:39.242 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 17:48:39.452 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:48:39.453 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile
2019-06-13 17:48:39.453 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 17:48:39.667 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:48:39.667 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 17:48:39.667 +08:00 [DBG] End userinfo request
2019-06-13 17:49:03.633 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:49:03.634 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:49:03.634 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:49:03.635 +08:00 [DBG] Start userinfo request
2019-06-13 17:49:03.635 +08:00 [DBG] Bearer token found in header
2019-06-13 17:49:04.718 +08:00 [DBG] mvcImp found in database: true
2019-06-13 17:49:04.718 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 17:49:05.802 +08:00 [DBG] mvcImp found in database: true
2019-06-13 17:49:05.802 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 17:49:05.920 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 17:49:05.920 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560419316,"exp":1560422916,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcImp","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560418199,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","api1"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 17:49:05.921 +08:00 [DBG] Creating userinfo response
2019-06-13 17:49:05.921 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 17:49:05.921 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 17:49:06.115 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:49:06.115 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile
2019-06-13 17:49:06.116 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 17:49:06.315 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:49:06.315 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 17:49:06.315 +08:00 [DBG] End userinfo request
2019-06-13 17:49:06.558 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 17:49:06.559 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 17:49:06.559 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 17:49:06.559 +08:00 [DBG] Start discovery request
2019-06-13 17:49:07.294 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 17:49:07.418 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 17:49:07.418 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 17:49:07.419 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 17:49:07.419 +08:00 [DBG] Start key discovery request
2019-06-13 17:51:17.078 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 17:51:17.079 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 17:51:17.079 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 17:51:17.079 +08:00 [DBG] Start discovery request
2019-06-13 17:51:17.804 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 17:51:17.908 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 17:51:17.909 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 17:51:17.909 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 17:51:17.909 +08:00 [DBG] Start key discovery request
2019-06-13 17:51:17.974 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-06-13 17:51:17.974 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-06-13 17:51:17.975 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-06-13 17:51:17.975 +08:00 [DBG] Start authorize request
2019-06-13 17:51:17.975 +08:00 [DBG] User in authorize request: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:51:17.975 +08:00 [DBG] Start authorize request protocol validation
2019-06-13 17:51:19.100 +08:00 [DBG] mvcImp found in database: true
2019-06-13 17:51:19.100 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 17:51:19.306 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:51:19.865 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:51:20.070 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:51:20.615 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:51:20.615 +08:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-06-13 17:51:20.615 +08:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","AllowedRedirectUris":["http://localhost:5004/signin-oidc"],"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ResponseType":"id_token token","ResponseMode":"form_post","GrantType":"implicit","RequestedScopes":"openid profile api1","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ir25NBxpODQ04NEuECblUeFBOcwpU_mlcBNsh8r3RiARKjwRdSvd3ijG0nu2SGaUFqH8-VnJCFinFtPU-vRFMKCCxtzA8W4kPsH7OcBm-nDpLfWQoFZrD7ouvKefxwcqIGf3Sg5-LtL7CJbd_tyBDEVqnfoHmc4Dc-cTeUWSIHAkKPd_MCjItaUfhD8pIiV6g4GnKv4DjNpv8bkyp9AtLrGuSSHislO0mB2jhn7KQ0dAaw31k8Vm6ugVIdiYZUfFszfbh25extG_RfNGtWeh0kqWycv1zCwYGgZ_0PSQkg8s7UhA5sXRJoDTnCOEY1XACs","UiLocales":null,"Nonce":"636960162779342767.YTEyNmMzMTEtYmM0Yy00ZDdlLWI2MjItYTVhNmVlODA4MjJlYzAxOTY2M2QtNTY0Yi00N2E1LTk5YmMtODFmY2UyMjc5ZTlj","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"402450cab079c1117d6f04b630d01503","Raw":{"client_id":"mvcImp","redirect_uri":"http://localhost:5004/signin-oidc","response_type":"id_token token","scope":"openid profile api1","response_mode":"form_post","nonce":"636960162779342767.YTEyNmMzMTEtYmM0Yy00ZDdlLWI2MjItYTVhNmVlODA4MjJlYzAxOTY2M2QtNTY0Yi00N2E1LTk5YmMtODFmY2UyMjc5ZTlj","state":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ir25NBxpODQ04NEuECblUeFBOcwpU_mlcBNsh8r3RiARKjwRdSvd3ijG0nu2SGaUFqH8-VnJCFinFtPU-vRFMKCCxtzA8W4kPsH7OcBm-nDpLfWQoFZrD7ouvKefxwcqIGf3Sg5-LtL7CJbd_tyBDEVqnfoHmc4Dc-cTeUWSIHAkKPd_MCjItaUfhD8pIiV6g4GnKv4DjNpv8bkyp9AtLrGuSSHislO0mB2jhn7KQ0dAaw31k8Vm6ugVIdiYZUfFszfbh25extG_RfNGtWeh0kqWycv1zCwYGgZ_0PSQkg8s7UhA5sXRJoDTnCOEY1XACs","x-client-SKU":"ID_NETSTANDARD2_0","x-client-ver":"5.3.0.0"},"$type":"AuthorizeRequestValidationLog"}
2019-06-13 17:51:20.870 +08:00 [DBG] 2DblLcoWEpsfI5cQMBWCdPB6FbTucq7UTTfTiMK6w9I= found in database: true
2019-06-13 17:51:20.874 +08:00 [DBG] Consent found in consent store is same as current request, consent is not required
2019-06-13 17:51:20.874 +08:00 [DBG] Creating Implicit Flow response.
2019-06-13 17:51:20.874 +08:00 [DBG] Getting claims for access token for client: mvcImp
2019-06-13 17:51:20.874 +08:00 [DBG] Getting claims for access token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:51:20.875 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 17:51:20.878 +08:00 [DBG] Getting claims for identity token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af and client: mvcImp
2019-06-13 17:51:20.878 +08:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-06-13 17:51:20.887 +08:00 [INF] {"ClientId":"mvcImp","ClientName":"MVC ClientImp","RedirectUri":"http://localhost:5004/signin-oidc","Endpoint":"Authorize","SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","Scopes":"openid profile api1","GrantType":"implicit","Tokens":[{"TokenType":"id_token","TokenValue":"****l6ag","$type":"Token"},{"TokenType":"access_token","TokenValue":"****2JxQ","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFSH5J69G6:00000003","TimeStamp":"2019-06-13T09:51:20.0000000Z","ProcessId":33776,"LocalIpAddress":"127.0.0.1:30489","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 17:51:20.888 +08:00 [INF] Authorize endpoint response
{"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","ClientId":"mvcImp","RedirectUri":"http://localhost:5004/signin-oidc","State":"CfDJ8Okx1kBrY49Hn4K6S7x-_Ir25NBxpODQ04NEuECblUeFBOcwpU_mlcBNsh8r3RiARKjwRdSvd3ijG0nu2SGaUFqH8-VnJCFinFtPU-vRFMKCCxtzA8W4kPsH7OcBm-nDpLfWQoFZrD7ouvKefxwcqIGf3Sg5-LtL7CJbd_tyBDEVqnfoHmc4Dc-cTeUWSIHAkKPd_MCjItaUfhD8pIiV6g4GnKv4DjNpv8bkyp9AtLrGuSSHislO0mB2jhn7KQ0dAaw31k8Vm6ugVIdiYZUfFszfbh25extG_RfNGtWeh0kqWycv1zCwYGgZ_0PSQkg8s7UhA5sXRJoDTnCOEY1XACs","Scope":"openid profile api1","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-06-13 17:51:21.105 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:51:21.106 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:51:21.106 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:51:21.106 +08:00 [DBG] Start userinfo request
2019-06-13 17:51:21.106 +08:00 [DBG] Bearer token found in header
2019-06-13 17:51:22.224 +08:00 [DBG] mvcImp found in database: true
2019-06-13 17:51:22.225 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 17:51:23.370 +08:00 [DBG] mvcImp found in database: true
2019-06-13 17:51:23.370 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 17:51:23.494 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 17:51:23.494 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560419480,"exp":1560423080,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcImp","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560418199,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","api1"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 17:51:23.494 +08:00 [DBG] Creating userinfo response
2019-06-13 17:51:23.495 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 17:51:23.495 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 17:51:23.711 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:51:23.711 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile
2019-06-13 17:51:23.711 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 17:51:23.920 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:51:23.920 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 17:51:23.920 +08:00 [DBG] End userinfo request
2019-06-13 17:51:30.653 +08:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-06-13 17:51:30.654 +08:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-06-13 17:51:30.654 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-06-13 17:51:30.654 +08:00 [DBG] Start userinfo request
2019-06-13 17:51:30.654 +08:00 [DBG] Bearer token found in header
2019-06-13 17:51:31.780 +08:00 [DBG] mvcImp found in database: true
2019-06-13 17:51:31.780 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 17:51:32.872 +08:00 [DBG] mvcImp found in database: true
2019-06-13 17:51:32.872 +08:00 [DBG] client configuration validation for client mvcImp succeeded.
2019-06-13 17:51:32.998 +08:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-06-13 17:51:32.998 +08:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1560419480,"exp":1560423080,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","api1"],"client_id":"mvcImp","sub":"af67182f-859b-42aa-a1aa-ee2f0321b4af","auth_time":1560418199,"idp":"local","preferred_username":"1223138295@qq.com","unique_name":"1223138295@qq.com","name":"晓锋","last_name":"王","card_number":"4353453453","card_holder":"43534","card_security_number":"454353","card_expiration":"23/23","address_city":"上海","address_country":"中国","address_state":"无","address_street":"上海浦东","address_zip_code":"226153","email":"1223138295@qq.com","email_verified":false,"phone_number":"17602180068","phone_number_verified":false,"scope":["openid","profile","api1"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-06-13 17:51:32.998 +08:00 [DBG] Creating userinfo response
2019-06-13 17:51:32.998 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 17:51:32.998 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 17:51:33.204 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:51:33.204 +08:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website picture preferred_username nickname middle_name given_name family_name name profile
2019-06-13 17:51:33.204 +08:00 [DBG] Scopes in access token: openid profile api1
2019-06-13 17:51:33.418 +08:00 [DBG] Found ["openid","profile"] identity scopes in database
2019-06-13 17:51:33.418 +08:00 [INF] Profile service returned the following claim types: sub preferred_username unique_name name last_name card_number card_holder card_security_number card_expiration address_city address_country address_state address_street address_zip_code email email_verified phone_number phone_number_verified
2019-06-13 17:51:33.418 +08:00 [DBG] End userinfo request
2019-06-13 17:51:33.611 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 17:51:33.611 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 17:51:33.612 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 17:51:33.612 +08:00 [DBG] Start discovery request
2019-06-13 17:51:34.344 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 17:51:34.460 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 17:51:34.461 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 17:51:34.461 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 17:51:34.461 +08:00 [DBG] Start key discovery request
2019-06-13 17:51:39.905 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-06-13 17:51:39.906 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-06-13 17:51:39.907 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-06-13 17:51:39.907 +08:00 [DBG] Start discovery request
2019-06-13 17:51:40.606 +08:00 [DBG] Found ["openid","profile","email","api1"] as all scopes in database
2019-06-13 17:51:40.665 +08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-06-13 17:51:40.666 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-06-13 17:51:40.666 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-06-13 17:51:40.666 +08:00 [DBG] Start key discovery request
2019-06-13 17:51:40.789 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2019-06-13 17:51:40.793 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2019-06-13 17:51:40.793 +08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2019-06-13 17:51:40.800 +08:00 [DBG] Start token request.
2019-06-13 17:51:40.808 +08:00 [DBG] Start client validation
2019-06-13 17:51:40.813 +08:00 [DBG] Start parsing Basic Authentication secret
2019-06-13 17:51:40.816 +08:00 [DBG] Start parsing for secret in post body
2019-06-13 17:51:40.831 +08:00 [DBG] Parser found secret: PostBodySecretParser
2019-06-13 17:51:40.831 +08:00 [DBG] Secret id found: ro.client
2019-06-13 17:51:41.944 +08:00 [DBG] ro.client found in database: true
2019-06-13 17:51:41.944 +08:00 [DBG] client configuration validation for client ro.client succeeded.
2019-06-13 17:51:41.953 +08:00 [DBG] Secret validator success: HashedSharedSecretValidator
2019-06-13 17:51:41.953 +08:00 [DBG] Client validation success
2019-06-13 17:51:41.953 +08:00 [INF] {"ClientId":"ro.client","AuthenticationMethod":"SharedSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"0HLNFSH5J69G6:0000000A","TimeStamp":"2019-06-13T09:51:41.0000000Z","ProcessId":33776,"LocalIpAddress":"127.0.0.1:30489","RemoteIpAddress":"::1","$type":"ClientAuthenticationSuccessEvent"}
2019-06-13 17:51:41.958 +08:00 [DBG] Start token request validation
2019-06-13 17:51:41.969 +08:00 [DBG] Start resource owner password token request validation
2019-06-13 17:51:42.092 +08:00 [DBG] Found [] identity scopes in database
2019-06-13 17:51:42.642 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:51:42.759 +08:00 [DBG] Found [] identity scopes in database
2019-06-13 17:51:43.309 +08:00 [DBG] Found ["api1"] API scopes in database
2019-06-13 17:51:43.476 +08:00 [INF] Credentials validated for username: 1223138295@qq.com
2019-06-13 17:51:43.477 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","DisplayName":"1223138295@qq.com","Endpoint":"Token","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNFSH5J69G6:0000000A","TimeStamp":"2019-06-13T09:51:43.0000000Z","ProcessId":33776,"LocalIpAddress":"127.0.0.1:30489","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-13 17:51:43.479 +08:00 [INF] {"Username":"1223138295@qq.com","Provider":null,"ProviderUserId":null,"SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","DisplayName":null,"Endpoint":"Token","Category":"Authentication","Name":"User Login Success","EventType":"Success","Id":1000,"Message":null,"ActivityId":"0HLNFSH5J69G6:0000000A","TimeStamp":"2019-06-13T09:51:43.0000000Z","ProcessId":33776,"LocalIpAddress":"127.0.0.1:30489","RemoteIpAddress":"::1","$type":"UserLoginSuccessEvent"}
2019-06-13 17:51:43.479 +08:00 [DBG] Resource owner password token request validation success.
2019-06-13 17:51:43.482 +08:00 [INF] Token request validation success
{"ClientId":"ro.client","ClientName":null,"GrantType":"password","Scopes":"api1","AuthorizationCode":null,"RefreshToken":null,"UserName":"1223138295@qq.com","AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"password","username":"1223138295@qq.com","password":"***REDACTED***","scope":"api1","client_id":"ro.client","client_secret":"***REDACTED***"},"$type":"TokenRequestValidationLog"}
2019-06-13 17:51:43.495 +08:00 [DBG] Getting claims for access token for client: ro.client
2019-06-13 17:51:43.496 +08:00 [DBG] Getting claims for access token for subject: af67182f-859b-42aa-a1aa-ee2f0321b4af
2019-06-13 17:51:43.496 +08:00 [DBG] Claim types from profile service that were filtered: ["sub"]
2019-06-13 17:51:43.509 +08:00 [INF] {"ClientId":"ro.client","ClientName":null,"RedirectUri":null,"Endpoint":"Token","SubjectId":"af67182f-859b-42aa-a1aa-ee2f0321b4af","Scopes":"api1","GrantType":"password","Tokens":[{"TokenType":"access_token","TokenValue":"****rPSA","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"0HLNFSH5J69G6:0000000A","TimeStamp":"2019-06-13T09:51:43.0000000Z","ProcessId":33776,"LocalIpAddress":"127.0.0.1:30489","RemoteIpAddress":"::1","$type":"TokenIssuedSuccessEvent"}
2019-06-13 17:51:43.510 +08:00 [DBG] Token request success.
